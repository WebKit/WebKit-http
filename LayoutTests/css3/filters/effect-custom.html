<!doctype html>
<html>
    <head>
        <title>Testing that the custom filter is applied correctly.</title>
        <script>
            if (window.layoutTestController) {
                window.layoutTestController.overridePreference("WebKitWebGLEnabled", "1");
                // Force software rendering mode.
                window.layoutTestController.overridePreference("WebKitAcceleratedCompositingEnabled", "0");
                window.layoutTestController.dumpAsText(true);
                window.layoutTestController.waitUntilDone();
            }
            
            function runTest()
            {
                // We need to run the tests after the downloading succeeded.
                // Using a timer is not ideal, but there seems to be no better options.
                setTimeout(function() {
                    if (window.layoutTestController)
                        window.layoutTestController.notifyDone();
                }, 200);
            }
        </script>
    </head>
    <body onload="runTest()">
        <img style="-webkit-filter: custom(url('resources/vertex-offset.vs') url('resources/color-offset.fs'))" src="resources/reference.png">
        <img style="-webkit-filter: custom(url('resources/vertex-offset.vs'), 6 11)" src="resources/reference.png">
        <img style="-webkit-filter: custom(url('resources/vertex-explode-detached.vs'), 3 3 detached)" src="resources/reference.png">
        <img style="-webkit-filter: custom(url('resources/vertex-explode-detached.vs') url('resources/color-offset.fs'), 3 3 detached)" src="resources/reference.png">
        <img style="-webkit-filter: custom(none url('resources/color-offset.fs'))" src="resources/reference.png">
        <!--
            Testing that simple custom filters work in software mode. You should see 5 blocks of colored bars with different effects applied, from left to right: 
            offset to the right with washed out colors, just offset to the right with normal colors, 4 smaller blocks attached to the corners, 4 smaller blocks 
            attached to the corners with washed out colors, normal block with washed out colors.
            Note: WebGL needs to be enabled for this test to succeed.
        -->
    </body>
</html>