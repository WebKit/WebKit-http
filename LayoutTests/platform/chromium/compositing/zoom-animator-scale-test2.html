<html>
  <head>
    <script>
        if (window.internals) {
            window.internals.setEnableScrollAnimator(document, true);
            window.internals.setForceCompositingMode(document, true);
        }

        if (window.layoutTestController) {
            window.layoutTestController.dumpAsText(true);
            window.layoutTestController.waitUntilDone();
        }

        var timer;
        var count = 0;
        var maxCount = 10;
        var newScale = 1.25;

        function finishTest() {
            count++;
            if (!window.internals || (window.internals.getPageScaleFactor(document) == newScale || count > maxCount)) {
                clearInterval(timer);

                if (count > maxCount) {
                    document.getElementById("aBox").style.backgroundColor = "red";
                    document.getElementById("aBox").innerHTML = "<center>FAIL!</center>";
                }

                document.documentElement.style.overflow = "hidden";
                if (window.layoutTestController)
                    window.layoutTestController.notifyDone();
            }
        }

        function doTest() {
            document.getElementById("aBox").style.backgroundColor = "green";
            if (window.internals) {
                window.internals.setZoomAnimatorTransform(document, newScale, 100.0, 100.0);
                // Check periodically for animation completion.
                timer = setInterval("finishTest()", 250);
            }
        }

        window.addEventListener("load", doTest, false);
    </script>
  </head>
<body id="theBody">
  <!--    If successful, the box should enlarge to be 125x125 at (125,125).
    -->
  <div id="aBox" style="width:100px; height:100px; position:absolute; left:100px; top:100px; background-color:#FF0000"></div>
</body>
</html>
