<!DOCTYPE html>
<body style="background-color: #eeffff;">
<input type=date id=date value="10000-12-31" list="suggestions" style="width: 200px;">
<datalist id=suggestions>
    <option>2012-01-00</option> <!--invalid-->
    <option>foo</option> <!--invalid-->
    <option label="Today">2012-01-01</option>
    <option label="Tomorrow">2012-01-02</option>
    <option>2012-01-03</option>
    <option>2012-01-04</option>
    <option>2012-01-05</option>
    <option>2012-01-06</option>
    <option>2012-01-07</option>
    <option>2012-01-08</option>
    <option>2012-01-09</option>
    <option>2012-01-10</option>
    <option>2012-01-11</option>
    <option>2012-01-12</option>
    <option>2012-01-13</option>
    <option>2012-01-14</option>
    <option>2012-01-15</option>
    <option>2012-01-16</option>
    <option>2012-01-17</option>
    <option>2012-01-18</option>
    <option>2012-01-19</option>
</datalist>
<script>
function sendKey(input, keyName) {
    var event = document.createEvent('KeyboardEvent');
    event.initKeyboardEvent('keydown', true, true, document.defaultView, keyName);
    input.dispatchEvent(event);
}

function finishTest() {
    pickerWindow.removeEventListener('resize', finishTest);
    pickerWindow.focus();
    eventSender.keyDown('downArrow');
    setTimeout(function() {testRunner.notifyDone();}, 0);
}

testRunner.dumpAsText(true);
testRunner.waitUntilDone();
if (window.internals)
    internals.settings.setEnableMockPagePopup(true);

var dateInput = document.getElementById('date');
dateInput.offsetTop;
sendKey(dateInput, 'Down');
var pickerWindow = document.getElementById('mock-page-popup').contentWindow;
pickerWindow.addEventListener('resize', finishTest, false);
</script>
</body>
