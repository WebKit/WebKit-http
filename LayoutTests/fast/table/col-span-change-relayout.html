<!DOCTYPE html>
<html>
    <head>
        <style>
            table
            {
                border-collapse: collapse;
                table-layout: fixed;
                width: 200px;
            }
            td
            {
                background: green;
                height: 1em;
            }
        </style>
        <script>
            if (window.testRunner)
                testRunner.dumpAsText();

            function log(msg)
            {
                var console = document.getElementById('console');
                console.appendChild(document.createTextNode(msg));
                console.appendChild(document.createElement('br'));
            }

            function changeColSpan()
            {
                var col = document.getElementById('column');
                var oldCellWidth = getComputedStyle(document.getElementById('table')).width;
                col.setAttribute("span", "1");
                var newCellWidth = getComputedStyle(document.getElementById('table')).width;

                log("Table width was " + oldCellWidth);
                log("Table width is " + newCellWidth);
                if (oldCellWidth != newCellWidth)
                    log("PASSED: Table changed width");
                else
                    log("FAILED: Table did not change width");
            }
        </script>
    </head>
    <body onload="changeColSpan();">
        <p>This test checks that dynamically changing a column's 'span' properly recompute the cell's widths.</p>
        <p>The table below shrink to 200px after changing the column's span.</p>
        <table id="table">
            <colgroup>
                <col span="2" id="column" style="width: 100px"></col>
                <col style="width: 100px;"></col>
            </colgroup>
            <tr>
                <td id="cell"></td>
                <td></td>
                <td></td>
           </tr>
        </table>
        <p id="console"></p>
    </body>
</html>

