<html>
<head>
    <script>
        
        function log(msg)
        {
            document.getElementById('log').appendChild(document.createTextNode(msg + '\n'));
        }

        function test() 
        {       
            if (window.layoutTestController) 
                layoutTestController.dumpAsText();

            var INEVENT = "focusin";
            var OUTEVENT = "focusout";
            
            var b1 = document.getElementById('button1');
            var b2 = document.getElementById('button2');
            var b3 = document.getElementById('button3');
            
            b1.addEventListener(INEVENT, TestInEvent, true);
            b2.addEventListener(INEVENT, TestInEvent, true);
            b3.addEventListener(INEVENT, TestInEvent, true);
            
            b1.addEventListener(OUTEVENT, TestOutEvent, true);
            b2.addEventListener(OUTEVENT, TestOutEvent, true);
            b3.addEventListener(OUTEVENT, TestOutEvent, true);
            
            if (!window.layoutTestController)
                return;
    
            for (var i = 0; i < 4; i++) 
                eventSender.keyDown('\t');
        }
        
        function TestInEvent(evt) 
        {
            if (evt.relatedTarget)
                log(evt.target.innerText + " received focusin, its relatedTarget is " + evt.relatedTarget.innerText);
            else
                log(evt.target.innerText + " received focusin, its relatedTarget is " + evt.relatedTarget);  
        }
        
        function TestOutEvent(evt) 
        {
            if (evt.relatedTarget)
                log(evt.target.innerText + " received focusout, its relatedTarget is " + evt.relatedTarget.innerText);
            else
                log(evt.target.innerText + " received focusout, its relatedTarget is " + evt.relatedTarget);
             
        }
    </script>
</head>
<body onload="test()">
<p>Layout test for <a href="https://bugs.webkit.org/show_bug.cgi?id=76216" tabindex=-1>https://bugs.webkit.org/show_bug.cgi?id=76216</a>.  Checks that the relatedTarget attribute for FocusEvent objects is being set correctly when focusin/focusout events are dispatched.  <b>Press tab four times</b> to dispatch a focusin and focusout event for each of the buttons below.</p>
    <button id="button1">Meow</button>
    <button id="button2">Purr</button>
    <button id="button3">Fur!</button>
    <button id="inputdone">Done</button>
    <p>Expected Result</p>
    <pre>
Meow received focusin, its relatedTarget is null
Meow received focusout, its relatedTarget is Purr
Purr received focusin, its relatedTarget is Meow
Purr received focusout, its relatedTarget is Fur!
Fur! received focusin, its relatedTarget is Purr
Fur! received focusout, its relatedTarget is Done
    </pre>
    <p>Actual Result</p>
    <pre id="log"></pre>
</body>
</html>
