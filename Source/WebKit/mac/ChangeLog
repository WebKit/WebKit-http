2013-11-01  Andy Estes  <aestes@apple.com>

        [iOS] Make some headers Private
        https://bugs.webkit.org/show_bug.cgi?id=123626

        Reviewed by Andreas Kling.

        * Configurations/WebKit.xcconfig: Exclude iOS Private headers from the Mac build.

2013-10-31  Alexey Proskuryakov  <ap@apple.com>

        Enable WebCrypto on Mac
        https://bugs.webkit.org/show_bug.cgi?id=123587

        Reviewed by Anders Carlsson.

        * Configurations/FeatureDefines.xcconfig: Do it.

2013-10-30  Ryosuke Niwa  <rniwa@webkit.org>

        Remove code for Mac Lion
        https://bugs.webkit.org/show_bug.cgi?id=123542

        Reviewed by Anders Carlsson.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView attachRootLayer:]):
        * WebView/WebView.mm:

2013-10-29  Andy Estes  <aestes@apple.com>

        [iOS] Upstream Source/WebKit/ios/
        https://bugs.webkit.org/show_bug.cgi?id=123470

        Reviewed by Sam Weinig.

        * Configurations/WebKit.xcconfig: Excluded some iOS files from the Mac build.

2013-10-29  Alexey Proskuryakov  <ap@apple.com>

        Result of focus-option-control-on-page.html depends on system preferences
        https://bugs.webkit.org/show_bug.cgi?id=123304

        Reviewed by Simon Fraser.

        * WebView/WebView.mm: (-[WebView _retrieveKeyboardUIModeFromPreferences:]):
        Read the preference from its correct domain. This doesn't affect behavior in practice
        and isn't part of the fix, but it's a good opportunity to correct this code.

2013-10-29  Jer Noble  <jer.noble@apple.com>

        [MSE] [Mac] Enable MediaSource on the Mac
        https://bugs.webkit.org/show_bug.cgi?id=122484

        Reviewed by Darin Adler.

        Enable ENABLE_MEDIA_SOURCE.

        * Configurations/FeatureDefines.xcconfig:

2013-10-28  Joseph Pecoraro  <pecoraro@apple.com>

        Upstream remaining PLATFORM(IOS) and ENABLE(REMOTE_INSPECTOR) pieces
        https://bugs.webkit.org/show_bug.cgi?id=123411

        Reviewed by Timothy Hatcher.

        Upstream iOS node highlighting and view indication.

        * WebCoreSupport/WebInspectorClient.h:
        * WebInspector/WebInspector.h:
        * WebInspector/WebInspector.mm:
        * WebInspector/WebNodeHighlight.h:
        * WebInspector/WebNodeHighlight.mm:
        (-[WebHighlightLayer initWithHighlightView:webView:]):
        (-[WebHighlightLayer layoutSublayers]):
        (-[WebHighlightLayer actionForKey:]):
        (-[WebNodeHighlight initWithTargetView:inspectorController:]):
        (-[WebNodeHighlight dealloc]):
        (-[WebNodeHighlight attach]):
        * WebInspector/WebNodeHighlightView.h:
        * WebInspector/WebNodeHighlightView.mm:
        (-[WebNodeHighlightView initWithWebNodeHighlight:]):
        (-[WebNodeHighlightView dealloc]):
        (-[WebNodeHighlightView _attach:numLayers:]):
        (findIntersectionOnLineBetweenPoints):
        (quadIntersection):
        (layerPathWithHole):
        (layerPath):
        (-[WebNodeHighlightView _layoutForNodeHighlight:parent:]):
        (-[WebNodeHighlightView _layoutForRectsHighlight:parent:]):
        (-[WebNodeHighlightView layoutSublayers:]):
        * WebInspector/WebNodeHighlighter.mm:
        (-[WebNodeHighlighter highlight]):
        * WebView/WebIndicateLayer.h: Added.
        * WebView/WebIndicateLayer.mm: Added.
        (-[WebIndicateLayer layoutSublayers]):
        (-[WebIndicateLayer actionForKey:]):
        * WebView/WebView.mm:
        (-[WebView setIndicatingForRemoteInspector:]):
        (-[WebView setHostApplicationBundleId:name:]):
        (-[WebView hostApplicationBundleId]):
        (-[WebView hostApplicationName]):
        * WebView/WebViewData.h:
        * WebView/WebViewData.mm:
        (-[WebViewPrivate dealloc]):

2013-10-28  Myles C. Maxfield  <mmaxfield@apple.com>

        Parsing support for -webkit-text-decoration-skip: ink
        https://bugs.webkit.org/show_bug.cgi?id=123358

        Reviewed by Dean Jackson.

        Adding ENABLE(CSS3_TEXT_DECORATION)

        * Configurations/FeatureDefines.xcconfig:

2013-10-25  Joseph Pecoraro  <pecoraro@apple.com>

        Upstream ENABLE(REMOTE_INSPECTOR) and enable on iOS and Mac
        https://bugs.webkit.org/show_bug.cgi?id=123111

        Reviewed by Timothy Hatcher.

        The actual implementation at the WebCoreSupport/WebInspectorClient level
        is the same as INSPECTOR_SERVER. Give debuggable pages a pageIdentifer.

        * Configurations/FeatureDefines.xcconfig:
        * Misc/WebKitLogging.h:
        Misc.

        * WebCoreSupport/WebInspectorClient.h:
        (WebInspectorClient::pageId):
        (WebInspectorClient::setPageId):
        Give WebInspectorClient's a page identifier.

        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorClient::WebInspectorClient):
        (WebInspectorClient::inspectorDestroyed):
        (WebInspectorClient::sendMessageToFrontend):
        (WebInspectorClient::sendMessageToBackend):
        (WebInspectorClient::setupRemoteConnection):
        (WebInspectorClient::teardownRemoteConnection):
        (WebInspectorClient::hasLocalSession):
        (WebInspectorClient::canBeRemotelyInspected):
        (WebInspectorClient::inspectedWebView):
        A WebInspectorClient can be either local or remote. Add handling
        for remote connections.

        * WebInspector/remote/WebInspectorClientRegistry.h: Added.
        * WebInspector/remote/WebInspectorClientRegistry.mm: Added.
        (+[WebInspectorClientRegistry sharedRegistry]):
        (-[WebInspectorClientRegistry init]):
        (-[WebInspectorClientRegistry _getNextAvailablePageId]):
        (-[WebInspectorClientRegistry registerClient:]):
        (-[WebInspectorClientRegistry unregisterClient:]):
        (-[WebInspectorClientRegistry clientForPageId:]):
        (-[WebInspectorClientRegistry inspectableWebViews]):
        Registry for all potentially debuggable pages. All WebInspectorClient instances.

        * WebInspector/remote/WebInspectorRelayDefinitions.h: Added.
        Constants (message keys) shared between WebKit and the XPC process.

        * WebInspector/remote/WebInspectorServer.h: Added.
        * WebInspector/remote/WebInspectorServer.mm: Added.
        (-[WebInspectorServer init]):
        (-[WebInspectorServer dealloc]):
        (-[WebInspectorServer start]):
        (-[WebInspectorServer stop]):
        (-[WebInspectorServer isEnabled]):
        (-[WebInspectorServer xpcConnection]):
        (-[WebInspectorServer setupXPCConnectionIfNeeded]):
        (-[WebInspectorServer pushListing]):
        (-[WebInspectorServer hasActiveDebugSession]):
        (-[WebInspectorServer setHasActiveDebugSession:]):
        (-[WebInspectorServer xpcConnection:receivedMessage:userInfo:]):
        (-[WebInspectorServer xpcConnectionFailed:]):
        (-[WebInspectorServer didRegisterClient:]):
        (-[WebInspectorServer didUnregisterClient:]):
        Singleton to start/stop remote inspection. Handles the connection to the XPC
        and hands off connections to the connection controller.

        * WebInspector/remote/WebInspectorServerWebViewConnection.h: Added.
        * WebInspector/remote/WebInspectorServerWebViewConnection.mm: Added.
        (-[WebInspectorServerWebViewConnection initWithController:connectionIdentifier:destination:identifier:]):
        (-[WebInspectorServerWebViewConnection setupChannel]):
        (-[WebInspectorServerWebViewConnection dealloc]):
        (-[WebInspectorServerWebViewConnection connectionIdentifier]):
        (-[WebInspectorServerWebViewConnection identifier]):
        (-[WebInspectorServerWebViewConnection clearChannel]):
        (-[WebInspectorServerWebViewConnection sendMessageToFrontend:]):
        (-[WebInspectorServerWebViewConnection sendMessageToBackend:]):
        (-[WebInspectorServerWebViewConnection receivedData:]):
        (-[WebInspectorServerWebViewConnection receivedDidClose:]):
        An individual remote debug session connection.

        * WebInspector/remote/WebInspectorServerWebViewConnectionController.h: Added.
        * WebInspector/remote/WebInspectorServerWebViewConnectionController.mm: Added.
        (-[WebInspectorServerWebViewConnectionController initWithServer:]):
        (-[WebInspectorServerWebViewConnectionController dealloc]):
        (-[WebInspectorServerWebViewConnectionController closeAllConnections]):
        (-[WebInspectorServerWebViewConnectionController _listingForWebView:pageId:registry:]):
        (-[WebInspectorServerWebViewConnectionController _pushListing:]):
        (-[WebInspectorServerWebViewConnectionController pushListing:]):
        (-[WebInspectorServerWebViewConnectionController pushListing]):
        (-[WebInspectorServerWebViewConnectionController _receivedSetup:]):
        (-[WebInspectorServerWebViewConnectionController _receivedData:]):
        (-[WebInspectorServerWebViewConnectionController _receivedDidClose:]):
        (-[WebInspectorServerWebViewConnectionController _receivedGetListing:]):
        (-[WebInspectorServerWebViewConnectionController _receivedIndicate:]):
        (-[WebInspectorServerWebViewConnectionController _receivedConnectionDied:]):
        (-[WebInspectorServerWebViewConnectionController receivedMessage:userInfo:]):
        (-[WebInspectorServerWebViewConnectionController connectionClosing:]):
        (-[WebInspectorServerWebViewConnectionController sendMessageToFrontend:userInfo:]):
        ConnectionController:
          - Holds all the current ongoing remote debug connections.
          - Simplifies multi-threaded work on iOS.
          - Dispatches incoming messages from the remote connection.

        * WebInspector/remote/WebInspectorRemoteChannel.h: Added.
        * WebInspector/remote/WebInspectorRemoteChannel.mm: Added.
        (+[WebInspectorRemoteChannel createChannelForPageId:connection:]):
        (-[WebInspectorRemoteChannel initWithRemote:local:]):
        (-[WebInspectorRemoteChannel closeFromLocalSide]):
        (-[WebInspectorRemoteChannel closeFromRemoteSide]):
        (-[WebInspectorRemoteChannel sendMessageToFrontend:]):
        (-[WebInspectorRemoteChannel sendMessageToBackend:]):
        Thin interface between the remote connection and web inspector client.
        This simplifies breaking the connection from either side, e.g. the
        page closing, or the remote connection disconnecting.

        * WebInspector/remote/WebInspectorXPCWrapper.h: Added.
        * WebInspector/remote/WebInspectorXPCWrapper.m: Added.
        (-[WebInspectorXPCWrapper initWithConnection:]):
        (-[WebInspectorXPCWrapper close]):
        (-[WebInspectorXPCWrapper dealloc]):
        (-[WebInspectorXPCWrapper _deserializeMessage:]):
        (-[WebInspectorXPCWrapper _handleEvent:]):
        (-[WebInspectorXPCWrapper sendMessage:userInfo:]):
        (-[WebInspectorXPCWrapper available]):
        * WebKit.exp:
        XPC Connection wrapper handling a simple message format.

        * WebView/WebViewData.h:
        * WebView/WebViewData.mm:
        (-[WebViewPrivate init]):
        (-[WebViewPrivate dealloc]):
        * WebView/WebViewInternal.h:
        * WebView/WebViewPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        (+[WebView sharedWebInspectorServer]):
        (+[WebView _enableRemoteInspector]):
        (+[WebView _disableRemoteInspector]):
        (+[WebView _disableAutoStartRemoteInspector]):
        (+[WebView _isRemoteInspectorEnabled]):
        (+[WebView _hasRemoteInspectorSession]):
        (-[WebView canBeRemotelyInspected]):
        (-[WebView allowsRemoteInspection]):
        (-[WebView setAllowsRemoteInspection:]):
        (-[WebView setIndicatingForRemoteInspector:]):
        (-[WebView setRemoteInspectorUserInfo:]):
        (-[WebView remoteInspectorUserInfo]):
        Remote inspector private API.
          - Enable / disable globally
          - Allow / disallow per webview
          - Optionally attach a userInfo dictionary on the WebView that is published with listing.
          - Indicate a WebView (implementation to land later)

        (-[WebView _didCommitLoadForFrame:]):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::dispatchDidReceiveTitle):
        Pages changed, pushed page listing.

2013-10-25  Mark Rowe  <mrowe@apple.com>

        Fix or disable some deprecation warnings.

        Reviewed by Darin Adler.

        * Panels/WebAuthenticationPanel.m:
        (-[WebAuthenticationPanel cancel:]): On newer OS versions, use the modern API.
        (-[WebAuthenticationPanel logIn:]): Ditto.
        (-[WebAuthenticationPanel runAsSheetOnWindow:withChallenge:]): Ditto. Translate the
        response code in to the form that -sheetDidEnd:responseCode:contextInfo: expects.
        * WebView/WebClipView.mm:
        (-[WebClipView initWithFrame:]): Disable deprecation warnings since it's not obvious
        how to avoid calling -releaseGState here.

2013-10-24  Mark Rowe  <mrowe@apple.com>

        Remove references to OS X 10.7 from Xcode configuration settings.

        Now that we're not building for OS X 10.7 they're no longer needed.

        Reviewed by Anders Carlsson.

        * Configurations/Base.xcconfig:
        * Configurations/DebugRelease.xcconfig:
        * Configurations/FeatureDefines.xcconfig:
        * Configurations/Version.xcconfig:

2013-10-24  Mark Rowe  <mrowe@apple.com>

        <rdar://problem/15312643> Prepare for the mysterious future.

        Reviewed by David Kilzer.

        * Configurations/Base.xcconfig:
        * Configurations/DebugRelease.xcconfig:
        * Configurations/FeatureDefines.xcconfig:
        * Configurations/Version.xcconfig:

2013-10-24  Anders Carlsson  <andersca@apple.com>

        Stop bringing in the std namespace
        https://bugs.webkit.org/show_bug.cgi?id=123273

        Reviewed by Andreas Kling.

        * WebView/WebFrameView.mm:
        (-[WebFrameView _verticalPageScrollDistance]):
        (-[WebFrameView _horizontalPageScrollDistance]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _scaleFactorForPrintOperation:]):
        * WebView/WebView.mm:
        (+[WebView _setCacheModel:]):
        (+[WebView _maxCacheModelInAnyInstance]):
        (+[WebView _cacheModelChangedNotification:]):
        (+[WebView _preferencesRemovedNotification:]):

2013-10-22  Dean Jackson  <dino@apple.com>

        [WebGL] Implement a software rendering option on Mac
        https://bugs.webkit.org/show_bug.cgi?id=123177

        Reviewed by Tim Horton.

        Implement a way to force software OpenGL rendering
        for WebGL, via a Setting/Preference.

        * WebView/WebPreferenceKeysPrivate.h: New WebKitForceSoftwareWebGLRendering key.
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences forceSoftwareWebGLRendering]):
        (-[WebPreferences setForceSoftwareWebGLRendering:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-10-21  Mark Rowe  <mrowe@apple.com>

        Add a version of WebKitSystemInterface for Mavericks.

        Reviewed by Ryosuke Niwa.

        * Configurations/DebugRelease.xcconfig:

2013-10-21  Daniel Bates  <dabates@apple.com>

        Remove platform #ifdefs from WebDataSourcePrivate.h
        https://bugs.webkit.org/show_bug.cgi?id=123120
        <rdar://problem/15275533>

        Reviewed by Anders Carlsson.

        * WebView/WebDataSource.mm:
        (-[WebDataSource _setAllowToBeMemoryMapped]): Define empty implementation when building without
        disk image cache enabled.
        (-[WebDataSource setDataSourceDelegate:]): Ditto.
        (-[WebDataSource dataSourceDelegate]): Return nullptr when building without disk image cache
        enabled on iOS.
        * WebView/WebDataSourcePrivate.h: Removed platform #ifdefs added in
        <http://trac.webkit.org/changeset/156918> (https://bugs.webkit.org/show_bug.cgi?id=121985)

2013-10-20  Mark Lam  <mark.lam@apple.com>

        Avoid JSC debugger overhead unless needed.
        https://bugs.webkit.org/show_bug.cgi?id=123084.

        Reviewed by Geoffrey Garen.

        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::WebScriptDebugger):

2013-10-19  Jer Noble  <jer.noble@apple.com>

        Unreviewed roll out of r157695; broke Mac builds.

        * Configurations/FeatureDefines.xcconfig:

2013-10-07  Jer Noble  <jer.noble@apple.com>

        [MSE] [Mac] Enable MediaSource on the Mac
        https://bugs.webkit.org/show_bug.cgi?id=122484

        Reviewed by Darin Adler.

        Enable ENABLE_MEDIA_SOURCE.

        * Configurations/FeatureDefines.xcconfig:

2013-10-19  Andreas Kling  <akling@apple.com>

        Attempt to get Lion building.

        * WebView/WebDataSource.mm:

2013-10-18  Anders Carlsson  <andersca@apple.com>

        Remove spaces between template angle brackets
        https://bugs.webkit.org/show_bug.cgi?id=123040

        Reviewed by Andreas Kling.

        * History/WebHistory.mm:
        (-[WebHistoryPrivate rebuildHistoryByDayIfNeeded:]):
        * History/WebHistoryItem.mm:
        (-[WebHistoryItem initFromDictionaryRepresentation:]):
        * Plugins/Hosted/NetscapePluginHostProxy.h:
        * Plugins/Hosted/NetscapePluginInstanceProxy.h:
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::idForObject):
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::retain):
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::release):
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::forget):
        (WebKit::NetscapePluginInstanceProxy::stopAllStreams):
        * Plugins/WebNetscapePluginView.h:
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView destroyPlugin]):
        * Storage/WebDatabaseManager.mm:
        (-[WebDatabaseManager origins]):
        * Storage/WebStorageManager.mm:
        (-[WebStorageManager origins]):
        * WebCoreSupport/WebApplicationCache.mm:
        (+[WebApplicationCache originsWithCache]):
        * WebCoreSupport/WebEditorClient.h:
        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::getClientPasteboardDataForRange):
        (WebEditorClient::documentFragmentFromAttributedString):
        * WebCoreSupport/WebFrameLoaderClient.h:
        * WebCoreSupport/WebNotificationClient.h:
        * WebCoreSupport/WebNotificationClient.mm:
        (WebNotificationClient::show):
        (WebNotificationClient::clearNotifications):
        * WebView/WebArchive.mm:
        (-[WebArchive initWithMainResource:subresources:subframeArchives:]):
        (-[WebArchive subresources]):
        (-[WebArchive subframeArchives]):
        * WebView/WebDataSource.mm:
        (-[WebDataSource subresources]):
        * WebView/WebViewData.h:

2013-10-16  Jochen Eisinger  <jochen@chromium.org>

        A page should exit fullscreen mode if it opens a new popup
        https://bugs.webkit.org/show_bug.cgi?id=122865

        Reviewed by Jer Noble.

        If a fullscreen page opens a popup, the popup would be hidden and
        therefore invisible to the user. To avoid this, exit fullscreen mode
        before opening a new window.

        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::createWindow):

2013-10-15  Dean Jackson  <dino@apple.com>

        Add ENABLE_WEB_ANIMATIONS flag
        https://bugs.webkit.org/show_bug.cgi?id=122871

        Reviewed by Tim Horton.

        Eventually might be http://dev.w3.org/fxtf/web-animations/
        but this is just engine-internal work at the moment.

        * Configurations/FeatureDefines.xcconfig:

2013-10-15  Andy Estes  <aestes@apple.com>

        Expose -[WebPluginPackage bundle] as SPI
        https://bugs.webkit.org/show_bug.cgi?id=122814

        Reviewed by Anders Carlsson.

        * Plugins/WebPluginPackage.mm:
        (-[WebPluginPackage bundle]): Defined.
        * Plugins/WebPluginPackagePrivate.h: Declared bundle as a method in a
        category on NSObject.

2013-10-12  Darin Adler  <darin@apple.com>

        Get rid of the toHTMLElement helper for casting FormAssociatedElement to HTMLElement
        https://bugs.webkit.org/show_bug.cgi?id=122713

        Reviewed by Sam Weinig.

        * WebView/WebHTMLRepresentation.mm:
        (-[WebHTMLRepresentation elementWithName:inForm:]): Use asHTMLElement.
        (-[WebHTMLRepresentation controlsInForm:]): Ditto.

2013-10-12  Adam Roben  <aroben@webkit.org>

        WebViews inside OS X screen savers have large caches, but should not
        https://bugs.webkit.org/show_bug.cgi?id=122604

        We use WebCacheModelDocumentViewer by default for apps linked against
        modern WebKit, and WebCacheModelDocumentBrowser for apps linked
        against legacy WebKit. ScreenSaverEngine.app doesn't link against
        WebKit at all, and thus falls into the legacy case by accident because
        NSVersionOfLinkTimeLibrary("WebKit") returns -1.

        But WebViews inside screen savers are almost certainly not being used
        as browsers, so this large-ish cache specified by
        WebCacheModelDocumentBrowser is wasteful. This is likely true for all
        apps that don't directly link against WebKit, so now we use
        WebCacheModelDocumentViewer by default for those apps.

        Reviewed by Darin Adler.

        * WebView/WebPreferences.mm:
        (cacheModelForMainBundle): Use WebCacheModelDocumentViewer by default
        for apps that don't link against WebKit directly. Also converted to
        use @autoreleasepool {} and early returns while I was in here.

2013-10-12  Alexey Proskuryakov  <ap@apple.com>

        Add a feature define for SubtleCrypto
        https://bugs.webkit.org/show_bug.cgi?id=122683

        Reviewed by Anders Carlsson.

        * Configurations/FeatureDefines.xcconfig:

2013-10-12  Darin Adler  <darin@apple.com>

        Use unique_ptr instead of delete in a few places
        https://bugs.webkit.org/show_bug.cgi?id=122639

        Reviewed by Anders Carlsson.

        * History/WebHistory.mm:
        (-[WebHistoryPrivate init]): Use make_unique.
        (-[WebHistoryPrivate dealloc]): Don't delete.
        (-[WebHistoryPrivate finalize]): Don't delete.
        (-[WebHistoryPrivate data]): Use get.

        * WebCoreSupport/WebFrameNetworkingContext.mm:
        (privateSession): Use NeverDestroyed here instead of a raw pointer.
        (WebFrameNetworkingContext::ensurePrivateBrowsingSession): Use the
        new function instead of direct global variable access.
        (WebFrameNetworkingContext::destroyPrivateBrowsingSession): Ditto.
        (WebFrameNetworkingContext::storageSession): Ditto.

        * WebView/WebFrame.mm:
        (-[WebFramePrivate dealloc]): Don't delete.
        (-[WebFramePrivate finalize]): Don't delete.
        (-[WebFrame _attachScriptDebugger]): Use make_unique.
        (-[WebFrame _detachScriptDebugger]): Don't delete.
        * WebView/WebFrameInternal.h: Use unique_ptr.

2013-10-11  Timothy Hatcher  <timothy@apple.com>

        Remove preference support for picking the old Web Inspector.
        https://bugs.webkit.org/show_bug.cgi?id=122655

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::localizedStringsURL):
        (-[WebInspectorWindowController inspectorPagePath]):

2013-10-10  Simon Fraser  <simon.fraser@apple.com>

        Always force layout before flushing compositing layers
        https://bugs.webkit.org/show_bug.cgi?id=122626

        Reviewed by Tim Horton.
        
        [m_webView _flushCompositingChanges] only actually flushes compositing
        layers if the FrameView does not need layout (FrameView::flushCompositingStateForThisFrame()
        returns in this case). In this situation, flushLayers() does actually try
        to force a layout, but on some platforms it's possible for something else
        to dirty layout before the runloop observer fires again. This can result
        in flushLayers() never actually managing to flush, which stalls visual
        updates.
        
        Fix by always calling -viewWillDraw (which updates layout) before flushing
        layers. This now matches WebKit2 behavior.

        * WebView/WebView.mm:
        (LayerFlushController::flushLayers):

2013-10-10  Andy Estes  <aestes@apple.com>

        Add SPI for telling WebKit to prefer pictograph glyphs over monochrome ones
        https://bugs.webkit.org/show_bug.cgi?id=122608

        Reviewed by Dan Bernstein.

        Based on patches by Dan Bernstein.

        * WebView/WebView.mm:
        (-[WebView _setFontFallbackPrefersPictographs:]): Called
        WebCore::Settings::setFontFallbackPrefersPictographs().
        * WebView/WebViewPrivate.h:

2013-10-10  Mark Rowe  <mrowe@apple.com>

        <rdar://problem/13341666> WebKit should always build against an SDK.

        Have all projects default to building against the OS X Internal SDK for the Production
        configuration. For the Debug and Release configurations, look for UseInternalSDK.xcconfig
        to determine whether the OS X Internal SDK should be used. If not, use the normal OS X SDK.

        Reviewed by Dan Bernstein.

        * Configurations/Base.xcconfig:
        * Configurations/DebugRelease.xcconfig:

2013-10-08  Darin Adler  <darin@apple.com>

        WebNetscapePluginView should no longer use deleteAllValues
        https://bugs.webkit.org/show_bug.cgi?id=122495

        Reviewed by Anders Carlsson.

        * Plugins/WebNetscapePluginView.h: Use unique_ptr for both the pointer to
        the timers hash table, and for the values in the hash table.

        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView stopTimers]): Rewrote loop so it works with unique_ptr.
        (-[WebNetscapePluginView startTimers]): Ditto.
        (-[WebNetscapePluginView fini]): Removed unneeded code to delete timers.
        (-[WebNetscapePluginView scheduleTimerWithInterval:repeat:timerFunc:]): Make
        the timers hash table with make-unique. Fixed the loop that chooses the timer
        ID so it won't ever try to use a deleted value, although that never happens
        in practice. Use HashMap::add instead of using both contains and set.
        Rearranged code so we don't need to make a raw pointer for the timer.
        (-[WebNetscapePluginView unscheduleTimer:]): Use remove instead of take/delete,
        since remove takes care of the deletion automatically since we are using the
        unique_ptr class.

2013-10-08  Darin Adler  <darin@apple.com>

        Eliminate use of deleteAllValues in ProxyInstance
        https://bugs.webkit.org/show_bug.cgi?id=122499

        Reviewed by Anders Carlsson.

        * Plugins/Hosted/ProxyInstance.h: Use unique_ptr for map values in m_fields and m_methods.

        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::~ProxyInstance): Removed calls to deleteAllValues.
        (WebKit::ProxyInstance::methodNamed): Use make_unique and get to deal with map entries
        that are unique_ptr. Also fixed a bug where this would do an expensive no-op if the map
        already had an entry with a null in it. We would call the plug-in, but eventually
        isNewEntry would be false so we would return null.
        (WebKit::ProxyInstance::fieldNamed): Use make_unique and get to deal with map entries
        that are unique_ptr.

2013-10-08  Darin Adler  <darin@apple.com>

        Change NetscapePluginInstanceProxy::m_replies to use unique_ptr instead of deleteAllValues
        https://bugs.webkit.org/show_bug.cgi?id=122492

        Reviewed by Andreas Kling.

        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::instantiatePlugin): Use auto so this works with
        unique_ptr instead of auto_ptr.
        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (WKPCGetScriptableNPObjectReply): Use make_unique instead of using new directly.
        (WKPCBooleanReply): Ditto.
        (WKPCBooleanAndDataReply): Ditto.
        (WKPCInstantiatePluginReply): Ditto.
        * Plugins/Hosted/NetscapePluginInstanceProxy.h: Changed m_replies to map to unique_ptr
        instead of to a raw pointer.
        (WebKit::NetscapePluginInstanceProxy::setCurrentReply): Changed to take a unique_ptr
        instead of a raw pointer since this takes ownership of the pointer.
        (WebKit::NetscapePluginInstanceProxy::waitForReply): Changed to return a unique_ptr
        instead of a auto_ptr because that's better. Use unique_ptr inside the function
        too to avoid the need for an explicit delete.
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::~NetscapePluginInstanceProxy): Removed the call to
        deleteAllValues.
        (WebKit::NetscapePluginInstanceProxy::cancelStreamLoad): Removed unneeded initialization
        of a local variable that was already set in all code paths.
        (WebKit::NetscapePluginInstanceProxy::wheelEvent): Use auto so this works with unique_ptr
        instead of auto_ptr.
        (WebKit::NetscapePluginInstanceProxy::print): Ditto.
        (WebKit::NetscapePluginInstanceProxy::snapshot): Ditto. Ditto.
        (WebKit::NetscapePluginInstanceProxy::processRequestsAndWaitForReply): Changed to return
        a unique_ptr. Also removed an unneeded assertion.
        (WebKit::NetscapePluginInstanceProxy::createBindingsInstance): Use auto so this works
        with unique_ptr instead of auto_ptr.

        * Plugins/Hosted/ProxyInstance.h: Changed return type of waitForReply to unique_ptr.

        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::invoke): Use auto so this works with unique_ptr instead of auto_ptr.
        (WebKit::ProxyInstance::supportsInvokeDefaultMethod): Ditto.
        (WebKit::ProxyInstance::supportsConstruct): Ditto.
        (WebKit::ProxyInstance::getPropertyNames): Ditto.
        (WebKit::ProxyInstance::methodNamed): Ditto.
        (WebKit::ProxyInstance::fieldNamed): Ditto.
        (WebKit::ProxyInstance::fieldValue): Ditto.
        (WebKit::ProxyInstance::setFieldValue): Ditto.

2013-10-07  Sam Weinig  <sam@webkit.org>

        CTTE: Use references in and around DragController
        https://bugs.webkit.org/show_bug.cgi?id=122427

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebDragClient.h:
        * WebCoreSupport/WebDragClient.mm:
        (WebDragClient::actionMaskForDrag):
        (WebDragClient::willPerformDragDestinationAction):
        (WebDragClient::willPerformDragSourceAction):
        (WebDragClient::startDrag):
        (WebDragClient::declareAndWriteDragImage):
        * WebView/WebFrame.mm:
        (-[WebFrame _replaceSelectionWithText:selectReplacement:smartReplace:]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _documentFragmentFromPasteboard:forType:inContext:subresources:]):
        * WebView/WebView.mm:
        (-[WebView draggingEntered:]):
        (-[WebView draggingUpdated:]):
        (-[WebView draggingExited:]):
        (-[WebView performDragOperation:]):

2013-10-05  Sam Weinig  <sam@webkit.org>

        CTTE: Thread references through markup.h
        https://bugs.webkit.org/show_bug.cgi?id=122403

        Reviewed by Darin Adler and Andreas Kling.

        * DOM/WebDOMOperations.mm:
        (-[DOMNode markupString]):
        (-[DOMRange markupString]):
        * WebView/WebFrame.mm:
        (-[WebFrame _documentFragmentWithMarkupString:baseURLString:]):
        (-[WebFrame _documentFragmentWithNodesAsParagraphs:]):

2013-10-05  Sam Weinig  <sam@webkit.org>

        CTTE: Pass DocumentWriter around as a reference
        https://bugs.webkit.org/show_bug.cgi?id=122396

        Reviewed by Andreas Kling.

        * WebView/WebFrame.mm:
        (-[WebFrame _canProvideDocumentSource]):

2013-10-04  Alexey Proskuryakov  <ap@apple.com>

        Don't preflight spell checker when calling -setContinuousSpellCheckingEnabled repeatedly
        https://bugs.webkit.org/show_bug.cgi?id=122329

        Reviewed by Darin Adler.

        * WebView/WebView.mm: (-[WebView setContinuousSpellCheckingEnabled:]): Don't do any
        work if preference didn't change (continuousSpellCheckingEnabled is a static that
        starts with false).

2013-10-04  Anders Carlsson  <andersca@apple.com>

        FramePolicyFunction should be an std::function
        https://bugs.webkit.org/show_bug.cgi?id=122362

        Reviewed by Darin Adler.

        * WebCoreSupport/WebFrameLoaderClient.h:
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::dispatchDecidePolicyForResponse):
        (WebFrameLoaderClient::dispatchDecidePolicyForNewWindowAction):
        (WebFrameLoaderClient::dispatchDecidePolicyForNavigationAction):
        (WebFrameLoaderClient::dispatchWillSubmitForm):

2013-10-04  Mark Lam  <mark.lam@apple.com>

        Change ScriptDebugServer to use DebuggerCallFrame instead of JavaScriptCallFrame.
        https://bugs.webkit.org/show_bug.cgi?id=121969.

        Reviewed by Geoffrey Garen.

        1. Make JavaScriptCallFrame a thin shell around the DebuggerCallFrame.
           DebuggerCallFrame now tracks whether it is valid instead of needing
           JavaScriptCallFrame do it.
        2. ScriptDebugServer now only instantiates an DebuggerCallFrame when needed
           just before it pauses and calls back to its client, and then invalidates
           it immediately when the callback returns. Every subsequent callback to
           the client will use a new instance of the DebuggerCallFrame.
        3. Similarly, ScriptDebugServer now only creates a JavaScriptCallFrame when
           it "pauses".
        4. DebuggerCallFrame only creates its caller DebuggerCallFrame when
           it is needed i.e. when the client calls callerFrame(). Similarly,
           JavaScriptCallFrame only creates its caller when it's requested.
        5. DebuggerCallFrame's line() and column() now returns a base-zero int.
        6. WebScriptDebugDelegate now only caches the functionName of the frame
           instead of the entire DebuggerCallFrame because that is all that is
           needed.
        7. Also removed evaluateInGlobalCallFrame() which is not used anywhere.

        * WebView/WebScriptDebugDelegate.mm:
        (-[WebScriptCallFramePrivate dealloc]):
        (-[WebScriptCallFrame _initWithGlobalObject:functionName:exceptionValue:JSC::]):
        (-[WebScriptCallFrame functionName]):
        (-[WebScriptCallFrame exception]):
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::exception):

2013-10-04  Anders Carlsson  <andersca@apple.com>

        Remove some unneeded code from WidgetMac
        https://bugs.webkit.org/show_bug.cgi?id=122355

        Reviewed by Dan Bernstein.

        Remove code to handle the visible rect changing, it's not needed anymore since we always put Netscape plug-ins into their own layers now.

        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        * Plugins/WebBaseNetscapePluginView.h:
        * Plugins/WebBaseNetscapePluginView.mm:

2013-10-04  Daniel Bates  <dabates@apple.com>

        [iOS] Upstream disk image cache
        https://bugs.webkit.org/show_bug.cgi?id=121985

        Reviewed by Joseph Pecoraro.

        * Misc/WebCache.mm:
        (+[WebCache statistics]):
        * WebView/WebDataSource.mm:
        (BufferMemoryMapped): Added.
        (-[WebDataSource _setAllowToBeMemoryMapped]): Added.
        (-[WebDataSource setDataSourceDelegate:]): Added.
        (-[WebDataSource dataSourceDelegate]): Added.
        (-[WebDataSource dealloc]):
        * WebView/WebDataSourcePrivate.h: Declared private delegate
        protocol, WebDataSourcePrivateDelegate.
        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences diskImageCacheEnabled]): Added.
        (-[WebPreferences setDiskImageCacheEnabled:]): Added.
        (-[WebPreferences diskImageCacheMinimumImageSize]): Added.
        (-[WebPreferences setDiskImageCacheMinimumImageSize:]): Added.
        (-[WebPreferences diskImageCacheMaximumCacheSize]): Added.
        (-[WebPreferences setDiskImageCacheMaximumCacheSize:]): Added.
        (-[WebPreferences _diskImageCacheSavedCacheDirectory]): Added.
        (-[WebPreferences _setDiskImageCacheSavedCacheDirectory:]): Added.
        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        (-[WebView _preferencesChanged:]):

2013-10-04  Anders Carlsson  <andersca@apple.com>

        Remove WebAssertions.h
        https://bugs.webkit.org/show_bug.cgi?id=122328

        Reviewed by Jessie Berlin.

        * Misc/WebAssertions.h: Removed.

2013-10-03  Anders Carlsson  <andersca@apple.com>

        Remove WebNSNotificationCenterExtras
        https://bugs.webkit.org/show_bug.cgi?id=122316

        Reviewed by Dan Bernstein.

        Use dispatch_async to ensure that notifications are posted on the main thread.

        * Misc/WebIconDatabase.mm:
        (-[WebIconDatabase _sendNotificationForURL:]):
        (-[WebIconDatabase _sendDidRemoveAllIconsNotification]):
        * Misc/WebNSNotificationCenterExtras.h: Removed.
        * Misc/WebNSNotificationCenterExtras.m: Removed.

2013-10-03  Sam Weinig  <sam@webkit.org>

        Remove shouldRubberBandInDirection from the WKBundlePageUIClient
        https://bugs.webkit.org/show_bug.cgi?id=122309

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebChromeClient.h:

2013-10-03  Anders Carlsson  <andersca@apple.com>

        Ignore deprecation warnings
        https://bugs.webkit.org/show_bug.cgi?id=122302

        Reviewed by Mark Rowe.

        * Misc/WebIconDatabase.mm:
        (-[WebIconDatabase _scaleIcon:toSize:]):
        (webGetNSImage):
        * Misc/WebNSImageExtras.m:
        (-[NSImage _web_scaleToMaxSize:]):
        (-[NSImage _web_dissolveToFraction:]):
        * Misc/WebNSViewExtras.m:
        (-[NSView _web_DragImageForElement:rect:event:pasteboard:source:offset:]):
        (-[NSView _web_convertRect:toView:]):
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::mouseEvent):
        * Plugins/Hosted/WebTextInputWindowController.m:
        (-[WebTextInputPanel _interpretKeyEvent:string:]):
        * Plugins/WebBaseNetscapePluginView.mm:
        (-[WebBaseNetscapePluginView convertFromX:andY:space:toX:andY:space:]):
        * WebCoreSupport/WebDragClient.mm:
        (WebDragClient::startDrag):
        * WebInspector/WebNodeHighlight.mm:
        (-[WebNodeHighlight _computeHighlightWindowFrame]):
        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController _startEnterFullScreenAnimationWithDuration:]):
        (-[WebFullScreenController _startExitFullScreenAnimationWithDuration:]):
        * WebView/WebHTMLView.mm:
        (+[WebHTMLView _postFlagsChangedEvent:]):
        (-[WebHTMLView _updateMouseoverWithFakeEvent]):
        (-[WebHTMLView _autoscroll]):
        (-[WebHTMLView mouseDown:]):
        (-[WebHTMLView mouseDragged:]):
        (-[WebHTMLView mouseUp:]):
        (-[WebHTMLView accessibilityHitTest:]):
        (-[WebHTMLView _executeSavedKeypressCommands]):
        (-[WebHTMLView attachRootLayer:]):
        (-[WebHTMLView textStorage]):
        (-[WebHTMLView _updateSelectionForInputManager]):
        * WebView/WebTextCompletionController.mm:
        (-[WebTextCompletionController _buildUI]):
        (-[WebTextCompletionController _placePopupWindow:]):

2013-10-01  Sam Weinig  <sam@webkit.org>

        CTTE: DOMWrapperWorlds should be passed around by reference
        https://bugs.webkit.org/show_bug.cgi?id=122206

        Reviewed by Andreas Kling.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::getWindowNPObject):
        (WebKit::NetscapePluginInstanceProxy::getPluginElementNPObject):
        (WebKit::NetscapePluginInstanceProxy::evaluate):
        * WebCoreSupport/WebFrameLoaderClient.h:
        * WebCoreSupport/WebFrameLoaderClient.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame _stringByEvaluatingJavaScriptFromString:withGlobalObject:inScriptWorld:]):
        (-[WebFrame _globalContextForScriptWorld:]):
        (-[WebFrame jsWrapperForNode:inScriptWorld:]):
        * WebView/WebScriptWorld.mm:
        (+[WebScriptWorld standardWorld]):
        (+[WebScriptWorld findOrCreateWorld:]):
        * WebView/WebScriptWorldInternal.h:
        * WebView/WebView.mm:
        (-[WebView _injectOutlookQuirksScript]):
        (+[WebView _addUserScriptToGroup:world:source:url:whitelist:blacklist:injectionTime:injectedFrames:]):
        (+[WebView _addUserStyleSheetToGroup:world:source:url:whitelist:blacklist:injectedFrames:]):
        (+[WebView _removeUserScriptFromGroup:world:url:]):
        (+[WebView _removeUserStyleSheetFromGroup:world:url:]):
        (+[WebView _removeUserScriptsFromGroup:world:]):
        (+[WebView _removeUserStyleSheetsFromGroup:world:]):

2013-09-30  Sam Weinig  <sam@webkit.org>

        Remove support for DOMFileSystem
        https://bugs.webkit.org/show_bug.cgi?id=122137

        Reviewed by Anders Carlsson.

        * Configurations/FeatureDefines.xcconfig:

2013-09-30  Benjamin Poulain  <benjamin@webkit.org>

        Remove the code guarded by STYLE_SCOPED
        https://bugs.webkit.org/show_bug.cgi?id=122123

        Reviewed by Anders Carlsson.

        * Configurations/FeatureDefines.xcconfig:

2013-09-30  Mark Rowe  <mrowe@apple.com>

        Fix the build when building against an SDK.

        Xcode helpfully prepends $(SDKROOT) to the paths in FRAMEWORK_SEARCH_PATHS when generating
        the compiler command lines. It can't know to do this for the system framework search paths
        we add manually via OTHER_CFLAGS though, so we need to prefix them with $(SDKROOT) ourself.

        * Configurations/WebKit.xcconfig:

2013-09-29  Mark Rowe  <mrowe@apple.com>

        Fix the Lion build.

        Ensure that C++ and Objective-C++ files build with the right compiler flags.

        * Configurations/WebKit.xcconfig:

2013-09-28  Mark Rowe  <mrowe@apple.com>

        Fix some failures with newer versions of clang.

        Some CoreGraphics headers generate warnings under newer versions of clang. Since they're system headers the warnings would
        usually be suppressed, but we're adding the frameworks to the non-system framework search path so they're no longer treated
        as system headers. We address this by removing the system paths from FRAMEWORK_SEARCH_PATHS and using the -iframework compiler
        flag in OTHER_CFLAGS to add the paths to the system framework search path. We have to set OTHER_CFLAGS at the target level
        in order for it to coexist with the ASAN-related OTHER_CFLAGS that's set in DebugRelease.xcconfig.

        Reviewed by Dan Bernstein.

        * Configurations/DebugRelease.xcconfig:
        * Configurations/WebKit.xcconfig:

2013-09-28  Mark Rowe  <mrowe@apple.com>

        Take Xcode's advice and enable some extra warnings.

        Reviewed by Sam Weinig.

        * Configurations/Base.xcconfig:

2013-09-28  Darin Adler  <darin@apple.com>

        Add Frame::mainFrame and Frame::isMainFrame
        https://bugs.webkit.org/show_bug.cgi?id=122064

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::canHandleRequest):
        (WebFrameLoaderClient::transitionToCommittedForNewPage):
        * WebView/WebFrameView.mm:
        (-[WebFrameView _install]):
        Call isMainFrame.

2013-09-28  Mark Rowe  <mrowe@apple.com>

        WebKit fails to build with newer versions of clang.

        Reviewed by Sam Weinig.

        * Carbon/HIWebView.mm: Remove an unused function.
        * History/BinaryPropertyList.cpp: #if a constant that's only used in 64-bit.
        * Misc/WebIconDatabase.mm: Remove two unused constants.
        * Plugins/WebBaseNetscapePluginView.mm: Remove an unused constant.
        * WebCoreSupport/WebEditorClient.mm: Ditto.

2013-09-27  Enrica Casucci  <enrica@apple.com>

        Upstream changes to Pasteboard implementation for iOS.
        https://bugs.webkit.org/show_bug.cgi?id=121818

        Reviewed by Benjamin Poulain.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::writeToPasteboard):
        (WebPlatformStrategies::getPasteboardItemsCount):
        (WebPlatformStrategies::readBufferFromPasteboard):
        (WebPlatformStrategies::readURLFromPasteboard):
        (WebPlatformStrategies::readStringFromPasteboard):
        (WebPlatformStrategies::changeCount):

2013-09-26  Darin Adler  <darin@apple.com>

        rename KURL to URL
        https://bugs.webkit.org/show_bug.cgi?id=16214

        Reviewed by Andreas Kling.

        * many files: Renamed, using script.

2013-09-06  Jer Noble  <jer.noble@apple.com>

        [Mac] Implement the media controls in JavaScript.
        https://bugs.webkit.org/show_bug.cgi?id=120895

        Reviewed by Dean Jackson.

        Define and turn on ENABLE_MEDIA_CONTROLS_SCRIPT.

        * Configurations/FeatureDefines.xcconfig:

2013-09-27  Darin Adler  <darin@apple.com>

        Add empty MainFrame class
        https://bugs.webkit.org/show_bug.cgi?id=121770

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebDragClient.mm:
        * WebCoreSupport/WebInspectorClient.mm:
        * WebCoreSupport/WebPlatformStrategies.mm:
        * WebView/WebFrame.mm:
        * WebView/WebHTMLView.mm:
        * WebView/WebView.mm:
        Include MainFrame.h instead of Frame.h as needed.

2013-09-26  Eric Carlson  <eric.carlson@apple.com>

        [MediaStream] make MediaStream testable
        https://bugs.webkit.org/show_bug.cgi?id=121967

        Reviewed by Dean Jackson.

        * WebCoreSupport/WebUserMediaClient.h: Added.
        * WebCoreSupport/WebUserMediaClient.mm: Added.

        * WebView/WebUIDelegatePrivate.h: Declare decidePolicyForUserMediaRequestFromOrigin:listener:

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]): Register WebUserMediaClient.
        (-[WebView _setUserMediaClient:]): New.
        (-[WebView _userMediaClient]): New.
        * WebView/WebViewData.h:
        * WebView/WebViewPrivate.h:

2013-09-25  Sam Weinig  <sam@webkit.org>

        Pass a JSC::VM& to JS bindings object creation functions, rather than a JSC::ExecState*
        https://bugs.webkit.org/show_bug.cgi?id=121934

        Reviewed by Geoffrey Garen.

        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::newRuntimeObject):
        * Plugins/Hosted/ProxyRuntimeObject.h:
        (WebKit::ProxyRuntimeObject::create):
        * Plugins/Hosted/ProxyRuntimeObject.mm:
        (WebKit::ProxyRuntimeObject::ProxyRuntimeObject):
        (WebKit::ProxyRuntimeObject::finishCreation):

2013-09-25  Brady Eidson  <beidson@apple.com>

        Enable the IndexedDB build on Mac, but leave the feature non-functional
        https://bugs.webkit.org/show_bug.cgi?id=121918

        Reviewed by Alexey Proskuryakov.

        * Configurations/FeatureDefines.xcconfig:

2013-09-25  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r156432.
        http://trac.webkit.org/changeset/156432
        https://bugs.webkit.org/show_bug.cgi?id=121932

        some integer conversion things that need brady to fix
        (Requested by thorton on #webkit).

        * Configurations/FeatureDefines.xcconfig:

2013-09-25  Brady Eidson  <beidson@apple.com>

        Enable the IndexedDB build on Mac, but leave the feature non-functional
        https://bugs.webkit.org/show_bug.cgi?id=121918

        Reviewed by Alexey Proskuryakov.

        * Configurations/FeatureDefines.xcconfig:

2013-09-25  Brent Fulgham  <bfulgham@apple.com>

        Refactor RuntimeEnabledFeatures as a Singleton.
        https://bugs.webkit.org/show_bug.cgi?id=121883.

        Reviewed by Jer Noble.

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): Use singleton accessor.
        (-[WebView _setDashboardBehavior:to:]): Ditto.

2013-09-25  Brady Eidson  <beidson@apple.com>

        FeatureDefine.xcconfig cleanup (They should all be identical).
        https://bugs.webkit.org/show_bug.cgi?id=121921

        Reviewed by Mark Rowe.

        * Configurations/FeatureDefines.xcconfig:

2013-09-24  Mark Lam  <mark.lam@apple.com>

        Change JSC debug hooks to pass a CallFrame* instead of a DebuggerCallFrame.
        https://bugs.webkit.org/show_bug.cgi?id=121867.

        Reviewed by Geoffrey Garen.

        * WebView/WebScriptDebugDelegate.mm:
        (-[WebScriptCallFrame _initWithGlobalObject:debuggerCallFrame:exceptionValue:JSC::]):
        (-[WebScriptCallFrame exception]):
        * WebView/WebScriptDebugger.h:
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::exception):

2013-09-24  Enrica Casucci  <enrica@apple.com>

        Upstream changes to Pasteboard implementation for iOS.
        https://bugs.webkit.org/show_bug.cgi?id=121818

        Reviewed by Darin Adler.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::writeToPasteboard):

2013-09-24  Mark Rowe  <mrowe@apple.com>

        <rdar://problem/14971518> WebKit should build against the Xcode default toolchain when targeting OS X 10.8

        Reviewed by Dan Bernstein.

        * Configurations/Base.xcconfig:

2013-09-21  Mark Lam  <mark.lam@apple.com>

        Remove unused code in WebKit/mac's WebScriptDebugDelegate.
        https://bugs.webkit.org/show_bug.cgi?id=121706.

        Reviewed by Timothy Hatcher.

        WebScriptDebugDelegate's didEnterCallFrame, willExecuteStatement,
        and willLeaveCallFrame are not in use. Removed them and all methods
        and fields used for supporting them.

        * WebView/WebDelegateImplementationCaching.h:
        * WebView/WebScriptDebugDelegate.h:
        * WebView/WebScriptDebugDelegate.mm:
        (-[WebScriptCallFramePrivate dealloc]):
        (-[WebScriptCallFrame _initWithGlobalObject:debuggerCallFrame:]):
        * WebView/WebScriptDebugger.h:
        (WebScriptDebugger::globalObject):
        (WebScriptDebugger::callEvent):
        (WebScriptDebugger::atStatement):
        (WebScriptDebugger::returnEvent):
        (WebScriptDebugger::willExecuteProgram):
        (WebScriptDebugger::didExecuteProgram):
        (WebScriptDebugger::didReachBreakpoint):
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::WebScriptDebugger):
        (WebScriptDebugger::exception):
        * WebView/WebView.mm:
        (-[WebView _cacheScriptDebugDelegateImplementations]):

2013-09-18  Anders Carlsson  <andersca@apple.com>

        RefPtrHashMap should work with move only types
        https://bugs.webkit.org/show_bug.cgi?id=121564

        Reviewed by Andreas Kling.

        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::methodNamed):
        (WebKit::ProxyInstance::fieldNamed):

2013-09-16  Enrica Casucci  <enrica@apple.com>

        Remove unused function didSetSelectionTypesForPasteboard from EditorClient.
        https://bugs.webkit.org/show_bug.cgi?id=121464

        Reviewed by Darin Adler.

        This method was only implemented in WebEditorClient.mm for Mac where it was
        calling a private delegate that is no longer in use.

        * DefaultDelegates/WebDefaultEditingDelegate.m:
        * WebCoreSupport/WebEditorClient.h:
        * WebCoreSupport/WebEditorClient.mm:
        * WebView/WebEditingDelegatePrivate.h:

2013-09-13  Anders Carlsson  <andersca@apple.com>

        Use nullptr instead of 0 in calls to HashMap::add
        https://bugs.webkit.org/show_bug.cgi?id=121322

        Reviewed by Sam Weinig.

        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::hostForPlugin):

2013-09-13  Dan Bernstein  <mitz@apple.com>

        [mac WK1] Introduce WebViewWillCloseNotification
        https://bugs.webkit.org/show_bug.cgi?id=121321

        Reviewed by Sam Weinig.

        * WebKit.exp: Exported WebViewWillCloseNotification.
        * WebView/WebView.mm:
        (-[WebView _close]): Send WebViewWillCloseNotification before closing the WebView.
        * WebView/WebViewPrivate.h: Declared WebViewWillCloseNotification.

2013-09-13  Tim Horton  <timothy_horton@apple.com>

        REGRESSION (r155615): Lots of reftests fail with single line or single pixel differences
        https://bugs.webkit.org/show_bug.cgi?id=121245

        Reviewed by Darin Adler.

        Similar to https://bugs.webkit.org/show_bug.cgi?id=120963,
        we need to manually ensure that some pieces of persistent
        CoreGraphics state are restored after PDFKit changes them.

        In this case, we bookend our restoration around the various
        _recursiveDisplay... functions that we also use in WebHTMLView.

        * WebView/WebPDFView.mm:
        (-[WebPDFView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]):
        (-[WebPDFView _recursiveDisplayAllDirtyWithLockFocus:visRect:]):
        (-[WebPDFView _recursive:displayRectIgnoringOpacity:inContext:topView:]):
        (-[WebPDFView _recursive:displayRectIgnoringOpacity:inGraphicsContext:CGContext:topView:shouldChangeFontReferenceColor:]):

2013-09-12  Anders Carlsson  <andersca@apple.com>

        SharedBuffer::createNSData should return a RetainPtr<NSData>
        https://bugs.webkit.org/show_bug.cgi?id=121237

        Reviewed by Darin Adler.

        Update for WebCore changes. This also fixes a leak where we'd create an NSFileWrapper from NSData but never release the data.

        * WebView/WebDataSource.mm:
        (-[WebDataSource data]):
        * WebView/WebHTMLRepresentation.mm:
        (-[WebHTMLRepresentation documentSource]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView namesOfPromisedFilesDroppedAtDestination:]):
        * WebView/WebResource.mm:
        (-[WebResource encodeWithCoder:]):
        (-[WebResource data]):

2013-09-12  Mark Lam  <mark.lam@apple.com>

        Change debug hooks to pass sourceID and position info via the DebuggerCallFrame.
        https://bugs.webkit.org/show_bug.cgi?id=121214.

        Reviewed by Geoffrey Garen.

        * webview/WebScriptDebugger.h:
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::WebScriptDebugger):
        (WebScriptDebugger::callEvent):
        (WebScriptDebugger::atStatement):
        (WebScriptDebugger::returnEvent):
        (WebScriptDebugger::exception):
        (WebScriptDebugger::willExecuteProgram):
        (WebScriptDebugger::didExecuteProgram):
        (WebScriptDebugger::didReachBreakpoint):

2013-09-11  Gyuyoung Kim  <gyuyoung.kim@samsung.com>

        Generate more HTML type checks and casting
        https://bugs.webkit.org/show_bug.cgi?id=121080

        Reviewed by Andreas Kling.

        Clean-up remained functions of HTML elements using auto-generated isFooElement(),
        and replace toFooElement() with ELEMENT_TYPE_CASTS() macro.

        Besides this patch clean-up unnecessary checks which are being supported by
        auto-generated isFooElement().

        No new tests, no behavior change.

        * Plugins/WebPluginController.mm:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::supportsFullscreenForNode):
        * WebView/WebView.mm:
        (-[WebView _enterFullscreenForNode:WebCore::]):

2013-09-10  Daniel Bates  <dabates@apple.com>

        [iOS] Upstream text autosizing
        https://bugs.webkit.org/show_bug.cgi?id=121111

        Reviewed by Andy Estes and Sam Weinig.

        * WebView/WebFrame.mm:
        (-[WebFrame resetTextAutosizingBeforeLayout]): Added.
        (-[WebFrame _setVisibleSize:]): Added.
        (-[WebFrame _setTextAutosizingWidth:]): Added.
        * WebView/WebFramePrivate.h:
        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences _setMinimumZoomFontSize:]): Added.
        (-[WebPreferences _minimumZoomFontSize]): Added.

2013-09-09  Dean Jackson  <dino@apple.com>

        [WebGL] Allow multithreaded OpenGL contexts
        https://bugs.webkit.org/show_bug.cgi?id=121062

        Reviewed by Simon Fraser.

        Expose a new preference "multithreadedWebGLEnabled".

        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences multithreadedWebGLEnabled]):
        (-[WebPreferences setMultithreadedWebGLEnabled:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-09-09  Dean Jackson  <dino@apple.com>

        Enable WebGL for OS X nightlies
        https://bugs.webkit.org/show_bug.cgi?id=121040

        Reviewed by Beth Dakin.

        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]): Set WebPreference to YES.

2013-09-06  Ryosuke Niwa  <rniwa@webkit.org>

        Range::ownerDocument should return Document&
        https://bugs.webkit.org/show_bug.cgi?id=120908

        Reviewed by Andreas Kling.

        * WebView/WebPDFView.mm:
        (isFrameInRange):

2013-09-05  Andreas Kling  <akling@apple.com>

        ScrollView::children() should return a reference.
        <https://webkit.org/b/120795>

        Reviewed by Anders Carlsson.

        * WebView/WebView.mm:
        (-[WebView _addScrollerDashboardRegionsForFrameView:dashboardRegions:]):

2013-09-04  Mark Rowe  <mrowe@apple.com>

        <https://webkit.org/b/120707> Make WebKit's localizable strings mechanism usable under ARC

        WebKit's localizable strings mechanism is also used outside of WebKit so it needs to work
        both with and without ARC.

        Reviewed by Anders Carlsson.

        * Misc/WebLocalizableStrings.h: Mark the bundle member as unretained. This matches how the
        member is used within WebLocalizableStrings.mm.

2013-09-02  Darin Adler  <darin@apple.com>

        [Mac] No need for HardAutorelease, which is same as CFBridgingRelease
        https://bugs.webkit.org/show_bug.cgi?id=120569

        Reviewed by Andy Estes.

        * Misc/WebNSFileManagerExtras.mm:
        (-[NSFileManager _webkit_startupVolumeName]): Removed some unneeded locals.
        Got rid of the pointless ref/leakRef/HardAutorelease dance, and replaced it
        with a [[x copy] autorelease].

        * Misc/WebNSURLExtras.mm:
        (-[NSURL _web_URLWithLowercasedScheme]): Use CFBridgingRelease, and got rid
        of unneeded type casts.

        * Plugins/WebBasePluginPackage.mm:
        (+[WebBasePluginPackage preferredLocalizationName]): Use CFBridgingRelease.
        * WebView/WebPDFRepresentation.mm:
        (-[WebPDFRepresentation convertPostScriptDataSourceToPDF:]): Ditto.

        * WebView/WebView.mm:
        (+[WebView _setCacheModel:]): Use CFBridgingRelease and got rid of unneeded
        type cast.

2013-08-30  Antti Koivisto  <antti@apple.com>

        Remove code behind ENABLE(DIALOG_ELEMENT)
        https://bugs.webkit.org/show_bug.cgi?id=120467

        Reviewed by Darin Adler.

        * Configurations/FeatureDefines.xcconfig:

2013-08-29  Sam Weinig  <sam@webkit.org>

        Add ENABLE gaurds for Promises
        https://bugs.webkit.org/show_bug.cgi?id=120488

        Reviewed by Andreas Kling.

        * Configurations/FeatureDefines.xcconfig:

2013-08-29  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: Download Web Archive of Inspected Page
        https://bugs.webkit.org/show_bug.cgi?id=119774

        Reviewed by Timothy Hatcher.

        Update to support InspectorFrontendHost.save's new base64Encoded
        parameter. It means the incoming content is binary data, not a string.

        * WebCoreSupport/WebInspectorClient.h:
        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::save):

2013-08-28  Chris Curtis  <chris_curtis@apple.com>

        https://bugs.webkit.org/show_bug.cgi?id=119548
        Refactoring Exception throws.

        Reviewed by Geoffrey Garen.
        
        Moved setting an exception into the vm, These functions changed to use the new functionality.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::moveGlobalExceptionToExecState):
        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::invokeMethod):

2013-08-27  Anders Carlsson  <andersca@apple.com>

        Fix build.

        * Plugins/Hosted/ProxyInstance.h:
        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::methodNamed):
        (WebKit::ProxyInstance::fieldNamed):

2013-08-23  Andy Estes  <aestes@apple.com>

        Fix issues found by the Clang Static Analyzer
        https://bugs.webkit.org/show_bug.cgi?id=120230

        Reviewed by Darin Adler.

        * Misc/WebNSFileManagerExtras.mm:
        (-[NSFileManager _webkit_startupVolumeName]): Used HardAutorelease()
        instead of WebCFAutorelease().
        * Misc/WebNSObjectExtras.h: Removed definition of WebCFAutorelease().
        * Misc/WebNSURLExtras.mm:
        (-[NSURL _web_URLWithLowercasedScheme]): Used HardAutorelease()
        instead of WebCFAutorelease().
        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView createPluginLayer]): Stop leaking
        CGColors (CALayer retains its backgroundColor property despite the
        property attributes claiming otherwise).
        * Plugins/WebBasePluginPackage.mm:
        (+[WebBasePluginPackage preferredLocalizationName]): Used
        HardAutorelease() instead of WebCFAutorelease().
        * WebView/WebDeviceOrientationProviderMock.mm:
        (-[WebDeviceOrientationProviderMockInternal lastOrientation]): Stop
        leaking WebDeviceOrientations.
        * WebView/WebPDFRepresentation.mm:
        (-[WebPDFRepresentation convertPostScriptDataSourceToPDF:]): Used
        HardAutorelease() instead of WebCFAutorelease().
        * WebView/WebView.mm:
        (+[WebView _setCacheModel:]): Ditto.
        (-[WebView _removeObjectForIdentifier:]): Ditto.

2013-08-26  Alexey Proskuryakov  <ap@apple.com>

        [Mac] can-read-in-dragstart-event.html and can-read-in-copy-and-cut-events.html fail
        https://bugs.webkit.org/show_bug.cgi?id=113094

        Reviewed by Darin Adler.

        Return new pasteboard change count from all functions that change it.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::copy):
        (WebPlatformStrategies::changeCount):
        (WebPlatformStrategies::addTypes):
        (WebPlatformStrategies::setTypes):
        (WebPlatformStrategies::setBufferForType):
        (WebPlatformStrategies::setPathnamesForType):
        (WebPlatformStrategies::setStringForType):

2013-08-26  Andreas Kling  <akling@apple.com>

        Unreviewed build fix.

        * WebView/WebFrame.mm:
        (+[WebFrame _createMainFrameWithPage:frameName:frameView:]):

2013-08-26  Andreas Kling  <akling@apple.com>

        WebCore: Let Page create the main Frame.
        <https://webkit.org/b/119964>

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebFrameLoaderClient.h:
        (WebFrameLoaderClient::setWebFrame):

            Make it possible to construct a WebFrameLoaderClient with a null WebFrame*.
            A WebFrame* is later hooked up with a call to setWebFrame().

        * WebView/WebFrame.mm:
        (+[WebFrame _createMainFrameWithPage:frameName:frameView:]):

            Customized this method to wrap the Page::mainFrame() instead of creating a
            new Frame.

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):

            Add a WebFrameLoaderClient to the PageClients passed to Page().

2013-08-25  Darin Adler  <darin@apple.com>

        Frame should not have a documentTypeString member function
        https://bugs.webkit.org/show_bug.cgi?id=120262

        Reviewed by Andreas Kling.

        * WebView/WebFrame.mm: Removed _stringWithDocumentTypeStringAndMarkupString:
        internal method, which was not used anywhere in WebKit. Internal methods are
        only for use within WebKit, as opposed to public and private methods that can
        be used outside.
        * WebView/WebFrameInternal.h: Ditto.

2013-08-24  Darin Adler  <darin@apple.com>

        Frame::tree should return a reference instead of a pointer
        https://bugs.webkit.org/show_bug.cgi?id=120259

        Reviewed by Andreas Kling.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::performRequest):
        * Plugins/WebBaseNetscapePluginView.mm:
        (-[WebBaseNetscapePluginView resolvedURLStringForURL:target:]):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView loadPluginRequest:]):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (applyAppleDictionaryApplicationQuirkNonInlinePart):
        (WebFrameLoaderClient::prepareForDataSourceReplacement):
        (WebFrameLoaderClient::createFrame):
        * WebView/WebFrame.mm:
        (+[WebFrame _createFrameWithPage:frameName:frameView:ownerElement:]):
        (-[WebFrame _updateBackgroundAndUpdatesWhileOffscreen]):
        (-[WebFrame _unmarkAllBadGrammar]):
        (-[WebFrame _unmarkAllMisspellings]):
        (-[WebFrame _atMostOneFrameHasSelection]):
        (-[WebFrame _findFrameWithSelection]):
        (-[WebFrame _drawRect:contentsOnly:]):
        (-[WebFrame _isDescendantOfFrame:]):
        (-[WebFrame _recursive_resumeNullEventsForAllNetscapePlugins]):
        (-[WebFrame _recursive_pauseNullEventsForAllNetscapePlugins]):
        (-[WebFrame name]):
        (-[WebFrame findFrameNamed:]):
        (-[WebFrame parentFrame]):
        (-[WebFrame childFrames]):
        * WebView/WebView.mm:
        (-[WebView _attachScriptDebuggerToAllFrames]):
        (-[WebView _detachScriptDebuggerFromAllFrames]):
        (-[WebView _clearMainFrameName]):
        (-[WebView _isUsingAcceleratedCompositing]):
        (-[WebView _isSoftwareRenderable]):
        (-[WebView setHostWindow:]):
        (incrementFrame):
        Use tree(). instead of tree()->.

2013-08-23  Beth Dakin  <bdakin@apple.com>

        REGRESSION (r132545): Some PDFs generated by WebKit are blank when viewed in 
        Adobe Reader
        https://bugs.webkit.org/show_bug.cgi?id=120240
        -and corresponding-
        <rdar://problem/14634453>

        Reviewed by Anders Carlsson.

        Hook up new WebSystemInterface API to find out if the current context is the PDF 
        context.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-08-20  Pratik Solanki  <psolanki@apple.com>

        <https://webkit.org/b/120029> Document::markers() should return a reference

        Reviewed by Andreas Kling.

        Document::m_markers is never NULL so return a reference from Document::markers(). Also mark
        m_markers as const and initialize it in member initialization.

        * WebView/WebFrame.mm:
        (-[WebFrame _unmarkAllBadGrammar]):
        (-[WebFrame _unmarkAllMisspellings]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView unmarkAllTextMatches]):
        (-[WebHTMLView rectsForTextMatches]):

2013-08-19  Ryosuke Niwa  <rniwa@webkit.org>

        <https://webkit.org/b/120049> Delete code for Snow Leopard

        Reviewed by Benjamin Poulain.

        * DefaultDelegates/WebDefaultContextMenuDelegate.mm:
        (-[WebDefaultUIDelegate menuItemWithTag:target:representedObject:]):
        (-[WebDefaultUIDelegate webView:contextMenuItemsForElement:defaultMenuItems:]):
        * Misc/WebNSControlExtras.m:
        (-[NSControl sizeToFitAndAdjustWindowHeight]):
        * Misc/WebNSFileManagerExtras.mm:
        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::shouldEraseMarkersAfterChangeSelection):
        (WebEditorClient::getGuessesForWord):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::dispatchDidLayout):
        (WebFrameLoaderClient::provisionalLoadStarted):
        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):
        * WebKitPrefix.h:
        * WebView/WebDynamicScrollBarsView.mm:
        (-[WebDynamicScrollBarsView scrollWheel:]):
        * WebView/WebFullScreenController.mm:
        (convertRectToScreen):
        (-[WebFullScreenController finishedEnterFullScreenAnimation:]):
        (-[WebFullScreenController exitFullScreen]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _pasteWithPasteboard:allowPlainText:]):
        (-[WebHTMLView removeMouseMovedObserver]):
        (-[WebHTMLView windowDidBecomeKey:]):
        (-[WebHTMLView windowDidResignKey:]):
        * WebView/WebView.mm:
        (-[WebView _deviceScaleFactor]):

2013-08-19  Ryosuke Niwa  <rniwa@webkit.org>

        <https://webkit.org/b/120051> Remove the Mail thread workaround

        Reviewed by Sam Weinig.

        Remove the workaround for a very old version of Mail added in r39455.

        * WebView/WebArchive.mm:
        (-[WebArchive initWithMainResource:subresources:subframeArchives:]):
        (-[WebArchive mainResource]):
        (-[WebArchive subresources]):
        (-[WebArchive subframeArchives]):
        * WebView/WebFrameView.mm:
        (-[WebFrameView initWithFrame:]):
        * WebView/WebResource.mm:
        (-[WebResource data]):
        (-[WebResource URL]):
        (-[WebResource MIMEType]):
        (-[WebResource textEncodingName]):
        (-[WebResource frameName]):
        (-[WebResource _ignoreWhenUnarchiving]):
        (-[WebResource _initWithData:URL:MIMEType:textEncodingName:frameName:response:copyData:]):
        (-[WebResource _suggestedFilename]):
        (-[WebResource _response]):
        (-[WebResource _stringValue]):

2013-08-19  Pratik Solanki  <psolanki@apple.com>

        <https://webkit.org/b/119918> Frame::selection() should return a reference

        Reviewed by Darin Adler.

        m_selection is never NULL so return a reference from Frame::selection(). Also removed some
        unnecessary null checks and assert diff ts exposed as a result.

        * Plugins/WebPluginController.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame _hasSelection]):
        (-[WebFrame _rangeByAlteringCurrentSelection:FrameSelection::direction:granularity:]):
        (-[WebFrame _selectionGranularity]):
        (-[WebFrame _convertToNSRange:]):
        (-[WebFrame _convertToDOMRange:]):
        (-[WebFrame _insertParagraphSeparatorInQuotedContent]):
        (-[WebFrame _typingStyle]):
        (-[WebFrame _selectedNSRange]):
        (-[WebFrame _selectNSRange:]):
        (-[WebFrame _replaceSelectionWithFragment:selectReplacement:smartReplace:matchStyle:]):
        (-[WebFrame _replaceSelectionWithText:selectReplacement:smartReplace:]):
        * WebView/WebHTMLRepresentation.mm:
        (-[WebHTMLRepresentation currentForm]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView readSelectionFromPasteboard:]):
        (-[WebHTMLView _selectedRange]):
        (-[WebHTMLView _hasSelection]):
        (-[WebHTMLView _hasSelectionOrInsertionPoint]):
        (-[WebHTMLView _hasInsertionPoint]):
        (-[WebHTMLView _isEditable]):
        (-[WebHTMLView jumpToSelection:]):
        (-[WebHTMLView validateUserInterfaceItemWithoutDelegate:]):
        (-[WebHTMLView maintainsInactiveSelection]):
        (isTextInput):
        (isInPasswordField):
        (-[WebHTMLView centerSelectionInVisibleArea:]):
        (-[WebHTMLView _canSmartCopyOrDelete]):
        (-[WebHTMLView _lookUpInDictionaryFromMenu:]):
        (-[WebHTMLView _updateSelectionForInputManager]):
        (-[WebHTMLView selectionRect]):
        (-[WebHTMLView selectionTextRects]):
        (-[WebHTMLView selectionImageRect]):
        (-[WebHTMLView selectAll]):
        (-[WebHTMLView deselectAll]):
        (-[WebHTMLView selectedAttributedString]):
        * WebView/WebTextCompletionController.mm:
        (-[WebTextCompletionController doCompletion]):
        * WebView/WebView.mm:
        (-[WebView setSelectedDOMRange:affinity:]):
        (-[WebView selectedDOMRange]):
        (-[WebView selectionAffinity]):
        (-[WebView setEditable:]):
        (-[WebView _selectionIsCaret]):
        (-[WebView _selectionIsAll]):

2013-08-17  Darin Adler  <darin@apple.com>

        <https://webkit.org/b/119941> Make Page::dragController return a reference

        Reviewed by Andreas Kling.

        * WebView/WebFrameView.mm:
        (-[WebFrameView _setDocumentView:]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView draggingSourceOperationMaskForLocal:]):
        (-[WebHTMLView namesOfPromisedFilesDroppedAtDestination:]):
        * WebView/WebView.mm:
        (-[WebView _setInitiatedDrag:]):
        (-[WebView draggingEntered:]):
        (-[WebView draggingUpdated:]):
        (-[WebView draggingExited:]):
        (-[WebView performDragOperation:]):
        (-[WebView moveDragCaretToPoint:]):
        (-[WebView removeDragCaret]):
        Updated call sites.

2013-08-16  Pratik Solanki  <psolanki@apple.com>

        <https://webkit.org/b/119852> Frame::scriptController() should return a reference

        Reviewed by Andreas Kling.

        m_script is never NULL so we can just return a reference. Also remove some pointless null
        checks as a result of doing this.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::cleanup):
        (WebKit::NetscapePluginInstanceProxy::getWindowNPObject):
        (WebKit::NetscapePluginInstanceProxy::getPluginElementNPObject):
        (WebKit::NetscapePluginInstanceProxy::evaluate):
        (WebKit::NetscapePluginInstanceProxy::invoke):
        (WebKit::NetscapePluginInstanceProxy::invokeDefault):
        (WebKit::NetscapePluginInstanceProxy::construct):
        (WebKit::NetscapePluginInstanceProxy::getProperty):
        (WebKit::NetscapePluginInstanceProxy::setProperty):
        (WebKit::NetscapePluginInstanceProxy::removeProperty):
        (WebKit::NetscapePluginInstanceProxy::hasProperty):
        (WebKit::NetscapePluginInstanceProxy::hasMethod):
        (WebKit::NetscapePluginInstanceProxy::enumerate):
        (WebKit::NetscapePluginInstanceProxy::demarshalValueFromArray):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView getVariable:value:]):
        (-[WebNetscapePluginView _destroyPlugin]):
        * Plugins/WebPluginController.mm:
        * WebCoreSupport/WebFrameLoaderClient.mm:
        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::save):
        (WebInspectorFrontendClient::append):
        * WebView/WebFrame.mm:
        (-[WebFrame _attachScriptDebugger]):
        (-[WebFrame _stringByEvaluatingJavaScriptFromString:forceUserGesture:]):
        (-[WebFrame _stringByEvaluatingJavaScriptFromString:withGlobalObject:inScriptWorld:]):
        (-[WebFrame _globalContextForScriptWorld:]):
        (-[WebFrame jsWrapperForNode:inScriptWorld:]):
        (-[WebFrame windowObject]):
        (-[WebFrame globalContext]):
        (-[WebFrame javaScriptContext]):
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::initGlobalCallFrame):
        (WebScriptDebugger::callEvent):
        * WebView/WebView.mm:
        (-[WebView windowScriptObject]):
        (-[WebView aeDescByEvaluatingJavaScriptFromString:]):

2013-08-15  Anders Carlsson  <andersca@apple.com>

        <https://webkit.org/b/119859> Frame::loader() should return a reference

        Reviewed by Andreas Kling.

        * Plugins/Hosted/HostedNetscapePluginStream.mm:
        (WebKit::HostedNetscapePluginStream::HostedNetscapePluginStream):
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::performRequest):
        (WebKit::NetscapePluginInstanceProxy::loadRequest):
        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView pluginView:receivedResponse:]):
        * Plugins/WebBaseNetscapePluginView.mm:
        (-[WebBaseNetscapePluginView requestWithURLCString:]):
        * Plugins/WebNetscapePluginStream.mm:
        (WebNetscapePluginStream::WebNetscapePluginStream):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView loadStream]):
        (-[WebNetscapePluginView pluginView:receivedResponse:]):
        (-[WebNetscapePluginView loadPluginRequest:]):
        (-[WebNetscapePluginView loadRequest:inTarget:withNotifyData:sendNotification:]):
        * Plugins/WebPluginController.mm:
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::dispatchDidReceiveServerRedirectForProvisionalLoad):
        (WebFrameLoaderClient::dispatchDidStartProvisionalLoad):
        (WebFrameLoaderClient::dispatchWillSubmitForm):
        (WebFrameLoaderClient::updateGlobalHistory):
        (WebFrameLoaderClient::updateGlobalHistoryRedirectLinks):
        (WebFrameLoaderClient::restoreViewState):
        (WebFrameLoaderClient::transitionToCommittedForNewPage):
        (WebFrameLoaderClient::createFrame):
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        (WebFrameNetworkingContext::blockedError):
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::getPluginInfo):
        * WebView/WebFrame.mm:
        (kit):
        (-[WebFrame _dataSource]):
        (-[WebFrame _canProvideDocumentSource]):
        (-[WebFrame _commitData:]):
        (-[WebFrame _firstLayoutDone]):
        (-[WebFrame _loadType]):
        (-[WebFrame _cacheabilityDictionary]):
        (-[WebFrame _clearOpener]):
        (-[WebFrame provisionalDataSource]):
        (-[WebFrame dataSource]):
        (-[WebFrame loadRequest:]):
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):
        (-[WebFrame loadArchive:]):
        (-[WebFrame stopLoading]):
        (-[WebFrame reload]):
        (-[WebFrame reloadFromOrigin]):
        * WebView/WebHTMLRepresentation.mm:
        (-[WebHTMLRepresentation receivedData:withDataSource:]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView validateUserInterfaceItemWithoutDelegate:]):
        * WebView/WebPDFView.mm:
        (-[WebPDFView PDFViewWillClickOnLink:withURL:]):
        * WebView/WebRenderLayer.mm:
        (-[WebRenderLayer initWithWebFrame:]):
        * WebView/WebRenderNode.mm:
        (-[WebRenderNode _initWithCoreFrame:]):
        * WebView/WebView.mm:
        (-[WebView _close]):
        (-[WebView _loadBackForwardListFromOtherView:]):
        (-[WebView _cachedResponseForURL:]):
        (-[WebView setCustomTextEncodingName:]):
        (-[WebView shouldClose]):

2013-08-15  Anders Carlsson  <andersca@apple.com>

        <https://webkit.org/b/119854> REGRESSION (r153379): Serious drawing issues with WebViews
        <rdar://problem/14698870>

        Reviewed by Simon Fraser.

        Don't set aside subviews if they have already been set aside.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _recursive:displayRectIgnoringOpacity:inGraphicsContext:CGContext:topView:shouldChangeFontReferenceColor:]):

2013-08-15  Eric Carlson  <eric.carlson@apple.com>

        [Mac] Remove "legacy" media UI
        https://bugs.webkit.org/show_bug.cgi?id=119752

        Reviewed by Jer Noble.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Remove MediaControllerThemeAvailable.

2013-08-14  Tim Horton  <timothy_horton@apple.com>

        Remotely hosted plugins don’t work in window-server-hosted WebKit1 views
        https://bugs.webkit.org/show_bug.cgi?id=119709
        <rdar://problem/14717572>

        Reviewed by Anders Carlsson.

        * Plugins/Hosted/NetscapePluginHostManager.h:
        Add hostLayersInWindowServer argument to instantiatePlugin.

        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::instantiatePlugin):
        Add hostLayersInWindowServer argument to instantiatePlugin, and pass it through to WebKitPluginHost.

        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (WKPCLayerHostingModeChanged):
        Forward the notification that the plugin host changed its layer hosting mode
        to the instance proxy.

        * Plugins/Hosted/NetscapePluginInstanceProxy.h:
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::setShouldHostLayersInWindowServer):
        Ask the plugin host to re-host its layers when the layer hosting mode changes.

        (WebKit::NetscapePluginInstanceProxy::layerHostingModeChanged):
        Inform the WebHostedNetscapePluginView of the new layer hosting mode
        when it changes. Also, store the new CAContext ID.

        * Plugins/Hosted/WebHostedNetscapePluginView.h:
        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView windowHostsLayersInWindowServer]):
        Determine whether the WebView's current window uses window-server hosting for its layers.

        (-[WebHostedNetscapePluginView createPlugin]):
        Drive-by spelling fix.
        Factor _pluginLayer initialization out into createPluginLayer.
        Instantiate the plugin with the appropriate layer hosting mode.

        (-[WebHostedNetscapePluginView createPluginLayer]):

        (-[WebHostedNetscapePluginView setHostsLayersInWindowServer:]):
        Create a new _pluginLayer if the layer hosting mode changes.
        Attach the new _pluginLayer to our parent layer.

        (-[WebHostedNetscapePluginView updateAndSetWindow]):
        Inform the NetscapePluginInstanceProxy if the layer hosting mode changes,
        so it can inform the plugin host. We will asynchronously receive a reply
        with the new hosting mode and renderContextID and switch to the new CAContext,
        in setHostsLayersInWindowServer:.

        * Plugins/Hosted/WebKitPluginClient.defs:
        * Plugins/Hosted/WebKitPluginHost.defs:

2013-08-14  Tim Horton  <timothy_horton@apple.com>

        REGRESSION (r153877): Plugin scanning slows creation of WebViews
        https://bugs.webkit.org/show_bug.cgi?id=119665
        <rdar://problem/14716549>

        Reviewed by Darin Adler.

        * Plugins/WebPluginDatabase.h:
        * Plugins/WebPluginDatabase.mm:
        (+[WebPluginDatabase sharedDatabaseIfExists]): Added.

        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::refreshPlugins):
        Only refresh the plugin database if it's already been loaded.

2013-08-14  Jer Noble  <jer.noble@apple.com>

        Revert r154019; causes >50 tests to fail on WebKit1 bots.

        * Plugins/Hosted/NetscapePluginHostManager.h:
        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::instantiatePlugin):
        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        * Plugins/Hosted/NetscapePluginInstanceProxy.h:
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        * Plugins/Hosted/WebHostedNetscapePluginView.h:
        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView setAttributeKeys:andValues:]):
        (-[WebHostedNetscapePluginView createPlugin]):
        (-[WebHostedNetscapePluginView updateAndSetWindow]):
        * Plugins/Hosted/WebKitPluginClient.defs:
        * Plugins/Hosted/WebKitPluginHost.defs:

2013-08-13  Filip Pizlo  <fpizlo@apple.com>

        Foo::s_info should be Foo::info(), so that you can change how the s_info is actually linked
        https://bugs.webkit.org/show_bug.cgi?id=119770

        Reviewed by Mark Hahnenberg.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::getObjectID):
        (WebKit::NetscapePluginInstanceProxy::retainLocalObject):
        (WebKit::NetscapePluginInstanceProxy::releaseLocalObject):
        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyRuntimeMethod::finishCreation):
        (WebKit::ProxyInstance::invokeMethod):
        * Plugins/Hosted/ProxyRuntimeObject.h:
        (WebKit::ProxyRuntimeObject::createStructure):
        * WebView/WebView.mm:
        (aeDescFromJSValue):

2013-08-13  Anders Carlsson  <andersca@apple.com>

        <https://webkit.org/b/119777> Get rid of two gotos

        Reviewed by Tim Horton.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView mouseDown:]):
        (-[WebHTMLView namesOfPromisedFilesDroppedAtDestination:]):

2013-08-13  Tim Horton  <timothy_horton@apple.com>

        Remotely hosted plugins don’t work in window-server-hosted WebKit1 views
        https://bugs.webkit.org/show_bug.cgi?id=119709
        <rdar://problem/14717572>

        Reviewed by Anders Carlsson.

        * Plugins/Hosted/NetscapePluginHostManager.h:
        Add hostLayersInWindowServer argument to instantiatePlugin.

        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::instantiatePlugin):
        Add hostLayersInWindowServer argument to instantiatePlugin, and pass it through to WebKitPluginHost.

        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (WKPCLayerHostingModeChanged):
        Forward the notification that the plugin host changed its layer hosting mode
        to the instance proxy.

        * Plugins/Hosted/NetscapePluginInstanceProxy.h:
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::setShouldHostLayersInWindowServer):
        Ask the plugin host to re-host its layers when the layer hosting mode changes.

        (WebKit::NetscapePluginInstanceProxy::layerHostingModeChanged):
        Inform the WebHostedNetscapePluginView of the new layer hosting mode
        when it changes. Also, store the new CAContext ID.

        * Plugins/Hosted/WebHostedNetscapePluginView.h:
        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView windowHostsLayersInWindowServer]):
        Determine whether the WebView's current window uses window-server hosting for its layers.

        (-[WebHostedNetscapePluginView createPlugin]):
        Drive-by spelling fix.
        Factor _pluginLayer initialization out into createPluginLayer.
        Instantiate the plugin with the appropriate layer hosting mode.

        (-[WebHostedNetscapePluginView createPluginLayer]):

        (-[WebHostedNetscapePluginView setHostsLayersInWindowServer:]):
        Create a new _pluginLayer if the layer hosting mode changes.
        Attach the new _pluginLayer to our parent layer.

        (-[WebHostedNetscapePluginView updateAndSetWindow]):
        Inform the NetscapePluginInstanceProxy if the layer hosting mode changes,
        so it can inform the plugin host. We will asynchronously receive a reply
        with the new hosting mode and renderContextID and switch to the new CAContext,
        in setHostsLayersInWindowServer:.

        * Plugins/Hosted/WebKitPluginClient.defs:
        * Plugins/Hosted/WebKitPluginHost.defs:

2013-08-08  Tim Horton  <timothy_horton@apple.com>

        navigator.plugins has plugins in it when plugins are disabled
        https://bugs.webkit.org/show_bug.cgi?id=119607
        <rdar://problem/14678030>

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::getPluginInfo):
        If plugins are disabled for the given page, give WebCore an empty list of
        plugins. If WebKit1 had any application plugins, we'd return just them
        instead.

2013-08-06  Stephanie Lewis  <slewis@apple.com>

        Update Order Files for Safari
        <rdar://problem/14517392>

        Unreviewed.

        * WebKit.order:

2013-08-04  Sam Weinig  <sam@webkit.org>

        Remove support for HTML5 MicroData
        https://bugs.webkit.org/show_bug.cgi?id=119480

        Reviewed by Anders Carlsson.

        * Configurations/FeatureDefines.xcconfig:

2013-07-23  David Farler  <dfarler@apple.com>

        Provide optional OTHER_CFLAGS, OTHER_CPPFLAGS, OTHER_LDFLAGS additions for building with ASAN
        https://bugs.webkit.org/show_bug.cgi?id=117762

        Reviewed by Mark Rowe.

        * Configurations/DebugRelease.xcconfig:
        Add ASAN_OTHER_CFLAGS, CPLUSPLUSFLAGS, LDFLAGS.
        * Configurations/WebKit.xcconfig:
        Add ASAN_OTHER_LDFLAGS.

2013-07-26  Mark Rowe  <mrowe@apple.com>

        Logging should be configurable using human-readable channel names rather than crazy bitmasks
        <http://webkit.org/b/119031>

        Implement shared logic for initializing logging channels based on human-readable channel names in WTF,
        and rework the WebCore, WebKit and WebKit2 logging initialization on top of it.

        Logging channels may now be enabled by providing a comma-separated list of channel names, with the special
        "all" name enabling all channels. Channel names prefixed with a leading "-" will result in the named channel
        being disabled. For instance, specifying "all,-history,-loading" will result in all logging channels except
        for history and loading being enabled.

        For OS X developers, this also changes the name of the user defaults used to enable logging. This is done to allow
        the old user defaults to remain set for those people that need to switch between version of WebKit before and
        after this change. Where the old user default keys were WebCoreLogLevel, WebKitLogLevel and WebKit2LogLevel,
        the new user default keys are WebCoreLogging, WebKitLogging and WebKit2Logging.

        For GTK developers, this changes the separator used in the WEBKIT_DEBUG environment variable to a comma for
        consistency with the other platforms and to enable more code sharing.

        While doing this work I've also taken the opportunity to eliminate the need to touch multiple files when
        adding a new logging channel. Now only the header in the relevant project needs to be updated.

        Reviewed by Sam Weinig.

        * Misc/WebKitLogging.h: Declare a WEBKIT_LOG_CHANNELS macro that can be used to apply a preprocessor macro
        across the set of all logging channels. Use this macro to declare the logging channels.
        * Misc/WebKitLogging.m: Use WEBKIT_LOG_CHANNELS to define all of the channels. Pass the channels and the
        preference value to the new WTF function that handles the initialization.
        * WebView/WebPreferenceKeysPrivate.h: Remove a key that does not need to be here.
        * WebView/WebView.mm: Switch from WebCore's InitializeLogging.h to Logging.h.

2013-08-01  Ruth Fong  <ruth_fong@apple.com>

        [Forms: color] <input type='color'> popover color well implementation
        <rdar://problem/14411008> and https://bugs.webkit.org/show_bug.cgi?id=119356

        Reviewed by Benjamin Poulain.

        * Configurations/FeatureDefines.xcconfig: Added and enabled INPUT_TYPE_COLOR_POPOVER.

2013-07-31  Tim Horton  <timothy_horton@apple.com>

        Remove didFinishLoad order quirk
        https://bugs.webkit.org/show_bug.cgi?id=119354
        <rdar://problem/11510686>

        Reviewed by Alexey Proskuryakov.

        * Misc/WebKitVersionChecks.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):
        Don't set the now-removed preference.

2013-07-31  Kwang Yul Seo  <skyul@company100.net>

        Use emptyString instead of String("")
        https://bugs.webkit.org/show_bug.cgi?id=119335

        Reviewed by Darin Adler.

        Use emptyString() instead of String("") because it is better style and
        faster. This is a followup to r116908, removing all occurrences of
        String("") from WebKit.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::userAgent):

2013-07-31  Ruth Fong  <ruth_fong@apple.com>

        <input type=color> Mac UI behaviour
        <rdar://problem/10269922> and https://bugs.webkit.org/show_bug.cgi?id=61276

        Reviewed by Brady Eidson.

        * Configurations/FeatureDefines.xcconfig: Enabled INPUT_TYPE_COLOR.
        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::createColorPicker): Added stub implementation.

2013-07-26  Dean Jackson  <dino@apple.com>

        Allow new transitions to run even when controller is suspended
        https://bugs.webkit.org/show_bug.cgi?id=119171
        <rdar://problem/14511404>

        Reviewed by Simon Fraser.

        Expose a new SPI on WebView that triggers the (buggy) old behaviour
        for animations, such that any newly created animations will start even
        when the document is supposedly suspended. It turns out that client content was
        unknowingly relying on this behaviour - e.g. suspending a view, loading a
        bunch of new content, bringing the view on screen and then unsuspending. In this
        situation, we were not running CSS transitions, because the page was suspended.
        However, JS was still triggering them, and content was expecting a transitionEnd event.

        * WebView/WebView.mm:
        (-[WebView allowsNewCSSAnimationsWhileSuspended]): Calls into AnimationController.
        (-[WebView setAllowsNewCSSAnimationsWhileSuspended:]): Ditto.
        * WebView/WebViewPrivate.h: New methods listed above.

2013-07-26  Anders Carlsson  <andersca@apple.com>

        Add another method that we need to set aside subviews for
        https://bugs.webkit.org/show_bug.cgi?id=119157
        <rdar://problem/14554723>

        Reviewed by Beth Dakin.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _recursive:displayRectIgnoringOpacity:inContext:topView:]):
        (-[WebHTMLView _recursive:displayRectIgnoringOpacity:inGraphicsContext:CGContext:topView:shouldChangeFontReferenceColor:]):

2013-07-25  Andreas Kling  <akling@apple.com>

        ChromeClient::focusedNodeChanged() should be focusedElementChanged().
        <http://webkit.org/b/119110>

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::focusedElementChanged):

2013-05-05  Geoffrey Garen  <ggaren@apple.com>

        Rolled back in r149527 with crash fixed.

        Reviewed by Oliver Hunt.

            Rationalized 'this' value conversion
            https://bugs.webkit.org/show_bug.cgi?id=115542

2013-07-17  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r152701, r152703, r152739, r152754,
        and r152756.
        http://trac.webkit.org/changeset/152701
        http://trac.webkit.org/changeset/152703
        http://trac.webkit.org/changeset/152739
        http://trac.webkit.org/changeset/152754
        http://trac.webkit.org/changeset/152756
        https://bugs.webkit.org/show_bug.cgi?id=118821

        this was a buggy fix and we're going to try something
        different (Requested by thorton on #webkit).

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::shouldUnavailablePluginMessageBeButton):

2013-07-17  Kangil Han  <kangil.han@samsung.com>

        Use toHTMLMediaElement
        https://bugs.webkit.org/show_bug.cgi?id=118727

        Reviewed by Ryosuke Niwa.

        To avoid direct use of static_cast, this patch uses toHTMLMediaElement for code cleanup.

        * WebView/WebView.mm:
        (-[WebView _enterFullscreenForNode:WebCore::]):

2013-07-16  Simon Fraser  <simon.fraser@apple.com>

        Protect against the LayerFlushController being deleted inside its flushLayers() callback
        https://bugs.webkit.org/show_bug.cgi?id=118741
        <rdar://problem/14402651>

        Reviewed by Tim Horton.
        
        It's possible (especially on iOS) for the LayerFlushController to be destroyed
        inside its callback, via -[WebView _close]. Protect against this by making
        it refcounted, and holding a ref across the callback.
        
        Due to the odd relationship in which LayerFlushController owns its LayerFlushScheduler
        by value, we achieve this by allowing subclasses of LayerFlushScheduler
        to override runLoopObserverCallback(). WebViewLayerFlushScheduler uses the
        override to protect the owner of the LayerFlushScheduler, which is the
        LayerFlushController, when the callback is firing.

        * WebView/WebView.mm:
        (-[WebView _close]):
        * WebView/WebViewData.h:
        (WebViewLayerFlushScheduler::~WebViewLayerFlushScheduler):
        (LayerFlushController::create):
        * WebView/WebViewData.mm:
        (LayerFlushController::invalidate):
        (WebViewLayerFlushScheduler::WebViewLayerFlushScheduler):

2013-07-16  Jessie Berlin  <jberlin@apple.com>

        Fix some NSDictionary misuse pointed out by the clang static analyzer
        https://bugs.webkit.org/show_bug.cgi?id=118736

        Reviewed by Anders Carlsson.

        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::spawnPluginHost):
        Explicitly cast the CFStringRef to an NSString *.
        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::documentFragmentFromAttributedString):
        Do not put a key with a nil value pair into the NSDictionary.

2013-07-15  Tim Horton  <timothy_horton@apple.com>

        Update blocked/missing plug-in UI
        https://bugs.webkit.org/show_bug.cgi?id=118347
        <rdar://problem/14209318>

        Reviewed by Sam Weinig.
        Patch by Antoine Quint, Anders Carlsson, Sam Weinig, and myself.

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::shouldUnavailablePluginMessageIncludeButton):
        Rename from shouldUnavailablePluginMessageBeButton to
        shouldUnavailablePluginMessageIncludeButton for accuracy.

2013-07-14  Jon Lee  <jonlee@apple.com>

        [WK2] Calling Notification.requestPermission() without a callback crashes
        https://bugs.webkit.org/show_bug.cgi?id=118654
        <rdar://problem/14293352>

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebNotificationClient.mm:
        (-[WebNotificationPolicyListener initWithCallback:]): The callback can be NULL, so remove the ASSERT.
        (-[WebNotificationPolicyListener allow]): Check for the callback before asking it to handle the event.
        (-[WebNotificationPolicyListener deny]): Ditto.

2013-07-12  Jessie Berlin  <jberlin@apple.com>

        Remove some dead stores pointed out by the clang static analyzer.
        https://bugs.webkit.org/show_bug.cgi?id=118608

        Reviewed by Anders Carlsson.

        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::instantiatePlugin):
        kr is never read after this point, so there is no reason to assign to it.

        * Plugins/WebBasePluginPackage.mm:
        (-[WebBasePluginPackage getPluginInfoFromPLists]):
        The extensions array is only used in the while loop. Move the declaration to the first place
        it is used in the while loop. Since it is always reassigned at that location, and since it
        is never read after the subsequent for loop, the assignment to an array containing the empty
        string is never used. Remove it.
        Similarly, the value of the description is always overwritten before used to assign to
        mimeClassInfo.desc or to pluginInfo.desc, so the code to assign it to the empty string is
        never used. Remove it.

        * WebView/WebTextCompletionController.mm:
        (-[WebTextCompletionController _placePopupWindow:]):
        maxWidth is never read (and never was since it was added in r7311) after it is used on the
        line above to set windowFrame.size.width.

2013-07-11  Dan Bernstein  <mitz@apple.com>

        [mac] No API for getting the page visibility state of a WebView
        https://bugs.webkit.org/show_bug.cgi?id=118578

        Reviewed by Simon Fraser.

        * WebView/WebView.mm:
        (kit): Added. Converts from WebCore::PageVisibilityState to WebPageVisibilityState.
        (-[WebView _visibilityState]): Added.
        * WebView/WebViewPrivate.h: Declared -_visibilityState.

2013-07-11  Timothy Hatcher  <timothy@apple.com>

        Revert r152267 and soft link WebInspectorUI.framework again.

        https://bugs.webkit.org/show_bug.cgi?id=118544

        Reviewed by David Kilzer.

        * Configurations/WebKit.xcconfig:
        * WebCoreSupport/WebInspectorClient.mm:
        (useWebKitWebInspector):

2013-07-10  Jessie Berlin  <jberlin@apple.com>

        Remove some dead code from WebNSURLExtras _web_hostString
        https://bugs.webkit.org/show_bug.cgi?id=118519

        Reviewed by Anders Carlsson.

        * Misc/WebNSURLExtras.mm:
        (-[NSURL _web_hostString]):
        NSString initWithData:encoding: does not throw an exception when passing nil for the data, so
        just delete the code that wasn't being run.

2013-07-09  Jeremy Noble  <jer.noble@apple.com>

        Reviewed by Simon Fraser.

        Remember the scroll position and restore after exiting full-screen mode.
        https://bugs.webkit.org/show_bug.cgi?id=61956
        <rdar://problem/9544461>

        Call into the main FrameView to save the scroll position before swapping the
        WebView into the full-screen window, and restore the scroll position after 
        swapping the WebView back into the browser window.

        * WebView/WebFullScreenController.h:
        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController windowDidEnterFullscreen:]): Save the scroll position.
        (-[WebFullScreenController exitFullscreen]): Restore the scroll position.

2013-07-04  Yongjun Zhang  <yongjun_zhang@apple.com>

        Add a method to get unreachable URL from WebFrame.
        https://bugs.webkit.org/show_bug.cgi?id=118399

        Normally we could use [[WebFrame dataSource] unreachableURL] to get the failed URL.  However, if the frame has not
        loaded (FrameLoader::frameHasLoaded() is false), we will get a nil dataSource and we won't be able to get unreachableURL.
        We can add a method to always return the unreachableURL regardless if the frame has loaded or not.

        Reviewed by Dan Bernstein.

        * WebView/WebFrame.mm:
        (-[WebFrame _unreachableURL]):
        * WebView/WebFramePrivate.h:

2013-07-03  Zalan Bujtas  <zalan@apple.com>

        H&R Block 2010 Help window can not be reopened.
        https://bugs.webkit.org/show_bug.cgi?id=118342

        Reviewed by Antti Koivisto.

        http://trac.webkit.org/changeset/118916 changed the window.focus() behaviour so that
        only the opener can (re)focus() a particular window.
        H&R Block app relies on the relaxed window.focus() rules.

        * WebView/WebView.mm:
        (shouldRestrictWindowFocus):
        (-[WebView _preferencesChanged:]):

2013-07-01  Timothy Hatcher  <timothy@apple.com>

        Link to WebInspectorUI.framework at build time instead of soft linking.

        https://bugs.webkit.org/show_bug.cgi?id=118261

        Reviewed by Joseph Pecoraro.

        * Configurations/WebKit.xcconfig:
        * WebCoreSupport/WebInspectorClient.mm:
        (useWebKitWebInspector):

2013-07-01  Jochen Eisinger  <jochen@chromium.org>

        Remove support for consumable user gestures
        https://bugs.webkit.org/show_bug.cgi?id=118247

        Reviewed by Geoffrey Garen.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::evaluate):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView sendEvent:isDrawRect:]):

2013-06-27  Jer Noble  <jer.noble@apple.com>

        Audio in apps which embed WebViews is corrupted.
        https://bugs.webkit.org/show_bug.cgi?id=118163

        Reviewed by Maciej Stachowiak.

        Expose the WebCore lowPowerVideoAudioBufferSizeEnabled setting to WebKit clients.

        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences lowPowerVideoAudioBufferSizeEnabled]):
        (-[WebPreferences setLowPowerVideoAudioBufferSizeEnabled:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-07-01  Kangil Han  <kangil.han@samsung.com>

        Adopt toHTMLTextAreaElement for code cleanup
        https://bugs.webkit.org/show_bug.cgi?id=118226

        Reviewed by Andreas Kling.

        To enhance readability, this patch adopts toHTMLTextAreaElement.
        This also helps out to reduce duplicated use of static_cast.

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::textDidChangeInTextArea):

2013-06-27  Kangil Han  <kangil.han@samsung.com>

        Adopt is/toHTMLInputElement for code cleanup
        https://bugs.webkit.org/show_bug.cgi?id=118130

        Reviewed by Antti Koivisto.

        To enhance readability, this patch adopts is/toHTMLInputElement.
        This also helps out to reduce duplicated use of static_cast.

        * DOM/WebDOMOperations.mm:
        (-[DOMHTMLInputElement _setAutofilled:]):
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::focusedNodeChanged):
        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::textFieldDidBeginEditing):
        (WebEditorClient::textFieldDidEndEditing):
        (WebEditorClient::textDidChangeInTextField):
        (WebEditorClient::doTextFieldCommandFromEvent):
        (WebEditorClient::textWillBeDeletedInTextField):
        * WebView/WebHTMLRepresentation.mm:
        (inputElementFromDOMElement):

2013-06-26  Kangil Han  <kangil.han@samsung.com>

        Adopt is/toHTMLAudioElement for code cleanup
        https://bugs.webkit.org/show_bug.cgi?id=117985

        Reviewed by Jer Noble.

        To enhance readibility, this patch adopts is/toHTMLAudioElement.
        This also helps out to reduce duplicated use of static_cast.

        * Plugins/WebPluginController.mm:

2013-06-24  Simon Fraser  <simon.fraser@apple.com>

        Move displayID stuff from Widget to Chrome
        https://bugs.webkit.org/show_bug.cgi?id=117944

        Reviewed by Anders Carlsson.

        In r151877 I polluted Widget with displayID-related stuff. This would
        be better on HostWindow, so move it there. This is a net code reduction,
        and eliminates PlatformScreenMac.h, and the NSScreen category.

        * WebView/WebView.mm:
        (-[WebView doWindowDidChangeScreen]): Go via chrome().

2013-06-21  Christophe Dumez  <ch.dumez@sisa.samsung.com>

        REGRESSION (r150663): Using webkitAudioContext in Inspector makes it undefined everywhere
        https://bugs.webkit.org/show_bug.cgi?id=117825

        Reviewed by Kentaro Hara.

        Use Settings to enable Web Audio instead of RuntimeEnabledFeatures.

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-06-20  Simon Fraser  <simon.fraser@apple.com>

        FrameView needs to initialize paintsEntireContents on creation
        https://bugs.webkit.org/show_bug.cgi?id=117844

        Reviewed by Anders Carlsson.
        
        In WebKit1, if the WebView is layer-backed, WebHTMLView gets a layer.
        In this mode, FrameView::paintsEntireContents() is true. However,
        we would only call setPaintsEntireContents(true) on the FrameView
        when the view's layer-backed status changes. FrameView also needs
        to fetch this state when it is initialized, because we may be creating
        a new FrameView for an already layer-backed WebHTMLView.

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::shouldPaintEntireContents):

2013-06-19  Benjamin Poulain  <bpoulain@apple.com>

        Use the PlatformEvent timestamp when creating a DOM Event
        https://bugs.webkit.org/show_bug.cgi?id=117179

        Reviewed by Darin Adler.

        * WebView/WebPDFView.mm:
        (-[WebPDFView PDFViewWillClickOnLink:withURL:]):

2013-06-18  Roger Fong  <roger_fong@apple.com>

        Unreviewed. Build fix for Mac.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        (WebFrameNetworkingContext::create):
        (WebFrameNetworkingContext::WebFrameNetworkingContext):

2013-06-18  Roger Fong  <roger_fong@apple.com>

        Re-implement WebFrameNetworkingContext.
        <rdar://problem/13174821>.

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebFrameNetworkingContext.h: Added.
        (WebFrameNetworkingContext::create):
        (WebFrameNetworkingContext::WebFrameNetworkingContext):
        (WebFrameNetworkingContext::userAgent):
        * WebCoreSupport/WebFrameNetworkingContext.mm: Added.
        (WebFrameNetworkingContext::ensurePrivateBrowsingSession):
        (WebFrameNetworkingContext::destroyPrivateBrowsingSession):
        (WebFrameNetworkingContext::needsSiteSpecificQuirks):
        (WebFrameNetworkingContext::localFileContentSniffingEnabled):
        (WebFrameNetworkingContext::scheduledRunLoopPairs):
        (WebFrameNetworkingContext::sourceApplicationAuditData):
        (WebFrameNetworkingContext::blockedError):
        (WebFrameNetworkingContext::storageSession):

2013-06-18  Alexey Proskuryakov  <ap@apple.com>

        <rdar://problem/13174821> Remove files with an incorrect license.

        Rubber-stamped by Maciej Stachowiak.

        This will break the build, stay tuned for a fix coming soon.

        * WebCoreSupport/WebFrameNetworkingContext.h: Removed.
        * WebCoreSupport/WebFrameNetworkingContext.mm: Removed.

2013-06-17  Michael Brüning  <michael.bruning@digia.com>

        [Qt] Remove Qt specific QTKIT flagged code.
        https://bugs.webkit.org/show_bug.cgi?id=117635

        Reviewed by Simon Hausmann.

        Due to disabling QTKIT for Qt in r151546, the
        code the flags that are not taken into account
        anymore and the code that has been rendered
        unreachable by this are removed.

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-06-17  Grzegorz Czajkowski  <g.czajkowski@samsung.com>

        Unreviewed, rolling out r151632.
        http://trac.webkit.org/changeset/151632
        https://bugs.webkit.org/show_bug.cgi?id=117585

        Debug build error ASSERT(WTF_USE_GRAMMAR_CHECKING) for non MAC
        platforms

        * WebCoreSupport/WebContextMenuClient.mm:
        (fixMenusReceivedFromOldClients):

2013-06-14  Grzegorz Czajkowski  <g.czajkowski@samsung.com>

        Context menu grammar checking items are available when GRAMMAR_CHECKING macro is off
        https://bugs.webkit.org/show_bug.cgi?id=117585

        Reviewed by Anders Carlsson.

        Add GRAMMAR_CHECKING guard to the context menu grammar items.

        * WebCoreSupport/WebContextMenuClient.mm:
        (fixMenusReceivedFromOldClients):

2013-06-13  Jer Noble  <jer.noble@apple.com>

        Add support for AVFoundation-backed HTMLMediaElements in the WebVideoFullScreenController.
        https://bugs.webkit.org/show_bug.cgi?id=117597

        Reviewed by Eric Carlson.

        Allow AVFoundation to be enabled even when the FullScreen API is disabled.

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): 

2013-06-12  Anders Carlsson  <andersca@apple.com>

        Remove the notion of inactive plug-ins
        https://bugs.webkit.org/show_bug.cgi?id=117570
        <rdar://problem/13484213>

        Reviewed by Tim Horton.

        Remove code that deals with inactive plug-ins.

        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::shouldUnavailablePluginMessageBeButton):
        (WebChromeClient::unavailablePluginButtonClicked):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::createPlugin):

2013-06-12  Zan Dobersek  <zdobersek@igalia.com>

        Remove memoryInfoEnabled, quantizedMemoryInfoEnabled settings
        https://bugs.webkit.org/show_bug.cgi?id=117512

        Reviewed by Darin Adler.

        * WebKit.order: Remove the memoryInfoEnabled entry.
        * WebView/WebPreferenceKeysPrivate.h: Remove WebKitMemoryInfoEnabledPreferenceKey.
        * WebView/WebPreferences.mm: Remove memoryInfoEnabled, setMemoryInfoEnabled methods.
        (+[WebPreferences initialize]): Don't set the default value for the WebKitMemoryInfoEnabledPreferenceKey, the preference is being removed.
        * WebView/WebPreferencesPrivate.h: Remove memoryInfoEnabled, setMemoryInfoEnabled method declarations.
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): Remove the call to Settings::setMemoryInfoEnabled, the setting is being removed.

2013-06-06  Timothy Hatcher  <timothy@apple.com>

        Update the framework bundle identifier for the Web Inspector.

        Reviewed by Mark Rowe.

        * WebCoreSupport/WebInspectorClient.mm:
        (useWebKitWebInspector):
        (WebInspectorFrontendClient::localizedStringsURL):
        (-[WebInspectorWindowController inspectorPagePath]):

2013-06-05  Bear Travis  <betravis@adobe.com>

        [CSS Exclusions][CSS Shapes] Split CSS Exclusions & Shapes compile & runtime flags
        https://bugs.webkit.org/show_bug.cgi?id=117172

        Reviewed by Alexandru Chiculita.

        Adding the CSS_SHAPES compile flag.

        * Configurations/FeatureDefines.xcconfig:

2013-06-01  Andreas Kling  <akling@apple.com>

        Remove unnused WebDOMNodeOperationsInternal category.
        <http://webkit.org/b/117105>

        Reviewed by Ryosuke Niwa.

        _subresourceURLs had no clients.

        * DOM/WebDOMOperations.mm:

2013-06-01  Andreas Kling  <akling@apple.com>

        Move Node::hasID() and hasClass() to Element.
        <http://webkit.org/b/117104>

        Reviewed by Ryosuke Niwa.

        * WebView/WebRenderLayer.mm:
        (+[WebRenderLayer nameForLayer:]):

2013-05-31  Stephanie Lewis  <slewis@apple.com>

        Update low memory handler to use new memory pressure notifications on new OS versions.
        <rdar://problem/14027095> 

        Reviewed by Mark Rowe.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-05-29  Jeffrey Pfau  <jpfau@apple.com>

        [Mac] Enable cache partitioning and the public suffix list on 10.8
        <rdar://problem/13679019>

        Rubber-stamped by David Kilzer.

        * Configurations/FeatureDefines.xcconfig:

2013-05-29  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: get rid of obsolete InspectorFrontendHost.hiddenPanels()
        https://bugs.webkit.org/show_bug.cgi?id=60152

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebInspectorClient.mm:

2013-05-28  Joseph Pecoraro  <pecoraro@apple.com>

        Drag to move DOM nodes does not work
        https://bugs.webkit.org/show_bug.cgi?id=116865

        Do not block drag events on the WebKit 1 Web Inspector WebView.

        Reviewed by Timothy Hatcher.

        * WebCoreSupport/WebInspectorClient.mm:

2013-05-28  Andreas Kling  <akling@apple.com>

        Document::setFocusedNode() should be setFocusedElement().
        <http://webkit.org/b/116857>

        Reviewed by Antti Koivisto.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView clearFocus]):
        (-[WebHTMLView becomeFirstResponder]):

2013-05-25  Andreas Kling  <akling@apple.com>

        Remove Document::getFocusableNodes().
        <http://webkit.org/b/116773>

        Reviewed by Joseph Pecoraro.

        Remove the private _focusableNodes API on DOMDocument, it has no clients.

        * DOM/WebDOMOperations.mm:
        * DOM/WebDOMOperationsPrivate.h:

2013-05-25  Simon Fraser  <simon.fraser@apple.com>

        Unprefix Page Visibility API
        https://bugs.webkit.org/show_bug.cgi?id=102340

        Reviewed by Tim Horton.

        Renaming of the "preview" state to "unloaded".

        * WebView/WebView.mm:
        * WebView/WebViewPrivate.h:

2013-05-25  Dan Bernstein  <mitz@apple.com>

        <rdar://problem/13924889> -webView:didPerformClientRedirectFromURL:toURL:inFrame: should be given the redirecting URL as the “from” URL
        https://bugs.webkit.org/show_bug.cgi?id=116733

        Reviewed by Adele Peterson.

        By the time the history controller calls updateGlobalHistoryRedirectLinks(), the document
        loader already reflects the destination URL. In order to be able to provide the immediate
        source URL to the delegate, we make WebFrame track a URL and provisional URL, updating them
        in response to FrameLoader callbacks in exactly the same way WebFrameProxy maintains its
        m_url and m_provisionalURL member variables.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::dispatchDidReceiveServerRedirectForProvisionalLoad): Update
        provisionalURL.
        (WebFrameLoaderClient::dispatchDidChangeLocationWithinPage): Update url.
        (WebFrameLoaderClient::dispatchDidPushStateWithinPage): Ditto.
        (WebFrameLoaderClient::dispatchDidReplaceStateWithinPage): Ditto.
        (WebFrameLoaderClient::dispatchDidPopStateWithinPage): Ditto.
        (WebFrameLoaderClient::dispatchDidStartProvisionalLoad): Update provisionalURL.
        (WebFrameLoaderClient::dispatchDidCommitLoad): Update URL and provisionalURL.
        (WebFrameLoaderClient::dispatchDidFailProvisionalLoad): Clear provisionalURL.
        (WebFrameLoaderClient::dispatchDidFailLoad): Added an assertion.
        (WebFrameLoaderClient::dispatchDidFinishLoad): Ditto.
        (WebFrameLoaderClient::updateGlobalHistoryRedirectLinks): Pass the last committed URL as the
        source, rather than clientRedirectSourceForHistory().
        * WebView/WebFrameInternal.h: Added url and provisionalURL ivars to WebFramePrivate.

2013-05-24  Anders Carlsson  <andersca@apple.com>

        Remove using namespace std from Mac WebKit1
        https://bugs.webkit.org/show_bug.cgi?id=116747

        Reviewed by Sam Weinig.

        Use explicit std:: qualifiers instead.

        * History/BinaryPropertyList.cpp:
        (IntegerArray::deletedValueSize):
        (BinaryPropertyListPlan::invalidObjectReference):
        (bytesNeeded):
        * History/WebHistory.mm:
        (-[WebHistoryPrivate orderedLastVisitedDays]):
        (WebHistoryWriter::WebHistoryWriter):
        * History/WebHistoryItem.mm:
        (-[WebHistoryItem initFromDictionaryRepresentation:]):
        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::instantiatePlugin):
        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::idForObject):
        (WebKit::NetscapePluginInstanceProxy::wheelEvent):
        (WebKit::NetscapePluginInstanceProxy::print):
        (WebKit::NetscapePluginInstanceProxy::snapshot):
        (WebKit::NetscapePluginInstanceProxy::loadURL):
        (WebKit::NetscapePluginInstanceProxy::createBindingsInstance):
        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::invoke):
        (WebKit::ProxyInstance::supportsInvokeDefaultMethod):
        (WebKit::ProxyInstance::supportsConstruct):
        (WebKit::ProxyInstance::getPropertyNames):
        (WebKit::ProxyInstance::methodNamed):
        (WebKit::ProxyInstance::fieldNamed):
        (WebKit::ProxyInstance::fieldValue):
        (WebKit::ProxyInstance::setFieldValue):
        * Plugins/WebBasePluginPackage.mm:
        (-[WebBasePluginPackage supportsExtension:]):
        (-[WebBasePluginPackage MIMETypeForExtension:]):
        * Plugins/WebNetscapePluginStream.mm:
        (WebNetscapePluginStream::deliverData):
        * Plugins/WebNetscapePluginView.mm:
        (PluginTimer::start):
        (-[WebNetscapePluginView _postURL:target:len:buf:file:notifyData:sendNotification:allowHeaders:]):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        * WebView/WebFrame.mm:
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _adjustedBottomOfPageWithTop:bottom:limit:]):
        * WebView/WebTextCompletionController.mm:
        (-[WebTextCompletionController _placePopupWindow:]):

2013-05-24  Anders Carlsson  <andersca@apple.com>

        Move history property list writer to WebKit
        https://bugs.webkit.org/show_bug.cgi?id=116746

        Reviewed by Tim Horton.

        Move WebCore history files to WebKit since they're only used by WebKit now.

        * History/BinaryPropertyList.cpp: Renamed from Source/WebCore/platform/cf/BinaryPropertyList.cpp.
        * History/BinaryPropertyList.h: Renamed from Source/WebCore/platform/cf/BinaryPropertyList.h.
        * History/HistoryPropertyList.cpp: Renamed from Source/WebCore/history/cf/HistoryPropertyList.cpp.
        * History/HistoryPropertyList.h: Renamed from Source/WebCore/history/cf/HistoryPropertyList.h.
        * History/WebHistory.mm:

2013-05-24  Christophe Dumez  <ch.dumez@sisa.samsung.com>

        Remove custom code for webkitAudioContext global constructor getter
        https://bugs.webkit.org/show_bug.cgi?id=116530

        Reviewed by Geoffrey Garen.

        Use RuntimeEnabledFeatures instead of Settings to toggle Web Audio support.

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-05-23  Anders Carlsson  <andersca@apple.com>

        Crash in convertMainResourceLoadToDownload when downloading file by option-return
        https://bugs.webkit.org/show_bug.cgi?id=116451

        Reviewed by Andreas Kling.

        If the main resource loader is null, create a new download instead since there's no existing loader to convert.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::convertMainResourceLoadToDownload):

2013-05-22  Simon Fraser  <simon.fraser@apple.com>

        Fix issues with focus rings on search fields
        https://bugs.webkit.org/show_bug.cgi?id=116591

        Reviewed by Darin Adler.
        
        In WebKit1, focus rings didn't render correctly on some OSes until
        some other control drew a focus ring, which changes internal AppKit state
        on the focused view. Fix by overriding an internal AppKit method to always
        disable AppKit's "automatic" focus ring drawing.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _automaticFocusRingDisabled]):

2013-05-20  David Kilzer  <ddkilzer@apple.com>

        Synchronize FeatureDefines.xcconfig

        * Configurations/FeatureDefines.xcconfig: Add a newline to the
        end of the file.

2013-05-19  Anders Carlsson  <andersca@apple.com>

        Remove link prerendering code
        https://bugs.webkit.org/show_bug.cgi?id=116415

        Reviewed by Darin Adler.

        This code was only used by Chromium and is dead now.

        * Configurations/FeatureDefines.xcconfig:

2013-05-19  Anders Carlsson  <andersca@apple.com>

        Remove ChromeClient::webView()
        https://bugs.webkit.org/show_bug.cgi?id=116054

        Reviewed by Darin Adler.

        This blatantly horrible layer violation was only used to know if a ChromeClient is an empty
        client or not. We already have a (slightly less horrible) way to do that.

        * WebCoreSupport/WebChromeClient.h:
        (WebChromeClient):

2013-05-17  Anders Carlsson  <andersca@apple.com>

        Accessing null function pointers is bad.

        * WebCoreSupport/WebFrameLoaderClient.mm:

2013-05-17  Anders Carlsson  <andersca@apple.com>

        Make kit(Frame*) more robust
        https://bugs.webkit.org/show_bug.cgi?id=116324

        Reviewed by Darin Adler.

        Check that the frame loader's client isn't the EmptyFrameLoaderClient (or a subclass thereof)
        before casting to WebFrameLoaderClient.

        * WebView/WebFrame.mm:
        (kit):

2013-05-17  Anders Carlsson  <andersca@apple.com>

        Move the policy function to WebFramePolicyListener
        https://bugs.webkit.org/show_bug.cgi?id=116323

        Reviewed by Darin Adler.

        There's no need for the WebFrameLoaaderClient to hold on to the policy function,
        so move it to WebFramePolicyListener. This gets rid of another WebFrameLoaderClient cast.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::setUpPolicyListener):
        Pass the policy function when creating the WebFramePolicyListener object.

2013-05-17  Anders Carlsson  <andersca@apple.com>

        WebFramePolicyListener should keep its Frame in a RefPtr
        https://bugs.webkit.org/show_bug.cgi?id=116322

        Reviewed by Darin Adler.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (-[WebFramePolicyListener initWithWebCoreFrame:]):
        No need to ref the frame, the RefPtr does that for us.

        (-[WebFramePolicyListener invalidate]):
        Just set the frame to null.

        (-[WebFramePolicyListener dealloc]):
        Remove call to deref, that's done automatically now.

        (-[WebFramePolicyListener finalize]):
        Remove this method. (We could have kept it just for the assertion but I didn't think that was necessary).

        (-[WebFramePolicyListener receivedPolicyDecision:):
        Use release() to transfer ownership.

2013-05-17  Anders Carlsson  <andersca@apple.com>

        Reduce number of WebFrameLoaderClient static casts in WebKit
        https://bugs.webkit.org/show_bug.cgi?id=116320

        Reviewed by Antti Koivisto.

        We already have a function to return a WebFrame from a WebCore::Frame, use it.

        * DOM/WebDOMOperations.mm:
        (WebFrameFilter::shouldIncludeSubframe):
        * WebView/WebDataSource.mm:
        (-[WebDataSource webFrame]):

2013-05-16  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r150034.
        http://trac.webkit.org/changeset/150034
        https://bugs.webkit.org/show_bug.cgi?id=116257

        This work around doesn't work due to another bug NSUndoManager
        has (Requested by rniwa on #webkit).

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::registerUndoOrRedoStep):

2013-05-16  Tim Horton  <timothy_horton@apple.com>

        PDFPlugins don't load when plugins are disabled, but they should
        https://bugs.webkit.org/show_bug.cgi?id=75790
        <rdar://problem/11650197>

        Reviewed by Anders Carlsson.

        * Plugins/WebBasePluginPackage.mm:
        (-[WebBasePluginPackage getPluginInfoFromPLists]):
        * Plugins/WebNetscapePluginPackage.mm:
        (-[WebNetscapePluginPackage getPluginInfoFromResources]):
        Nothing loaded via WebBasePluginPackage or WebNetscapePluginPackage
        is an application plugin.

        * WebView/WebFrame.mm:
        (-[WebFrame _canProvideDocumentSource]):
        Previously, this caller depended on pluginData() returning null if
        plug-ins were disabled. Since that is no longer the case, we have to
        check if we can use plug-ins, and otherwise ignore non-application-plug-ins.

2013-05-16  Andreas Kling  <akling@apple.com>

        Page::chrome() should return a reference.
        <http://webkit.org/b/116185>

        Reviewed by Anders Carlsson.

2013-05-16  Dan Bernstein  <mitz@apple.com>

        -webView:updateHistoryTitle:forURL: does not pass a frame to the delegate
        https://bugs.webkit.org/show_bug.cgi?id=116243

        Reviewed by Anders Carlsson.

        Added a WebFrame parameter to the delegate method.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::setTitle): Pass the frame to the delegate. Maintain
        compatibility with clients that implement the old delegate method that
        doesn’t take a frame.
        * WebView/WebDelegateImplementationCaching.h:
        (WebHistoryDelegateImplementationCache): Added a field to cache the
        implementation of the old delegate method.
        * WebView/WebHistoryDelegate.h: Changed the signature of the delegate method.
        * WebView/WebView.mm:
        (-[WebView _cacheHistoryDelegateImplementations]): Cache the implementation
        of the new delegate method, but also check for the old one.

2013-05-16  Simon Fraser  <simon.fraser@apple.com>

        Re-land r150168 with some OS version guards.

        * WebView/WebFrameView.mm:
        (-[WebFrameView drawRect:]):
        (-[WebFrameView wantsUpdateLayer]):
        (-[WebFrameView updateLayer]):

2013-05-16  Commit Queue  <commit-queue@webkit.org>

        Unreviewed, rolling out r150168.
        http://trac.webkit.org/changeset/150168
        https://bugs.webkit.org/show_bug.cgi?id=116214

        broke the world on Mountain Lion (Requested by thorton on
        #webkit).

        * WebView/WebFrameView.mm:
        (-[WebFrameView drawRect:]):

2013-05-15  Simon Fraser  <simon.fraser@apple.com>

        Avoid backing store for the WebFrameView's layer when the WebView is layer-backed
        https://bugs.webkit.org/show_bug.cgi?id=116172

        Reviewed by Tim Horton.

        When the WebView is layer-backed, AppKit will create a layer with backing store for
        the WebFrameView because it implements drawRect:. However, this method only paints
        when there is no documentView, so this layer’s backing store is wasteful.

        We can avoid allocation of this backing store by implementing -wantsUpdateLayer
        and -updateLayer, and setting the view’s backgroundColor.

        * WebView/WebFrameView.mm:
        (-[WebFrameView wantsUpdateLayer]):
        (-[WebFrameView updateLayer]):

2013-05-13  Anders Carlsson  <andersca@apple.com>

        Frame::editor() should return a reference
        https://bugs.webkit.org/show_bug.cgi?id=116037

        Reviewed by Darin Adler.

        * WebView/WebFrame.mm:
        (-[WebFrame _selectedString]):
        (-[WebFrame _firstRectForDOMRange:]):
        (-[WebFrame _markDOMRange]):
        (-[WebFrame _insertParagraphSeparatorInQuotedContent]):
        (-[WebFrame _setTypingStyle:withUndoAction:]):
        (-[WebFrame _replaceSelectionWithFragment:selectReplacement:smartReplace:matchStyle:]):
        * WebView/WebHTMLRepresentation.mm:
        (-[WebHTMLRepresentation finishedLoadingWithDataSource:]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _pasteWithPasteboard:allowPlainText:]):
        (-[WebHTMLView _shouldDeleteRange:]):
        (-[WebHTMLView _canEdit]):
        (-[WebHTMLView _canEditRichly]):
        (-[WebHTMLView _insertOrderedList]):
        (-[WebHTMLView _insertUnorderedList]):
        (-[WebHTMLView _canIncreaseSelectionListLevel]):
        (-[WebHTMLView _canDecreaseSelectionListLevel]):
        (-[WebHTMLView _increaseSelectionListLevel]):
        (-[WebHTMLView _increaseSelectionListLevelOrdered]):
        (-[WebHTMLView _increaseSelectionListLevelUnordered]):
        (-[WebHTMLView _decreaseSelectionListLevel]):
        (-[WebHTMLView Editor::coreCommandBySelector:]):
        (-[WebHTMLView Editor::coreCommandByName:]):
        (-[WebHTMLView validateUserInterfaceItemWithoutDelegate:]):
        (-[WebHTMLView becomeFirstResponder]):
        (-[WebHTMLView _selectionStartFontAttributesAsRTF]):
        (-[WebHTMLView _applyStyleToSelection:withUndoAction:]):
        (-[WebHTMLView _changeCSSColorUsingSelector:inRange:]):
        (-[WebHTMLView checkSpelling:]):
        (-[WebHTMLView showGuessPanel:]):
        (-[WebHTMLView toggleBaseWritingDirection:]):
        (-[WebHTMLView changeBaseWritingDirection:]):
        (-[WebHTMLView _changeBaseWritingDirectionTo:]):
        (-[WebHTMLView _updateFontPanel]):
        (-[WebHTMLView markedRange]):
        (-[WebHTMLView hasMarkedText]):
        (-[WebHTMLView unmarkText]):
        (-[WebHTMLView setMarkedText:selectedRange:]):
        (-[WebHTMLView doCommandBySelector:]):
        (-[WebHTMLView insertText:]):
        (-[WebHTMLView _updateSelectionForInputManager]):
        (-[WebHTMLView countMatchesForText:inDOMRange:options:limit:markMatches:]):
        (-[WebHTMLView setMarkedTextMatchesAreHighlighted:]):
        (-[WebHTMLView markedTextMatchesAreHighlighted]):
        (-[WebHTMLView _findString:options:]):
        * WebView/WebView.mm:
        (-[WebView _executeCoreCommandByName:value:]):
        (-[WebView editableDOMRangeForPoint:]):
        (-[WebView setEditable:]):
        (-[WebView deleteSelection]):
        (-[WebView applyStyle:]):
        (-[WebView typingAttributes]):
        (-[WebView _simplifyMarkup:endNode:]):
        (-[WebView handleAcceptedAlternativeText:]):

2013-05-15  Darin Adler  <darin@apple.com>

        [Mac] Remove the ClipboardMac class and header file
        https://bugs.webkit.org/show_bug.cgi?id=116165

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebDragClient.mm: Import Clipboard.h instead of ClipboardMac.h.

2013-05-15  Darin Adler  <darin@apple.com>

        [Mac] Thin out the ClipboardMac class and header file to prepare for deleting them
        https://bugs.webkit.org/show_bug.cgi?id=116159

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebDragClient.mm:
        (WebDragClient::willPerformDragSourceAction): Changed to get the pasteboard name
        without going through the ClipboardMac class.
        (WebDragClient::startDrag): Ditto.

2013-05-14  Beth Dakin  <bdakin@apple.com>

        Printing in 1Password app is broken with screen fonts disabled
        https://bugs.webkit.org/show_bug.cgi?id=116133
        -and corresponding-
        <rdar://problem/13162981>

        Reviewed by Anders Carlsson.

        Return YES from [WebPreferences screenFontSubstitutionEnabled] for versions of the 
        1Password app that were linked on or before MountainLion.

        * WebView/WebPreferences.mm:
        (needsScreenFontsEnabledQuirk):
        (-[WebPreferences screenFontSubstitutionEnabled]):

2013-05-13  Dan Bernstein  <mitz@apple.com>

        Make -[WebNavigationData url] the destination of the navigation
        https://bugs.webkit.org/show_bug.cgi?id=114904

        Reviewed by Dave Kilzer.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::updateGlobalHistory): Initialize the WebNavigationData with the
        current URL, not the original request URL.

2013-05-13  Anders Carlsson  <andersca@apple.com>

        Remove ChromeClient::willPopupMenu
        https://bugs.webkit.org/show_bug.cgi?id=116063

        Reviewed by Andreas Kling.

        ChromeClient::willPopupMenu is only called in one place from WebKit, so just move the function to the call site.

        * WebCoreSupport/PopupMenuMac.mm:
        (PopupMenuMac::show):
        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:

2013-05-12  Timothy Hatcher  <timothy@apple.com>

        Add support for updating the Web Inspector toolbar height.

        https://bugs.webkit.org/show_bug.cgi?id=115996

        Reviewed by Joseph Pecoraro and Benjamin Poulain.

        * WebCoreSupport/WebInspectorClient.h:
        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::setToolbarHeight):

2013-05-13  Ryosuke Niwa  <rniwa@webkit.org>

        Sometimes NSUndoManager can get into an inconsistent state
        https://bugs.webkit.org/show_bug.cgi?id=116050

        Reviewed by Enrica Casucci.

        Always group undo items to work around a bug in NSUndoManager that manifests
        when we call removeAllActionsWithTarget.

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::registerUndoOrRedoStep):

2013-05-13  Zalan Bujtas  <zalan@apple.com>

        WebProcess consuming very high CPU on linkedin.com
        https://bugs.webkit.org/show_bug.cgi?id=115601

        Reviewed by Andreas Kling.

        Disable WEB_TIMING_MINIMAL.
        Turn off window.performance and performance.now(). Some JS frameworks expect
        additional Web Timing APIs, when performance.now() is available.

        * Configurations/FeatureDefines.xcconfig:

2013-05-13  Darin Adler  <darin@apple.com>

        [Mac] Layer-backed WebViews draw their background color even when setDrawsBackground:NO was called
        https://bugs.webkit.org/show_bug.cgi?id=116014
        <rdar://problem/12781227>

        Reviewed by Dan Bernstein.

        * WebView/WebFrame.mm:
        (-[WebFrame _updateBackgroundAndUpdatesWhileOffscreen]): Remove calls to setBackgroundColor: and
        setDrawsBackground: on the document view. These were added to support a hypothetical document view
        that wanted to draw its background like WebHTMLView does, but this was never communicated as a
        document view protocol, formal or informal, and it's unlikely that it was ever used. The bug was
        caused because there is an -[NSView setDrawsBackground:] method, probably an internal one, and we
        were calling it unintentionally on a WebHTMLView.

2013-05-12  Anders Carlsson  <andersca@apple.com>

        Stop including UnusedParam.h
        https://bugs.webkit.org/show_bug.cgi?id=116003

        Reviewed by Sam Weinig.

        UnusedParam.h is empty now so there's no need to include it anymore.

        * Plugins/WebNetscapePluginEventHandlerCocoa.mm:
        * WebView/WebDashboardRegion.mm:
        * WebView/WebFullScreenController.mm:

2013-05-12  Andreas Kling  <akling@apple.com>

        Unload event listeners should prevent Safari from insta-killing the web process on last tab close.
        <http://webkit.org/b/115988>
        <rdar://problem/13870943>

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::enableSuddenTermination):
        (WebChromeClient::disableSuddenTermination):

2013-05-10  Brian J. Burg  <burg@cs.washington.edu>

        Web Inspector: Implement WK2 version of WebInspectorFrontendClient::save
        https://bugs.webkit.org/show_bug.cgi?id=115564

        Reviewed by Benjamin Poulain.

        Clean up save() and append() implementations.

        * WebCoreSupport/WebInspectorClient.h:
        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::save):
        (WebInspectorFrontendClient::append):

2013-05-10  Laszlo Gombos  <l.gombos@samsung.com>

        Remove Mac OS X Leopard (10.5) support
        https://bugs.webkit.org/show_bug.cgi?id=107964

        Reviewed by Ryosuke Niwa.

        Removed the code for 10.5 and removed if-def for 10.6.

        * DefaultDelegates/WebDefaultContextMenuDelegate.mm:
        * Misc/WebKitErrors.m:
        (-[NSError _initWithPluginErrorCode:contentURL:pluginPageURL:pluginName:MIMEType:]):
        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):
        * WebView/WebClipView.mm:
        (-[WebClipView _immediateScrollToPoint:]):
        * WebView/WebFrameView.mm:
        (-[WebFrameView initWithFrame:]):
        * WebView/WebView.mm:

2013-05-07  Mark Rowe  <mrowe@apple.com>

        <rdar://problem/13633007> WebKit and others fail to build headers due to build root dependency

        Reviewed by Sam Weinig.

        * Configurations/WebKit.xcconfig: Look for WebCore's headers within the SDK if we're building against one.

2013-05-07  Mikhail Pozdnyakov  <mikhail.pozdnyakov@intel.com>

        HashTraits<RefPtr<P> >::PeekType should be raw pointer for better performance
        https://bugs.webkit.org/show_bug.cgi?id=115646

        Reviewed by Darin Adler.

        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (WebKit::NetscapePluginHostProxy::pluginInstance):
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::cancelStreamLoad):
            Updated accordingly to new HashMap<.., RefPtr>::get() semantics.

2013-05-04  Dean Jackson  <dino@apple.com>

        Animations and Transitions should not start when globally suspended
        https://bugs.webkit.org/show_bug.cgi?id=114915

        Reviewed by Sam Weinig.

        The WebView private API cssAnimationsSuspended did not necessarily
        reflect the reality of the Frame's AnimationController value because it
        was caching rather than asking directly. While the WebCore part of this
        patch ensured loading the Document wouldn't resume all animations, it
        is still better to ask directly.

        * WebView/WebView.mm:
        (-[WebView cssAnimationsSuspended]): Call into AnimationController.
        (-[WebView setCSSAnimationsSuspended:]): Ditto.
        * WebView/WebViewData.h: Remove cssAnimationsSuspended boolean.
        * WebView/WebViewData.mm: Ditto.
        (-[WebViewPrivate init]):

2013-05-04  Sam Weinig  <sam@webkit.org>

        Move PopupMenuMac and SearchPopupMenuMac to Source/WebKit/mac
        matching where they are in WebKit2.

        Reviewed by Anders Carlsson.

        * WebCoreSupport/PopupMenuMac.h: Copied from WebCore/platform/mac/PopupMenuMac.h.
        * WebCoreSupport/PopupMenuMac.mm: Copied from WebCore/platform/mac/PopupMenuMac.mm.
        * WebCoreSupport/SearchPopupMenuMac.h: Copied from WebCore/platform/mac/SearchPopupMenuMac.h.
        * WebCoreSupport/SearchPopupMenuMac.mm: Copied from WebCore/platform/mac/SearchPopupMenuMac.mm.
        * WebCoreSupport/WebChromeClient.mm:

2013-05-04  Anders Carlsson  <andersca@apple.com>

        Get rid of -[NSMutableDictionary _webkit_setObject:forUncopiedKey:]
        https://bugs.webkit.org/show_bug.cgi?id=115592

        Reviewed by Beth Dakin.

        Using CFDictionarySetValue to set a key without having to copy it is not supported. Use NSMapTable with strong pointers instead.

        * Misc/WebNSDictionaryExtras.h:
        * Misc/WebNSDictionaryExtras.m:
        * Panels/WebPanelAuthenticationHandler.h:
        (NSURLAuthenticationChallenge):
        * Panels/WebPanelAuthenticationHandler.m:
        (-[WebPanelAuthenticationHandler init]):
        (-[WebPanelAuthenticationHandler enqueueChallenge:forWindow:]):
        (-[WebPanelAuthenticationHandler tryNextChallengeForWindow:]):
        (-[WebPanelAuthenticationHandler startAuthentication:window:]):
        (-[WebPanelAuthenticationHandler cancelAuthentication:]):
        * Plugins/WebNetscapePluginView.h:
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView destroyPlugin]):
        (-[WebNetscapePluginView initWithFrame:pluginPackage:URL:baseURL:MIMEType:attributeKeys:attributeValues:loadManually:element:WebCore::]):
        (-[WebNetscapePluginView webFrame:didFinishLoadWithReason:]):
        (-[WebNetscapePluginView loadPluginRequest:]):

2011-05-01  Ryosuke Niwa  <rniwa@webkit.org>

        [Mac] WebKit doesn't enable or disable autocorrections when system preferences are changed
        https://bugs.webkit.org/show_bug.cgi?id=115463

        Reviewed by Darin Adler.

        Observe the default notification center for changes to autocorrection preferences.
        Note system preferences may also update WebAutomatic* defaults.

        * WebView/WebView.mm:
        (+[WebView initialize]):
        (+[WebView _shouldAutomaticTextReplacementBeEnabled]):
        (+[WebView _didChangeAutomaticTextReplacementEnabled:]):
        (+[WebView _shouldAutomaticSpellingCorrectionBeEnabled]):
        (+[WebView _didChangeAutomaticSpellingCorrectionEnabled:]):
        (+[WebView _shouldAutomaticQuoteSubstitutionBeEnabled]):
        (+[WebView _shouldAutomaticDashSubstitutionBeEnabled]):
        (+[WebView _didChangeAutomaticQuoteSubstitutionEnabled:]):
        (+[WebView _didChangeAutomaticDashSubstitutionEnabled:]):

2013-05-01  Benjamin Poulain  <bpoulain@apple.com>

        Fix the function names of r149453

        Unreviewed.

        I forgot to follow one of Darin's review comment. This patch
        fixes the function names to follow CF naming conventions.

        * WebView/WebHTMLRepresentation.mm:
        (newArrayWithStrings):
        (newArrayByConcatenatingArrays):
        (+[WebHTMLRepresentation supportedMIMETypes]):
        (+[WebHTMLRepresentation supportedNonImageMIMETypes]):
        (+[WebHTMLRepresentation supportedImageMIMETypes]):
        (+[WebHTMLRepresentation unsupportedTextMIMETypes]):

2013-05-01  Benjamin Poulain  <benjamin@webkit.org>

        Simplify WebHTMLRepresentation supportedMIMETypes methods
        https://bugs.webkit.org/show_bug.cgi?id=115314

        Reviewed by Darin Adler.

        The initialization was surprisingly complex because of DEFINE_STATIC_LOCAL.
        First, a new pointer was allocated on the heap with fast malloc (for RetainPtr<NSArray>).
        Then a new NSMutableArray was allocated but immediately put on the autorelease pool.
        Finally, that array was retained by the RetainPtr.

        This patch changes the code to only leak the NSMutableArray memory. There
        is no fastMalloc, nor any use of the autorelease pool.

        * WebView/WebHTMLRepresentation.mm:
        (createArrayWithStrings):
        (createArrayByConcatenatingArrays):
        (+[WebHTMLRepresentation supportedMIMETypes]):
        (+[WebHTMLRepresentation supportedNonImageMIMETypes]):
        (+[WebHTMLRepresentation supportedImageMIMETypes]):
        (+[WebHTMLRepresentation unsupportedTextMIMETypes]):

2013-04-30  Darin Adler  <darin@apple.com>

        [Mac] Remove adoptNS/retain pairs, since the two cancel each other out
        https://bugs.webkit.org/show_bug.cgi?id=115426

        Reviewed by Anders Carlsson.

        * Plugins/WebNetscapePluginStream.mm:
        (WebNetscapePluginStream::deliverDataToFile): Remove adoptNS and release.

2013-04-30  Geoffrey Garen  <ggaren@apple.com>

        Objective-C JavaScriptCore API should publicly support bridging to C
        https://bugs.webkit.org/show_bug.cgi?id=115447

        Reviewed by Mark Hahnenberg.

        * WebView/WebFrame.mm:
        (-[WebFrame _javaScriptContextForScriptWorld:]):
        * WebView/WebScriptWorld.mm:
        (+[WebScriptWorld scriptWorldForJavaScriptContext:]):

2013-04-30  Anders Carlsson  <andersca@apple.com>

        More StorageTracker cleanup
        https://bugs.webkit.org/show_bug.cgi?id=115429

        Reviewed by Andreas Kling.

        Call PageGroup::syncLocalStorage directly.

        * Storage/WebStorageManager.mm:
        (-[WebStorageManager syncLocalStorage]):

2013-04-30  Zalan Bujtas  <zalan@apple.com>

        Animations fail to start on http://www.google.com/insidesearch/howsearchworks/thestory/
        https://bugs.webkit.org/show_bug.cgi?id=111244

        Reviewed by David Kilzer.
        
        Enable performance.now() as a minimal subset of Web Timing API. 
        It returns DOMHighResTimeStamp, a monotonically increasing value representing the 
        number of milliseconds from the start of the navigation of the current document.
        JS libraries use this API to check against the requestAnimationFrame() timestamp.

        * Configurations/FeatureDefines.xcconfig:

2013-04-29  Chris Fleizach  <cfleizach@apple.com>

        WEB SPEECH: need to identify the default voice per language
        https://bugs.webkit.org/show_bug.cgi?id=115366

        Reviewed by Tim Horton.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-04-28  Dean Jackson  <dino@apple.com>

        [Mac] Disable canvas backing store scaling (HIGH_DPI_CANVAS)
        https://bugs.webkit.org/show_bug.cgi?id=115310

        Reviewed by Simon Fraser.

        Remove ENABLE_HIGH_DPI_CANVAS_macosx.

        * Configurations/FeatureDefines.xcconfig:

2013-04-27  Darin Adler  <darin@apple.com>

        Move from constructor and member function adoptCF/NS to free function adoptCF/NS.
        https://bugs.webkit.org/show_bug.cgi?id=115307

        Reviewed by Geoffrey Garen.

        This change was done by a global replace followed by compiling and inspecting for
        cases that needed to be tweaked by hand.

        * DefaultDelegates/WebDefaultContextMenuDelegate.mm:
        (-[WebDefaultUIDelegate menuItemWithTag:target:representedObject:]):
        * Misc/WebNSFileManagerExtras.mm:
        (-[NSFileManager _webkit_startupVolumeName]):
        * Plugins/Hosted/HostedNetscapePluginStream.mm:
        (WebKit::HostedNetscapePluginStream::HostedNetscapePluginStream):
        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::spawnPluginHost):
        (WebKit::NetscapePluginHostManager::instantiatePlugin):
        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (WebKit::NetscapePluginHostProxy::NetscapePluginHostProxy):
        (WebKit::NetscapePluginHostProxy::beginModal):
        (WKPCBooleanAndDataReply):
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::print):
        (WebKit::NetscapePluginInstanceProxy::snapshot):
        (WebKit::NetscapePluginInstanceProxy::status):
        (WebKit::NetscapePluginInstanceProxy::loadURL):
        (WebKit::NetscapePluginInstanceProxy::evaluateJavaScript):
        (WebKit::NetscapePluginInstanceProxy::enumerate):
        (WebKit::NetscapePluginInstanceProxy::marshalValue):
        (WebKit::NetscapePluginInstanceProxy::marshalValues):
        (WebKit::NetscapePluginInstanceProxy::demarshalValue):
        (WebKit::NetscapePluginInstanceProxy::demarshalValues):
        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView setAttributeKeys:andValues:]):
        (-[WebHostedNetscapePluginView createPlugin]):
        * Plugins/WebBaseNetscapePluginView.mm:
        (-[WebBaseNetscapePluginView initWithFrame:pluginPackage:URL:baseURL:MIMEType:attributeKeys:attributeValues:loadManually:element:WebCore::]):
        (-[WebBaseNetscapePluginView cacheSnapshot]):
        (WebKit::getAuthenticationInfo):
        * Plugins/WebBasePluginPackage.mm:
        (-[WebBasePluginPackage initWithPath:]):
        * Plugins/WebNetscapePluginEventHandlerCarbon.mm:
        (WebNetscapePluginEventHandlerCarbon::startTimers):
        * Plugins/WebNetscapePluginEventHandlerCocoa.mm:
        (WebNetscapePluginEventHandlerCocoa::syntheticKeyDownWithCommandModifier):
        (WebNetscapePluginEventHandlerCocoa::handleTSMEvent):
        * Plugins/WebNetscapePluginPackage.mm:
        (-[WebNetscapePluginPackage _initWithPath:]):
        * Plugins/WebNetscapePluginStream.mm:
        (WebNetscapePluginStream::WebNetscapePluginStream):
        (WebNetscapePluginStream::deliverData):
        (WebNetscapePluginStream::deliverDataToFile):
        (WebNetscapePluginStream::didReceiveData):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView createPlugin]):
        (-[WebNetscapePluginView initWithFrame:pluginPackage:URL:baseURL:MIMEType:attributeKeys:attributeValues:loadManually:element:WebCore::]):
        (-[WebNetscapePluginView evaluateJavaScriptPluginRequest:]):
        * Storage/WebDatabaseManagerClient.mm:
        (WebDatabaseManagerClient::dispatchDidModifyOrigin):
        (WebDatabaseManagerClient::dispatchDidModifyDatabase):
        * Storage/WebStorageTrackerClient.mm:
        (WebStorageTrackerClient::dispatchDidModifyOrigin):
        * WebCoreSupport/CorrectionPanel.mm:
        (CorrectionPanel::handleAcceptedReplacement):
        * WebCoreSupport/WebApplicationCache.mm:
        (+[WebApplicationCache originsWithCache]):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::didRunInsecureContent):
        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorClient::WebInspectorClient):
        (WebInspectorClient::openInspectorFrontend):
        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController enterFullScreen:]):
        * WebView/WebPDFDocumentExtras.mm:
        (allScriptsInPDFDocument):
        * WebView/WebPreferences.mm:
        (-[WebPreferences initWithIdentifier:]):
        (-[WebPreferences initWithCoder:]):
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::initGlobalCallFrame):
        (WebScriptDebugger::callEvent):
        * WebView/WebView.mm:
        (-[WebView previousValidKeyView]):
        Use adoptNS and adoptCF free functions.

2013-04-25  Roger Fong  <roger_fong@apple.com>

        Disable sub-pixel layout on mac.
        https://bugs.webkit.org/show_bug.cgi?id=114999.

        Reviewed by Simon Fraser.

        * Configurations/FeatureDefines.xcconfig:

2013-04-26  Simon Fraser  <simon.fraser@apple.com>

        Layer-backed WebViews don't repaint content outside the visible area
        https://bugs.webkit.org/show_bug.cgi?id=115275

        Reviewed by Beth Dakin.

        When a client of WebView makes the WebView be layer-backed, then
        AppKit propagaes the layer-backing down to the WebHTMLView (but
        no further).
        
        In this situation, we had a bug where content that was not
        in the visible content rect would not get repainted, because
        WebCore clips repaints to the visible rect.
        
        Fix by calling ScrollView::setPaintsEntireContents(bool) from
        -[WebHTMLView setLayer:], saying that we need
        to paint the entire contents if we have a layer.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView setLayer:]):

2013-04-25  Chris Fleizach  <cfleizach@apple.com>

        WEB SPEECH: language support does not work as expected
        https://bugs.webkit.org/show_bug.cgi?id=115119

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-04-25  Simon Fraser  <simon.fraser@apple.com>

        Build fix for smart compliers.

        Reviewed by Tim Horton.
        
        [NSDictionary dictionaryWithObjectsAndKeys:] returns an NSDictionary,
        not a NSMutableDictionary.

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::updateSpellingUIWithGrammarString):

2013-04-25  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: ConsoleMessage should include line and column number where possible
        https://bugs.webkit.org/show_bug.cgi?id=114929

        Reviewed by Timothy Hatcher.

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::addMessageToConsole):

2013-04-24  Jessie Berlin  <jberlin@apple.com>

        Assertion failure (crash in release) attempting to delete database storage in WK1 without
        creating a WebView first
        https://bugs.webkit.org/show_bug.cgi?id=115065

        Reviewed by Brady Eidson.

        Make sure the WebPlatformStrategies is initialized before using the WebDatabaseManager.

        * Storage/WebDatabaseManager.mm:
        (-[WebDatabaseManager init]):
        Move the logic from WebKitInitializeDatabasesIfNecessary here, and add a call to
        WebPlatformStrategies::initializeIfNecessary.

        * Storage/WebDatabaseManagerInternal.h: Removed.

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        Change "initialize" to "initalizeIfNecessary".
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::initializeIfNecessary):
        Only call setPlatformStrategies once.

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        Updated for the name change from initialize to initializeIfNecessary.
        Instead of calling WebKitInitializeDatabasesIfNecessary, call [WebDatabaseManager
        sharedWebDatabaseManager].
        (+[WebView _setLoadResourcesSerially:]):
        Updated for the name change from initialize to initializeIfNecessary.

2013-04-23  Antoine Quint  <graouts@apple.com>

        Initial advance of text runs should be taken into account
        https://bugs.webkit.org/show_bug.cgi?id=114949

        Reviewed by Darin Adler.

        Adding support for new method CTRunGetInitialAdvance in WebKitSystemInterface.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-04-22  Benjamin Poulain  <benjamin@webkit.org>

        Remove the memory instrumentation code
        https://bugs.webkit.org/show_bug.cgi?id=114931

        Reviewed by Andreas Kling.

        * WebView/WebRenderLayer.mm:

2013-04-18  Andy Estes  <aestes@apple.com>

        REGRESSION (r116645): Versions app's UI is munged in HiDPI due to background-size being reset to 'auto' when background short-hand is also specified
        https://bugs.webkit.org/show_bug.cgi?id=114833

        Reviewed by David Kilzer.

        The Versions app specifies both a background-size and a background
        shorthand CSS property, and its UI is broken after r116645 which resets
        background-size to 'auto' if the background shorthand property is
        specified.

        This patch enables the useLegacyBackgroundSizeShorthandBehavior setting
        added in r147034 to restore the expected behavior if the embedder is
        Versions.app and it was linked against a version of WebKit that had the
        legacy behavior.

        * Misc/WebKitVersionChecks.h:
        * WebView/WebView.mm:
        (shouldUseLegacyBackgroundSizeShorthandBehavior):
        (-[WebView _commonInitializationWithFrameName:groupName:]):

2013-04-18  Sam Weinig  <sam@webkit.org>

        Network Process crashing trying to read in IDNScriptWhiteList.txt
        https://bugs.webkit.org/show_bug.cgi?id=114827

        Reviewed by Anders Carlsson.

        Move IDNScriptWhiteList.txt from WebKit to WebCore, so that the NetworkProcess does not have to link against
        WebKit. It was a layering violation for WebCore to be trying to access WebKit resources anyway.

        * Resources/IDNScriptWhiteList.txt: Removed.

2013-04-17  Geoffrey Garen  <ggaren@apple.com>

        Renamed JSGlobalData to VM
        https://bugs.webkit.org/show_bug.cgi?id=114777

        Reviewed by Phil Pizlo.

        * Misc/WebCoreStatistics.mm:
        (+[WebCoreStatistics javaScriptObjectsCount]):
        (+[WebCoreStatistics javaScriptGlobalObjectsCount]):
        (+[WebCoreStatistics javaScriptProtectedObjectsCount]):
        (+[WebCoreStatistics javaScriptProtectedGlobalObjectsCount]):
        (+[WebCoreStatistics javaScriptProtectedObjectTypeCounts]):
        (+[WebCoreStatistics javaScriptObjectTypeCounts]):
        (+[WebCoreStatistics shouldPrintExceptions]):
        (+[WebCoreStatistics setShouldPrintExceptions:]):
        (+[WebCoreStatistics memoryStatistics]):
        (+[WebCoreStatistics javaScriptReferencedObjectsCount]):
        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (identifierFromIdentifierRep):
        * Plugins/Hosted/NetscapePluginInstanceProxy.h:
        (LocalObjectMap):
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::idForObject):
        (WebKit::NetscapePluginInstanceProxy::getWindowNPObject):
        (WebKit::NetscapePluginInstanceProxy::getPluginElementNPObject):
        (WebKit::NetscapePluginInstanceProxy::evaluate):
        (WebKit::NetscapePluginInstanceProxy::addValueToArray):
        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyRuntimeMethod::create):
        (WebKit::ProxyRuntimeMethod::createStructure):
        (WebKit::ProxyRuntimeMethod::finishCreation):
        (WebKit::ProxyInstance::getPropertyNames):
        * Plugins/Hosted/ProxyRuntimeObject.h:
        (WebKit::ProxyRuntimeObject::create):
        (WebKit::ProxyRuntimeObject::createStructure):
        * Plugins/WebNetscapePluginStream.mm:
        (WebNetscapePluginStream::wantsAllStreams):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView sendEvent:isDrawRect:]):
        (-[WebNetscapePluginView privateBrowsingModeDidChange]):
        (-[WebNetscapePluginView setWindowIfNecessary]):
        (-[WebNetscapePluginView createPluginScriptableObject]):
        (-[WebNetscapePluginView getFormValue:]):
        (-[WebNetscapePluginView evaluateJavaScriptPluginRequest:]):
        (-[WebNetscapePluginView webFrame:didFinishLoadWithReason:]):
        (-[WebNetscapePluginView loadPluginRequest:]):
        (-[WebNetscapePluginView _printedPluginBitmap]):
        * Plugins/WebPluginController.mm:
        (+[WebPluginController plugInViewWithArguments:fromPluginPackage:]):
        (-[WebPluginController stopOnePlugin:]):
        (-[WebPluginController destroyOnePlugin:]):
        (-[WebPluginController startAllPlugins]):
        (-[WebPluginController addPlugin:]):
        * WebKit.order:
        * WebView/WebScriptDebugDelegate.mm:
        (-[WebScriptCallFrame scopeChain]):
        (-[WebScriptCallFrame evaluateWebScript:]):
        * WebView/WebScriptDebugger.mm:
        (WebScriptDebugger::WebScriptDebugger):

2013-04-16  Beth Dakin  <bdakin@apple.com>

        Re-name Page::layoutMilestones() to Page::requestedLayoutMilestones()
        https://bugs.webkit.org/show_bug.cgi?id=114713

        Reviewed by Simon Fraser.

        * WebView/WebView.mm:
        (-[WebView _layoutMilestones]):

2013-04-15  Sam Weinig  <sam@webkit.org>

        Remove more #includes from Frame.h
        https://bugs.webkit.org/show_bug.cgi?id=114642

        Reviewed by Anders Carlsson.

        * WebView/WebFrame.mm:
        * WebView/WebHTMLRepresentation.mm:
        * WebView/WebView.mm:

2013-04-16  Alexey Proskuryakov  <ap@apple.com>

        Remove unused AlternativeTextClient::dismissDictationAlternativeUI
        https://bugs.webkit.org/show_bug.cgi?id=114598

        Reviewed by Ryosuke Niwa.

        * WebCoreSupport/WebAlternativeTextClient.h:
        * WebCoreSupport/WebAlternativeTextClient.mm:
        * WebView/WebView.mm:
        * WebView/WebViewInternal.h:

2013-04-15  Ryosuke Niwa  <rniwa@webkit.org>

        REGRESSION(r146025): WebKit applications can't apply underline or strike through
        https://bugs.webkit.org/show_bug.cgi?id=114662

        Reviewed by Enrica Casucci.

        Use -webkit- prefixes to apply underline. There should be no further compatibility issues
        since -khtml- was used only internally to pass the information down to WebCore.

        Unfortunately, we can't test this code like any other font panel bug.

        In the long run, we need to add some abstraction layer around font panel to make this testable
        or else we'll keep regressing this feature.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _styleFromFontAttributes:]):
        (-[WebHTMLView _styleForAttributeChange:]):

2013-04-15  Anders Carlsson  <andersca@apple.com>

        plugins/get-url-beforeunload-destroys-plugin.html crashes in WebKit1
        https://bugs.webkit.org/show_bug.cgi?id=114653
        <rdar://problem/13659541>

        Reviewed by Sam Weinig.

        Protect the NetscapePluginInstanceProxy since it can otherwise go away.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::performRequest):

2013-04-14  Sam Weinig  <sam@webkit.org>

        Move Mac specific snapshotting code into its own file
        https://bugs.webkit.org/show_bug.cgi?id=114597

        Reviewed by Andreas Kling.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _selectionDraggingImage]):
        (-[WebHTMLView selectionImageForcingBlackText:]):

2013-04-14  Andreas Kling  <akling@apple.com>

        Move CSSOM classes to using MutableStylePropertySet over StylePropertySet.
        <http://webkit.org/b/114581>

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::shouldApplyStyle):
        * WebView/WebFrame.mm:
        (-[WebFrame _typingStyle]):

2013-04-10  Sam Weinig  <sam@webkit.org>

        Make Frame's ScriptController an OwnPtr and remove the #include
        https://bugs.webkit.org/show_bug.cgi?id=114105

        Reviewed by Dean Jackson.

        * Plugins/Hosted/HostedNetscapePluginStream.mm:
        * Plugins/WebNetscapePluginStream.mm:
        * Plugins/WebPluginContainerCheck.mm:
        * WebCoreSupport/WebGeolocationClient.mm:
        * WebCoreSupport/WebInspectorClient.mm:
        * WebView/WebFrame.mm:

2013-04-13  Anders Carlsson  <andersca@apple.com>

        Add form delegate method that's invoked right before sending a submit event to a form element
        https://bugs.webkit.org/show_bug.cgi?id=114575

        Reviewed by Dan Bernstein.

        * MigrateHeaders.make:
        Copy DOMHTMLFormElementInternal.h over to WebKit.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (makeFormFieldValuesDictionary):
        New helper function that returns the values of a form in dictionary form.

        (WebFrameLoaderClient::dispatchWillSendSubmitEvent):
        Call the right delegate method.

        (WebFrameLoaderClient::dispatchWillSubmitForm):
        Use the helper function.

        * WebView/WebDelegateImplementationCaching.h:
        * WebView/WebDelegateImplementationCaching.mm:
        (CallFormDelegate):
        Add another overload.

        * WebView/WebFormDelegate.h:
        * WebView/WebFormDelegate.m:
        (-[WebFormDelegate willSendSubmitEventToForm:inFrame:withValues:]):
        Add a default implementation.

2013-04-10  Benjamin Poulain  <bpoulain@apple.com>

        Mass remove all the empty directories

        Rubberstamped by Ryosuke Niwa.

        * ForwardingHeaders/wtf/unicode/icu: Removed.

2013-04-08  Anders Carlsson  <andersca@apple.com>

        Remove unneeded headers from FrameLoader.h
        https://bugs.webkit.org/show_bug.cgi?id=114223

        Reviewed by Geoffrey Garen.

        Include HistoryController.h from WebCore.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        * WebView/WebView.mm:

2013-04-09  Geoffrey Garen  <ggaren@apple.com>

        Removed bitrotted TimeoutChecker code
        https://bugs.webkit.org/show_bug.cgi?id=114336

        Reviewed by Alexey Proskuryakov.

        This mechanism hasn't worked for a while.

        MarkL is working on a new version of this feature with a distinct
        implementation.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::evaluate):

2013-04-08  Benjamin Poulain  <benjamin@webkit.org>

        Remove HTML Notification
        https://bugs.webkit.org/show_bug.cgi?id=114231

        Reviewed by Ryosuke Niwa.

        * Configurations/FeatureDefines.xcconfig:

2013-04-05  Anders Carlsson  <andersca@apple.com>

        Stop building Objective-C bindings for the SVG DOM
        https://bugs.webkit.org/show_bug.cgi?id=114076

        Reviewed by Geoffrey Garen.

        The DOM SVG Objective-C bindings have never been exposed as API, and not building them cuts WebCore build by 10%.

        * Configurations/FeatureDefines.xcconfig:
        * MigrateHeaders.make:

2013-04-05  Timothy Hatcher  <timothy@apple.com>

        Allow the Web Inspector to use WebSQL.

        This fixes an exception on load in the Safari Web Inspector.

        https://webkit.org/b/114040
        rdar://problem/13581422

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebInspectorClient.mm:
        (-[WebInspectorWindowController webView:frame:exceededDatabaseQuotaForSecurityOrigin:database:]): Added.

2013-04-02  Timothy Hatcher  <timothy@apple.com>

        Provide a user default that can be used to disable docking of the Web Inspector.

        The user default is "WebKit Web Inspector Setting - inspectorAttachDisabled".

        https://webkit.org/b/113779
        rdar://problem/13446021

        Reviewed by Joseph Pecoraro.

        * WebCoreSupport/WebInspectorClient.h:
        (WebInspectorClient::inspectorAttachDisabled): Added.
        (WebInspectorClient::setInspectorAttachDisabled): Added.

        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorClient::didResizeMainFrame):
        (-[WebInspectorWindowController window]):
        (-[WebInspectorWindowController showWindow:]):
        Check inspectorAttachDisabled() in places where we attach or update the dock button.

2013-04-02  Alexey Proskuryakov  <ap@apple.com>

        [Mac] Remove WKCreateNSURLConnectionDelegateProxy
        https://bugs.webkit.org/show_bug.cgi?id=113810

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-04-02  Alexey Proskuryakov  <ap@apple.com>

        <rdar://problem/13551119> [WK2] Crashes in NetworkProcess when canceling loads
        https://bugs.webkit.org/show_bug.cgi?id=113803

        Reviewed by Darin Adler.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::convertMainResourceLoadToDownload):
        Just pass nil instead of proxy.

2013-04-01  Ryosuke Niwa  <rniwa@webkit.org>

        WebKit/mac shouldn't have code for Mac 10.5 and earlier
        https://bugs.webkit.org/show_bug.cgi?id=113746

        Reviewed by Darin Adler.

        Deleted the code for 10.5 and removed if-defs for 10.6.

        * Plugins/Hosted/WebHostedNetscapePluginView.mm:
        (-[WebHostedNetscapePluginView createPlugin]):
        * Plugins/WebBaseNetscapePluginView.mm:
        (-[WebBaseNetscapePluginView initWithFrame:pluginPackage:URL:baseURL:MIMEType:attributeKeys:attributeValues:loadManually:element:WebCore::]):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView createPlugin]):
        (-[WebNetscapePluginView getVariable:forURL:value:length:]):
        (-[WebNetscapePluginView _workaroundSilverlightFullscreenBug:]):
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::selectItemWritingDirectionIsNatural):
        (WebChromeClient::selectItemAlignmentFollowsMenuWritingDirection):
        * WebCoreSupport/WebEditorClient.mm:
        (core):
        (WebEditorClient::checkTextOfParagraph):
        (WebEditorClient::requestCheckingOfString):
        * WebView/WebDynamicScrollBarsView.mm:
        (-[WebDynamicScrollBarsView reflectScrolledClipView:]):
        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController _updateMenuAndDockForFullScreen]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _documentFragmentFromPasteboard:inContext:allowPlainText:]):
        (-[WebHTMLView _frameOrBoundsChanged]):
        (+[WebHTMLView _insertablePasteboardTypes]):
        (-[WebHTMLView _documentFragmentFromPasteboard:forType:inContext:subresources:]):
        (-[WebHTMLView validateUserInterfaceItemWithoutDelegate:]):
        (writingDirectionKeyBindingsEnabled):
        (-[WebHTMLView _lookUpInDictionaryFromMenu:]):
        (-[WebHTMLView attachRootLayer:]):
        * WebView/WebHTMLViewInternal.h:
        * WebView/WebPDFDocumentExtras.mm:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        * WebView/WebResourceInternal.h:
        * WebView/WebScriptDebugDelegate.h:
        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        (-[WebView _preferencesChanged:]):
        (+[WebView initialize]):
        (clientNeedsWebViewInitThreadWorkaround):
        (-[WebView validateUserInterfaceItemWithoutDelegate:]):
        (-[WebView setGrammarCheckingEnabled:]):
        (-[WebView isAutomaticQuoteSubstitutionEnabled]):
        (-[WebView isAutomaticLinkDetectionEnabled]):
        (-[WebView isAutomaticDashSubstitutionEnabled]):
        (-[WebView isAutomaticTextReplacementEnabled]):
        (-[WebView isAutomaticSpellingCorrectionEnabled]):
        (-[WebView _searchWithSpotlightFromMenu:]):
        (WebInstallMemoryPressureHandler):
        * WebView/WebViewPrivate.h:

2013-04-01  Tim Horton  <timothy_horton@apple.com>

        WebCache should do the normal initialization dance
        https://bugs.webkit.org/show_bug.cgi?id=113722
        <rdar://problem/13424530>

        Reviewed by Anders Carlsson.

        In case a WebKit1 client uses WebCache before creating a WebView (or any of the other
        initialization-ready classes), we should do the initialization work in WebCache as well.

        * Misc/WebCache.mm:
        (+[WebCache initialize]):

2013-03-26  Timothy Hatcher  <timothy@apple.com>

        Add support for dock-to-right of the Web Inspector in the Mac port.

        Unfortunately this requires Safari changes, so it is disabled in the nightly builds.

        https://webkit.org/b/113341
        rdar://problem/10368152

        Reviewed by Joseph Pecoraro.

        * Resources/Dock.pdf: Updated.
        * WebCoreSupport/WebInspectorClient.h:
        (WebInspectorFrontendClient):
        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::frontendLoaded):
        (WebInspectorFrontendClient::attachWindow):
        (WebInspectorFrontendClient::setAttachedWindowWidth):
        (-[WebInspectorWindowController attachWindow:]):
        (-[WebInspectorWindowController attach]):
        (-[WebInspectorWindowController detach]):
        * WebInspector/WebInspectorFrontend.mm:
        (-[WebInspectorFrontend attach]):

2013-03-26  Tim Horton  <timothy_horton@apple.com>

        Unreviewed attempted cr-mac build fix.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-03-26  Hayato Ito  <hayato@chromium.org>

        Allow ShadowContents in HitTests by default.
        https://bugs.webkit.org/show_bug.cgi?id=113171

        Reviewed by Dimitri Glazkov.

        * WebView/WebFrame.mm:
        (-[WebFrame elementAtPoint:]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView elementAtPoint:allowShadowContent:]):

2013-03-26  Tim Horton  <timothy_horton@apple.com>

        [ca] Tell CA to clean up unused resources if a given WebProcess won't be drawing
        https://bugs.webkit.org/show_bug.cgi?id=107539
        <rdar://problem/13032692>

        Reviewed by Simon Fraser.

        Update WebSystemInterface.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-03-26  Sergio Villar Senin  <svillar@igalia.com>

        Implement overtype mode for editable content
        https://bugs.webkit.org/show_bug.cgi?id=112126

        Reviewed by Ryosuke Niwa.

        Added the OverWrite editing command to the WebCore editing
        commands lists.

        * WebView/WebHTMLView.mm:
        * WebView/WebView.h:
        * WebView/WebView.mm:

2013-03-25  Kent Tamura  <tkent@chromium.org>

        Rename ENABLE_INPUT_TYPE_DATETIME
        https://bugs.webkit.org/show_bug.cgi?id=113254

        Reviewed by Kentaro Hara.

        Rename ENABLE_INPUT_TYPE_DATETIME to ENABLE_INPUT_TYPE_DATETIME_INCOMPLETE.
        Actually I'd like to remove the code, but we shouldn't remove it yet
        because we shipped products with it on some platforms.

        * Configurations/FeatureDefines.xcconfig:

2013-03-21  Kiran Muppala  <cmuppala@apple.com>

        Add runtime setting for hidden page DOM timer throttling and CSS animation suspension
        https://bugs.webkit.org/show_bug.cgi?id=112308

        Reviewed by Gavin Barraclough.

        Add private preference for enabling/disabling hidden page DOM timer
        throttling and CSS animation suspension.  The preference should be
        disabled by default to avoid compatibility issues.

        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences hiddenPageDOMTimerThrottlingEnabled]):
        (-[WebPreferences setHiddenPageDOMTimerThrottlingEnabled:]):
        (-[WebPreferences hiddenPageCSSAnimationSuspensionEnabled]):
        (-[WebPreferences setHiddenPageCSSAnimationSuspensionEnabled:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-03-19  Ryosuke Niwa  <rniwa@webkit.org>

        Another Mac build fix attempt after r146239.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        (WebFrameNetworkingContext):

2013-03-19  Ryosuke Niwa  <rniwa@webkit.org>

        Mac build fix attempt after r146239.

        * WebCoreSupport/WebFrameNetworkingContext.h:

2013-03-19  Sergey Ryazanov  <serya@chromium.org>

        Web Inspector: split Console into two entities, a web-facing bound object and page console.
        https://bugs.webkit.org/show_bug.cgi?id=111578

        Reviewed by Vsevolod Vlasov.

        Otherwise, a lot of logging in WebCore needs to go through the DOMWindow which is unnecessary.

        * Misc/WebCoreStatistics.mm:
        (+[WebCoreStatistics shouldPrintExceptions]):
        (+[WebCoreStatistics setShouldPrintExceptions:]):

2013-03-17  Adam Barth  <abarth@webkit.org>

        Legacy CSS vendor prefixes should only work for Dashboard
        https://bugs.webkit.org/show_bug.cgi?id=111890

        Reviewed by Eric Seidel.

        Enable legacy CSS vendor prefixes when we've been asked to turn on
        Dashboard compatibility mode.

        * WebView/WebView.mm:
        (-[WebView _setDashboardBehavior:to:]):

2013-03-16  Pratik Solanki  <psolanki@apple.com>

        Disable High DPI Canvas on iOS
        https://bugs.webkit.org/show_bug.cgi?id=112511

        Reviewed by Joseph Pecoraro.

        * Configurations/FeatureDefines.xcconfig:

2013-03-15  Timothy Hatcher  <timothy@apple.com>

        Disable suppressesIncrementalRendering for the Web Inspector.

        This ends up causing the Inspector to show blank for a couple seconds before
        it does its first paint. During that time the bare window chrome is showing
        when the Inspector's background and other simple elements count be painting.
        This causes the Inspector to look like it is loading slower than reality.

        https://bugs.webkit.org/show_bug.cgi?id=112300
        rdar://problem/13412219
 
        Reviewed by Geoff Garen.

        * WebCoreSupport/WebInspectorClient.mm:
        (-[WebInspectorWindowController init]): Disable suppressesIncrementalRendering.

2013-03-15  Nate Chapin  <japhet@chromium.org>

        Hide MainResourceLoader from the outside world
        https://bugs.webkit.org/show_bug.cgi?id=109971

        Reviewed by Adam Barth.

        * WebCoreSupport/WebFrameLoaderClient.h:
        (WebFrameLoaderClient):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::convertMainResourceLoadToDownload):

2013-03-15  Abhishek Arya  <inferno@chromium.org>

        Replace static_casts with to* helper functions.
        https://bugs.webkit.org/show_bug.cgi?id=112401

        Reviewed by Stephen Chenney.

        to* helper functions are preferred over static_cast calls since they
        help to catch bad casts easily on the testing infrastructure.

        * WebView/WebRenderNode.mm:
        (copyRenderNode):
        * WebView/WebView.mm:
        (-[WebView _addScrollerDashboardRegionsForFrameView:dashboardRegions:]):

2013-03-14  Manuel Rego Casasnovas  <rego@igalia.com>

        Add selectTrailingWhitespaceEnabled setting to WebCore::Page
        https://bugs.webkit.org/show_bug.cgi?id=109404

        Reviewed by Tony Chang.

        Use new settings for smartInsertDeleteEnabled and
        selectTrailingWhitespaceEnabled.

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::smartInsertDeleteEnabled):
        (WebEditorClient::isSelectTrailingWhitespaceEnabled):
        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]): Initialize
        settings from NSUserDefaults.
        (-[WebView setSelectTrailingWhitespaceEnabled:]):
        (-[WebView isSelectTrailingWhitespaceEnabled]):
        (-[WebView setSmartInsertDeleteEnabled:]):
        (-[WebView smartInsertDeleteEnabled]):
        * WebView/WebViewData.h:
        * WebView/WebViewData.mm:
        (-[WebViewPrivate init]):

2013-03-14  Abhishek Arya  <inferno@chromium.org>

        Replace static_casts with to* helper functions.
        https://bugs.webkit.org/show_bug.cgi?id=112296

        Reviewed by Kentaro Hara.

        to* helper functions are preferred over static_cast calls since they
        help to catch bad casts easily on the testing infrastructure.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (applyAppleDictionaryApplicationQuirkNonInlinePart):
        * WebView/WebHTMLRepresentation.mm:
        (searchForLabelsBeforeElement):

2013-03-14  Alice Liu  <alice.liu@apple.com>

        Add to HistoryItem a way to know if its underlying CachedPage has expired.
        https://bugs.webkit.org/show_bug.cgi?id=110652

        Reviewed by Brady Eidson.

        * History/WebHistoryItem.mm:
        (-[WebHistoryItem _isInPageCache]): Added. Just calls and returns core imple's function. 
        (-[WebHistoryItem _hasCachedPageExpired]): Same thing. 
        * History/WebHistoryItemPrivate.h:
        * WebView/WebPreferences.mm:
        (-[WebPreferences _backForwardCacheExpirationInterval]): Address fixme, now that WebCore::Settings
        has getters and setters with default value.
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): call setBackForwardCacheExpirationInterval similar to other settings.

2013-03-13  Rik Cabanier  <cabanier@adobe.com>

        create runtime flags for CSS Compositing
        https://bugs.webkit.org/show_bug.cgi?id=111818

        Reviewed by Ryosuke Niwa.

        Added a preference to enable CSS compositing.

        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):
        (-[WebPreferences cssCompositingEnabled]):
        (-[WebPreferences setCSSCompositingEnabled:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2013-03-13  Ryosuke Niwa  <rniwa@webkit.org>

        Threaded HTML Parser is missing feature define flags in all but Chromium port's build files
        https://bugs.webkit.org/show_bug.cgi?id=112277

        Reviewed by Adam Barth.

        * Configurations/FeatureDefines.xcconfig:

2013-03-13  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: get rid of hiddenPanels filter
        https://bugs.webkit.org/show_bug.cgi?id=112252

        Reviewed by Vsevolod Vlasov.

        * WebCoreSupport/WebInspectorClient.h:
        (WebInspectorFrontendClient):
        * WebCoreSupport/WebInspectorClient.mm:
        * WebKit.order:

2013-03-12  Geoffrey Garen  <ggaren@apple.com>

        Moved RunLoopTimer and SchedulePair to WTF
        https://bugs.webkit.org/show_bug.cgi?id=112171

        Reviewed by Oliver Hunt.

        This will allow us to use timers in lower level primitives without
        duplicating all the code.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        (WebFrameNetworkingContext):

2013-03-12  Abhishek Arya  <inferno@chromium.org>

        Replace static_casts with to* functions.
        https://bugs.webkit.org/show_bug.cgi?id=112072

        Reviewed by Philip Rogers.

        to* functions are preferred over static_cast calls since they
        help to catch bad casts easily on the testing infrastructure.

        * WebView/WebView.mm:
        (-[WebView _enterFullscreenForNode:WebCore::]):

2013-03-11  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r145462.
        http://trac.webkit.org/changeset/145462
        https://bugs.webkit.org/show_bug.cgi?id=112097

        Compilation failure in PluginView.cpp (Requested by jamesr_ on
        #webkit).

        * WebView/WebView.mm:
        (-[WebView _enterFullscreenForNode:WebCore::]):

2013-03-11  Abhishek Arya  <inferno@chromium.org>

        Replace static_casts with to* functions.
        https://bugs.webkit.org/show_bug.cgi?id=112072

        Reviewed by Philip Rogers.

        to* functions are preferred over static_cast calls since they
        help to catch bad casts easily on the testing infrastructure.

        * WebView/WebView.mm:
        (-[WebView _enterFullscreenForNode:WebCore::]):

2013-03-11  Jochen Eisinger  <jochen@chromium.org>

        Rename DefinitelyProcessingUserGesture to DefinitelyProcessingNewUserGesture
        https://bugs.webkit.org/show_bug.cgi?id=111959

        Reviewed by Alexey Proskuryakov.

        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::evaluate):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView sendEvent:isDrawRect:]):

2013-03-11  Abhishek Arya  <inferno@chromium.org>

        Replace static_cast with to* helper functions.
        https://bugs.webkit.org/show_bug.cgi?id=112045

        Reviewed by Eric Seidel.

        * WebView/WebRenderLayer.mm:
        (+[WebRenderLayer nameForLayer:]):

2013-03-11  Jer Noble  <jer.noble@apple.com>

        Unreviewed build fix.  Remove stray brace which crept into r145409.

        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController performClose:]):

2013-01-30  Jer Noble  <jer.noble@apple.com>

        Mac: Cmd-w should close full screen window.
        https://bugs.webkit.org/show_bug.cgi?id=108406

        Reviewed by Darin Adler.

        Allow the user to close the full screen window with Cmd-w by making the full screen window
        closable, and by intercepting performClose:.

        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController init]): Create a closable full screen window.
        (-[WebFullScreenController performClose:]): When we receive a close request in full screen mode,
            animate out of full screen.

2013-03-07  Anders Carlsson  <andersca@apple.com>

        Add didFocusTextField:inFrame to WebFormDelegate
        https://bugs.webkit.org/show_bug.cgi?id=111804

        Reviewed by Dan Bernstein.

        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::focusedNodeChanged):
        * WebView/WebFormDelegate.h:
        * WebView/WebFormDelegate.m:
        (-[WebFormDelegate didFocusTextField:inFrame:]):

2013-03-04  Jer Noble  <jer.noble@apple.com>

        Default mouse cursor behavior should be auto-hide for full screen video with custom controls
        https://bugs.webkit.org/show_bug.cgi?id=107601

        Reviewed by Beth Dakin.

        Enable the CURSOR_VISIBILITY feature.

        * Configurations/FeatureDefines.xcconfig:

2013-03-05  Geoffrey Garen  <ggaren@apple.com>

        Removed some dead code in the page cache
        https://bugs.webkit.org/show_bug.cgi?id=111525

        Reviewed by Alexey Proskuryakov.

        Page cache autorelease doesn't exist anymore, so there's no need to keep
        around these olds hacks.

        This fixes <rdar://problem/4886761> Fix bizarre WebWindowWatcher policy in WebHistoryItem.

        * History/WebHistoryItem.mm:
        (+[WebHistoryItem _releaseAllPendingPageCaches]):
        * History/WebHistoryItemInternal.h:
        * Misc/WebCoreStatistics.mm:
        (+[WebCoreStatistics autoreleasedPageCount]):
        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):

2013-03-06  Dmitry Zvorygin  <zvorygin@chromium.org>

        Introduce new message sources for logging.
        https://bugs.webkit.org/show_bug.cgi?id=110968

        Reviewed by Pavel Feldman.

        * WebCoreSupport/WebChromeClient.mm:
        * WebView/WebUIDelegatePrivate.h:

2013-03-05  Kent Tamura  <tkent@chromium.org>

        Rename WebCore/editing/visible_units.* to VisibleUnits.*
        https://bugs.webkit.org/show_bug.cgi?id=111426

        Reviewed by Alexey Proskuryakov.

        * WebView/WebFrame.mm:

2013-03-05  James Robinson  <jamesr@chromium.org>

        ContainerNode::setActive should not sleep for 100ms on platforms that do not implement synchronous repaint(true) semantics
        https://bugs.webkit.org/show_bug.cgi?id=87054

        Reviewed by Darin Adler.

        The Mac WebKit1 port supports immediate invalidations.

        * WebCoreSupport/WebChromeClient.h:
        (WebChromeClient):
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::supportsImmediateInvalidation):

2013-03-05  David Kilzer  <ddkilzer@apple.com>

        BUILD FIX (r144698): Only enable SPEECH_SYNTHESIS for Mac
        <http://webkit.org/b/106742>

        Fixes the following build failures:

            Undefined symbols for architecture i386:
              "__ZTVN7WebCore25PlatformSpeechSynthesizerE", referenced from:
                  __ZN7WebCore25PlatformSpeechSynthesizerC2EPNS_31PlatformSpeechSynthesizerClientE in PlatformSpeechSynthesizer.o
              NOTE: a missing vtable usually means the first non-inline virtual member function has no definition.
              "__ZN7WebCore25PlatformSpeechSynthesizer19initializeVoiceListEv", referenced from:
                  __ZN7WebCore25PlatformSpeechSynthesizerC2EPNS_31PlatformSpeechSynthesizerClientE in PlatformSpeechSynthesizer.o
            ld: symbol(s) not found for architecture i386

        * Configurations/FeatureDefines.xcconfig:
        - Only set ENABLE_SPEECH_SYNTHESIS for the macosx platform.

2013-03-04  David Kilzer  <ddkilzer@apple.com>

        BUILD FIX (r144662): Import JSBase.h in WebFrameLoadDelegate.h
        <http://webkit.org/b/111269>

        Fixes the following build failure:

            In file included from Source/WebKit/ios/DefaultDelegates/WebDefaultFrameLoadDelegate.m:11:
            In file included from Source/WebKit/mac/WebView/WebFrameLoadDelegatePrivate.h:29:
            Source/WebKit/mac/WebView/WebFrameLoadDelegate.h:41:5: error: 'JSC_OBJC_API_ENABLED' is not defined, evaluates to 0 [-Werror,-Wundef]
            #if JSC_OBJC_API_ENABLED
                ^
            Source/WebKit/mac/WebView/WebFrameLoadDelegate.h:207:5: error: 'JSC_OBJC_API_ENABLED' is not defined, evaluates to 0 [-Werror,-Wundef]
            #if JSC_OBJC_API_ENABLED
                ^
            2 errors generated.

        * WebView/WebFrameLoadDelegate.h: Include JSBase.h.

2013-03-04  Chris Fleizach  <cfleizach@apple.com>

        Support WebSpeech - Speech Synthesis
        https://bugs.webkit.org/show_bug.cgi?id=106742

        Reviewed by Simon Fraser.

        Enable speech synthesis for the Mac.

        * Configurations/FeatureDefines.xcconfig:

2013-03-04  Mark Hahnenberg  <mhahnenberg@apple.com>

        Remove contextInternalContext from JSContextInternal.h
        https://bugs.webkit.org/show_bug.cgi?id=111356

        Reviewed by Geoffrey Garen.

        We don't need it any more since we have globalContextRef in JSContext.

        * WebView/WebScriptWorld.mm:
        (+[WebScriptWorld scriptWorldForJavaScriptContext:]):

2013-03-04  Laszlo Gombos  <l.gombos@samsung.com>

        JSC_OBJC_API_ENABLED should be removed from FeatureDefines.h
        https://bugs.webkit.org/show_bug.cgi?id=111269

        Reviewed by Mark Hahnenberg.

        Include JavaScriptCore/JSBase.h for the definition of JSC_OBJC_API_ENABLED.

        * WebView/WebDelegateImplementationCaching.h:

2013-03-04  Kunihiko Sakamoto  <ksakamoto@chromium.org>

        Add build flag for FontLoader
        https://bugs.webkit.org/show_bug.cgi?id=111289

        Reviewed by Benjamin Poulain.

        Add ENABLE_FONT_LOAD_EVENTS build flag (disabled by default).

        * Configurations/FeatureDefines.xcconfig:

2013-03-03  Benjamin Poulain  <benjamin@webkit.org>

        [Mac] Get rid of a useless method from DOMHTMLInputElement
        https://bugs.webkit.org/show_bug.cgi?id=111279

        Reviewed by Sam Weinig.

        * DOM/WebDOMOperations.mm:
        * DOM/WebDOMOperationsPrivate.h:
        setValueForUser: is already privately exposed by DOMHTMLInputElement,
        no need to have it twice.

2013-03-03  Adam Barth  <abarth@webkit.org>

        Unreviewed attempted build fix. Adds back some includes removed in
        http://trac.webkit.org/changeset/144565.

        * DOM/WebDOMOperations.mm:
        * Misc/WebNSPasteboardExtras.mm:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        * WebView/WebRenderLayer.mm:
        * WebView/WebRenderNode.mm:

2013-03-03  Adam Barth  <abarth@webkit.org>

        Unreviewed rollout of http://trac.webkit.org/r144530
        As described in https://bugs.webkit.org/show_bug.cgi?id=111167 and
        https://bugs.webkit.org/show_bug.cgi?id=111035, this patch caused a
        large number of ASSERTs in chromium-win.

        * DOM/WebDOMOperations.mm:
        * Misc/WebNSPasteboardExtras.mm:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        * WebView/WebRenderLayer.mm:
        * WebView/WebRenderNode.mm:

2013-02-18  Darin Adler  <darin@apple.com>

        Cut down the number of source files that depend on Clipboard.h
        https://bugs.webkit.org/show_bug.cgi?id=110030

        Reviewed by Ryosuke Niwa.

        * WebView/WebPDFView.mm: Add include of Clipboard.h since we use it
        here and the world no longer includes it everywhere.

2013-03-02  Benjamin Poulain  <bpoulain@apple.com>

        Move computedStyleIncludingVisitedInfo from TestRunner to Internals
        https://bugs.webkit.org/show_bug.cgi?id=109772

        Reviewed by Andreas Kling.

        * WebView/WebView.mm:
        * WebView/WebViewPrivate.h:

2013-03-02  David Kilzer  <ddkilzer@apple.com>

        BUILD FIX (r143637): Predeclare JSContext as an Objective-C class
        <http://webkit.org/b/106059>

        Fixes the following build failure:

            In file included from Source/WebKit/ios/DefaultDelegates/WebDefaultFrameLoadDelegate.m:11:
            In file included from Source/WebKit/mac/WebView/WebFrameLoadDelegatePrivate.h:29:
            Source/WebKit/mac/WebView/WebFrameLoadDelegate.h:215:64: error: expected a type
            - (void)webView:(WebView *)webView didCreateJavaScriptContext:(JSContext *)context forFrame:(WebFrame *)frame;
                                                                           ^
            1 error generated.

        * WebView/WebFrameLoadDelegate.h: Add @class JSContext
        declaration.

2013-02-28  Alexey Proskuryakov  <ap@apple.com>

        Reduce amount of rebuilding when touching networking headers
        https://bugs.webkit.org/show_bug.cgi?id=111035

        Reviewed by Eric Seidel.

        Adding includes that are now necessary because WebCore headers don't have them
        any more.

        * DOM/WebDOMOperations.mm:
        * Misc/WebNSPasteboardExtras.mm:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        * WebView/WebRenderLayer.mm:
        * WebView/WebRenderNode.mm:

2013-03-01  Jason Anderssen  <janderssen@gmail.com>

        Move markerTextForListItem from TestRunner to Internals
        https://bugs.webkit.org/show_bug.cgi?id=110939

        Reviewed by Benjamin Poulain.

        * DOM/WebDOMOperations.mm:
        * DOM/WebDOMOperationsPrivate.h:

2013-02-28  Sam Weinig  <sam@webkit.org>

        Add SPI for marking a WebView as doing things on behalf of another process
        https://bugs.webkit.org/show_bug.cgi?id=111125

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        (WebFrameNetworkingContext):
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        (WebFrameNetworkingContext::sourceApplicationAuditData):
        * WebView/WebView.mm:
        (-[WebView _setSourceApplicationAuditData:]):
        (-[WebView _sourceApplicationAuditData]):
        * WebView/WebViewData.h:
        * WebView/WebViewData.mm:
        (-[WebViewPrivate dealloc]):
        * WebView/WebViewPrivate.h:
        Add SPI for setting a source application for a WebView.

2013-03-01  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r144422 and r144424.
        http://trac.webkit.org/changeset/144422
        http://trac.webkit.org/changeset/144424
        https://bugs.webkit.org/show_bug.cgi?id=111167

        Caused over 20 tests to fail assertion on Chromium Win port as
        ASSERTION FAILED: m_platformRequestUpdated (Requested by
        toyoshim on #webkit).

        * DOM/WebDOMOperations.mm:
        * Misc/WebNSPasteboardExtras.mm:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        * WebView/WebRenderLayer.mm:
        * WebView/WebRenderNode.mm:

2013-02-28  Alexey Proskuryakov  <ap@apple.com>

        Reduce amount of rebuilding when touching networking headers
        https://bugs.webkit.org/show_bug.cgi?id=111035

        Reviewed by Eric Seidel.

        Adding includes that are now necessary because WebCore headers don't have them
        any more.

        * DOM/WebDOMOperations.mm:
        * Misc/WebNSPasteboardExtras.mm:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        * WebView/WebRenderLayer.mm:
        * WebView/WebRenderNode.mm:

2013-02-27  John Bauman  <jbauman@chromium.org>

        Plugin in iframe may not display
        https://bugs.webkit.org/show_bug.cgi?id=109879

        Reviewed by Simon Fraser.

        Ensure NetscapePluginWidget informs the plugin view of the cliprect change directly.

        * Plugins/WebBaseNetscapePluginView.h:
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (NetscapePluginWidget::clipRectChanged):

2013-02-26  Alexey Proskuryakov  <ap@apple.com>

        Don't add a body to platform request until necessary
        https://bugs.webkit.org/show_bug.cgi?id=110900

        Reviewed by Brady Eidson.

        WebKit1 behavior is unchanged, body is added on every conversion.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::convertMainResourceLoadToDownload):
        (WebFrameLoaderClient::dispatchDidLoadResourceFromMemoryCache):
        (WebFrameLoaderClient::assignIdentifierToInitialRequest):
        (WebFrameLoaderClient::dispatchWillSendRequest):
        (WebFrameLoaderClient::dispatchDecidePolicyForResponse):
        (WebFrameLoaderClient::dispatchDecidePolicyForNewWindowAction):
        (WebFrameLoaderClient::dispatchDecidePolicyForNavigationAction):
        (WebFrameLoaderClient::updateGlobalHistory):
        (WebFrameLoaderClient::canHandleRequest):
        * WebView/WebDataSource.mm:
        (-[WebDataSource initialRequest]):
        (-[WebDataSource request]):
        * WebView/WebFrame.mm:
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):

2013-02-27  Glenn Adams  <glenn@skynav.com>

        Add ENABLE_CSS3_TEXT_LINE_BREAK flag.
        https://bugs.webkit.org/show_bug.cgi?id=110944

        Reviewed by Dean Jackson.

        * Configurations/FeatureDefines.xcconfig:

2013-02-26  Jer Noble  <jer.noble@apple.com>

        Unreviewed build fix; use correct macro for platform name in FeatureDefines.xcconfig.

        * Configurations/FeatureDefines.xcconfig:

2013-02-26  Dmitry Zvorygin  <zvorygin@chromium.org>

        Merged Tip and Debug log levels for web console.
        https://bugs.webkit.org/show_bug.cgi?id=109919

        Reviewed by Pavel Feldman.

        In every component either TIP or DEBUG level was used for reporting,
        but not both. This patch is prerequisite for Web Inspector console log filtering.

        * WebCoreSupport/WebChromeClient.mm:
        (stringForMessageLevel):
        * WebView/WebUIDelegatePrivate.h:


2013-02-21  Jeffrey Pfau  <jpfau@apple.com>

        Optionally partition cache to prevent using cache for tracking
        https://bugs.webkit.org/show_bug.cgi?id=110269

        Reviewed by Maciej Stachowiak.

        Update WKSI bindings and add feature defines.

        * Configurations/FeatureDefines.xcconfig: Add defines for cache partitioning and public suffix list usage
        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-02-25  Jer Noble  <jer.noble@apple.com>

        Normalize ENABLE_ENCRYPTED_MEDIA definitions across all FeatureDefines files.
        https://bugs.webkit.org/show_bug.cgi?id=110806

        Reviewed by Alexey Proskuryakov.
    
        Ensure both ENCRYPTED_MEDIA and ENCRYPTED_MEDIA_V2 are enabled on macosx_1090.

        * Configurations/FeatureDefines.xcconfig:

2013-02-25  Andreas Kling  <akling@apple.com>

        Reduce amount of code that includes StylePropertySet.h
        <http://webkit.org/b/101149>

        Reviewed by Antti Koivisto.

        * WebCoreSupport/WebEditorClient.mm:
        * WebView/WebFrame.mm:
        * WebView/WebView.mm:

2013-02-24  Andreas Kling  <akling@apple.com>

        Reduce include graph of JSDOMBinding.h
        <http://webkit.org/b/110709>

        Reviewed by Antti Koivisto.

        * WebView/WebHTMLView.mm:

2013-02-21  Grzegorz Czajkowski  <g.czajkowski@samsung.com>

        Allow to retrieve the request data from abstract TextCheckingRequest to be accessible for WK2
        https://bugs.webkit.org/show_bug.cgi?id=110208

        Reviewed by Hajime Morrita.

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::didCheckSucceed):
        (WebEditorClient::requestCheckingOfString):
        Extract the request data as it is the member of 'TextCheckingRequest'.

2013-02-19  Mark Hahnenberg  <mhahnenberg@apple.com>

        Objective-C API: Need a way to use the Objective-C JavaScript API with WebKit
        https://bugs.webkit.org/show_bug.cgi?id=106059

        Reviewed by Geoffrey Garen.

        Addition of appropriate delegate callbacks and support to the WebKit API.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        * WebView/WebDelegateImplementationCaching.h:
        (WebFrameLoadDelegateImplementationCache):
        * WebView/WebFrame.h:
        * WebView/WebFrame.mm:
        (-[WebFrame _stringByEvaluatingJavaScriptFromString:forceUserGesture:]):
        (-[WebFrame _stringByEvaluatingJavaScriptFromString:withGlobalObject:inScriptWorld:]):
        (-[WebFrame _javaScriptContextForScriptWorld:]):
        (-[WebFrame javaScriptContext]):
        * WebView/WebFrameLoadDelegate.h:
        * WebView/WebFramePrivate.h:
        * WebView/WebScriptDebugDelegate.mm:
        (-[WebScriptCallFrame _convertValueToObjcValue:JSC::]):
        (-[WebScriptCallFrame exception]):
        (-[WebScriptCallFrame evaluateWebScript:]):
        * WebView/WebScriptWorld.h:
        * WebView/WebScriptWorld.mm:
        (+[WebScriptWorld scriptWorldForJavaScriptContext:]):
        * WebView/WebView.mm:
        (-[WebView _cacheFrameLoadDelegateImplementations]):
        (aeDescFromJSValue):
        (-[WebView aeDescByEvaluatingJavaScriptFromString:]):
        (-[WebView _computedStyleIncludingVisitedInfo:forElement:]):

2013-02-20  Dirk Schulze  <krit@webkit.org>

        Enable CANVAS_PATH flag
        https://bugs.webkit.org/show_bug.cgi?id=108508

        Reviewed by Simon Fraser.

        Enable CANVAS_PATH flag on trunk.

        * Configurations/FeatureDefines.xcconfig:

2013-02-19  Tim Horton  <timothy_horton@apple.com>

        Clarify isInWindow vs. isVisible path through to RenderLayerCompositor
        https://bugs.webkit.org/show_bug.cgi?id=110261
        <rdar://problem/13196122>

        Reviewed by Simon Fraser.

        * WebView/WebView.mm:
        (-[WebView viewWillMoveToWindow:]):
        (-[WebView viewDidMoveToWindow]):
        Use Page::setIsInWindow in addition to willMoveOffscreen/didMoveOnscreen.

2013-02-18  Anders Carlsson  <andersca@apple.com>

        Add a DefaultHash for RefPtr<SecurityOrigin>
        https://bugs.webkit.org/show_bug.cgi?id=110170

        Reviewed by Andreas Kling.

        Remove all explicit uses of SecurityOriginHash.

        * WebCoreSupport/WebApplicationCache.mm:
        (+[WebApplicationCache originsWithCache]):

2013-02-15  Eric Carlson  <eric.carlson@apple.com>

        [Mac] remove wkCaptionAppearance from WebKitSystemInterface
        https://bugs.webkit.org/show_bug.cgi?id=109996

        Reviewed by Simon Fraser.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-02-15  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r143088.
        http://trac.webkit.org/changeset/143088
        https://bugs.webkit.org/show_bug.cgi?id=110000

        Breaks the build (Requested by dgorbik on #webkit).

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-02-15  Eric Carlson  <eric.carlson@apple.com>

        [Mac] remove wkCaptionAppearance from WebKitSystemInterface
        https://bugs.webkit.org/show_bug.cgi?id=109996

        Reviewed by Simon Fraser.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-02-15  Allan Sandfeld Jensen  <allan.jensen@digia.com>

        Simplify hitTestResultAtPoint and nodesFromRect APIs
        https://bugs.webkit.org/show_bug.cgi?id=95720

        Reviewed by Julien Chaffraix.

        Update calls to new API.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::actionDictionary):
        * WebView/WebFrame.mm:
        (-[WebFrame elementAtPoint:]):
        * WebView/WebHTMLView.mm:
        (-[WebHTMLView elementAtPoint:allowShadowContent:]):

2013-02-14  David Kilzer  <ddkilzer@apple.com>

        [Mac] Clean up WARNING_CFLAGS
        <http://webkit.org/b/109747>
        <rdar://problem/13208373>

        Reviewed by Mark Rowe.

        * Configurations/Base.xcconfig: Use
        GCC_WARN_64_TO_32_BIT_CONVERSION to enable and disable
        -Wshorten-64-to-32 rather than WARNING_CFLAGS.

2013-02-13  Zan Dobersek  <zdobersek@igalia.com>

        The 'global isinf/isnan' compiler quirk required when using clang with libstdc++
        https://bugs.webkit.org/show_bug.cgi?id=109325

        Reviewed by Anders Carlsson.

        Prefix calls to the isinf and isnan methods with std::, declaring we want to use the
        two methods as they're provided by the C++ standard library being used.

        * tests/DecimalTest.cpp:
        (TEST_F):

2013-02-12  Joseph Pecoraro  <pecoraro@apple.com>

        [iOS] Enable PAGE_VISIBILITY_API
        https://bugs.webkit.org/show_bug.cgi?id=109399

        Reviewed by David Kilzer.

        * Configurations/FeatureDefines.xcconfig:

2013-02-12  David Kilzer  <ddkilzer@apple.com>

        BUILD FIX (r142576): WK1 build fails when ENABLE(DELETION_UI) is off
        <https://bugs.webkit.org/show_bug.cgi?id=109534>

        Fixes the following build failure:

            WebEditorClient.mm:243:23: error: out-of-line definition of 'shouldShowDeleteInterface' does not match any declaration in 'WebEditorClient'
            bool WebEditorClient::shouldShowDeleteInterface(HTMLElement* element)
                                  ^~~~~~~~~~~~~~~~~~~~~~~~~

        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::shouldShowDeleteInterface): Protect with
        ENABLE(DELETION_UI) macro.

2013-02-11  Ryosuke Niwa  <rniwa@webkit.org>

        Disable delete button controller on non-Mac ports and delete EditorClient::shouldShowDeleteInterface
        https://bugs.webkit.org/show_bug.cgi?id=109534

        Reviewed by Anders Carlsson.

        * WebCoreSupport/WebEditorClient.h:

2013-02-11  Benjamin Poulain  <benjamin@webkit.org>

        Kill TestRunner::setMinimumTimerInterval; implement the feature with InternalSettings
        https://bugs.webkit.org/show_bug.cgi?id=109349

        Reviewed by Sam Weinig.

        * WebView/WebView.mm:
        * WebView/WebViewPrivate.h:

2013-02-10  Dan Bernstein  <mitz@apple.com>

        Added *.pdf to EXCLUDED_SOURCE_FILE_NAMES_iphoneos.

        Rubber-stamped by Anders Carlsson.

        * Configurations/WebKit.xcconfig:

2013-02-10  Jae Hyun Park  <jae.park08@gmail.com>

        Rename ENABLE(GLIB_SUPPORT) to USE(GLIB)
        https://bugs.webkit.org/show_bug.cgi?id=104266

        Reviewed by Philippe Normand.

        Using USE(GLIB) instead of ENABLE(GLIB_SUPPORT) is more consistent with
        the existing macro naming conventions.

        From Platform.h
        USE() - use a particular third-party library or optional OS service
        ENABLE() - turn on a specific feature of WebKit

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        (-[WebView _close]):
        * WebView/WebViewData.h:
        * WebView/WebViewInternal.h:

2013-02-08  Benjamin Poulain  <bpoulain@apple.com>

        Move workerThreadCount from TestRunner to WebCore Internals
        https://bugs.webkit.org/show_bug.cgi?id=109239

        Reviewed by Darin Adler.

        Get rid of WebWorkersPrivate, which was only needed for DRT.

        * WebKit.exp:
        * Workers/WebWorkersPrivate.h: Removed.
        * Workers/WebWorkersPrivate.mm: Removed.

2013-02-07  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r142212.
        http://trac.webkit.org/changeset/142212
        https://bugs.webkit.org/show_bug.cgi?id=109255

        Causes ASSERT(!m_installed) on launch (Requested by smfr on
        #webkit).

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        (WebInstallMemoryPressureHandler):

2013-02-06  Gavin Barraclough  <barraclough@apple.com>

        PluginProcess should quit immediately if idle in response to low-memory notifications
        https://bugs.webkit.org/show_bug.cgi?id=109103
        <rdar://problem/12679827>

        Reviewed by Darin Adler.

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
            - MemoryPressureHandler::install is now called via MemoryPressureHandler::initialize.
        (WebInstallMemoryPressureHandler):
            - MemoryPressureHandler::install is now called via MemoryPressureHandler::initialize.

2013-02-07  Benjamin Poulain  <bpoulain@apple.com>

        Move pauseAnimation/pauseTransition from TestRunner to Internals
        https://bugs.webkit.org/show_bug.cgi?id=109107

        Reviewed by Anders Carlsson.

        * WebView/WebFrame.mm:
        * WebView/WebFramePrivate.h:

2013-02-06  Mike West  <mkwst@chromium.org>

        Add an ENABLE_NOSNIFF feature flag.
        https://bugs.webkit.org/show_bug.cgi?id=109029

        Reviewed by Jochen Eisinger.

        This new flag will control the behavior of 'X-Content-Type-Options: nosniff'
        when processing script and other resource types.

        * Configurations/FeatureDefines.xcconfig:

2013-02-04  Benjamin Poulain  <bpoulain@apple.com>

        Kill suspendAnimation(), resumeAnimation() and numberOfActiveAnimations() from DRT/WTR; use Internals
        https://bugs.webkit.org/show_bug.cgi?id=108741

        Reviewed by Tony Chang.

        * WebView/WebFrame.mm:
        * WebView/WebFramePrivate.h:

2013-02-04  Enrica Casucci  <enrica@apple.com>

        Add specific EditActions for Bold and Italic commands.
        https://bugs.webkit.org/show_bug.cgi?id=108842.
        <rdar://problem/13098252>

        Reviewed by Ryosuke Niwa.

        * WebCoreSupport/WebEditorClient.mm:
        (undoNameForEditAction):

2013-02-03  David Kilzer  <ddkilzer@apple.com>

        Upstream ENABLE_PDFKIT_PLUGIN settting
        <http://webkit.org/b/108792>

        Reviewed by Tim Horton.

        * Configurations/FeatureDefines.xcconfig: Disable PDFKIT_PLUGIN
        on iOS since PDFKit is a Mac-only framework.

2013-02-02  David Kilzer  <ddkilzer@apple.com>

        Upstream iOS FeatureDefines
        <http://webkit.org/b/108753>

        Reviewed by Anders Carlsson.

        * Configurations/FeatureDefines.xcconfig:
        - ENABLE_DEVICE_ORIENTATION: Add iOS configurations.
        - ENABLE_PLUGIN_PROXY_FOR_VIDEO: Ditto.
        - FEATURE_DEFINES: Add ENABLE_PLUGIN_PROXY_FOR_VIDEO.  Add
          PLATFORM_NAME variant to reduce future merge conflicts. 

2013-02-01  Alexis Menard  <alexis@webkit.org>

        Enable unprefixed CSS transitions by default.
        https://bugs.webkit.org/show_bug.cgi?id=108216

        Reviewed by Dean Jackson.

        Rename the flag CSS_TRANSFORMS_ANIMATIONS_TRANSITIONS_UNPREFIXED
        to CSS_TRANSFORMS_ANIMATIONS_UNPREFIXED which will be used later to 
        guard the unprefixing work for CSS Transforms and animations.

        * Configurations/FeatureDefines.xcconfig:

2013-01-31  Aurimas Liutikas  <aurimas@chromium.org>

        Editor::m_compositionNode not updated on HTMLInputElement::setValue()
        https://bugs.webkit.org/show_bug.cgi?id=107737

        Reviewed by Ryosuke Niwa.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _updateSelectionForInputManager]):

2013-01-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r141479.
        http://trac.webkit.org/changeset/141479
        https://bugs.webkit.org/show_bug.cgi?id=108564

        breaks chromium test (Requested by morrita on #webkit).

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _updateSelectionForInputManager]):

2013-01-31  Enrica Casucci  <enrica@apple.com>

        Mac: Editor::baseWritingDirectionForSelectionStart should return WritingDirection instead of NSWritingDirection.
        https://bugs.webkit.org/show_bug.cgi?id=108519.

        Reviewed by Sam Weinig.

        There is no need to use AppKit types here.
        baseWritingDirectionForSelectionStart now returns WritingDirection and
        WebHTMLView toggleWritingDirection has been modified accordingly.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView toggleBaseWritingDirection:]):

2013-01-31  Aurimas Liutikas  <aurimas@chromium.org>

        Editor::m_compositionNode not updated on HTMLInputElement::setValue()
        https://bugs.webkit.org/show_bug.cgi?id=107737

        Reviewed by Ryosuke Niwa.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView _updateSelectionForInputManager]):

2013-01-31  Joseph Pecoraro  <pecoraro@apple.com>

        Disable ENABLE_FULLSCREEN_API on iOS
        https://bugs.webkit.org/show_bug.cgi?id=108250

        Reviewed by Benjamin Poulain.

        * Configurations/FeatureDefines.xcconfig:

2013-01-31  Enrica Casucci  <enrica@apple.com>

        WebKit2: provide new bundle APIs to allow bundle clients to be notified of pasteboard access.
        https://bugs.webkit.org/show_bug.cgi?id=108396.
        <rdar://problem/12920461>

        Reviewed by Alexey Proskuryakov.

        Adds stub implementation for WebKit of the new EditorClient methods.

        * WebCoreSupport/WebEditorClient.h:
        * WebCoreSupport/WebEditorClient.mm:
        (WebEditorClient::willWriteSelectionToPasteboard):
        (WebEditorClient::getClientPasteboardDataForRange):

2013-01-31  Brady Eidson  <beidson@apple.com>

        Lack of a log level string should not obliterate compiled in logging channel state.
        https://bugs.webkit.org/show_bug.cgi?id=108502

        Reviewed by Alexey Proskuryakov and Sam Weinig.

        * Misc/WebKitLogging.m: If there's no log level string, leave the channel state alone.

2013-01-29  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r140983.
        http://trac.webkit.org/changeset/140983
        https://bugs.webkit.org/show_bug.cgi?id=108277

        Unfortunately, this API has one last client (Requested by
        abarth on #webkit).

        * Configurations/FeatureDefines.xcconfig:

2012-11-28  Jer Noble  <jer.noble@apple.com>

        Allow clients to ask for the WebView/WKView placeholder view when in full screen mode.
        https://bugs.webkit.org/show_bug.cgi?id=103558
        <rdar://problem/12763112>

        Reviewed by Benjamin Poulain.

        Clients may want to behave differently when their WebView/WKView has been swapped out by a placeholder
        view when in full screen mode.  Add a simple accessor for the existing placeholder view to
        WebFullScreenController and WebView.

        * WebView/WebFullScreenController.h:
        * WebView/WebFullScreenController.mm:
        (-[WebFullScreenController webViewPlaceholder]): Added simple accessor.
        * WebView/WebView.mm:
        (-[WebView fullScreenPlaceholderView]): Added simple accessor.

2013-01-28  Pratik Solanki  <psolanki@apple.com>

        PLATFORM(IOS) should come before __MAC_OS_X_VERSION_MIN_REQUIRED
        https://bugs.webkit.org/show_bug.cgi?id=108101

        Reviewed by Benjamin Poulain.

        Since iOS does not define __MAC_OS_X_VERSION_MIN_REQUIRED, any usage of
        __MAC_OS_X_VERSION_MIN_REQUIRED should be after a PLATFORM(IOS) check.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2013-01-28  Joseph Pecoraro  <pecoraro@apple.com>

        [Mac] Update PageVisibilityState when WebView is hidden / visible
        https://bugs.webkit.org/show_bug.cgi?id=107509

        Reviewed by Sam Weinig.

        * WebView/WebView.mm:
        * WebView/WebViewPrivate.h:
        (-[WebView _commonInitializationWithFrameName:groupName:]):
        Set the initial visibility of the page.

        (-[WebView addWindowObserversForWindow:]):
        (-[WebView removeWindowObservers]):
        (-[WebView _isViewVisible]):
        (-[WebView _updateVisibilityState]):
        (-[WebView viewDidMoveToWindow]):
        (-[WebView _windowVisibilityChanged:]):
        Update visibility state in the same ways WK2 does. This involves
        listening for some new NSWindow delegates.

2013-01-28  Joseph Pecoraro  <pecoraro@apple.com>

        Improve PageVisibility API with enums
        https://bugs.webkit.org/show_bug.cgi?id=107364

        Reviewed by Sam Weinig.

        * WebView/WebView.mm:
        * WebView/WebViewPrivate.h:
        (core):
        (-[WebView _setVisibilityState:isInitialState:]):
        Switch the private API form int to a WebPageVisibilityState enum.

2013-01-28  Adam Barth  <abarth@webkit.org>

        Remove webkitNotifications.createHTMLNotification
        https://bugs.webkit.org/show_bug.cgi?id=107598

        Reviewed by Benjamin Poulain.

        * Configurations/FeatureDefines.xcconfig:

2013-01-25  Andy Estes  <aestes@apple.com>

        Wrap content filtering code in an object
        https://bugs.webkit.org/show_bug.cgi?id=107914

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Updated to reflect changes in WKSI.

2013-01-24  Dan Bernstein  <mitz@apple.com>

        WebNavigationData does not distinguish between an empty title and a missing title
        https://bugs.webkit.org/show_bug.cgi?id=107917

        Reviewed by Andy Estes.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (nilOrNSString): Added this helper function.
        (WebFrameLoaderClient::updateGlobalHistory): Initialize the WebNavigationData with a nil
        title, rather than the empty string, if the document does not have a title.

2013-01-24  Mark Hahnenberg  <mhahnenberg@apple.com>

        Objective-C API: Rename JSValue.h/APIJSValue.h to JSCJSValue.h/JSValue.h
        https://bugs.webkit.org/show_bug.cgi?id=107327

        Reviewed by Filip Pizlo.

        We're renaming these two files, so we have to replace the names everywhere.

        * DOM/WebDOMOperations.mm:
        * ForwardingHeaders/runtime/JSCJSValue.h: Copied from Source/WebKit/mac/ForwardingHeaders/runtime/JSValue.h.
        * ForwardingHeaders/runtime/JSValue.h: Removed.
        * WebView/WebFrame.mm:
        * WebView/WebView.mm:

2013-01-22  Anders Carlsson  <andersca@apple.com>

        Use a platforom strategy for local storage
        https://bugs.webkit.org/show_bug.cgi?id=107600

        Reviewed by Andreas Kling.

        Update for new storage strategy.

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::createStorageStrategy):

2013-01-21  Kentaro Hara  <haraken@chromium.org>

        Implement UIEvent constructor
        https://bugs.webkit.org/show_bug.cgi?id=107430

        Reviewed by Adam Barth.

        Editor's draft: https://dvcs.w3.org/hg/d4e/raw-file/tip/source_respec.htm

        UIEvent constructor is implemented under a DOM4_EVENTS_CONSTRUCTOR flag,
        which is enabled on Safari and Chromium for now.

        * Configurations/FeatureDefines.xcconfig:

2013-01-22  Joseph Pecoraro  <pecoraro@apple.com>

        [Mac] Enable Page Visibility (PAGE_VISIBILITY_API)
        https://bugs.webkit.org/show_bug.cgi?id=107230

        Reviewed by David Kilzer.

        * Configurations/FeatureDefines.xcconfig:

2013-01-22  Tim Horton  <timothy_horton@apple.com>

        PDFPlugin: Build PDFPlugin everywhere, enable at runtime
        https://bugs.webkit.org/show_bug.cgi?id=107117

        Reviewed by Alexey Proskuryakov.

        Since PDFLayerController SPI is all forward-declared, the plugin should build
        on all Mac platforms, and can be enabled at runtime.

        * Configurations/FeatureDefines.xcconfig:

2013-01-21  Dirk Schulze  <dschulze@adobe.com>

        Add build flag for Canvas's Path object (disabled by default)
        https://bugs.webkit.org/show_bug.cgi?id=107473

        Reviewed by Dean Jackson.

        * Configurations/FeatureDefines.xcconfig:

2013-01-17  Andy Estes  <aestes@apple.com>

        Add a USE() macro for content filtering code
        https://bugs.webkit.org/show_bug.cgi?id=107098

        Reviewed by Mark Rowe.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Use USE(CONTENT_FILTERING).

2013-01-19  Philip Rogers  <pdr@google.com>

        Merge SVGStylable into SVGStyledElement
        https://bugs.webkit.org/show_bug.cgi?id=106877

        SVG2 changes element inheritance so all SVGElements are stylable. As a first-step towards a
        cleaner class hierarchy, this patch moves SVGStylable into SVGStyledElement.

        Reviewed by Dirk Schulze.

        * MigrateHeaders.make:

2013-01-18  Seokju Kwon  <seokju.kwon@gmail.com>

        Add explicit keyword to constructors in platform-specific InspectorClient
        https://bugs.webkit.org/show_bug.cgi?id=107255

        Reviewed by Kentaro Hara.

        Add explicit keyword to constructors that take one argument
        in platform-specific implementation of InspectorClient.

        * WebCoreSupport/WebInspectorClient.h:
        (WebInspectorClient):

2013-01-15  Jer Noble  <jer.noble@apple.com>

        Add a Setting to disable QTKit media engine.
        https://bugs.webkit.org/show_bug.cgi?id=106972

        Reviewed by Eric Carlson.

        Add WebKit API to set QTKit enabled setting from user defaults.

        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]): Set WebCore settings based on user defaults.
        (-[WebPreferences setQTKitEnabled:]): Pass through to WebCore.
        (-[WebPreferences isQTKitEnabled]): Ditto.
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): Synchronize WebKit/WebCore settings.

2013-01-15  Enrica Casucci  <enrica@apple.com>

        Add a new set of WebKit2 APIs for text search and
        search results management.
        https://bugs.webkit.org/show_bug.cgi?id=106834.
        <rdar://problem/12597159>

        Reviewed by Simon Fraser.
        
        Adding new API to perform text search in WebKit2 without using
        the stock UI. The new interface provides all the information
        necessary to write a custom UI for search.

        Added new TextWebKitAPI test.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView countMatchesForText:inDOMRange:options:limit:markMatches:]):
        Modified to reflect the changes to Editor::countMatchesForText interface.

2013-01-10  Zan Dobersek  <zandobersek@gmail.com>

        Remove the ENABLE_ANIMATION_API feature define occurences
        https://bugs.webkit.org/show_bug.cgi?id=106544

        Reviewed by Simon Fraser.

        The Animation API code was removed in r137243. The ENABLE_ANIMATION_API
        feature define handling still lingers in various build systems and configurations
        but is of no use, so it should be removed.

        * Configurations/FeatureDefines.xcconfig:

2013-01-08  Mark Lam  <mark.lam@apple.com>

        Removed the need for the ProposedDatabase mechanism.
        https://bugs.webkit.org/show_bug.cgi?id=106292.

        Reviewed by Sam Weinig.

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::exceededDatabaseQuota):

2013-01-07  Dan Bernstein  <mitz@apple.com>

        [mac] WebKit1 clients can’t tell when a frame has been removed from the hierarchy
        https://bugs.webkit.org/show_bug.cgi?id=106261

        Reviewed by Simon Fraser.

        Test: TestWebKitAPI/Tests/mac/WebViewDidRemoveFrameFromHierarchy.mm.

        Added -[WebFrameLoadDelegate webView:didRemoveFrameFromHierarchy:].

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::detachedFromParent2): Added a call to the new frame load delegate
        method.
        * WebView/WebDelegateImplementationCaching.h:
        (WebFrameLoadDelegateImplementationCache): Added the new method to the cache.
        * WebView/WebFrameLoadDelegatePrivate.h: Declared the new delegate method.
        * WebView/WebView.mm:
        (-[WebView _cacheFrameLoadDelegateImplementations]): Added the new method to the cache.

2013-01-07  Mike West  <mkwst@chromium.org>

        Make the IFRAME_SEAMLESS flag runtime-enabled.
        https://bugs.webkit.org/show_bug.cgi?id=106213

        Reviewed by Ojan Vafai.

        * WebView/WebPreferenceKeysPrivate.h:
        * WebView/WebPreferences.mm:
        (-[WebPreferences seamlessIFramesEnabled]):
        (-[WebPreferences setSeamlessIFramesEnabled:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):
            Add a seamless IFrame preference to WebPreferences, and use it to
            toggle the runtime state of the feature as appropriate.

2013-01-04  Adam Klein  <adamk@chromium.org>

        Remove ENABLE_MUTATION_OBSERVERS #define
        https://bugs.webkit.org/show_bug.cgi?id=105459

        Reviewed by Ryosuke Niwa.

        * Configurations/FeatureDefines.xcconfig:

2013-01-01  Dan Bernstein  <mitz@apple.com>

        <rdar://problem/12942239> Update copyright strings

        Reviewed by Sam Weinig.

        * Info.plist:

2012-12-29  Adam Roben  <aroben@webkit.org>

        Web Inspector: Mac WK1 Inspector can't save/load timeline data
        https://bugs.webkit.org/show_bug.cgi?id=105547

        Reviewed by Pavel Feldman.

        * WebCoreSupport/WebInspectorClient.h: Declared new overrides and
        member variables necessary for save support.

        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::save):
        (WebInspectorFrontendClient::append):
        Implemented these to make saving timeline data work. (It seems to me
        the InspectorFrontendClient API could be cleaned up a bit. I had to
        look at Chromium source code to determine that I needed to call back
        into the InspectorFrontendAPI JS object after saving/appending, and
        that I needed to keep a map of passed URLs -> chosen URLs.)

        (-[WebInspectorWindowController window:willPositionSheet:usingRect:]):
        Tweaked the position of the sheet so that open/save sheets look a
        little bette.r

        (-[WebInspectorWindowController webView:runOpenPanelForFileButtonWithResultListener:allowMultipleFiles:]):
        Implemented to make loading timeline data work.

2012-12-28  Mark Rowe  <mrowe@apple.com>

        Move logic for extracting the OS X marketing version in to WebCore
        <http://webkit.org/b/105841> / <rdar://problem/10736041>

        Reviewed by Dan Bernstein.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Remove the code related to the WKSI symbol.
        * WebView/WebView.mm:
        (systemMarketingVersionForUserAgentString): Call the WebCore function instead of the WKSI function.
        (+[WebView _standardUserAgentWithApplicationName:]): Retain the result now that our helper doesn't
        do that for us.

2012-12-27  Sam Weinig  <sam@webkit.org>

        Attempt to fix the tests.

        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]):

2012-12-23  Alexey Proskuryakov  <ap@apple.com>

        <rdar://problem/12808377> Network process should respect cookie accept policy
        https://bugs.webkit.org/show_bug.cgi?id=105684

        Reviewed by Sam Weinig.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        CookiesStrategy no longer has notifyCookiesChanged().

2012-12-22  Alexey Proskuryakov  <ap@apple.com>

        Add a separate class for networking related storage
        https://bugs.webkit.org/show_bug.cgi?id=105676

        Reviewed by Sam Weinig.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        Updated for ResourceHandle include changes.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        This class is now simpler, with more session tracking being in WebCore now.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::cookiesForDOM):
        (WebPlatformStrategies::setCookiesFromDOM):
        (WebPlatformStrategies::cookiesEnabled):
        (WebPlatformStrategies::cookieRequestHeaderFieldValue):
        (WebPlatformStrategies::getRawCookies):
        (WebPlatformStrategies::deleteCookie):
        We no longer need a function for default cookie storage! Other cookie functions
        now take a session.

        * WebView/WebPreferences.mm:
        (+[WebPreferences _switchNetworkLoaderToNewTestingSession]): Initialize WCSI before
        calling a WebCore that uses it.
        (+[WebPreferences _setCurrentNetworkLoaderSessionCookieAcceptPolicy:]): Use
        NetworkStorageSession for session tracking.

        * WebView/WebView.mm: (-[WebView _cachedResponseForURL:]): Updated for networking
        context now returning a class for session.

2012-12-20  Ilya Tikhonovsky  <loislo@chromium.org>

        Unreviewed build fix for chromium mac after r138206.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2012-12-19  Alexey Proskuryakov  <ap@apple.com>

        <rdar://problem/12890242> [WK2 NetworkProcess] Client doesn't receive SSL certificates
        https://bugs.webkit.org/show_bug.cgi?id=105467

        Reviewed by Brady Eidson.

        * WebCoreSupport/WebSystemInterface.mm: (InitWebCoreSystemInterface): Initialize
        a WKSI function we've been missing.

2012-12-19  Alexis Menard  <alexis@webkit.org>

        Implement CSS parsing for CSS transitions unprefixed.
        https://bugs.webkit.org/show_bug.cgi?id=104804

        Reviewed by Dean Jackson.

        Add a new flag ENABLE_CSS_TRANSFORMS_ANIMATIONS_TRANSITIONS_UNPREFIXED
        to cover the work of unprefixing Transforms, Animations and 
        Transitions. It will let the possibility of each ports to turn it off 
        in their release branches until we're confident that these CSS 
        properties are ready to be unprefixed.

        * Configurations/FeatureDefines.xcconfig:

2012-12-18  Alexey Proskuryakov  <ap@apple.com>

        Remove unnecessary functions from CookiesStrategy
        https://bugs.webkit.org/show_bug.cgi?id=105369

        Reviewed by Brady Eidson.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:

2012-12-18  Alice Liu  <alice.liu@apple.com>

        Add SPI to WebKit1 WebFrame for hit testing
        https://bugs.webkit.org/show_bug.cgi?id=105106

        Reviewed by Dan Bernstein.

        * WebView/WebFrame.mm:
        (-[WebFrame elementAtPoint:]): Added. Takes an NSPoint to feed to the WebCore::Frame for hit-testing.
        Creates a WebElementDictionary from that WebCore::HitTestResult, and returns the element dictionary. 
        * WebView/WebFramePrivate.h:

2012-12-18  Alice Liu  <alice.liu@apple.com>

        Add SPI to WebKit1 WebFrame for node conversion to JSValueRef
        https://bugs.webkit.org/show_bug.cgi?id=105262

        Reviewed by Anders Carlsson.

        * WebView/WebFrame.mm:
        (-[WebFrame jsWrapper:forWorld:]): Added. Takes a DOMNode and WebScriptWorld and provides a JSValueRef
        for the WebCore::Node in that particular WebScriptWorld.
        * WebView/WebFramePrivate.h:

2012-12-18  Beth Dakin  <bdakin@apple.com>

        https://bugs.webkit.org/show_bug.cgi?id=102579
        [mac] Enable scaled cursors

        Reviewed by Dean Jackson.

        * Configurations/FeatureDefines.xcconfig:

2012-12-16  Levi Weintraub  <leviw@chromium.org>

        Push pixel snapping logic into TransformState
        https://bugs.webkit.org/show_bug.cgi?id=101779

        Reviewed by Simon Fraser.

        * WebView/WebFullScreenController.mm:
        (screenRectOfContents): Removed SnapOffsetForTransforms as it's no longer needed.

2012-12-15  Anders Carlsson  <andersca@apple.com>

        Rename FrameLoaderClient::download to convertMainResourceLoadToDownload
        https://bugs.webkit.org/show_bug.cgi?id=105122

        Reviewed by Andreas Kling.

        Update for WebCore changes.

        * WebCoreSupport/WebFrameLoaderClient.h:
        (WebFrameLoaderClient):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::convertMainResourceLoadToDownload):

2012-12-15  Mark Lam  <mark.lam@apple.com>

        Re-landing patch for "Introducing the DatabaseStrategy and database servers".
        https://bugs.webkit.org/show_bug.cgi?id=104934.

        Not reviewed.

        Merged from r137767. Previously reviewed by Sam Weinig.

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::createDatabaseStrategy):

2012-12-14  Mark Lam  <mark.lam@apple.com>

        The WebView should initialize the platform strategies before initializing other sub-systems.
        https://bugs.webkit.org/show_bug.cgi?id=105083.

        Reviewed by Alexey Proskuryakov.

        * WebView/WebView.mm:
        (-[WebView _commonInitializationWithFrameName:groupName:]):

2012-12-14  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r137767.
        http://trac.webkit.org/changeset/137767
        https://bugs.webkit.org/show_bug.cgi?id=105062

        Broke Mac builds. (Requested by mlam on #webkit).

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        * WebCoreSupport/WebPlatformStrategies.mm:

2012-12-14  Mark Lam  <mark.lam@apple.com>

        Introducing the DatabaseStrategy and database servers.
        https://bugs.webkit.org/show_bug.cgi?id=104934.

        Reviewed by Sam Weinig.

        The database server is currently a placeholder that does nothing.

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::createDatabaseStrategy):

2012-12-13  Alexey Proskuryakov  <ap@apple.com>

        <rdar://problem/12838354> Per-Tab WebProcess: DOM cookie access functions should respect private browsing
        https://bugs.webkit.org/show_bug.cgi?id=104691

        Reviewed by Sam Weinig.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        (WebFrameNetworkingContext::inPrivateBrowsingMode):
        (WebFrameNetworkingContext::storageSession):
        Implemented inPrivateBrowsingMode().

2012-12-12  Mark Lam  <mark.lam@apple.com>

        Encapsulate externally used webdatabase APIs in DatabaseManager.
        https://bugs.webkit.org/show_bug.cgi?id=104741.

        Reviewed by Sam Weinig.

        Use DatabaseManager instead of accessing DatabaseTracker, AbstractDatabase,
        and DatabaseContext directly. This is to prepare for upcoming webkit2
        refactoring.

        * Storage/WebDatabaseManager.mm:
        (-[WebDatabaseManager origins]):
        (-[WebDatabaseManager databasesWithOrigin:]):
        (-[WebDatabaseManager detailsForDatabase:withOrigin:]):
        (-[WebDatabaseManager deleteAllDatabases]):
        (-[WebDatabaseManager deleteOrigin:]):
        (-[WebDatabaseManager deleteDatabase:withOrigin:]):
        (WebKitInitializeDatabasesIfNecessary):
        * Storage/WebDatabaseManagerClient.h: Copied from Source/WebKit/mac/Storage/WebDatabaseTrackerClient.h.
        (WebDatabaseManagerClient):
        * Storage/WebDatabaseManagerClient.mm: Copied from Source/WebKit/mac/Storage/WebDatabaseTrackerClient.mm.
        (WebDatabaseManagerClient::sharedWebDatabaseManagerClient):
        (WebDatabaseManagerClient::WebDatabaseManagerClient):
        (WebDatabaseManagerClient::~WebDatabaseManagerClient):
        (DidModifyOriginData::dispatchToMainThread):
        (DidModifyOriginData::DidModifyOriginData):
        (DidModifyOriginData):
        (WebDatabaseManagerClient::dispatchDidModifyOrigin):
        (WebDatabaseManagerClient::dispatchDidModifyDatabase):
        * Storage/WebDatabaseQuotaManager.mm:
        (-[WebDatabaseQuotaManager usage]):
        (-[WebDatabaseQuotaManager quota]):
        (-[WebDatabaseQuotaManager setQuota:]):
        * Storage/WebDatabaseTrackerClient.h: Removed.
        * Storage/WebDatabaseTrackerClient.mm: Removed.
        * WebCoreSupport/WebSecurityOrigin.mm:
        (-[WebSecurityOrigin usage]):
        (-[WebSecurityOrigin quota]):
        (-[WebSecurityOrigin setQuota:]):
        * WebKit.order:
        * WebView/WebFrame.mm:
        (-[WebFrame _cacheabilityDictionary]):
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2012-12-12  Alexey Proskuryakov  <ap@apple.com>

        Make LOG() work in WebProcess and NetworkProcess
        https://bugs.webkit.org/show_bug.cgi?id=104718

        Reviewed by Tim Horton.

        * WebView/WebView.mm: Use WebCore/InitializeLogging.h to avoid conflicts between
        WebCore and WebKit versions of this file.

2012-12-11  Mike West  <mkwst@chromium.org>

        Web Inspector: ConsoleTypes should not expose MessageType - it should be private to inspector.
        https://bugs.webkit.org/show_bug.cgi?id=66371

        Reviewed by Pavel Feldman.

        Drops WebCore::MessageType from the addMessageToConsole method.

        * WebCoreSupport/WebChromeClient.h:
        (WebChromeClient):
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::addMessageToConsole):

2012-12-09  Antti Koivisto  <antti@apple.com>

        Factor node traversal into standalone functions
        https://bugs.webkit.org/show_bug.cgi?id=104507

        Reviewed by Eric Seidel.
    
        * WebView/WebHTMLRepresentation.mm:
        (searchForLabelsBeforeElement):

2012-12-10  Alexis Menard  <alexis@webkit.org>

        [CSS3 Backgrounds and Borders] Remove CSS3_BACKGROUND feature flag.
        https://bugs.webkit.org/show_bug.cgi?id=104539

        Reviewed by Antonio Gomes.

        As discussed on webkit-dev it is not needed to keep this feature flag 
        as support for <position> type is a small feature that is already 
        implemented by three other UAs. It was useful while landing this 
        feature as partial bits were landed one after one.

        * Configurations/FeatureDefines.xcconfig:

2012-12-06  Rick Byers  <rbyers@chromium.org>

        CSS cursor property should support webkit-image-set
        https://bugs.webkit.org/show_bug.cgi?id=99493

        Reviewed by Beth Dakin.

        Add ENABLE_MOUSE_CURSOR_SCALE - disabled by default.

        * Configurations/FeatureDefines.xcconfig:

2012-12-03  Yury Semikhatsky  <yurys@chromium.org>

        Unreviewed. Fix Mac compilation after r136448.

        * WebCoreSupport/WebChromeClient.mm:
        (stringForMessageType):

2012-12-03  Alexis Menard  <alexis@webkit.org>

        [Mac] Enable CSS3 background-position offset by default.
        https://bugs.webkit.org/show_bug.cgi?id=103905

        Reviewed by Simon Fraser.

        Turn the flag on by default.

        * Configurations/FeatureDefines.xcconfig:

2012-12-02  Yongjun Zhang  <yongjun_zhang@apple.com>

        Need a method to close all idle localstorage databases immediately.
        https://bugs.webkit.org/show_bug.cgi?id=103469

        Reviewed by David Kilzer.

        Add a new method to WebStorageManager that we can call to close all
        idle local storage databases.

        * Storage/WebStorageManager.mm:
        (+[WebStorageManager closeIdleLocalStorageDatabases]):
        * Storage/WebStorageManagerPrivate.h:

2012-11-30  Mihai Maerean  <mmaerean@adobe.com>

        [CSSRegions] when WebKit uses V8, there should be a single variable to store if the CSS Regions feature is enabled
        https://bugs.webkit.org/show_bug.cgi?id=101192

        Reviewed by Hajime Morita.

        Removed the CSS Regions flag in Settings and switched to using the new flag I have added in RuntimeEnabledFeatures.

        Tests: No new tests because there is no functional change.

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]):

2012-11-29  Rafael Weinstein  <rafaelw@chromium.org>

        [HTMLTemplateElement] Add feature flag
        https://bugs.webkit.org/show_bug.cgi?id=103694

        Reviewed by Adam Barth.

        This flag will guard the implementation of the HTMLTemplateElement.
        http://dvcs.w3.org/hg/webcomponents/raw-file/tip/spec/templates/index.html

        * Configurations/FeatureDefines.xcconfig:

2012-11-29  Alexey Proskuryakov  <ap@apple.com>

        [WK2] Forward cookie jar calls to NetworkProcess
        https://bugs.webkit.org/show_bug.cgi?id=103457

        Reviewed by Darin Adler.

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::cookiesForDOM):
        (WebPlatformStrategies::setCookiesFromDOM):
        (WebPlatformStrategies::cookiesEnabled):
        (WebPlatformStrategies::cookieRequestHeaderFieldValue):
        (WebPlatformStrategies::getRawCookies):
        (WebPlatformStrategies::deleteCookie):
        (WebPlatformStrategies::getHostnamesWithCookies):
        (WebPlatformStrategies::deleteCookiesForHostname):
        (WebPlatformStrategies::deleteAllCookies):
        (WebPlatformStrategies::getPluginInfo):
        (WebPlatformStrategies::bufferForType):
        WebKit1 strategy just uses PlatformCookieJar.

2012-11-28  Beth Dakin  <bdakin@apple.com>

        https://bugs.webkit.org/show_bug.cgi?id=102970
        [WK1] REGRESSION (r129545): Main frame doesn't rubberband unless 
        WebFrameLoadDelegate implements -webView:didFirstLayoutInFrame:

        Reviewed by Sam Weinig.

        We should always register for DidFirstLayout in WK1 since we do work 
        at that time besides just calling the delegate function.
        * WebView/WebView.mm:
        (-[WebView _cacheFrameLoadDelegateImplementations]):

2012-11-27  Michael Saboff  <msaboff@apple.com>

        TextIterator unnecessarily converts 8 bit strings to 16 bits
        https://bugs.webkit.org/show_bug.cgi?id=103295

        Reviewed by Brent Fulgham.

        Updated _stringForRange to use plainText() instead of removed plainTextToMallocAllocatedBuffer().

        * WebView/WebFrame.mm:
        (-[WebFrame _stringForRange:]):

2012-11-27  James Simonsen  <simonjam@chromium.org>

        Consolidate FrameLoader::load() into one function taking a FrameLoadRequest
        https://bugs.webkit.org/show_bug.cgi?id=102151

        Reviewed by Adam Barth.

        * Plugins/WebPluginController.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame loadRequest:]):
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):

2012-11-27  Pratik Solanki  <psolanki@apple.com>

        objc/objc-runtime.h does not exist on all PLATFORM(MAC)
        https://bugs.webkit.org/show_bug.cgi?id=101780

        Reviewed by Brent Fulgham.

        Clean up header includes so we don't include objc/objc-runtime.h.

        * Carbon/HIWebView.mm:
        (UpdateCommandStatus): Use wtfObjcMsgSend template instead of objc_msgSend.
        * Plugins/WebNetscapePluginView.mm:
        * Plugins/WebPluginContainerCheck.mm:
        (-[WebPluginContainerCheck _continueWithPolicy:]): Use wtfObjcMsgSend template instead of objc_msgSend.
        * Plugins/WebPluginController.mm:
        * WebCoreSupport/WebCachedFramePlatformData.h:
        * WebCoreSupport/WebDeviceOrientationClient.mm:
        * WebView/WebDelegateImplementationCaching.mm:
        * WebView/WebHTMLView.mm:
        * WebView/WebPDFDocumentExtras.mm:
        * WebView/WebPolicyDelegate.mm:
        (-[WebPolicyDecisionListener _usePolicy:]): Use wtfObjcMsgSend template instead of objc_msgSend.
        * WebView/WebView.mm:

2012-11-27  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r135786.
        http://trac.webkit.org/changeset/135786
        https://bugs.webkit.org/show_bug.cgi?id=103379

        It made 3 plugin tests timeout on several platforms (Requested
        by Ossy on #webkit).

        * Plugins/WebPluginController.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame loadRequest:]):
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):

2012-11-26  James Simonsen  <simonjam@chromium.org>

        Consolidate FrameLoader::load() into one function taking a FrameLoadRequest
        https://bugs.webkit.org/show_bug.cgi?id=102151

        Reviewed by Adam Barth.

        * Plugins/WebPluginController.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame loadRequest:]):
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):

2012-11-23  Alexis Menard  <alexis@webkit.org>

        [CSS3 Backgrounds and Borders] Implement new CSS3 background-position parsing.
        https://bugs.webkit.org/show_bug.cgi?id=102104

        Reviewed by Julien Chaffraix.

        Protect the new feature behind a feature flag.

        * Configurations/FeatureDefines.xcconfig:

2012-11-21  Allan Sandfeld Jensen  <allan.jensen@digia.com>

        Disambiguate innerNodeFramePoint and mainFramePoint
        https://bugs.webkit.org/show_bug.cgi?id=98139

        Reviewed by Julien Chaffraix.

        Switch to using HitTestResult::innerNodeFrame and HitTestResult::innerNodeFramePoint.

        * WebCoreSupport/WebContextMenuClient.mm:
        (WebContextMenuClient::showContextMenu):

2012-11-20  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r135295.
        http://trac.webkit.org/changeset/135295
        https://bugs.webkit.org/show_bug.cgi?id=102834

        This patch causes assertion to some layout tests on chromium
        (Requested by jianli on #webkit).

        * Plugins/WebPluginController.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame loadRequest:]):
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):

2012-11-20  James Simonsen  <simonjam@chromium.org>

        Consolidate FrameLoader::load() into one function taking a FrameLoadRequest
        https://bugs.webkit.org/show_bug.cgi?id=102151

        Reviewed by Adam Barth.

        * Plugins/WebPluginController.mm:
        * WebView/WebFrame.mm:
        (-[WebFrame loadRequest:]):
        (-[WebFrame _loadData:MIMEType:textEncodingName:baseURL:unreachableURL:]):

2012-11-19  Kihong Kwon  <kihong.kwon@samsung.com>

        Add PROXIMITY_EVENTS feature
        https://bugs.webkit.org/show_bug.cgi?id=102658

        Reviewed by Kentaro Hara.

        Add PROXIMITY_EVENTS feature to xcode project for WebKit.

        * Configurations/FeatureDefines.xcconfig:

2012-11-16  Tony Chang  <tony@chromium.org>

        Remove ENABLE_CSS_HIERARCHIES since it's no longer in use
        https://bugs.webkit.org/show_bug.cgi?id=102554

        Reviewed by Andreas Kling.

        As mentioned in https://bugs.webkit.org/show_bug.cgi?id=79939#c41 ,
        we're going to revist this feature once additional vendor support is
        achieved.

        * Configurations/FeatureDefines.xcconfig:

2012-11-15  Alexey Proskuryakov  <ap@apple.com>

        Private Browsing is a per-page setting that sets a global value
        https://bugs.webkit.org/show_bug.cgi?id=67870

        Reviewed by Sam Weinig.

        * WebCoreSupport/WebFrameNetworkingContext.h:
        * WebCoreSupport/WebFrameNetworkingContext.mm:
        Moved functions for managing global sessions from WebCore.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::defaultCookieStorage): Added. Uses WebFrameNetworkingContext
        to reach the storage.

        * WebView/WebPreferences.mm:
        (+[WebPreferences _switchNetworkLoaderToNewTestingSession]): Ditto.
        (+[WebPreferences _setCurrentNetworkLoaderSessionCookieAcceptPolicy:]): Ditto.

        * WebView/WebPreferencesPrivate.h: Added a comment explaining that two functions
        are not generic enough for use outside DRT (one of them had "testing" in name,
        but another did not).

        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): Create a global private browsing session when
        the first view with private browsing is created, delete it when any window with
        it disabled is created (since this comes from preferences, it applies to all
        views equally, even though we are dealing with a single one here).
        (-[WebView _cachedResponseForURL:]): Use main frame's networking context instead of
        a global one.

2012-11-13  Timothy Hatcher  <timothy@apple.com>

        Adjust the Web Inspector window title frame if needed to prevent it from intersecting the dock button.

        https://bugs.webkit.org/show_bug.cgi?id=102073

        Reviewed by Joseph Pecoraro.

        * WebCoreSupport/WebInspectorClient.mm:
        (-[WebInspectorWindow _customTitleFrame]): Added. Adjust the title frame.

2012-11-12  Simon Fraser  <simon.fraser@apple.com>

        Build fix after r134346 and 134347.
        
        Use frameView.isFlipped, not frameView.flipped in the assertion.

        * WebCoreSupport/WebInspectorClient.mm:
        (-[WebInspectorWindowController window]):

2012-11-12  Timothy Hatcher  <timothy@apple.com>

        Add a dock button to the top right corner of the Web Inspector window (similar to the full screen button).

        https://bugs.webkit.org/show_bug.cgi?id=102025

        Reviewed by Joseph Pecoraro.

        * Resources/Dock.pdf: Added.
        * WebCoreSupport/WebInspectorClient.h:
        * WebCoreSupport/WebInspectorClient.mm:
        (-[WebInspectorWindow _cursorForResizeDirection:]): Added.
        (WebInspectorClient::didResizeMainFrame): Call attachAvailabilityChanged instead.
        (WebInspectorFrontendClient::attachAvailabilityChanged): Added.
        (-[WebInspectorWindowController window]): Create the dock button and add it.
        (-[WebInspectorWindowController attachWindow:]): Added.
        (-[WebInspectorWindowController attach]): Call setAttachedWindow.
        (-[WebInspectorWindowController detach]): Ditto.
        (-[WebInspectorWindowController setDockingUnavailable:]): Added. Update hidden state of the dock button.

2012-11-08  Timothy Hatcher  <timothy@apple.com>

        Always use a textured window for the Web Inspector.

        https://bugs.webkit.org/show_bug.cgi?id=101693

        Reviewed by Joseph Pecoraro.

        * WebCoreSupport/WebInspectorClient.mm:
        (-[WebInspectorWindowController window]): Removed the conditional for a textured window.

2012-11-08  Roger Fong  <roger_fong@apple.com>

        Null check URL key entries into WebHistory hash table. 
        https://bugs.webkit.org/show_bug.cgi?id=101664
        <rdar://problem/12440852>

        Reviewed by Brady Eidson.
        
        Sometimes the _entriesByURL hash table used to keep track of web history is erroneously passed in null key entries, which causes an exception to fire.
        This prevents the desired page navigation from taking effect. This is a workaround for the problem.
        Ideally we would figure out where the null values for the key are coming from but for now we'll just set it to "" to prevent the exception from being thrown
        so that navigation can continue as expected.

        * History/WebHistory.mm:
        (-[WebHistoryPrivate visitedURL:withTitle:increaseVisitCount:]):

2012-11-07  Andreas Kling  <akling@apple.com>

        Remove build-webkit dependency on Java SDK for Apple Mac WebKit.
        <http://webkit.org/b/101492>

        Reviewed by Anders Carlsson.

        * Plugins/WebJavaPlugIn.h: Removed.

2012-11-06  Adam Barth  <abarth@webkit.org>

        Unreviewed attempt to fix the chromium-mac build.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2012-11-06  Anders Carlsson  <andersca@apple.com>

        Update Java related WKSI function names
        https://bugs.webkit.org/show_bug.cgi?id=101414

        Reviewed by Sam Weinig.

        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::unavailablePluginButtonClicked):
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (isPlugInInactive):

2012-11-06  Alexey Proskuryakov  <ap@apple.com>

        Clean up which storage cookie jar functions use
        https://bugs.webkit.org/show_bug.cgi?id=101395

        Reviewed by Brady Eidson.

        * WebCoreSupport/WebSystemInterface.mm: (InitWebCoreSystemInterface): Updated for
        two new functions.

2012-11-06  Andrey Lushnikov  <lushnikov@google.com>

        Added console.clear() method

        Web Inspector: add console.clear()
        https://bugs.webkit.org/show_bug.cgi?id=101021

        Reviewed by Vsevolod Vlasov.

        * WebCoreSupport/WebChromeClient.mm:
        (stringForMessageType): Added ClearMessageType case to switch

2012-11-05  Alexey Proskuryakov  <ap@apple.com>

        Get rid of setCookieStoragePrivateBrowsingEnabled.
        https://bugs.webkit.org/show_bug.cgi?id=101247

        Reviewed by Brady Eidson.

        * WebCoreSupport/WebSystemInterface.mm: (InitWebCoreSystemInterface): We no longer
        have this function.

2012-11-03  Alexey Proskuryakov  <ap@apple.com>

        Get rid of USE(CFURLSTORAGESESSIONS)
        https://bugs.webkit.org/show_bug.cgi?id=101131

        Reviewed by Sam Weinig.

        * WebView/WebPreferences.mm:
        (+[WebPreferences _switchNetworkLoaderToNewTestingSession]):
        (+[WebPreferences _setCurrentNetworkLoaderSessionCookieAcceptPolicy:]):
        * WebView/WebView.mm:
        (-[WebView _cachedResponseForURL:]):

2012-11-02  Anders Carlsson  <andersca@apple.com>

        Don't instantiate the Java plug-in if it's inactive
        https://bugs.webkit.org/show_bug.cgi?id=101102
        <rdar://problem/12595679>

        Reviewed by Andreas Kling.

        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::shouldUnavailablePluginMessageBeButton):
        The RenderEmbeddedObject::PluginInactive reason should always result in a button being shown.

        (WebChromeClient::unavailablePluginButtonClicked):
        If the Java plug-in is inactive, call WKJLReportWebComponentsUsed() to reactivate the plug-in and
        then reload the page.

        * WebCoreSupport/WebFrameLoaderClient.mm:
        (isOracleJavaPlugIn):
        (isPlugInInactive):
        Helper functions.

        (WebFrameLoaderClient::createPlugin):
        If the plug-in is inactive, set the appropriate unavailability reason on the renderer.

2012-11-02  Simon Fraser  <simon.fraser@apple.com>

        Enable SUBPIXEL_LAYOUT on Mac
        https://bugs.webkit.org/show_bug.cgi?id=101076

        Reviewed by Dave Hyatt.

        Define ENABLE_SUBPIXEL_LAYOUT and include it in FEATURE_DEFINES.

        * Configurations/FeatureDefines.xcconfig:

2012-11-02  Adam Barth  <abarth@webkit.org>

        ENABLE(UNDO_MANAGER) is disabled everywhere and is not under active development
        https://bugs.webkit.org/show_bug.cgi?id=100711

        Reviewed by Eric Seidel.

        * Configurations/FeatureDefines.xcconfig:

2012-11-01  Adam Roben  <aroben@webkit.org>

        [WK1] Fixed-position elements jiggle up and down slightly during scrolling on a Retina display
        https://bugs.webkit.org/show_bug.cgi?id=100957

        Reviewed by Simon Fraser.

        WebCore doesn't yet support subpixel scrolling. WebKit2 forces
        scrolling to always be integral. Now WebKit1 forces this as well.

        I'm not sure how to write a test for this.

        * WebView/WebDynamicScrollBarsView.mm:
        (shouldRoundScrollOrigin): Returns YES if there are any position:fixed
        or position:sticky elements in the page.
        (-[WebDynamicScrollBarsView scrollClipView:toPoint:]): Round the
        scroll origin to the nearest pixel if needed.

2012-10-31  Anders Carlsson  <andersca@apple.com>

        Fix build.
        <rdar://problem/12612207>.

        Reviewed by Sam Weinig.

        * Panels/WebAuthenticationPanel.m:
        (-[WebAuthenticationPanel loadNib]):

2012-10-30  Joseph Pecoraro  <pecoraro@apple.com>

        [Mac] Sync up FeatureDefine Configuration Files
        https://bugs.webkit.org/show_bug.cgi?id=100171

        Reviewed by David Kilzer.

        Follow up to better coordinate with iOS feature defines. Make:

          - ENABLE_FILTERS always on
          - ENABLE_INPUT_* iphonesimulator values point to the iphoneos values

        * Configurations/FeatureDefines.xcconfig:

2012-10-30  Joseph Pecoraro  <pecoraro@apple.com>

        [Mac] Sync up FeatureDefine Configuration Files
        https://bugs.webkit.org/show_bug.cgi?id=100171

        Reviewed by David Kilzer.

        Ensure an identical FeatureDefine files across all projects. Changes:

          - ENABLE_CSS_BOX_DECORATION_BREAK should be in all
          - ENABLE_PDFKIT_PLUGIN should be in all
          - ENABLE_RESOLUTION_MEDIA_QUERY should be in all
          - ENABLE_ENCRYPTED_MEDIA should be in all
          - ENABLE_HIDDEN_PAGE_DOM_TIMER_THROTTLING with corrected value
          - Some alphabetical ordering cleanup

        * Configurations/FeatureDefines.xcconfig:

2012-10-29  Anders Carlsson  <andersca@apple.com>

        Build WebKit as C++11 on Mac
        https://bugs.webkit.org/show_bug.cgi?id=100720

        Reviewed by Daniel Bates.

        * Configurations/Base.xcconfig:
        Add CLANG_CXX_LANGUAGE_STANDARD=gnu++0x.

        * History/WebBackForwardList.mm:
        (-[WebBackForwardList description]):
        * History/WebHistoryItem.mm:
        (-[WebHistoryItem description]):
        Add static_casts to prevent implicit type conversions in non-constant initializer lists.

2012-10-28  Mark Rowe  <mrowe@apple.com>

        Simplify Xcode configuration settings that used to vary between OS versions.

        Reviewed by Dan Bernstein.

        * Configurations/Base.xcconfig:
        * Configurations/DebugRelease.xcconfig:
        * Configurations/WebKit.xcconfig:

2012-10-28  Mark Rowe  <mrowe@apple.com>

        Remove references to unsupported OS and Xcode versions.

        Reviewed by Anders Carlsson.

        * Configurations/Base.xcconfig:
        * Configurations/CompilerVersion.xcconfig: Removed.
        * Configurations/DebugRelease.xcconfig:
        * Configurations/Version.xcconfig:

2012-10-29  Enrica Casucci  <enrica@apple.com>

        Add ENABLE_USERSELECT_ALL feature flag.
        https://bugs.webkit.org/show_bug.cgi?id=100559

        Reviewed by Eric Seidel.

        * Configurations/FeatureDefines.xcconfig:

2012-10-27  Alexey Proskuryakov  <ap@apple.com>

        All tests crash in WebKit1 mode
        https://bugs.webkit.org/show_bug.cgi?id=100602

        Reviewed by Sam Weinig.

        * WebView/WebView.mm: (+[WebView _setLoadResourcesSerially:]): Resource load
        scheduler is created via a strategy, so strategies need to be initialized before
        using it.

2012-10-27  Dan Bernstein  <mitz@apple.com>

        REAL_PLATFORM_NAME build setting is no longer needed
        https://bugs.webkit.org/show_bug.cgi?id=100587

        Reviewed by Mark Rowe.

        Removed the definition of REAL_PLATFORM_NAME and replaced references to it with references
        to PLATFORM_NAME.

        * Configurations/Base.xcconfig:
        * Configurations/CompilerVersion.xcconfig:
        * Configurations/DebugRelease.xcconfig:
        * Configurations/FeatureDefines.xcconfig:
        * Configurations/Version.xcconfig:
        * Configurations/WebKit.xcconfig:

2012-10-26  Thiago Marcos P. Santos  <thiago.santos@intel.com>

        Add feature flags for CSS Device Adaptation
        https://bugs.webkit.org/show_bug.cgi?id=95960

        Reviewed by Kenneth Rohde Christiansen.

        * Configurations/FeatureDefines.xcconfig:

2012-10-25  Dominik Röttsches  <dominik.rottsches@intel.com>

        Conditionalize XHR timeout support
        https://bugs.webkit.org/show_bug.cgi?id=100356

        Reviewed by Adam Barth.

        Adding XHR_TIMEOUT feature to conditionalize this on ports without network backend support.
        Defaults to ON on Mac since the Mac NSUrlConnection based backend has setTimeoutInterval support.

        * Configurations/FeatureDefines.xcconfig:

2012-10-24  Timothy Hatcher  <timothy@apple.com>

        Fix a crash seen during the Inspector tests on the WebKit1 bots.

        Reviewed by Filip Pizlo.

        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::bringToFront): Use the window from the WebView since m_windowController's window
        is not the same when the Inspector is docked.

2012-10-24  Brady Eidson  <beidson@apple.com>

        Add a strategy for loader customization.
        https://bugs.webkit.org/show_bug.cgi?id=100278

        Reviewed by Alexey Proskuryakov.

        * WebCoreSupport/WebPlatformStrategies.h:
        (WebPlatformStrategies):
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::createLoaderStrategy):

2012-10-24  Timothy Hatcher  <timothy@apple.com>

        Make the Inspector WKView/WebView become the first responder when bringToFront is called.

        https://bugs.webkit.org/show_bug.cgi?id=100209

        Reviewed by Joseph Pecoraro.

        * WebCoreSupport/WebInspectorClient.mm:
        (WebInspectorFrontendClient::bringToFront): Make the Inspector WebView become the first responder.

2012-10-23  Alexey Proskuryakov  <ap@apple.com>

        Add a strategy for shared workers
        https://bugs.webkit.org/show_bug.cgi?id=100165

        Reviewed by Brady Eidson.

        * WebCoreSupport/WebPlatformStrategies.h:
        * WebCoreSupport/WebPlatformStrategies.mm:
        (WebPlatformStrategies::createPasteboardStrategy):
        (WebPlatformStrategies::createSharedWorkerStrategy):
        (WebPlatformStrategies::createVisitedLinkStrategy):

2012-10-24  Eric Carlson  <eric.carlson@apple.com>

        Allow ports to override text track rendering style
        https://bugs.webkit.org/show_bug.cgi?id=97800
        <rdar://problem/12044964>

        Reviewed by Maciej Stachowiak.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Initialize new WKSI function pointers.

2012-10-23  Dan Bernstein  <mitz@apple.com>

        WebKit/mac part of <rdar://problem/2966974> [mac] Kerning and ligatures are not enabled by default
        https://bugs.webkit.org/show_bug.cgi?id=100188

        Reviewed by Sam Weinig.

        * WebView/WebView.mm:
        (+[WebView initialize]): Added a local variable to hold the standard user defaults. Added
        code to register a value of YES for the WebKitKerningAndLigaturesEnabledByDefault user
        default. Changed to refer to that default key by name.

2012-10-23  Kenneth Rohde Christiansen  <kenneth@webkit.org>

        Add support for resolution media query
        https://bugs.webkit.org/show_bug.cgi?id=99077

        Reviewed by Antti Koivisto.

        Add support for the RESOLUTION_MEDIA_QUERY feature flag.

        * Configurations/FeatureDefines.xcconfig:

2012-10-21  Andreas Kling  <kling@webkit.org>

        Remove Page::javaScriptURLsAreAllowed setting.
        <http://webkit.org/b/99944>

        Reviewed by Anders Carlsson.

        * WebKit.order:
        * WebView/WebView.mm:
        * WebView/WebViewPrivate.h:

2012-10-19  Dongwoo Joshua Im  <dw.im@samsung.com>

        Rename ENABLE_CSS3_TEXT_DECORATION to ENABLE_CSS3_TEXT
        https://bugs.webkit.org/show_bug.cgi?id=99804

        Reviewed by Julien Chaffraix.

        CSS3 text related properties will be implemented under this flag,
        including text decoration, text-align-last, and text-justify.

        * Configurations/FeatureDefines.xcconfig:

2012-10-18  Pablo Flouret  <pablof@motorola.com>

        Implement css3-conditional's @supports rule
        https://bugs.webkit.org/show_bug.cgi?id=86146

        Reviewed by Antti Koivisto.

        * Configurations/FeatureDefines.xcconfig:
            Add an ENABLE_CSS3_CONDITIONAL_RULES flag.

2012-10-17  Joseph Pecoraro  <pecoraro@apple.com>

        [Mac] Uninitialized Members in WebDataSourcePrivate
        https://bugs.webkit.org/show_bug.cgi?id=99617

        Reviewed by David Kilzer.

        Initialize BOOL member variables.

        * WebView/WebDataSource.mm:
        (WebDataSourcePrivate::WebDataSourcePrivate):

2012-10-17  Mark Rowe  <mrowe@apple.com>

        Fix the build with a newer version of clang.

        Reviewed by Dan Bernstein.

        Some of the methods in WebCoreStatistics appear to have been added by someone not familiar with Objective-C.
        While it's technically valid to have empty components in a selector, it's rarely done and is not consistent
        with our style guidelines. In this particular case it's also done in such a manner that it's ambiguous and
        therefore generates a warning in newer versions of the compiler.

        Fixes <rdar://problem/12503709>.

        * Misc/WebCoreStatistics.h: Remove unused methods and rename the two poorly-named methods that remain.
        * Misc/WebCoreStatistics.mm: Ditto.
        (-[WebFrame numberOfPagesWithPageWidth:pageHeight:]):
        (-[WebFrame printToCGContext:pageWidth:pageHeight:]):

2012-10-16  Jian Li  <jianli@chromium.org>

        Rename feature define ENABLE_WIDGET_REGION to ENABLE_DRAGGBALE_REGION
        https://bugs.webkit.org/show_bug.cgi?id=98975

        Reviewed by Adam Barth.

        Renaming is needed to better match with the draggable region code.

        * Configurations/FeatureDefines.xcconfig:

2012-10-15  Dan Bernstein  <mitz@apple.com>

        WebKit/mac part of <rdar://problem/12470680> Font’s fast code path doesn’t support kerning and ligatures
        https://bugs.webkit.org/show_bug.cgi?id=99113

        Reviewed by Tim Horton.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Added wkCTFontTransformGlyphs.

2012-10-15  David Kilzer  <ddkilzer@apple.com>

        Move framework and library linking into WebKit.xcconfig
        <http://webkit.org/b/99284>

        Reviewed by Mark Rowe.

        * Configurations/WebKit.xcconfig: Move frameworks and libraries
        link flags to OTHER_LDFLAGS so that they work for iOS and OS X.

2012-10-14  Jon Lee  <jonlee@apple.com>

        Allow notification origin permission request when no js callback is provided
        https://bugs.webkit.org/show_bug.cgi?id=63615
        <rdar://problem/11059590>

        Reviewed by Sam Weinig.

        Introduce a boolean to determine whether the request was using the legacy or standard API. This way,
        we do not fall through to calling the standard API's callback if the legacy API's callback is null.

        * WebCoreSupport/WebNotificationClient.mm:
        (WebCore):
        (-[WebNotificationPolicyListener initWithVoidCallback:]):
        (-[WebNotificationPolicyListener allow]):
        (-[WebNotificationPolicyListener deny]):

2012-10-14  Sam Weinig  <sam@webkit.org>

        Make UserScript and UserStyleSheet value objects that are copyable
        https://bugs.webkit.org/show_bug.cgi?id=99275

        Reviewed by Tim Horton.

        * WebView/WebView.mm:
        (-[WebView _injectMailQuirksScript]):
        (-[WebView _injectOutlookQuirksScript]):
        Update for new PageGroup function signatures.

2012-10-10  Brady Eidson  <beidson@apple.com>

        Switch ResourceLoader::resourceData() from SharedBuffer to ResourceBuffer
        https://bugs.webkit.org/show_bug.cgi?id=98976

        Reviewed by Anders Carlsson.

        * WebView/WebDataSource.mm:
        (-[WebDataSource data]):

2012-10-10  Jer Noble  <jer.noble@apple.com>

        Disallow full screen mode keyboard access by default.
        https://bugs.webkit.org/show_bug.cgi?id=98971
        <rdar://problem/12474226>

        Reviewed by Sam Weinig.

        Only support full screen if keyboard access is not requested.

        * WebView/WebView.mm:
        (-[WebView _supportsFullScreenForElement:WebCore::withKeyboard:]):

2012-10-10  Jon Lee  <jonlee@apple.com>

        [WK2] Activate plugins when user clicks on snapshot
        https://bugs.webkit.org/show_bug.cgi?id=98328
        <rdar://problem/12426681>

        Reviewed by Brady Eidson.

        * WebCoreSupport/WebFrameLoaderClient.h:
        * WebCoreSupport/WebFrameLoaderClient.mm:
        (WebFrameLoaderClient::recreatePlugin): Stub implementation of recreatePlugin().

2012-10-10  Brady Eidson  <beidson@apple.com>

        Switch CachedResource over from SharedBuffer to a new ResourceBuffer
        https://bugs.webkit.org/show_bug.cgi?id=98541

        Reviewed by Anders Carlsson.

        * WebView/WebHTMLView.mm:
        (-[WebHTMLView namesOfPromisedFilesDroppedAtDestination:]):

2012-10-10  Simon Fraser  <simon.fraser@apple.com>

        Store a visible rect in GraphicsLayers, and optionally dump it in layerTreeAsText
        https://bugs.webkit.org/show_bug.cgi?id=98839

        Reviewed by Sam Weinig.

        To replace CATiledLayer with TileCaches, we need to be able to compute the visible part of a GraphicsLayer,
        in order to limit the extent of TileCache tiles. Reuse the existing code in GraphicsLayerCA for this,
        but store the computed rect in m_visibleRect.
        
        Add a flag to layerTreeAsText() so that tests can optionally include this visible rect in
        layer tree dumps. This output will be platform-specific, so we don't want to do it unconditionally.

        * WebView/WebFrame.mm:
        (-[WebFrame _layerTreeAsText]):

2012-10-09  Jian Li  <jianli@chromium.org>

        Update the CSS property used to support draggable regions.
        https://bugs.webkit.org/show_bug.cgi?id=97156

        Reviewed by Adam Barth.

        The CSS property to support draggable regions, guarded under
        WIDGET_REGION is now disabled from Mac WebKit, in order not to cause
        confusion with DASHBOARD_SUPPORT feature.

        Also update the code to use the new name annotatedRegions to work for
        both features.

        * Configurations/FeatureDefines.xcconfig: Disable WIDGET_REGION feature.
        * WebCoreSupport/WebChromeClient.h: Rename dashboardRegions to annotatedRegions.
        * WebCoreSupport/WebChromeClient.mm: Rename dashboardRegions to annotatedRegions.
        (WebChromeClient::annotatedRegionsChanged):
        * WebView/WebView.mm: Rename dashboardRegions to annotatedRegions.
        (-[WebView _dashboardRegions]):

2012-10-09  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r130811 and r130821.
        http://trac.webkit.org/changeset/130811
        http://trac.webkit.org/changeset/130821
        https://bugs.webkit.org/show_bug.cgi?id=98831

        Broke date-suggestion-picker-appearance-with-scroll-bar.html
        (Requested by abarth|gardening on #webkit).

        * WebView/WebFullScreenController.mm:
        (screenRectOfContents):
        * WebView/WebRenderNode.mm:
        (copyRenderNode):

2012-10-08  Kiran Muppala  <cmuppala@apple.com>

        Throttle DOM timers on hidden pages.
        https://bugs.webkit.org/show_bug.cgi?id=98474

        Reviewed by Maciej Stachowiak.

        Add HIDDEN_PAGE_DOM_TIMER_THROTTLING feature define and provide a SPI for
        DumpRenderTree to modify the visibility state of a page.  The latter
        is needed to test throttling of timers on hidden pages through DumpRenderTree.

        * Configurations/FeatureDefines.xcconfig:
        * WebView/WebView.mm:
        (-[WebView _setVisibilityState:isInitialState:]):
        * WebView/WebViewPrivate.h:

2012-10-07  Caio Marcelo de Oliveira Filho  <caio.oliveira@openbossa.org>

        Rename first/second to key/value in HashMap iterators
        https://bugs.webkit.org/show_bug.cgi?id=82784

        Reviewed by Eric Seidel.

        * History/WebHistory.mm:
        (-[WebHistoryPrivate removeItemFromDateCaches:]):
        (-[WebHistoryPrivate orderedLastVisitedDays]):
        (WebHistoryWriter::WebHistoryWriter):
        * Misc/WebCoreStatistics.mm:
        (+[WebCoreStatistics javaScriptProtectedObjectTypeCounts]):
        (+[WebCoreStatistics javaScriptObjectTypeCounts]):
        * Plugins/Hosted/NetscapePluginHostManager.mm:
        (WebKit::NetscapePluginHostManager::hostForPlugin):
        (WebKit::NetscapePluginHostManager::pluginHostDied):
        (WebKit::NetscapePluginHostManager::didCreateWindow):
        * Plugins/Hosted/NetscapePluginHostProxy.mm:
        (WebKit::NetscapePluginHostProxy::pluginHostDied):
        * Plugins/Hosted/NetscapePluginInstanceProxy.mm:
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::idForObject):
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::retain):
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::release):
        (WebKit::NetscapePluginInstanceProxy::LocalObjectMap::forget):
        (WebKit::NetscapePluginInstanceProxy::destroy):
        (WebKit::NetscapePluginInstanceProxy::webFrameDidFinishLoadWithReason):
        (WebKit::NetscapePluginInstanceProxy::cancelCheckIfAllowedToLoadURL):
        * Plugins/Hosted/ProxyInstance.mm:
        (WebKit::ProxyInstance::methodNamed):
        (WebKit::ProxyInstance::fieldNamed):
        * Plugins/WebNetscapePluginView.mm:
        (-[WebNetscapePluginView stopTimers]):
        (-[WebNetscapePluginView startTimers]):
        * WebCoreSupport/WebNotificationClient.mm:
        (WebNotificationClient::show):
        (WebNotificationClient::clearNotifications):
        (WebNotificationClient::notificationObjectDestroyed):
        * WebView/WebHTMLView.mm:
        (commandNameForSelector):

2012-10-06  Dan Bernstein  <mitz@apple.com>

        WebKit/mac part of <rdar://problem/12446507> [mac] WebKit clients cannot change the behavior of text-rendering: auto
        https://bugs.webkit.org/show_bug.cgi?id=98601

        Reviewed by Darin Adler.

        * WebView/WebView.mm:
        (+[WebView initialize]): Added a call to Font::setDefaultTypesettingFeatures() to enable
        kerning and ligatures if the WebKitKerningAndLigaturesEnabledByDefault user default key has
        the value YES.

2012-10-05  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r130556 and r130564.
        http://trac.webkit.org/changeset/130556
        http://trac.webkit.org/changeset/130564
        https://bugs.webkit.org/show_bug.cgi?id=98572

        The patch wasn't reviewed by a reviewer and it is breaking
        Chromium Windows (Requested by jchaffraix on #webkit).

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2012-10-05  Tim Horton  <timothy_horton@apple.com>

        [cg] GraphicsContextCG should ask CG whether the shadow offset workaround is required
        https://bugs.webkit.org/show_bug.cgi?id=98565
        <rdar://problem/12436468>

        Reviewed by Simon Fraser.

        Add wkCGContextDrawsWithCorrectShadowOffsets.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface):

2012-10-04  Eric Carlson  <eric.carlson@apple.com>

        Allow ports to override text track rendering style
        https://bugs.webkit.org/show_bug.cgi?id=97800
        <rdar://problem/12044964>

        Reviewed by Silvia Pfeiffer.

        Add WCSI support for new WKSI caption functions.

        * WebCoreSupport/WebSystemInterface.mm:
        (InitWebCoreSystemInterface): Initialize new WKSI function pointers.

2012-10-04  Jon Lee  <jonlee@apple.com>

        Add a setting to enable plugin snapshotting
        https://bugs.webkit.org/show_bug.cgi?id=98319
        <rdar://problem/12426480>

        Reviewed by Brady Eidson.

        Expose plugInSnapshottingEnabled preference to WebKit clients.

        * WebView/WebPreferenceKeysPrivate.h: Add WebKitPlugInSnapshottingEnabled key.
        * WebView/WebPreferences.mm:
        (+[WebPreferences initialize]): Setting is turned off by default.
        (-[WebPreferences plugInSnapshottingEnabled]):
        (-[WebPreferences setPlugInSnapshottingEnabled:]):
        * WebView/WebPreferencesPrivate.h:
        * WebView/WebView.mm:
        (-[WebView _preferencesChanged:]): Update settings based on preference.

2012-10-04  Rik Cabanier  <cabanier@adobe.com>

        Turn Compositing on by default in WebKit build
        https://bugs.webkit.org/show_bug.cgi?id=98315

        Reviewed by Simon Fraser.

        enable -webkit-blend-mode on trunk.

        * Configurations/FeatureDefines.xcconfig:

2012-10-04  Simon Fraser  <simon.fraser@apple.com>

        Final part of "sync" to "flush" renaming
        https://bugs.webkit.org/show_bug.cgi?id=98430

        Reviewed by Tim Horton.

        Change method names on GraphicsLayer and GraphicsLayerClient that
        refer to "sync" to use the term "flush" instead, to be consistent
        with the rest of the code.

        * WebView/WebView.mm:

2012-10-03  Benjamin Poulain  <bpoulain@apple.com>

        [WK2] Support all attributes of GeolocationPosition
        https://bugs.webkit.org/show_bug.cgi?id=98212

        Reviewed by Sam Weinig.

        Add an internal constructor for the sake of testing.
        A similar API is used on iOS.

        * WebView/WebGeolocationPosition.mm:
        (-[WebGeolocationPosition initWithGeolocationPosition:]):

2012-10-04  Simon Fraser  <simon.fraser@apple.com>

        Standardize on "flush" terminology for compositing layer flushing/syncing
        https://bugs.webkit.org/show_bug.cgi?id=98321

        Reviewed by Simon Fraser.

        Rename compositing-related methods that refer to "syncing" to instead
        refer to "flushing".

        * WebCoreSupport/WebChromeClient.h:
        * WebCoreSupport/WebChromeClient.mm:
        (WebChromeClient::scheduleCompositingLayerFlush):
        * WebView/WebView.mm:
        (-[WebView _flushCompositingChanges]):
        (LayerFlushController::flushLayers):
        (-[WebView _scheduleCompositingLayerFlush]):
        * WebView/WebViewInternal.h:

== Rolled over to ChangeLog-2012-10-02 ==
