2012-09-19  David Grogan  <dgrogan@chromium.org>

        Disable some failing IDB tests
        https://bugs.webkit.org/show_bug.cgi?id=97135

        Reviewed by Nate Chapin.

        They were broken in r129037.

        * tests/IDBDatabaseBackendTest.cpp:

2012-09-19  Alpha Lam  <hclam@chromium.org>

        [chromium] Unreviewed. Build fix.

        Not building WebImageTest.cpp for component build.

        * WebKit.gyp:

2012-09-19  Alpha Lam  <hclam@chromium.org>

        [chromium] WebImage should use ImageDecoder directly
        https://bugs.webkit.org/show_bug.cgi?id=96135

        Reviewed by Adam Barth.

        This patch is for preparation of deferred image decoding.
        ImageSource will be used as a portal to access deferred image decoder
        by BitmapImage, it should not be accessible through WebKit APIs.

        WebImage now calls ImageDecoder directly which is the actual
        implementation of an image decoder.

        Tests: WebImageTest.PNGImage
               WebImageTest.ICOImage
               WebImageTest.BadImage

        * WebKit.gypi:
        * src/WebImageSkia.cpp:
        (WebKit::WebImage::fromData):
        (WebKit::WebImage::framesFromData):
        * tests/WebImageTest.cpp: Added.
        (WebKit):
        (WebKit::readFile):
        (WebKit::TEST):
        * tests/data/black-and-white.ico: Added.
        * tests/data/white-1x1.png: Added.

2012-09-19  Oli Lan  <olilan@chromium.org>

        [chromium] Add a method didHandleGestureEvent to WebViewClient, called from WebViewImpl::handleGestureEvent.
        https://bugs.webkit.org/show_bug.cgi?id=96112

        Reviewed by Adam Barth.

        Adds a new method didHandleGestureEvent to WebViewClient, called from WebViewImpl::handleGestureEvent.

        This will be used by the Android port to implement platform-specific gesture behaviour.

        This is tested by the new test WebViewTest.ClientTapHandlers.

        * public/WebViewClient.h:
        (WebViewClient):
        (WebKit::WebViewClient::didHandleGestureEvent):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        * tests/WebViewTest.cpp:

2012-09-19  Robert Flack  <flackr@chromium.org>

        [chromium] Support high DPI scroll bar on top level web frame.
        https://bugs.webkit.org/show_bug.cgi?id=95134

        Reviewed by Adrienne Walker.

        Calls setAppliesPageScale(true) on root scrollbar layers as these are not scaled.

        * src/NonCompositedContentHost.cpp:
        (WebKit::setScrollbarBoundsContainPageScale):
        (WebKit):
        (WebKit::NonCompositedContentHost::setViewport):

2012-09-19  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move notifyJSOutOfMemory out of PlatformSupport
        https://bugs.webkit.org/show_bug.cgi?id=97116

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.
        
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::didExhaustMemoryAvailableForScript):
        (WebKit):
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):
        * src/PlatformSupport.cpp:
        (WebCore):

2012-09-19  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Remove unused popupsAllowed function from PlatformSupport
        https://bugs.webkit.org/show_bug.cgi?id=96521

        Reviewed by Eric Seidel.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-09-19  Kent Tamura  <tkent@chromium.org>

        [Chromium] Fix crash in WebFrameImpl::loadHistoryItem
        https://bugs.webkit.org/show_bug.cgi?id=96352

        Reviewed by Adam Barth.

        We have some crash reports with the following stack:
          - HistoryItem::shouldDoSameDocumentNavigationTo.
          - WebFrameImpl::loadHistoryItem
          ...

        We don't have reproducible steps, and not sure what's the root
        cause. Anyway we should check nullness of currentItem because
        HistoryController::m_currentItem can be 0.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::loadHistoryItem):
        Check nullness of currentItem.

2012-09-18  Sailesh Agrawal  <sail@chromium.org>

        Chromium: Scrollbar with tickmarks doesn't respond to clicks
        https://bugs.webkit.org/show_bug.cgi?id=96049

        Reviewed by Beth Dakin.

        Pipe isAlphaLocked and setIsAlphaLocked.

        * src/WebPluginScrollbarImpl.cpp:
        (WebKit::WebPluginScrollbarImpl::isAlphaLocked):
        (WebKit):
        (WebKit::WebPluginScrollbarImpl::setIsAlphaLocked):
        * src/WebPluginScrollbarImpl.h:
        (WebPluginScrollbarImpl):
        * src/WebScrollbarThemeClientImpl.cpp:
        (WebKit::WebScrollbarThemeClientImpl::isAlphaLocked):
        (WebKit):
        (WebKit::WebScrollbarThemeClientImpl::setIsAlphaLocked):
        * src/WebScrollbarThemeClientImpl.h:
        (WebScrollbarThemeClientImpl):
        * tests/ScrollbarLayerChromiumTest.cpp:

2012-09-18  Alpha Lam  <hclam@chromium.org>

        Unreviewed, rolling out r128939.
        http://trac.webkit.org/changeset/128939
        https://bugs.webkit.org/show_bug.cgi?id=96135

        Failing test_shell_tests.

        * WebKit.gypi:
        * src/WebImageSkia.cpp:
        (WebKit::WebImage::fromData):
        (WebKit::WebImage::framesFromData):
        * tests/WebImageTest.cpp: Removed.
        * tests/data/black-and-white.ico: Removed.
        * tests/data/white-1x1.png: Removed.

2012-09-18  Alpha Lam  <hclam@chromium.org>

        [chromium] WebImage should use ImageDecoder directly
        https://bugs.webkit.org/show_bug.cgi?id=96135

        Reviewed by Adam Barth.

        This patch is for preparation of deferred image decoding.
        ImageSource will be used as a portal to access deferred image decoder
        by BitmapImage, it should not be accessible through WebKit APIs.

        WebImage now calls ImageDecoder directly which is the actual
        implementation of an image decoder.

        Tests: WebImageTest.PNGImage
               WebImageTest.ICOImage

        * WebKit.gypi:
        * src/WebImageSkia.cpp:
        (WebKit::WebImage::fromData):
        (WebKit::WebImage::framesFromData):
        * tests/WebImageTest.cpp: Added.
        (WebKit):
        (WebKit::readFile):
        (WebKit::TEST):
        * tests/data/black-and-white.ico: Added.
        * tests/data/white-1x1.png: Added.

2012-09-18  Tommy Widenflycht  <tommyw@google.com>

        MediaStream API: Create a flag to enable PeerConnection00
        https://bugs.webkit.org/show_bug.cgi?id=96989

        Reviewed by Adam Barth.

        Adding the functionality to separately enable/disable PeerConnection00.
        For now it is enabled by default.

        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures):
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableDeprecatedPeerConnection):
        (WebKit):
        (WebKit::WebRuntimeFeatures::isDeprecatedPeerConnectionEnabled):

2012-09-18  Iain Merrick  <husky@google.com>

        [Chromium] Merge moveSelectionStart, moveSelectionEnd, and moveCaret into selectRange
        https://bugs.webkit.org/show_bug.cgi?id=96508

        Reviewed by Ryosuke Niwa.

        These methods had "start" and "end" parameters, but this is incorrect.
        selectRange() actually takes base and extent (where the user actually
        touched), and selectionBounds() returns anchor and focus (base and extent
        expanded to account for the selection granularity).

        This patch fixes the parameter names, and updates selectRange, its test
        and its documentation to reflect the correct usage. It also removes
        moveSelectionStart/moveSelectionEnd/moveCaret (which aren't being used
        yet), and updates WebFrameTest to show how these can be implemented via
        selectRange.

        * public/WebFrame.h:
        (WebFrame):
        * public/WebWidget.h:
        (WebWidget):
        (WebKit::WebWidget::selectionBounds):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::selectRange):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::selectionBounds):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/WebFrameTest.cpp:

2012-09-18  Terry Anderson  <tdanderson@chromium.org>

        Roll chromium DEPS to r157342
        https://bugs.webkit.org/show_bug.cgi?id=96963

        Reviewed by Stephen White.

        Roll chromium DEPS to r157342. Also include the top-level directory 
        google_apis as a dependency, which was required for r157130.

        * DEPS:

2012-09-17  Brian Anderson  <brianderson@chromium.org>

        [chromium] Add rendering commit statistics
        https://bugs.webkit.org/show_bug.cgi?id=96938

        Reviewed by James Robinson.

        Adds total commit time and total commit count to WebRenderingStats.
        Allows us to caculate average commit time in performance tests.

        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::renderingStats):

2012-09-17  James Robinson  <jamesr@chromium.org>

        [chromium] Move a FilterOperationsTest and WebInputEventConversionTest back to webkit_unittest_files variable
        https://bugs.webkit.org/show_bug.cgi?id=96964

        Reviewed by Adrienne Walker.

        These targets are really webkit unit tests and shouldn't be guarded by use_libcc_for_compositor.

        * WebKit.gypi:

2012-09-17  Rick Byers  <rbyers@chromium.org>

        Send GestureTapDownCancel to WebCore
        https://bugs.webkit.org/show_bug.cgi?id=96060

        Reviewed by Antonio Gomes.

        Plumb WebInputEvent::GetsureTapCancel to
        PlatformInputEvent::GestureTapDownCancel.  After all the chromium code
        was landed, it was suggested that 'TapDownCancel' was a better name
        than 'TapCancel' since you can't cancel a Tap.  I'm not changing the
        WebInputEvent definition here because that would be a breaking change
        to chromium, but I can do that as a series of follow-up CLs.
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::handleInputEvent):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):

2012-09-17  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Use ScriptValue instead of SerializedScriptValue for get/openCursor
        https://bugs.webkit.org/show_bug.cgi?id=95409

        Reviewed by Kentaro Hara.

        This removes a bunch of tests that have been migrated to
        LayoutTests, in https://bugs.webkit.org/show_bug.cgi?id=96818.

        * tests/IDBBindingUtilitiesTest.cpp:
        (WebCore::checkKeyFromValueAndKeyPathInternal):
        (WebCore::checkKeyPathNullValue):
        (WebCore::injectKey):
        (WebCore::checkInjection):
        (WebCore::checkInjectionFails):
        (WebCore::checkKeyPathStringValue):
        (WebCore::checkKeyPathNumberValue):
        (WebCore::TEST):
        * tests/IDBKeyPathTest.cpp:

2012-09-17  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Fix cases where find-in-page doesn't send a final update
        https://bugs.webkit.org/show_bug.cgi?id=96402

        Fix some issues in the WebKit implementation that prevented to send a final
        reportFindInPageMatchCount message.

        Reviewed by Adam Barth.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::scopeStringMatches):
        (WebKit):
        (WebKit::WebFrameImpl::finishCurrentScopingEffort):
        (WebKit::WebFrameImpl::cancelPendingScopingEffort):
        (WebKit::WebFrameImpl::WebFrameImpl):
        (WebKit::WebFrameImpl::shouldScopeMatches):
        * src/WebFrameImpl.h:

2012-09-17  Joshua Bell  <jsbell@chromium.org>

        [Chromium] IndexedDB: Remove legacy two-phase open() API members
        https://bugs.webkit.org/show_bug.cgi?id=96802

        Reviewed by Tony Chang.

        Following http://webkit.org/b/90411 and subsequent cleanup on the Chromium side,
        these entry points are no longer needed.

        * public/WebIDBDatabase.h: Delete old second-phase open(db-callbacks)
        * public/WebIDBFactory.h: Delete old first-phase open() w/o db-callbacks
        * src/WebIDBDatabaseImpl.cpp: No longer need to account for a close between phases.
        (WebKit::WebIDBDatabaseImpl::WebIDBDatabaseImpl):
        (WebKit::WebIDBDatabaseImpl::close):
        (WebKit::WebIDBDatabaseImpl::forceClose):
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):

2012-09-17  Ilya Tikhonovsky  <loislo@chromium.org>

        Unreviewed. Temporary disable visited set counter check.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::TEST):

2012-09-17  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: now when we can detect instrumented classes we can
        remove addInstrumentedMember and use addMember for everything.
        https://bugs.webkit.org/show_bug.cgi?id=96913

        Reviewed by Yury Semikhatsky.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::InstrumentedDOM::reportMemoryUsage):
        (WebCore::NonVirtualInstrumented::reportMemoryUsage):
        (WebCore::InstrumentedOwner::reportMemoryUsage):

2012-09-17  Ilya Tikhonovsky  <loislo@chromium.org>

        Unreviewed single line fix for mac chromium canary bot.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::TEST):

2012-09-15  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: automatically detect if class has reportMemoryUsage method
        https://bugs.webkit.org/show_bug.cgi?id=96756

        Reviewed by Alexander Pavlov.

        Test that reportMemoryUsage method will be called on the instrumented object
        even if it is a template.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore):
        (InstrumentedTemplate):
        (WebCore::InstrumentedTemplate::InstrumentedTemplate):
        (WebCore::InstrumentedTemplate::reportMemoryUsage):
        (WebCore::TEST):

2012-09-14  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: OwnPtr and RefPtr reported by pointer can be double counted by the memory instrumentation
        https://bugs.webkit.org/show_bug.cgi?id=96791

        Reviewed by Alexander Pavlov.

        Test that pointers to RefPtr and OwnPtr won't be double counted by
        the memory instrumentation.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore):
        (TwoPointersToRefPtr):
        (WebCore::TwoPointersToRefPtr::TwoPointersToRefPtr):
        (WebCore::TwoPointersToRefPtr::reportMemoryUsage):
        (WebCore::TEST):
        (TwoPointersToOwnPtr):
        (WebCore::TwoPointersToOwnPtr::TwoPointersToOwnPtr):
        (WebCore::TwoPointersToOwnPtr::reportMemoryUsage):

2012-09-16  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-14  Julien Chaffraix  <jchaffraix@webkit.org>

        Revert r127457 and following fixes due to several hit-testing regressions
        https://bugs.webkit.org/show_bug.cgi?id=96830

        Reviewed by Antonio Gomes.

        This change reverts r127457, r127863 and r128505.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):

2012-09-14  Ojan Vafai  <ojan@chromium.org>

        Provide a runtime setting to disable position:sticky
        https://bugs.webkit.org/show_bug.cgi?id=96827

        Reviewed by James Robinson.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setCSSStickyPositionEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-09-14  Adam Barth  <abarth@webkit.org>

        Remove webkitPostMessage
        https://bugs.webkit.org/show_bug.cgi?id=96577

        Reviewed by Ojan Vafai.

        Add ENABLE_LEGACY_VENDOR_PREFIXES flag.

        * features.gypi:

2012-09-14  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-14  Rick Byers  <rbyers@chromium.org>

        [chromium] add touch area to gestureTapDown data
        https://bugs.webkit.org/show_bug.cgi?id=96806

        Reviewed by Adam Barth.

        Add width/height for GestureTapDown as for GestureTap/LongPress so that
        we can eventually do fuzzing on it.
        * public/WebInputEvent.h:
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):

2012-09-14  Peter Beverloo  <peter@chromium.org>

        [Chromium] Support the --{in,out,err}-fifo arguments on TestWebKitAPI and webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=96687

        Reviewed by Tony Chang.

        Android's DumpRenderTree currently supports these arguments, implemented
        as part of TestShellAndroid:
        http://trac.webkit.org/browser/trunk/Tools/DumpRenderTree/chromium/TestShellAndroid.cpp?rev=128496

        They're used by the layout test runner to get the STDOUT and STDERR while
        a layout test run is in process, which is a safer alternative to parsing
        all the logcat output manually. The implementation can be seen here:
        http://trac.webkit.org/browser/trunk/Tools/Scripts/webkitpy/layout_tests/port/chromium_android.py?rev=128496#L590

        This patch generalizes parsing of and applying the effects of these arguments
        so that they can be used for TestWebKitAPI and webkit_unit_tests as well.
        After this patch, this will make it possible to pull out the output-reading
        code from Android's layout test port and generalize it so it can be re-used
        in the new test-runner for the other two test suites.

        This has no effect when compiling and running these tests as part of Chromium
        code, which has a much more advanced test-runner that does parse complete log
        output, but also directly depends on code licensed under Apache 2.

        * WebKit.gypi:
        * tests/ForwardIOStreamsAndroid.cpp: Added.
        (WebKit):
        (WebKit::maybeInitIOStreamForwardingForAndroid):
        * tests/ForwardIOStreamsAndroid.h: Added.
        (WebKit):
        * tests/RunAllTests.cpp:
        (main):

2012-09-14  Keishi Hattori  <keishi@webkit.org>

        Make time input lang attribute aware for testing
        https://bugs.webkit.org/show_bug.cgi?id=96728

        Reviewed by Kent Tamura.

        * tests/LocalizedDateICUTest.cpp:
        (LocalizedDateICUTest::localizedDateFormatText):
        (LocalizedDateICUTest::localizedShortDateFormatText):

2012-09-14  Keishi Hattori  <keishi@webkit.org>

        Refactor time format related methods on LocaleWin/Mac/ICU so that they override Localizer methods
        https://bugs.webkit.org/show_bug.cgi?id=96726

        Reviewed by Kent Tamura.

        * tests/LocaleMacTest.cpp:
        (LocaleMacTest::timeFormat):
        (LocaleMacTest::shortTimeFormat):
        (TEST_F):
        * tests/LocaleWinTest.cpp:
        (LocaleWinTest::timeFormat):
        (LocaleWinTest::shortTimeFormat):
        (TEST_F):
        * tests/LocalizedDateICUTest.cpp:
        (LocalizedDateICUTest::localizedDateFormatText):
        (LocalizedDateICUTest::localizedShortDateFormatText):

2012-09-14  Keishi Hattori  <keishi@webkit.org>

        LocaleMac should fallback to defaultLanguage for an invalid locale
        https://bugs.webkit.org/show_bug.cgi?id=96744

        Reviewed by Kent Tamura.

        * tests/LocaleMacTest.cpp:
        (TEST_F):

2012-09-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r128543.
        http://trac.webkit.org/changeset/128543
        https://bugs.webkit.org/show_bug.cgi?id=96722

        Caused LocaleWinTest.localizedNumberRoundTrip to fail
        (Requested by keishi on #webkit).

        * tests/LocaleWinTest.cpp:
        (testNumberIsReversible):
        (testNumbers):
        (TEST_F):

2012-09-13  Keishi Hattori  <keishi@webkit.org>

        Create Localizer factory method for LocaleWin
        https://bugs.webkit.org/show_bug.cgi?id=96667

        Reviewed by Kent Tamura.

        * tests/LocaleWinTest.cpp:
        (testNumberIsReversible):
        (testNumbers):

2012-09-13  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Consolidate two-phase connection to avoid race conditions
        https://bugs.webkit.org/show_bug.cgi?id=90411

        Reviewed by Tony Chang.

        API plumbing for simplified single-phase connection opening, and tests updated
        to exercise the new APIs.

        * public/WebIDBDatabase.h:
        (WebIDBDatabase): Just a FIXME to remove the old second-phase hookup API.
        * public/WebIDBFactory.h:
        (WebKit):
        (WebIDBFactory):
        (WebKit::WebIDBFactory::open): New overload that takes db-callbacks.
        * src/IDBCallbacksProxy.cpp: The db-callbacks plumbing is needed earlier.
        (WebKit::IDBCallbacksProxy::onSuccess):
        (WebKit::IDBCallbacksProxy::onUpgradeNeeded):
        (WebKit):
        (WebKit::IDBCallbacksProxy::setDatabaseCallbacks): Needs to hold on to
        the db-callbacks and hook it up when the onSuccess callback comes through.
        * src/IDBCallbacksProxy.h:
        (WebKit):
        (IDBCallbacksProxy):
        * src/IDBDatabaseBackendProxy.cpp:
        * src/IDBDatabaseBackendProxy.h:
        (IDBDatabaseBackendProxy):
        * src/IDBFactoryBackendProxy.cpp:
        (WebKit::IDBFactoryBackendProxy::open):
        * src/IDBFactoryBackendProxy.h:
        (IDBFactoryBackendProxy):
        * src/WebIDBDatabaseImpl.cpp:
        (WebKit::WebIDBDatabaseImpl::WebIDBDatabaseImpl):
        (WebKit::WebIDBDatabaseImpl::close):
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):
        * src/WebIDBFactoryImpl.cpp:
        (WebKit::WebIDBFactoryImpl::open):
        * src/WebIDBFactoryImpl.h:
        (WebIDBFactoryImpl):
        * tests/IDBAbortOnCorruptTest.cpp:
        (FakeIDBDatabaseCallbacks):
        (WebCore::FakeIDBDatabaseCallbacks::create):
        (WebCore::FakeIDBDatabaseCallbacks::~FakeIDBDatabaseCallbacks):
        (WebCore::FakeIDBDatabaseCallbacks::FakeIDBDatabaseCallbacks):
        (WebCore):
        (WebCore::TEST): Updated connection sequence.
        * tests/IDBDatabaseBackendTest.cpp: Ditto.

2012-09-13  James Robinson  <jamesr@chromium.org>

        PlatformGestureCurveTest compile fix pt 2

        * tests/PlatformGestureCurveTest.cpp:

2012-09-13  James Robinson  <jamesr@chromium.org>

        Fix compile warning/error on windows - literal that isn't exactly representable as a float needs "f" suffix.

        * tests/PlatformGestureCurveTest.cpp:

2012-09-13  Julien Chaffraix  <jchaffraix@webkit.org>

        [Chromium] REGRESSION(r127457): Context menu on textarea is displayed in the wrong place
        https://bugs.webkit.org/show_bug.cgi?id=96593

        Reviewed by Adam Barth.

        After r127457, the HitTestResult stored in ContextMenuController is in window coordinates.
        Trying to convert it again to window coordinates will result in adding the containing frame's
        position twice, thus the wrong placing.

        Chromium Mac wasn't impacted by the regression and I manually checked that the fix doesn't impact Mac.

        Unfortunately, no test as I don't think we have a way of testing context menu position.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):

2012-09-13  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] alter fling animation parameters.
        https://bugs.webkit.org/show_bug.cgi?id=96666

        Reviewed by Adrienne Walker.

        Corrected the test to be non-fragile in the presence of altered fling
        curve parameters.

        * tests/PlatformGestureCurveTest.cpp:

2012-09-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r128489.
        http://trac.webkit.org/changeset/128489
        https://bugs.webkit.org/show_bug.cgi?id=96686

        Does not compile on windows (Requested by jamesr on #webkit).

        * public/WebIDBDatabase.h:
        * public/WebIDBFactory.h:
        (WebIDBFactory):
        * src/IDBCallbacksProxy.cpp:
        (WebKit::IDBCallbacksProxy::onSuccess):
        (WebKit::IDBCallbacksProxy::onUpgradeNeeded):
        * src/IDBCallbacksProxy.h:
        (WebKit):
        (IDBCallbacksProxy):
        * src/IDBDatabaseBackendProxy.cpp:
        (WebKit::IDBDatabaseBackendProxy::registerFrontendCallbacks):
        (WebKit):
        * src/IDBDatabaseBackendProxy.h:
        (IDBDatabaseBackendProxy):
        * src/IDBFactoryBackendProxy.cpp:
        (WebKit::IDBFactoryBackendProxy::open):
        * src/IDBFactoryBackendProxy.h:
        (IDBFactoryBackendProxy):
        * src/WebIDBDatabaseImpl.cpp:
        (WebKit::WebIDBDatabaseImpl::WebIDBDatabaseImpl):
        (WebKit::WebIDBDatabaseImpl::close):
        (WebKit::WebIDBDatabaseImpl::open):
        (WebKit):
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):
        * src/WebIDBFactoryImpl.cpp:
        (WebKit::WebIDBFactoryImpl::open):
        * src/WebIDBFactoryImpl.h:
        (WebIDBFactoryImpl):
        * tests/IDBAbortOnCorruptTest.cpp:
        (WebCore::TEST):
        * tests/IDBDatabaseBackendTest.cpp:

2012-09-13  Glenn Hartmann  <hartmanng@chromium.org>

        Add new accelerated compositing for overflow scroll setting.
        https://bugs.webkit.org/show_bug.cgi?id=95885

        Reviewed by James Robinson.

        wkb.ug/91117 introduces RenderLayer::usesCompositedScrolling(), which
        currently returns true if we're overflow scrolling and the element has
        been styled with '-webkit-overflow-scrolling: touch'. If this is true,
        we get promoted to a composited layer, the associated RenderLayerBacking
        gets special scrolling layers and in response to RenderLayer::scrollTo()
        we no longer have to invalidate everything to get the scrolled content
        in the right spot, thereby avoiding very expensive repaints. It's
        unfortunate that we require -webkit-overflow-scrolling: touch, though.
        It would be nice if RenderLayer::usesCompositedScrolling() returned true
        if the page would continue to behave correctly.  This is what
        wkb.ug/94743 is intended to do.  Unfortunately, when we become a
        composited layer, we switch from subpixel to grayscale anti-aliasing. We
        only want to auto-opt into composited scrolling if we don't mind the
        change in anti-aliasing, so we need a flag to enable/disable this
        feature.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setAcceleratedCompositingForOverflowScrollEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-09-13  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Consolidate two-phase connection to avoid race conditions
        https://bugs.webkit.org/show_bug.cgi?id=90411

        Reviewed by Tony Chang.

        API plumbing for simplified single-phase connection opening, and tests updated
        to exercise the new APIs.

        * public/WebIDBDatabase.h:
        (WebIDBDatabase): Just a FIXME to remove the old second-phase hookup API.
        * public/WebIDBFactory.h:
        (WebKit):
        (WebIDBFactory):
        (WebKit::WebIDBFactory::open): New overload that takes db-callbacks.
        * src/IDBCallbacksProxy.cpp: The db-callbacks plumbing is needed earlier.
        (WebKit::IDBCallbacksProxy::onSuccess):
        (WebKit::IDBCallbacksProxy::onUpgradeNeeded):
        (WebKit):
        (WebKit::IDBCallbacksProxy::setDatabaseCallbacks): Needs to hold on to
        the db-callbacks and hook it up when the onSuccess callback comes through.
        * src/IDBCallbacksProxy.h:
        (WebKit):
        (IDBCallbacksProxy):
        * src/IDBDatabaseBackendProxy.cpp:
        * src/IDBDatabaseBackendProxy.h:
        (IDBDatabaseBackendProxy):
        * src/IDBFactoryBackendProxy.cpp:
        (WebKit::IDBFactoryBackendProxy::open):
        * src/IDBFactoryBackendProxy.h:
        (IDBFactoryBackendProxy):
        * src/WebIDBDatabaseImpl.cpp:
        (WebKit::WebIDBDatabaseImpl::WebIDBDatabaseImpl):
        (WebKit::WebIDBDatabaseImpl::close):
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):
        * src/WebIDBFactoryImpl.cpp:
        (WebKit::WebIDBFactoryImpl::open):
        * src/WebIDBFactoryImpl.h:
        (WebIDBFactoryImpl):
        * tests/IDBAbortOnCorruptTest.cpp:
        (FakeIDBDatabaseCallbacks):
        (WebCore::FakeIDBDatabaseCallbacks::create):
        (WebCore::FakeIDBDatabaseCallbacks::~FakeIDBDatabaseCallbacks):
        (WebCore::FakeIDBDatabaseCallbacks::FakeIDBDatabaseCallbacks):
        (WebCore):
        (WebCore::TEST): Updated connection sequence.
        * tests/IDBDatabaseBackendTest.cpp: Ditto.

2012-09-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-13  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: instrument KURL directly.
        https://bugs.webkit.org/show_bug.cgi?id=96624

        Reviewed by Yury Semikhatsky.

        I replaced traits based instrumentation of KURL with reportMemoryUsage functions.
        CString* were also instrumented.

        Drive by fix: Instrumentation code in QualifiedName was moved to cpp.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore):
        (InstrumentedOwner):
        (WebCore::InstrumentedOwner::InstrumentedOwner):
        (WebCore::InstrumentedOwner::reportMemoryUsage):
        (WebCore::TEST):

2012-09-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r128409.
        http://trac.webkit.org/changeset/128409
        https://bugs.webkit.org/show_bug.cgi?id=96622

        It broke Chromium browser_tests (Requested by tkent on
        #webkit).

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::scopeStringMatches):
        (WebKit::WebFrameImpl::shouldScopeMatches):

2012-09-13  Taiju Tsuiki  <tzik@chromium.org>

        Check if WorkerContext is terminated in WebWorkerClientImple::openFileSystem call.
        https://bugs.webkit.org/show_bug.cgi?id=96601

        Reviewed by Kent Tamura.

        m_webFrame might be already deleted after terminateWorkerContext call.
        This patch ensure it be NULL and change to avoid using it.

        Test: fast/filesystem/workers/detached-frame-crash.html

        * src/WebWorkerClientImpl.cpp:
        (WebKit::WebWorkerClientImpl::terminateWorkerContext):
        (WebKit::WebWorkerClientImpl::openFileSystem):

2012-09-12  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Fix cases where find-in-page doesn't send a final update
        https://bugs.webkit.org/show_bug.cgi?id=96402

        Fix some issues in the WebKit implementation that prevented to send a final
        reportFindInPageMatchCount message.

        Reviewed by Adam Barth.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::scopeStringMatches):
        (WebKit::WebFrameImpl::shouldScopeMatches):

2012-09-12  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r127876.
        http://trac.webkit.org/changeset/127876
        https://bugs.webkit.org/show_bug.cgi?id=96600

        mouse click doesn't work for spin button if spin button in
        iframe (Requested by yosin on #webkit).

        * src/ContextMenuClientImpl.cpp:
        (WebKit::selectMisspelledWord):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::dispatchDecidePolicyForNavigationAction):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::characterIndexForPoint):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::isRectTopmost):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleMouseUp):
        (WebKit::WebViewImpl::computeBlockBounds):

2012-09-12  Rick Byers  <rbyers@chromium.org>

        [chromium] Remove unused WebGestureEvent fields
        https://bugs.webkit.org/show_bug.cgi?id=95496

        Reviewed by Adam Barth.

        Remove the no-longer used fields from WebGestureEvent, now that
        chromium has been updated to use the per-event-type fields instead.
        This depends on crrev.com/156346 in chromium.

        * public/WebInputEvent.h:
        (WebKit::WebGestureEvent::WebGestureEvent):
        * public/android/WebInputEventFactory.h:
        * src/WebInputEvent.cpp:
        (SameSizeAsWebGestureEvent):
        * src/android/WebInputEventFactory.cpp:
        (WebKit):
        (WebKit::WebInputEventFactory::gestureEvent):

2012-09-12  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r128351.
        http://trac.webkit.org/changeset/128351
        https://bugs.webkit.org/show_bug.cgi?id=96573

        Broke FindInPage browser_tests (Requested by jamesr_ on
        #webkit).

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::scopeStringMatches):
        (WebKit::WebFrameImpl::cancelPendingScopingEffort):
        (WebKit::WebFrameImpl::setFindEndstateFocusAndSelection):
        (WebKit::WebFrameImpl::shouldScopeMatches):

2012-09-12  Adrienne Walker  <enne@google.com>

        [chromium] Fix search tickmarks not disappearing when compositing is enabled
        https://bugs.webkit.org/show_bug.cgi?id=96536

        Reviewed by James Robinson.

        view->invalidateRect() on the root frame just invalidates the
        contents, since WebViewImpl doesn't know anything about scrollbar
        layers. This causes an "InvalidateAll" to not actually invalidate the
        scrollbars.

        To fix this, make WebFrameImpl explicitly invalidate the
        scrollbars when required.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::invalidateArea):

2012-09-12  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Fix cases where find-in-page doesn't send a final update
        https://bugs.webkit.org/show_bug.cgi?id=96402

        Fix some issues in the WebKit implementation that prevented to send a final
        reportFindInPageMatchCount message. Also, fix a buggy reset of the active match
        when calling the stopFinding method.

        Reviewed by Adam Barth.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::scopeStringMatches):
        (WebKit::WebFrameImpl::cancelPendingScopingEffort):
        (WebKit::WebFrameImpl::setFindEndstateFocusAndSelection):
        (WebKit::WebFrameImpl::shouldScopeMatches):

2012-09-12  Sami Kyostila  <skyostil@google.com>

        Rename OVERFLOW_SCROLLING as ACCELERATED_OVERFLOW_SCROLLING
        https://bugs.webkit.org/show_bug.cgi?id=96251

        Reviewed by Simon Fraser.

        Rename OVERFLOW_SCROLLING as ACCELERATED_OVERFLOW_SCROLLING to better describe
        the feature it controls.

        * features.gypi:

2012-09-12  Christopher Cameron  <ccameron@chromium.org>

        [chromium] Evict textures through the texture manager instead of the resource provider
        https://bugs.webkit.org/show_bug.cgi?id=96463

        Reviewed by James Robinson.

        Update layer tree host impl test to include the extra interface functions
        added to CCLayerTreeHostImplClient.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-09-12  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI move String* instrumentation to wtf.
        https://bugs.webkit.org/show_bug.cgi?id=96405

        Reviewed by Yury Semikhatsky.

        This instrumentation is solving the problem with substrings and removes traits based code which is hard to upstream.

        Tested by webkit_unit_tests.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::TEST):

2012-09-12  Philippe Liard  <pliard@google.com>

        Depend on {base,net} GYP targets rather than {base,net}_java.
        https://bugs.webkit.org/show_bug.cgi?id=95690

        Reviewed by Adam Barth.

        {base,net}_java became 'private' targets on the Chromium side that
        clients should not depend on (see
        https://chromiumcodereview.appspot.com/10913083/).
        This also adds the missing 'chromium_net.jar' to |input_jars_paths|
        that was magically included in Chrome for Android downstream but not
        upstream. It's needed to register JNI for 'net' in webkit_unit_tests.


        * WebKitUnitTests.gyp:

2012-09-12  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r128279.
        http://trac.webkit.org/changeset/128279
        https://bugs.webkit.org/show_bug.cgi?id=96487

        "Snow Leopard compilation broken" (Requested by yurys on
        #webkit).

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::InstrumentedUndefined::reportMemoryUsage):
        (WebCore::TEST):

2012-09-12  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI move String* instrumentation to wtf.
        https://bugs.webkit.org/show_bug.cgi?id=96405

        Reviewed by Yury Semikhatsky.

        This instrumentation is solving the problem with substrings and removes traits based code which is hard to upstream.

        Tested by webkit_unit_tests.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::InstrumentedUndefined::reportMemoryUsage):
        (WebCore::TEST):

2012-09-12  Jochen Eisinger  <jochen@chromium.org>

        [chromium] consumable user gesture count off for input events
        https://bugs.webkit.org/show_bug.cgi?id=96373

        Reviewed by Adam Barth.

        Don't create a UserGestureIndicator in the chromium layer, as it will
        already be created by webcore's event handler. Creating multiple
        UserGestureIndicator objects for the same object would allow to execute
        multiple user-gesture-gated actions per user gesture such as opening a
        new window.

        * public/WebInputEvent.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleInputEvent):

2012-09-12  Alexandre Elias  <aelias@chromium.org>

        [chromium] Flip Y and swizzle inside compositeAndReadback implementation
        https://bugs.webkit.org/show_bug.cgi?id=96458

        Reviewed by James Robinson.

        Currently, compositeAndReadback API assumes a GL-style texture
        and is converted to the normal software format in WebViewImpl.
        For the software implementation, this API would result in two
        redundant conversions.  This patch makes the conversion inside
        CCRendererGL instead.  I rolled my own for loop as I didn't find the
        appropriate function within raw Skia.

        No new tests (covered by existing layout tests).

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::doPixelReadbackToCanvas):

2012-09-11  Taiju Tsuiki  <tzik@chromium.org>

        WebFrameImpl::client() needs NULL check in WebWorkerClientImpl::openFileSystem
        https://bugs.webkit.org/show_bug.cgi?id=96354

        Reviewed by Kent Tamura.

        Ensure non-NULL before using WebFrameImpl::client().

        Test: fast/filesystem/workers/detached-frame-crash.html

        * src/WebWorkerClientImpl.cpp:
        (WebKit::WebWorkerClientImpl::openFileSystem):

2012-09-11  Keishi Hattori  <keishi@webkit.org>

        Create Localizer factory method for LocaleICU
        https://bugs.webkit.org/show_bug.cgi?id=96363

        Reviewed by Kent Tamura.

        * tests/LocalizedNumberICUTest.cpp:
        (testNumberIsReversible):
        (testDecimalSeparator):

2012-09-11  Christopher Cameron  <ccameron@chromium.org>

        [chromium] Make prioritized texture manager not touch backings array on the main thread
        https://bugs.webkit.org/show_bug.cgi?id=96114

        Reviewed by James Robinson.

        Take a snapshot of the textures' priorities from the main thread,
        and save it in their backings for access by the impl thread.
        Update functions that access the sorted backings array to use the
        snapshotted values instead of the values that the main thread may
        have computed for the next frame.

        Make the main thread not touch the m_backings array.  Split
        prioritizeTextures into a updateBackingsPriorities function.
        In places where the main thread would have touched m_backings,
        set a flag specifying that m_backings needs to be re-sorted
        before any function that requires it be sorted by priority be
        executed.

        Update the two functions that require sorted order (acquireBacking
        and reduceMemory) to sort the backings array (if needed) before
        traversing it.

        Updated tests to set correct thread during asserts. Add a test to
        verify that requestLate is correctly incorporated into the backing
        sorting.

        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::CCPrioritizedTextureTest::validateTexture):

2012-09-11  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-11  Iain Merrick  <husky@chromium.org>

        [chromium] Fix double call to scrollBegin() when handling scroll gesture
        https://bugs.webkit.org/show_bug.cgi?id=95322

        Reviewed by James Robinson.

        WebCompositorInputHandlerImpl::handleGestureFling() calls scrollBegin() on its
        client, then if the result is ScrollStarted, it creates a PlatformGestureCurve
        object to handle the fling animation. This patch adds a matching scrollEnd()
        before the animation starts.

        Now using strict mocks in WebCompositorInputHandlerImplTest, which turns all
        unexpected calls into test failures. This ensures that scrollBegin / scrollEnd
        happen exactly when we want and at no other times.

        * src/WebCompositorInputHandlerImpl.cpp:
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):
        * tests/WebCompositorInputHandlerImplTest.cpp:
        (WebCompositorInputHandlerImplTest):
        (WebKit::TEST_F):

2012-09-11  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-11  Keishi Hattori  <keishi@webkit.org>

        Create Localizer factory method for LocaleMac
        https://bugs.webkit.org/show_bug.cgi?id=96355

        Reviewed by Kent Tamura.

        * tests/LocaleMacTest.cpp:
        (testNumberIsReversible): Use Localizer::create.
        (testNumbers):

2012-09-11  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r128150.
        http://trac.webkit.org/changeset/128150
        https://bugs.webkit.org/show_bug.cgi?id=96357

        it broke chromium compilation (Requested by loislo on
        #webkit).

        * DEPS:

2012-09-10  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-10  Joanmarie Diggs  <jdiggs@igalia.com>

        Properly expose <legend> elements to ATs
        https://bugs.webkit.org/show_bug.cgi?id=84137

        Reviewed by Chris Fleizach.

        Created a new WebCore Accessibility Role, LegendRole. Used it to map to
        the expected platform role, ATK_ROLE_LABEL. Also established the needed
        AtkRelation pair, label-for/labelled-by between the legend and fieldset.

        * public/WebAccessibilityRole.h: added WebAccessibilityRoleLegend
        * src/AssertMatchingEnums.cpp: added the assert matching rule for
        WebAccessibilityRoleLegend and LegendRole

2012-09-10  Beth Dakin  <bdakin@apple.com>

        https://bugs.webkit.org/show_bug.cgi?id=96158
        Need API to suppress scrollbar animations
        -and corresponding-
        <rdar://problem/12210972>

        Reviewed by Sam Weinig.

        ScrollableArea::isOnActivePage() has been re-named to
        ScrollableArea:: scrollbarsCanBeActive().
        * src/ScrollbarGroup.cpp:
        (WebKit::ScrollbarGroup::scrollbarsCanBeActive):
        * src/ScrollbarGroup.h:
        * tests/GraphicsLayerChromiumTest.cpp:
        * tests/ScrollAnimatorNoneTest.cpp:
        (MockScrollableArea):

2012-09-10  Dan Alcantara  <dfalcantara@chromium.org>

        [chromium, android] Reloading a page with a different user agent can cause the page to be zoomed in
        https://bugs.webkit.org/show_bug.cgi?id=90222

        Reviewed by Adam Barth.

        When reloading a page with an overridden URL, the page's scroll and zoom
        state will be restored once the reload is complete.  This is problematic
        in situations when switching between mobile and desktop versions of the
        same site because it will zoom back in on a random part of alternate page.
        This CL just avoids that situation by resetting the zoom and scale whenever
        this type of reload occurs.

        Chromium half: https://chromiumcodereview.appspot.com/10889019

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::resetScrollAndScaleState):
        (WebKit):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-09-10  Adam Barth  <abarth@chromium.org>

        [V8] V8AuxiliaryContext used by IDB leaks memory
        https://bugs.webkit.org/show_bug.cgi?id=96317

        Reviewed by Tony Chang.

        Call the V8 APIs directly instead of using a helper class.

        * tests/IDBBindingUtilitiesTest.cpp:
        (WebCore::TEST):

2012-09-10  Adam Barth  <abarth@chromium.org>

        [V8] Inline firstFrame and currentFrame into their unique callers
        https://bugs.webkit.org/show_bug.cgi?id=96309

        Reviewed by Eric Seidel.

        This patch just lines these WebCore functions because we only call them
        from here.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrame::frameForEnteredContext):
        (WebKit::WebFrame::frameForCurrentContext):

2012-09-10  Rick Byers  <rbyers@chromium.org>

        [chromium] Add unused GestureTapCancel
        https://bugs.webkit.org/show_bug.cgi?id=96183

        Reviewed by Adam Barth.

        This adds a new 'tap cancel' gesture type.  This is temporarily unused,
        so that we can change chromium to start sending the gesture type
        without breaking anything.

        * public/WebInputEvent.h:
        * src/PageWidgetDelegate.cpp:
        (WebKit::PageWidgetDelegate::handleInputEvent):
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::handleInputEvent):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):

2012-09-10  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Define new setSharedWorkerRepository function in preparation for removing WebKitPlatformSupport::sharedWorkerRepository()
        https://bugs.webkit.org/show_bug.cgi?id=95861

        Reviewed by Adam Barth.

        Followup patch to Chromium will call this new function, then we can remove all references to the legacy function on WebKitPlatformSupport.

        * public/WebSharedWorkerRepository.h:
        (WebKit):
        * src/SharedWorkerRepository.cpp:
        (WebKit):
        (WebKit::setSharedWorkerRepository):
        (WebKit::sharedWorkerRepository):
        (WebCore::SharedWorkerRepository::isAvailable):
        (WebCore::SharedWorkerRepository::connect):
        (WebCore::SharedWorkerRepository::documentDetached):
        (WebCore::SharedWorkerRepository::hasSharedWorkers):

2012-09-10  Catalin Badea  <badea@adobe.com>

        webkit build for 64-bit Mac chromium
        https://bugs.webkit.org/show_bug.cgi?id=95977

        Reviewed by Eric Seidel.

        Ensure header completeness and use the correct include order. This fixes a compilation issues noticeable when building chromium for 64-bit Mac. 

        * public/mac/WebSubstringUtil.h:
        * src/mac/WebSubstringUtil.mm:

2012-09-10  Adrienne Walker  <enne@google.com>

        [chromium] Fix deadlock between WebMediaPlayerClientImpl dtor and PutCurrentFrame
        https://bugs.webkit.org/show_bug.cgi?id=96010

        Reviewed by James Robinson.

        The key fix here is that the destructor no longer has a mutex.
        The m_compositingMutex was supposedly protecting races between
        ~WebMediaPlayerClientImpl and setVideoFrameProviderClient. The
        former is only called from the main thread and the latter is called
        from the compositor thread only when the main thread is blocked (and
        it already asserts that this is the case).

        In addition, the m_providerMutex in CCVideoLayerImpl prevents the
        destruction of WebMediaPlayerClientImpl, thus keeping the frame
        acquired via getCurrentFrame alive until putCurrentFrame is called.
        These functions are only called by the client, and comments are added
        to the interface to better document this.

        To prevent a race between load() and getCurrentFrame/putCurrentFrame
        (which are called from different threads) a new m_webMediaPlayerMutex
        to replace part of what the old m_compositingMutex was doing.

        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::~WebMediaPlayerClientImpl):
        (WebKit::WebMediaPlayerClientImpl::load):
        (WebKit::WebMediaPlayerClientImpl::loadInternal):
        (WebKit::WebMediaPlayerClientImpl::setVideoFrameProviderClient):
        (WebKit::WebMediaPlayerClientImpl::getCurrentFrame):
        (WebKit::WebMediaPlayerClientImpl::putCurrentFrame):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-09-10  Rick Byers  <rbyers@chromium.org>

        [chromium] Don't use WebGestureEvent.boundingBox for touch adjustment
        https://bugs.webkit.org/show_bug.cgi?id=95996

        Reviewed by Adam Barth.

        Switch from WebGestureEvent.boundingBox to new gesture-type specific
        data fields.
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):

2012-09-09  Keishi Hattori  <keishi@webkit.org>

        REGRESSION(r127558): Fix a crash in DateTimeChooserImpl::didClosePopup
        https://bugs.webkit.org/show_bug.cgi?id=96222

        Reviewed by Kent Tamura.

        DateTimeChooserClient will delete DateTimeChooserImpl inside didEndChooser()
        so we shouldn't be changing the members after that.

        Testing covered by fast/forms/date/calendar-picker-appearance-pre-100.html.

        * src/DateTimeChooserImpl.cpp:
        (WebKit::DateTimeChooserImpl::didClosePopup):

2012-09-09  Kenichi Ishibashi  <bashi@chromium.org>

        [Chromium] Unreviewed gardening after r127907

        Fix CCRenderPassTest::copyShouldBeIdenticalExceptIdAndQuads

        * tests/CCRenderPassTest.cpp:
        (CCRenderPassSize): Changed type of m_id

2012-09-09  Emil A Eklund  <eae@chromium.org>

        Rename Node::getRect/getPixelSnappedRect and remove ContainerNode::getRect
        https://bugs.webkit.org/show_bug.cgi?id=81413

        Reviewed by David Hyatt.

        Update WebViewImpl to call boundingBox/pixelSnappedBoundingBox.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::computeBlockBounds):
        (WebKit::WebViewImpl::applyAutofillSuggestions):
        (WebKit::WebViewImpl::refreshAutofillPopup):

2012-09-09  James Robinson  <jamesr@chromium.org>

        [chromium] webkit_platform should only be linked into the webkit target
        https://bugs.webkit.org/show_bug.cgi?id=96213

        Reviewed by Adrienne Walker.

        The Platform.gyp:webkit_platform target provides the implementation of several WEBKIT_EXPORTed symbols. It only
        makes sense as a target of WebKit.gyp:webkit, other targets shouldn't directly depend on it.

        * WebKit.gyp:

2012-09-09  James Robinson  <jamesr@chromium.org>

        [chromium] Use WebCompositorSupport creation functions in GraphicsLayerChromiumTest
        https://bugs.webkit.org/show_bug.cgi?id=96212

        Reviewed by Adrienne Walker.

        The static ::create()s the test references currently are going away soon.

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKit::TEST_F):

2012-09-07  Benjamin Poulain  <benjamin@webkit.org>

        Unreviewed prospective build fix.

        * tests/WebCompositorInputHandlerImplTest.cpp: Looks like someone is missing an #include.
        Remove the using directive from r127959.

2012-09-07  Simon Hausmann  <simon.hausmann@nokia.com>

        Unreviewed prospective build fix.

        Use WTF namespace like in other files in the same directory to resolve unqualified
        adoptPtr correctly.

        * tests/WebCompositorInputHandlerImplTest.cpp:

2012-09-07  James Robinson  <jamesr@chromium.org>

        [chromium] Remove transitional WebCompositorSupport fallback code
        https://bugs.webkit.org/show_bug.cgi?id=96155

        Reviewed by Adrienne Walker.

        * src/LinkHighlight.cpp:
        (WebKit::LinkHighlight::LinkHighlight):
        (WebKit::LinkHighlight::startHighlightAnimation):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):

2012-09-07  James Robinson  <jamesr@chromium.org>

        [chromium] Implement WebCompositorInputHandlerImpl on top of exposed API instead of CC internals
        https://bugs.webkit.org/show_bug.cgi?id=96151

        Reviewed by Adrienne Walker.

        Moves input handler setup code up to the WebKit layer instead of reaching in to CC internals.
        WebLayerTreeViewImpl implements createInputHandler() by asking its embedder for a WebInputHandler. If one is
        provided, it wraps the WebInputHandler in a CCInputHandler implementation to pass down to CC.

        WebViewImpl implements WebLayerTreeView::createInputHandler() by constructing a WebCompositorInputHandlerImpl
        and storing its identifier for the didActivateCompositor call.  From this point on the setup is the same as
        before.

        WCIHI changes covered by unit tests, overall scrolling behavior manually tested.

        * WebKit.gypi:
        * src/WebCompositorInputHandlerImpl.cpp:
        (WebKit::WebCompositorInputHandlerImpl::fromIdentifier):
        (WebKit::WebCompositorInputHandlerImpl::WebCompositorInputHandlerImpl):
        (WebKit::WebCompositorInputHandlerImpl::~WebCompositorInputHandlerImpl):
        (WebKit::WebCompositorInputHandlerImpl::setClient):
        (WebKit::WebCompositorInputHandlerImpl::handleInputEvent):
        (WebKit::WebCompositorInputHandlerImpl::handleInputEventInternal):
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):
        (WebKit::WebCompositorInputHandlerImpl::bindToClient):
        * src/WebCompositorInputHandlerImpl.h:
        (WebCompositorInputHandlerImpl):
        (WebKit::WebCompositorInputHandlerImpl::identifier):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::createInputHandler):
        (WebKit):
        * src/WebLayerTreeViewImpl.h:
        (WebLayerTreeViewImpl):
        * src/WebToCCInputHandlerAdapter.cpp: Added.
        (WebKit):
        (WebKit::WebToCCInputHandlerAdapter::create):
        (WebKit::WebToCCInputHandlerAdapter::WebToCCInputHandlerAdapter):
        (WebKit::WebToCCInputHandlerAdapter::~WebToCCInputHandlerAdapter):
        (WebToCCInputHandlerAdapter::ClientAdapter):
        (WebKit::WebToCCInputHandlerAdapter::ClientAdapter::ClientAdapter):
        (WebKit::WebToCCInputHandlerAdapter::ClientAdapter::~ClientAdapter):
        (WebKit::WebToCCInputHandlerAdapter::bindToClient):
        (WebKit::WebToCCInputHandlerAdapter::animate):
        * src/WebToCCInputHandlerAdapter.h: Copied from Source/WebCore/platform/graphics/chromium/cc/CCLayerTreeHostClient.h.
        (WebKit):
        (WebToCCInputHandlerAdapter):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        (WebKit::WebViewImpl::createInputHandler):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCThreadedTest.cpp:
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/WebCompositorInputHandlerImplTest.cpp:
        (MockWebInputHandlerClient):
        (WebKit::MockWebInputHandlerClient::MockWebInputHandlerClient):
        (WebKit::MockWebInputHandlerClient::~MockWebInputHandlerClient):
        (WebKit::WebCompositorInputHandlerImplTest::WebCompositorInputHandlerImplTest):
        (WebCompositorInputHandlerImplTest):
        (WebKit::TEST_F):

2012-09-07  David Reveman  <reveman@chromium.org>

        [Chromium] Multiple commits without invalidation allowed per redraw.
        https://bugs.webkit.org/show_bug.cgi?id=95661

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestContinuousCommit):
        (WebKitTests::CCLayerTreeHostTestContinuousCommit::CCLayerTreeHostTestContinuousCommit):
        (WebKitTests):
        (WebKitTests::TEST_F):
        (CCLayerTreeHostTestContinuousInvalidate):
        (WebKitTests::CCLayerTreeHostTestContinuousInvalidate::CCLayerTreeHostTestContinuousInvalidate):
        (CCLayerTreeHostTestContinuousAnimate):
        (WebKitTests::CCLayerTreeHostTestContinuousAnimate::CCLayerTreeHostTestContinuousAnimate):
        * tests/CCSchedulerStateMachineTest.cpp:
        (WebCore::TEST):

2012-09-07  Dominic Mazzoni  <dmazzoni@google.com>

        AX: WebCore accessibility roles should be cross-platform
        https://bugs.webkit.org/show_bug.cgi?id=94870

        Reviewed by Chris Fleizach.

        Add a new accessibility role.

        * public/WebAccessibilityRole.h:
        * src/AssertMatchingEnums.cpp:

2012-09-07  Dominic Mazzoni  <dmazzoni@google.com>

        AX: Chromium needs access to canvasHasFallbackContent
        https://bugs.webkit.org/show_bug.cgi?id=96124

        Reviewed by Chris Fleizach.

        Expose canvasHasFallbackContent on Chromium.

        * public/WebAccessibilityObject.h:
        (WebAccessibilityObject):
        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::canvasHasFallbackContent):
        (WebKit):

2012-09-07  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] Add touchscreen specific fling curve parametrization
        https://bugs.webkit.org/show_bug.cgi?id=95997

        Reviewed by James Robinson.

        Added a new set of fling curve parameters with a good feel for touchscreen
        initiated flings. Renamed TouchpadFlingPlatformGestureCurve to
        TouchFlingPlatformGestureCurve to better reflect that the class
        can serve for both touchscreen and touchpad flings when appropriately
        parametrized. Updated build files as necessary for the rename.

        No new tests - existing tests apply.


        * tests/PlatformGestureCurveTest.cpp: To use the renamed curve constructor.

2012-09-07  Dana Jansens  <danakj@chromium.org>

        [chromium] Make RenderPass ids hold both generating layer id and an index
        https://bugs.webkit.org/show_bug.cgi?id=95500

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCRendererGLTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):

2012-09-07  Joshua Bell  <jsbell@chromium.org>

        [Chromium] IndexedDB: public WebKit API changes for consolidating two-phase connect
        https://bugs.webkit.org/show_bug.cgi?id=96122

        Reviewed by Adam Barth.

        Prep work for landing Chromium side of http://webkit.org/b/90411 - the IDBFactory
        open() method now takes the "database callbacks", rather than being sent through
        in a later call.

        Also, delete an obsolete method.

        * public/WebIDBFactory.h:
        (WebKit):
        (WebIDBFactory): Delete pre-version overload of open().
        (WebKit::WebIDBFactory::open): Add overload that takes WebIDBDatabaseCallbacks.

2012-09-07  Sami Kyostila  <skyostil@google.com>

        [Chromium] GraphicsLayerChromiumTest::applyScrollToScrollableArea() is failing
        https://bugs.webkit.org/show_bug.cgi?id=95932

        Reviewed by James Robinson.

        Give the FakeScrollableArea valid geometry to allow ScrollAnimatorMac to
        properly scroll it.

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::TEST_F): Re-enable the test.

2012-09-07  James Robinson  <jamesr@chromium.org>

        [chromium] Move some CC unit tests into correct gyp variable
        https://bugs.webkit.org/show_bug.cgi?id=96048

        Reviewed by Adrienne Walker.

        These tests are testing compositor internals, so they belong in the webkit_compositor_unittest_files variable.

        * WebKit.gypi:

2012-09-07  James Robinson  <jamesr@chromium.org>

        [chromium] Remove dead CCActiveGestureAnimation code and related classes
        https://bugs.webkit.org/show_bug.cgi?id=96075

        Reviewed by Adrienne Walker.

        Cuts out unnecessary boilerplate in PlatformGestureCurve evaluation for handling flings. WCIHI can easily
        evaluate the curve itself without intermediate classes.

        * src/WebCompositorInputHandlerImpl.cpp:
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):
        (WebKit::WebCompositorInputHandlerImpl::animate):
        (WebKit::WebCompositorInputHandlerImpl::cancelCurrentFling):
        * src/WebCompositorInputHandlerImpl.h:
        (WebCore):
        (WebCompositorInputHandlerImpl):
        * tests/PlatformGestureCurveTest.cpp:
        * tests/WebCompositorInputHandlerImplTest.cpp:

2012-09-07  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up dependencies in ScrollbarLayerChromiumTest
        https://bugs.webkit.org/show_bug.cgi?id=96052

        Reviewed by Adrienne Walker.

        Fixes two minor but annoying dependencies in ScrollbarLayerChromiumTest:
        *) WebScrollbarImpl.h is #included, but not use
        *) The two-arg constructor of WebThemeScrollbarPainter is used, but this is guarded by #if
            WEBKIT_IMPLEMENTATION. The no-arg c'tor does the right thing for this test.

        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::TEST):

2012-09-07  Dominic Mazzoni  <dmazzoni@google.com>

        AX: ARIA spin button should support range value attributes
        https://bugs.webkit.org/show_bug.cgi?id=96076

        Reviewed by Chris Fleizach.

        Expose supportsRangeValue to simplify Chromium logic for when to
        extract a value from a range.

        * public/WebAccessibilityObject.h:
        (WebAccessibilityObject):
        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::supportsRangeValue):
        (WebKit):

2012-09-07  Allan Sandfeld Jensen  <allan.jensen@nokia.com>

        Simplify hitTestResultAtPoint and nodesFromRect APIs
        https://bugs.webkit.org/show_bug.cgi?id=95720

        Reviewed by Antonio Gomes.

        Update calls to new API.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::selectMisspelledWord):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::dispatchDecidePolicyForNavigationAction):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::characterIndexForPoint):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::isRectTopmost):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleMouseUp):
        (WebKit::WebViewImpl::computeBlockBounds):

2012-09-07  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: move WebCore specific code to separate header
        https://bugs.webkit.org/show_bug.cgi?id=96101

        Reviewed by Yury Semikhatsky.

        I extracted WebCore related code from MemoryInstrumentation.h to WebCoreMemoryInstrumentation.h

        * tests/MemoryInstrumentationTest.cpp:

2012-09-07  Ian Vollick  <vollick@chromium.org>

        [chromium] We should accelerate all transformations, except when we must blend matrices that cannot be decomposed.
        https://bugs.webkit.org/show_bug.cgi?id=95855

        Reviewed by James Robinson.

        Added the following unit tests:
          AnimationTranslationUtilTest.createTransformAnimationWithNonDecomposableMatrix
          AnimationTranslationUtilTest.createTransformAnimationWithNonInvertibleTransform

        * tests/AnimationTranslationUtilTest.cpp:
        (WebKit::TEST):
        (WebKit):

2012-09-07  Allan Sandfeld Jensen  <allan.jensen@nokia.com>

        X11 Global Selection
        https://bugs.webkit.org/show_bug.cgi?id=88238

        Reviewed by Tony Chang.

        Use new editor command for pasting global selection.

        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::supportsGlobalSelection):
        * src/EditorClientImpl.h:
        (EditorClientImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleMouseUp):

2012-09-07  Yoshifumi Inoue  <yosin@chromium.org>

        We should have a localized string of empty for date time field
        https://bugs.webkit.org/show_bug.cgi?id=96081

        Reviewed by Kent Tamura.

        This patch add a function for getting localized string of empty field
        value of date time fields for accessibility inside
        ENABLE_INPUT_TYPE_TIME_MULTIPLE_FIELDS.

        These functions will be used by derived classes of DateTimeFieldElement.

        Note: We'll rename ENABLE_INPUT_TYPE_MULTIPLE_FIELDS to generic name
        to support "date", "datetime", "month" and "week" multiple fields input
        UI.

        * src/LocalizedStrings.cpp:
        (WebCore::AXDateTimeFieldEmptyValueText): Added.

2012-09-06  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r127822.
        http://trac.webkit.org/changeset/127822
        https://bugs.webkit.org/show_bug.cgi?id=96073

        It broke compilation on chromium debug bots (Requested by
        loislo on #webkit).

        * tests/CCDrawQuadTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCRenderPassTest.cpp:
        (WebCore::TEST):
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCRendererGLTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):

2012-09-06  Dana Jansens  <danakj@chromium.org>

        [chromium] Make RenderPass ids hold both generating layer id and an index
        https://bugs.webkit.org/show_bug.cgi?id=95500

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCRendererGLTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):

2012-09-06  Yoshifumi Inoue  <yosin@chromium.org>

        We should have localized strings of date time fields for accessibility
        https://bugs.webkit.org/show_bug.cgi?id=96050

        Reviewed by Kent Tamura.

        This patch adds functions for getting localized strings of date time
        fields for accessibility inside ENABLE_INPUT_TYPE_TIME_MULTIPLE_FIELDS.

        These functions will be used by derived classes of DateTimeFieldElement.

        Note: We'll rename ENABLE_INPUT_TYPE_MULTIPLE_FIELDS to generic name
        to support "date", "datetime", "month" and "week" multiple fields input
        UI.

        * src/LocalizedStrings.cpp:
        (WebCore::AXAMPMFieldText): Added.
        (WebCore::AXDayOfMonthFieldText): Added.
        (WebCore::AXHourFieldText): Added.
        (WebCore::AXMillisecondFieldText): Added.
        (WebCore::AXMinuteFieldText): Added.
        (WebCore::AXMonthFieldText): Added.
        (WebCore::AXSecondFieldText): Added.
        (WebCore::AXWeekOfYearFieldText): Added.
        (WebCore::AXYearFieldText): Added.

2012-09-06  James Robinson  <jamesr@chromium.org>

        [chromium] Don't link cc in to WebKit.dll when use_libcc_for_compositor=1
        https://bugs.webkit.org/show_bug.cgi?id=96024

        Reviewed by Adam Barth.

        When use_libcc_for_compositor=1, the implementation of the compositor guts are provided through PlatformSupport.
        We don't need to link anything in to WebKit.dll.

        * WebKit.gyp:

2012-09-06  James Robinson  <jamesr@chromium.org>

        [chromium] Use WebCompositorSupport functions instead of WebCompositor statics
        https://bugs.webkit.org/show_bug.cgi?id=96007

        Reviewed by Adrienne Walker.

        Updates many tests to initialize / shutdown compositing with WebCompositorSupport. Adds a
        WebCompositorInitializer RAII class to simplify this somewhat tedious process.

        * WebKit.gypi:
        * public/WebCompositorInputHandlerClient.h:
        (WebCompositorInputHandlerClient):
        * src/WebCompositorInputHandlerImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::composite):
        (WebKit::WebViewImpl::scheduleAnimation):
        (WebKit::WebViewImpl::scheduleComposite):
        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::CCPrioritizedTextureTest::CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::~CCPrioritizedTextureTest):
        (CCPrioritizedTextureTest):
        * tests/CCRendererGLTest.cpp:
        (CCRendererGLTest::CCRendererGLTest):
        (CCRendererGLTest::SetUp):
        (CCRendererGLTest):
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadedTest.cpp:
        (WebKitTests::CCThreadedTest::runTest):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKit::GraphicsLayerChromiumTest::~GraphicsLayerChromiumTest):
        * tests/LayerChromiumTest.cpp:
        * tests/LinkHighlightTest.cpp:
        (WebCore::TEST):
        * tests/TextureLayerChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/WebCompositorInitializer.h: Added.
        (WebKit):
        (WebKitTests):
        (WebCompositorInitializer):
        (WebKitTests::WebCompositorInitializer::WebCompositorInitializer):
        (WebKitTests::WebCompositorInitializer::~WebCompositorInitializer):
        * tests/WebCompositorInputHandlerImplTest.cpp:
        (WebKit::TEST):
        (WebKit::WebCompositorInputHandlerImplTest::WebCompositorInputHandlerImplTest):
        (WebCompositorInputHandlerImplTest):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-09-06  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-06  Alec Flett  <alecflett@chromium.org>

        IndexedDB: make IDBKeyPath's string and array constructors explicit
        https://bugs.webkit.org/show_bug.cgi?id=96004

        Reviewed by Tony Chang.

        Fix test to use explicit constructor for IDBKeyPath.

        * tests/IDBDatabaseBackendTest.cpp:

2012-09-06  Adrienne Walker  <enne@google.com>

        [chromium] Remove GraphicsContext references from ContentLayerChromiumTest
        https://bugs.webkit.org/show_bug.cgi?id=96002

        Reviewed by James Robinson.

        This is a compositor unit test, so it shouldn't reference things
        outside of the compositor like GraphicsContext. The
        OpaqueRectTrackingContentLayerDelegateTest already tests opaque
        tracking right at the time of paint. This test is about verifying that
        transformed canvases work properly, so can just fake the opaque rect
        coming back from the paint.

        * tests/ContentLayerChromiumTest.cpp:
        (WebKit::MockContentLayerChromiumClient::MockContentLayerChromiumClient):
        (WebKit::TEST):

2012-09-06  Jeff Timanus  <twiz@chromium.org>

        [Chromium] Remove contentsScale and related logic from GraphicsLayerChromium.
        https://bugs.webkit.org/show_bug.cgi?id=95094

        Reviewed by Adrienne Walker.

        In the short term, the page-scale logic is to be unified in the CCLayerTreeHost class.  This is a first pass to
        try to remove the page-scale logic from GraphicsLayerChromium.  This change should be a no-op in terms of
        contentsScale behaviour.
        This change exports the disregardsPageScale() set of functions from WebContentLayer to LayerChromium.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
            Inform the layer associated with the NCCH that it is to disregard the page scale factor.
            Also remove now unused m_deviceScaleFactor and associated routines.
        (WebKit::NonCompositedContentHost::setViewport):
        * src/NonCompositedContentHost.h:
        (NonCompositedContentHost):
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::setBoundsContainPageScale):
        (WebKit):
        (WebKit::WebContentLayerImpl::boundsContainPageScale):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::updateLayerTreeViewport):
        * tests/CCLayerTreeHostTest.cpp:
        (NoScaleContentLayerChromium):
        (WebKitTests::NoScaleContentLayerChromium::create):
        (WebKitTests::NoScaleContentLayerChromium::NoScaleContentLayerChromium):
        (WebKitTests):
        (WebKitTests::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers):
            Rebaselined to correspond to the new behaviour.  Because the layers are now assigned a contentsScale, the
            scale on the draw transforms remain identity.
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit): Remove now obsolete unit-test.

2012-09-06  Adrienne Walker  <enne@google.com>

        [chromium] Remove Scrollbar/Settings dependencies from ScrollbarLayerChromiumTest
        https://bugs.webkit.org/show_bug.cgi?id=95994

        Reviewed by James Robinson.

        This compositor test shouldn't depend on code outside the compositor.

        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::FakeWebScrollbar::create):
        (FakeWebScrollbar):
        (WebCore::TEST):

2012-09-06  James Robinson  <jamesr@chromium.org>

        [chromium] Put chromium implementations of WTF symbols in separate static library
        https://bugs.webkit.org/show_bug.cgi?id=95933

        Reviewed by Adam Barth.

        A few symbols from WTF are implemented in chromium on top of the chromium WebKit Platform API. These
        implementation files are in WebKit/chromium/src and currently link into the webkit target, which in the
        component build is a DLL. This moves these files into a static library that webkit depends on so targets can
        statically link in wtf and these support files without depending directly on webkit.

        * WebKit.gyp:

2012-09-06  Iain Merrick  <husky@chromium.org>

        [chromium] Add WebFrame::moveSelectionStart, moveSelectionEnd, moveCaret
        https://bugs.webkit.org/show_bug.cgi?id=93998

        Reviewed by Adam Barth.

        These provide the same functionality selectRange(WebPoint, WebPoint),
        with finer-grained control needed on the Android platform. By passing
        allowCollapsedSelection=false, we can ensure the selection stays at
        least one character wide.

        I have reimplemented WebFrameImpl::selectRange(WebPoint, WebPoint) by
        calling the new methods. The existing test passes, and I've added new
        tests for the new methods.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::selectRange):
        (WebKit):
        (WebKit::WebFrameImpl::moveSelectionStart):
        (WebKit::WebFrameImpl::moveSelectionEnd):
        (WebKit::WebFrameImpl::moveCaret):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * tests/WebFrameTest.cpp:
        * tests/data/text_selection.html: Added.

2012-09-06  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] Enable different fling behaviour for touchscreen and touchpad
        https://bugs.webkit.org/show_bug.cgi?id=95756

        Reviewed by James Robinson.

        Add support for a flag on WebGestureEvents that differentiates GestureFlingStart
        events by their originating device and pass this flag to a factory that produces
        different device  specific fling curves based on the value of the flag.

        * public/WebActiveWheelFlingParameters.h:
        (WebActiveWheelFlingParameters): Store source device for transfer to mainthread.
        (WebKit::WebActiveWheelFlingParameters::WebActiveWheelFlingParameters):
        * public/WebInputEvent.h: Added source device flag to WebGestureEvent.
        * src/WebCompositorInputHandlerImpl.cpp:
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):  Use factory to
        obtain device-appropriate fling curve.
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent): Use factory to obtain device-appropriate
        fling curve.
        (WebKit::WebViewImpl::transferActiveWheelFlingAnimation):

2012-09-05  Sam Weinig  <sam@webkit.org>

        Part 2 of removing PlatformString.h, remove PlatformString.h
        https://bugs.webkit.org/show_bug.cgi?id=95931

        Reviewed by Adam Barth.

        Remove PlatformString.h

        * src/ContextMenuClientImpl.cpp:
        * src/EditorClientImpl.cpp:
        * src/InspectorFrontendClientImpl.cpp:
        * src/LocalFileSystemChromium.cpp:
        * src/SpeechInputClientImpl.cpp:
        * src/SpeechRecognitionClientProxy.h:
        * src/WebDevToolsAgentImpl.cpp:
        * src/WebDevToolsFrontendImpl.cpp:
        * src/WebDevToolsFrontendImpl.h:
        * src/WebEntities.h:
        * src/WebFrameImpl.h:
        * src/WorkerFileSystemCallbacksBridge.h:
        * tests/UniscribeHelperTest.cpp:

2012-09-06  Dana Jansens  <danakj@chromium.org>

        [chromium] Add a customized copy() method to CCRenderPassDrawQuad
        https://bugs.webkit.org/show_bug.cgi?id=95871

        Reviewed by Adrienne Walker.

        * tests/CCDrawQuadTest.cpp:
        (WebCore):
        (WebCore::TEST):

2012-09-06  Ilya Tikhonovsky  <loislo@chromium.org>

        Unreviewed Web Inspector: test fix.

        * tests/MemoryInstrumentationTest.cpp:
        (StringOwnerInstrumented):
        (WebCore::StringOwnerInstrumented::StringOwnerInstrumented):
        (WebCore::StringOwnerInstrumented::reportMemoryUsage):
        (WebCore):
        (WebCore::TEST):

2012-09-06  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: switch to hierarchical identifiers of MemoryBlockTypes and use these identifiers in protocol.
        https://bugs.webkit.org/show_bug.cgi?id=95957

        Reviewed by Yury Semikhatsky.

        Now when we use string identifiers as MemoryObjectType we can use them as the identifiers for the protocol
        instead of MemoryBlockNames hardcoded in InspectorMemoryAgent..
        At a later stage, when each memory type is counted in MemoryInstrumentation
        we will build the blocks hierarchy for the front-end automatically.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::InstrumentedUndefined::InstrumentedUndefined):
        (WebCore::InstrumentedUndefined::reportMemoryUsage):
        (WebCore::InstrumentedDOM::InstrumentedDOM):
        (WebCore::InstrumentedDOM::reportMemoryUsage):
        (InstrumentedDOM):
        (WebCore::TEST):

2012-09-06  Kenichi Ishibashi  <bashi@chromium.org>

        [Chromium] Win build fix attempt after r127715

        * tests/CCRenderPassTest.cpp:
        (WebCore::TEST):

2012-09-06  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-06  Dana Jansens  <danakj@chromium.org>

        [chromium] Add a copy() method to CCRenderPass
        https://bugs.webkit.org/show_bug.cgi?id=95485

        Reviewed by Adrienne Walker.

        * WebKit.gypi:
        * tests/CCRenderPassTest.cpp: Added.
        (CCTestRenderPass):
        (CCTestRenderPass::quadList):
        (CCTestRenderPass::sharedQuadStateList):
        (CCRenderPassSize):
        (TEST):

2012-09-06  Peter Beverloo  <peter@chromium.org>

        [Chromium] Chromium Mac build fix after revision r127711
        https://bugs.webkit.org/show_bug.cgi?id=95958

        Unreviewed build fix.

        This is a clear typo in the source file, so changing the function to
        call locationModifiersFromWindowsKeyCode instead.

        * src/mac/WebInputEventFactory.mm:
        (WebKit::WebInputEventFactory::keyboardEvent):

2012-09-06  Raymes Khoury  <raymes@chromium.org>

        Added modifiers to distinguish between left/right Shift/Ctrl/Alt in WebInputEvents
        https://bugs.webkit.org/show_bug.cgi?id=94142

        Reviewed by Tony Chang.

        Previously we distinguished between left/right Shift/Ctrl/Alt in
        WebInputEvents by using the location-specific virtual keycodes (e.g.
        VK_LSHIFT instead of VK_SHIFT. However, the Windows API for key events
        always returns the non-locational version (e.g. VK_SHIFT).
        Furthermore, KeyboardEvent also returns
        non-locational keycodes and separates the location information which
        matches the behavior described in the DOM3
        spec http://www.w3.org/TR/DOM-Level-3-Events/#events-keyboardevents. We
        should be consistent with this in our representation of key events.
        This patch changes WebInputEvents so they always store the
        non-locational keycode and location information is stored in
        modifiers. Since this only changes internal representation, no new
        tests are added.

        This patch also ensures that when KeyboardEvents are converted back to
        WebInputEvents location information is preserved (which was not
        happening before). This is important so that key location information
        is passed on to plugins. A unittest is added for this.

        * WebKit.gypi:
        * public/WebInputEvent.h:
        (WebKeyboardEvent):
        * src/WebInputEvent.cpp:
        (WebKit):
        (WebKit::WebKeyboardEvent::windowsKeyCodeWithoutLocation):
        (WebKit::WebKeyboardEvent::locationModifiersFromWindowsKeyCode):
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformKeyboardEventBuilder::PlatformKeyboardEventBuilder):
        (WebKit::WebKeyboardEventBuilder::WebKeyboardEventBuilder):
        * src/android/WebInputEventFactory.cpp:
        (WebKit::WebInputEventFactory::keyboardEvent):
        * src/gtk/WebInputEventFactory.cpp:
        (WebKit::WebInputEventFactory::keyboardEvent):
        * src/mac/WebInputEventFactory.mm:
        (WebKit::WebInputEventFactory::keyboardEvent):
        * src/win/WebInputEventFactory.cpp:
        (WebKit::getLocationModifier):
        (WebKit::WebInputEventFactory::keyboardEvent):
        * tests/WebInputEventConversionTest.cpp: Added.

2012-09-06  Adam Barth  <abarth@webkit.org>

        Chromium should call restrictScaleFactorToInitialScaleIfNotUserScalable unless/until userScalable is supported directly.
        https://bugs.webkit.org/show_bug.cgi?id=91110

        Reviewed by Tony Chang.

        Prior to this patch, we were ignoring the user-scalable property of
        viewport meta tags. This patch enforces the user-scalable property by
        claming the minimum-scale and maximum-scale values, effectively
        preventing user scaling. This approach isn't perfect, as discussed in
        https://bugs.webkit.org/show_bug.cgi?id=70609, but it is an improvement
        over the status quo.

        This approach is also used by EFL, GTK, and Qt.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::dispatchViewportPropertiesDidChange):

2012-09-05  Dana Jansens  <danakj@chromium.org>

        [chromium] Add a copy() method to CCDrawQuad and CCSharedQuadState
        https://bugs.webkit.org/show_bug.cgi?id=95374

        Reviewed by Adrienne Walker.

        * WebKit.gypi:
        * tests/CCDrawQuadTest.cpp: Added.
        (TEST):
        (createSharedQuadState):
        (compareDrawQuad):

2012-09-05  Kenichi Ishibashi  <bashi@chromium.org>

        [Chromium] Unreviewed gardening

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::TEST_F): Disabled applyScrollToScrollableArea()

2012-09-05  Tony Chang  <tony@chromium.org>

        [chromium] Remove dependency on webkit_user_agent
        https://bugs.webkit.org/show_bug.cgi?id=95886

        Reviewed by Adam Barth.

        The code isn't used by webkit_unit_tests.

        * WebKitUnitTests.gyp:

2012-09-05  Nate Chapin  <japhet@chromium.org>

        Test for https://bugs.webkit.org/show_bug.cgi?id=91685

        Reviewed by Adam Barth.

        * tests/WebFrameTest.cpp:

2012-09-05  Rick Byers  <rbyers@chromium.org>

        Use new type-specific WebGestureEvent fields
        https://bugs.webkit.org/show_bug.cgi?id=95573

        Reviewed by James Robinson.

        Chromium has been updated to store gesture-type specific details in the
        new WebGestureEvent fields (crrev.com/152508, crrev.com/154815 and
        crrev.com/154959), so we can now rely on them.

        * src/WebCompositorInputHandlerImpl.cpp:
        Update the compositor scroll, pinch and fling handling to use these new fields.
        (WebKit::WebCompositorInputHandlerImpl::handleInputEventInternal):
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):
        * src/WebInputEventConversion.cpp:
        Update PlatformGestureEvent/WebGestureEvent conversion to use the new
        fields, storing into the existing overloaded PlatformGestureEvent
        fields (which will be cleaned up in my next CL).
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):
        (WebKit::WebGestureEventBuilder::WebGestureEventBuilder):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        Update fling scrolling implementation for correct location of velocity.
        * tests/WebCompositorInputHandlerImplTest.cpp:
        (WebKit::TEST_F):
        Update tests to use the new fields.


2012-09-05  James Robinson  <jamesr@chromium.org>

        [chromium] Test WebSolidColorLayer in WebLayerTest.Client unit test
        https://bugs.webkit.org/show_bug.cgi?id=95819

        Reviewed by Adam Barth.

        This unit test doesn't do all that much, but it does verify that WebSolidColorLayer doesn't completely explode
        upon use and also makes sure that the WebSolidColorLayer::create() symbol is referenced and not dropped from
        webkit.dll in the component build.

        * tests/WebLayerTest.cpp:

2012-09-05  Victoria Kirst  <vrk@chromium.org>

        Add the duration attribute to MediaSource
        https://bugs.webkit.org/show_bug.cgi?id=95149

        Reviewed by Eric Carlson.

        Add support for the duration attribute recently added to the MediaSource spec.
        http://dev.w3.org/html5/spec/media-elements.html#dom-media-duration

        * public/WebMediaPlayer.h:
        (WebKit::WebMediaPlayer::sourceSetDuration): Add empty definition.
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::sourceSetDuration): Forward call to m_webMediaPlayer.
        (WebKit):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-09-05  Mihai Parparita  <mihaip@chromium.org>

        [Chromium] history.{push,replace}State should no longer be V8EnabledAtRuntime
        https://bugs.webkit.org/show_bug.cgi?id=95865

        Reviewed by Darin Fisher.

        Make WebRuntimeFeatures::{enablePushState,isPushStateEnabled} into
        no-ops.

        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures):
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enablePushState):
        (WebKit::WebRuntimeFeatures::isPushStateEnabled):

2012-09-05  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Remove getRenderStyleForStrike from PlatformSupport
        https://bugs.webkit.org/show_bug.cgi?id=95363

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * public/linux/WebFontInfo.h:
        * public/linux/WebFontRenderStyle.h:
        * src/PlatformSupport.cpp:
        (WebCore):

2012-09-05  Ilya Tikhonovsky  <loislo@chromium.org>

        Unreviewed: WebInspector: remove accidentally committed speed test.

        * tests/MemoryInstrumentationTest.cpp:

2012-09-05  Sami Kyostila  <skyostil@chromium.org>

        [chromium] Wire up scrollable sublayers in ScrollingCoordinatorChromium
        https://bugs.webkit.org/show_bug.cgi?id=95679

        Reviewed by James Robinson.

        Introduce WebLayerScrollClient for getting notified about scroll events targeting a WebLayer.

        * src/WebLayerImpl.cpp:
        (WebKit::WebLayerImpl::setMaxScrollPosition):
        (WebKit):
        (WebKit::WebLayerImpl::setScrollClient):
        (WebKit::WebLayerImpl::scrollBy):
        * src/WebLayerImpl.h:
        (WebLayerImpl):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/GraphicsLayerChromiumTest.cpp:
        (MockScrollableArea):
        (WebKit):
        (WebKit::TEST_F):
        * tests/WebLayerTest.cpp:

2012-09-05  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: extract MemoryObjectType constants from MemoryInstrumentation.
        https://bugs.webkit.org/show_bug.cgi?id=95850

        Reviewed by Yury Semikhatsky.

        I'd like to extract MemoryObjectTypes into separate classes.
        After that we will be able to move core NMI instrumentation code to WTF.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::Instrumented::reportMemoryUsage):
        (WebCore::InstrumentedRefPtr::reportMemoryUsage):
        (WebCore::InstrumentedWithOwnPtr::reportMemoryUsage):
        (WebCore::InstrumentedOther::reportMemoryUsage):
        (WebCore::InstrumentedDOM::reportMemoryUsage):
        (WebCore::TEST):
        (WebCore::NonVirtualInstrumented::reportMemoryUsage):

2012-09-05  Peter Beverloo  <peter@chromium.org>

        Unreviewed, rolling out r127590.
        http://trac.webkit.org/changeset/127590

        Broke the Chromium bots because of a compile error in the compositor.

        * DEPS:

2012-09-05  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-04  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: replace ObjectType enum with static const char* string identifiers.
        https://bugs.webkit.org/show_bug.cgi?id=95739

        Reviewed by Yury Semikhatsky.

        When we go deeper into different parts of browser like skia, chromium itself etc.
        we can't use a single enum for all reported object types.
        The current idea is to use plain simple strings as ObjectType identifiers.
        In the future patches we will extract these identifiers into separate class or namespace
        and and split it between components.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::TEST):
        (WebCore):

2012-09-04  Keishi Hattori  <keishi@webkit.org>

        Move PagePopupClient implementation for input[type=date] to Chromium WebKit layer
        https://bugs.webkit.org/show_bug.cgi?id=95681

        Reviewed by Kent Tamura.

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp:
        (WebKit):
        (WebKit::ChromeClientImpl::openDateTimeChooser):
        * src/ChromeClientImpl.h:
        (WebCore):
        (ChromeClientImpl):
        * src/DateTimeChooserImpl.cpp: Added.
        (WebKit):
        (WebKit::DateTimeChooserImpl::DateTimeChooserImpl):
        (WebKit::DateTimeChooserImpl::~DateTimeChooserImpl):
        (WebKit::DateTimeChooserImpl::endChooser):
        (WebKit::DateTimeChooserImpl::contentSize):
        (WebKit::DateTimeChooserImpl::writeDocument):
        (WebKit::DateTimeChooserImpl::setValueAndClosePopup):
        (WebKit::DateTimeChooserImpl::didClosePopup):
        * src/DateTimeChooserImpl.h:
        (WebCore):
        (WebKit):
        (DateTimeChooserImpl):

2012-09-04  Adam Barth  <abarth@chromium.org>

        Make chromium-linux build without WTF_DEPRECATED_STRING_OPERATORS
        https://bugs.webkit.org/show_bug.cgi?id=95798

        Reviewed by Eric Seidel.

        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::keyboardShortcut):
          - Remove use of WTF::String::operator+=
        * src/WebPageSerializerImpl.cpp:
          - Whitelist use of WTF::String::operator+=. Remove this use will take
            some more careful thought.

2012-09-04  Alec Flett  <alecflett@chromium.org>

        IndexedDB: remove final createIndex backend glue
        https://bugs.webkit.org/show_bug.cgi?id=95385

        Reviewed by Adam Barth.

        Remove chromium glue for old key-generation code.

        * public/WebIDBKey.h:
        (WebIDBKey):
        * src/WebIDBKey.cpp:

2012-09-04  Tien-Ren Chen  <trchen@chromium.org>

        [chromium] Rename WebViewClient::handleDisambiguationPopup
        https://bugs.webkit.org/show_bug.cgi?id=95529

        Reviewed by Adam Barth.

        Rename it to something more descriptive (WebViewClient::didTapMultipleTargets) before people start using it.

        * public/WebViewClient.h:
        (WebKit::WebViewClient::didTapMultipleTargets):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        * tests/WebFrameTest.cpp:

2012-09-03  Tao Bai  <michaelbai@chromium.org>

        Added ANDROID_GDBSERVER definition for Ant
        https://bugs.webkit.org/show_bug.cgi?id=95265

        Reviewed by Adam Barth.

        ANDROID_GDBSERVER will replace ANDROID_TOOLCHAIN, because the ANDROID_TOOLCHAIN
        is only used for finding the gdbserver.

        * WebKitUnitTests.gyp:

2012-09-03  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-09-03  Tommy Widenflycht  <tommyw@google.com>

        MediaStream API: Add Ice-related functionality to RTCPeerConnection
        https://bugs.webkit.org/show_bug.cgi?id=95565

        Reviewed by Adam Barth.

        * src/AssertMatchingEnums.cpp:

2012-09-01  James Robinson  <jamesr@chromium.org>

        Unreviewed chromium buildfix when use_libcc_for_compositor=1

        This gyp target was renamed downstream.

        * WebKit.gyp:

2012-09-01  Tommy Widenflycht  <tommyw@google.com>

        MediaStream API: Add MediaStream management to RTCPeerConnection
        https://bugs.webkit.org/show_bug.cgi?id=95543

        Reviewed by Adam Barth.

        * src/AssertMatchingEnums.cpp:

2012-08-31  Koji Ishii  <kojiishi@gmail.com>

        Glyphs in vertical text tests are rotated 90 degrees clockwise on Chromium Windows
        https://bugs.webkit.org/show_bug.cgi?id=51450

        Reviewed by Tony Chang.

        When writing-mode is vertical-*, Chromium Win does not render glyphs correctly.
        http://dev.w3.org/csswg/css3-writing-modes/#writing-mode
        Glyphs are now drawn in the correct orientation, regardless of the leading '@' in the font name,
        and vertical alternate glyphs (OpenType 'vert' feature) is not enabled.
        CJK characters drawn at wrong baseline position is also fixed.
        In addition, fontMetrics().unitsPerEm() and SimpleFontData::platformBoundsForGlyph() were empty
        in Chromium Win but they were implemented because they were needed to draw vertical flow correctly.

        Note that this patch does not address issues in vertical flow for complex code path.
        The issue is under discussion with Google people and it will not be fixed in short term.

        Existing tests in fast/writing-mode/* are enabled in LayoutTests/platform/chromium/TestExpectations.

        * features.gypi: ENABLE_OPENTYPE_VERTICAL=1.

2012-08-31  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] Make link highlighter use same node selection criteria as Chromium for Android.
        https://bugs.webkit.org/show_bug.cgi?id=95371

        Reviewed by James Robinson.

        This CL brings the selection criteria for link highlight targets into alignment with Chromium for Android.

        * src/WebViewImpl.cpp:
        (WebKit::highlightConditions):
        (WebKit::WebViewImpl::bestTouchLinkNode):
        * tests/data/test_touch_link_highlight.html:

2012-08-31  James Robinson  <jamesr@chromium.org>

        [chromium] Consolidate geometry unit testing functions for cc
        https://bugs.webkit.org/show_bug.cgi?id=95526

        Reviewed by Julien Chaffraix.

        This consolidates geometry equality (rects, matrices) in CCGeometryUtils and removes a few duplicate macros for
        testing rect equality.

        * WebKit.gypi:
        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCGeometryTestUtils.cpp: Added.
        (WebKitTests):
        (WebKitTests::ExpectTransformationMatrixEq):
        * tests/CCGeometryTestUtils.h: Renamed from Source/WebKit/chromium/tests/CCLayerTreeTestCommon.h.
        (WebKit):
        (WebKitTests):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCMathUtilTest.cpp:
        (WebKit::TEST):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-31  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up Web*Layer initialization paths
        https://bugs.webkit.org/show_bug.cgi?id=95523

        Reviewed by Darin Fisher.

        Constructing a Web*LayerImpl (or other compositor type) wrapper shouldn't require knowledge of the underyling
        implementation. Also normalizes naming conventions in these files.

        * src/WebAnimationImpl.cpp:
        (WebKit::WebAnimation::create):
        (WebKit::WebAnimationImpl::WebAnimationImpl):
        * src/WebAnimationImpl.h:
        (WebAnimationImpl):
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::layer):
        (WebKit::WebContentLayerImpl::setDoubleSided):
        (WebKit::WebContentLayerImpl::setContentsScale):
        (WebKit::WebContentLayerImpl::setUseLCDText):
        (WebKit::WebContentLayerImpl::setDrawCheckerboardForMissingTiles):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebFloatAnimationCurveImpl.cpp:
        (WebKit::WebFloatAnimationCurve::create):
        (WebKit::WebFloatAnimationCurveImpl::WebFloatAnimationCurveImpl):
        * src/WebFloatAnimationCurveImpl.h:
        (WebFloatAnimationCurveImpl):
        * src/WebIOSurfaceLayerImpl.cpp:
        (WebKit::WebIOSurfaceLayer::create):
        (WebKit::WebIOSurfaceLayerImpl::WebIOSurfaceLayerImpl):
        * src/WebIOSurfaceLayerImpl.h:
        (WebIOSurfaceLayerImpl):
        * src/WebImageLayerImpl.cpp:
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayerImpl::WebImageLayerImpl):
        * src/WebImageLayerImpl.h:
        (WebImageLayerImpl):
        * src/WebLayerImpl.cpp:
        (WebKit::WebLayer::create):
        (WebKit):
        (WebKit::WebLayerImpl::WebLayerImpl):
        * src/WebLayerImpl.h:
        (WebLayerImpl):
        * src/WebScrollbarLayerImpl.cpp:
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayerImpl::WebScrollbarLayerImpl):
        * src/WebScrollbarLayerImpl.h:
        (WebScrollbarLayerImpl):
        * src/WebSolidColorLayerImpl.cpp:
        (WebKit::WebSolidColorLayer::create):
        (WebKit::WebSolidColorLayerImpl::WebSolidColorLayerImpl):
        * src/WebSolidColorLayerImpl.h:
        (WebSolidColorLayerImpl):
        * src/WebTransformAnimationCurveImpl.cpp:
        (WebKit::WebTransformAnimationCurve::create):
        (WebKit::WebTransformAnimationCurveImpl::WebTransformAnimationCurveImpl):
        * src/WebTransformAnimationCurveImpl.h:
        (WebTransformAnimationCurveImpl):
        * src/WebVideoLayerImpl.cpp:
        (WebKit::WebVideoLayer::create):
        (WebKit::WebVideoLayerImpl::WebVideoLayerImpl):
        * src/WebVideoLayerImpl.h:
        (WebVideoLayerImpl):

2012-08-31  Tony Chang  <tony@chromium.org>

        Remove ENABLE_CSS3_FLEXBOX compile time flag
        https://bugs.webkit.org/show_bug.cgi?id=95382

        Reviewed by Ojan Vafai.

        Everyone is already enabling this by default and the spec has stablized.

        * features.gypi:

2012-08-31  Christopher Cameron  <ccameron@chromium.org>

        [chromium] Add main versus impl thread asserts
        https://bugs.webkit.org/show_bug.cgi?id=95596

        Reviewed by James Robinson.

        Add asserts to prioritized texture manager that specify that a
        function be called on the main or impl thread.

        Add debug signs that the main thread is blocked to the threaded
        proxy.

        Add a mechanism to simultaneously set the thread to the impl thread
        and indicate that the main thread is blocked.

        Update tests that hit asserts in the prioritized texture manager to
        set their impl thread and main thread blocked state correctly.

        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::CCPrioritizedTextureTest::CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::~CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::validateTexture):
        (WTF::TEST_F):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-30  James Robinson  <jamesr@chromium.org>

        [chromium] Put compositor client interfaces in separate headers, normalize naming
        https://bugs.webkit.org/show_bug.cgi?id=95522

        Reviewed by Adam Barth.

        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebExternalTextureLayerImpl.h:
        * src/WebLayerTreeViewImpl.h:
        (WebCore):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WebKitTests::ContentLayerChromiumWithUpdateTracking::create):
        (WebKitTests::ContentLayerChromiumWithUpdateTracking::ContentLayerChromiumWithUpdateTracking):
        (WebKitTests::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers):
        (WebKitTests::CCLayerTreeHostTestAtomicCommit::CCLayerTreeHostTestAtomicCommit):
        (WebKitTests::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::CCLayerTreeHostTestAtomicCommitWithPartialUpdate):
        (WebKitTests::CCLayerTreeHostTestLostContextWhileUpdatingResources::CCLayerTreeHostTestLostContextWhileUpdatingResources):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources):
        * tests/ContentLayerChromiumTest.cpp:
        (WebKit::MockContentLayerChromiumClient::MockContentLayerChromiumClient):
        (WebKit::TEST):

2012-08-31  Gavin Peters  <gavinp@chromium.org>

        [chromium] DEPS roll with a test skip.
        https://bugs.webkit.org/show_bug.cgi?id=95601

        Unreviewed gardening & DEPS roll.


        fast/frames/cached-frame-counter.html was never the most stable test, and now it's failing on more platforms. Marking it flaky, along with a DEPS roll (earlier attempts at the DEPS roll failed on this)

        * DEPS:

2012-08-31  Gavin Peters  <gavinp@chromium.org>

        [chromium] Disable WebViewTest.AutoResizeMinimumSize
        https://bugs.webkit.org/show_bug.cgi?id=95571

        Unreviewed gardening.

        Disabling this test since it started failing in build 17225, see http://build.chromium.org/p/chromium.webkit/builders/Webkit%20Win/builds/17247 for instance. Will shortly file bug to re-enable this.

        * tests/WebViewTest.cpp:

2012-08-30  James Robinson  <jamesr@chromium.org>

        [chromium] Revert WebCompositorSupport to raw ptrs, make dtor protected
        https://bugs.webkit.org/show_bug.cgi?id=95520

        Reviewed by Darin Fisher.

        Adopt the return value of WebCompositorSupport explicitly.

        * src/LinkHighlight.cpp:
        (WebKit::LinkHighlight::LinkHighlight):
        (WebKit::LinkHighlight::startHighlightAnimation):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):

2012-08-30  James Robinson  <jamesr@chromium.org>

        [chromium] Make webkit_compositor specific unit test compilation conditional on gyp var
        https://bugs.webkit.org/show_bug.cgi?id=95401

        Reviewed by Dirk Pranke.

        If use_libcc_for_compositor is set, these tests are being compiled and run elsewhere.

        * WebKit.gyp:
        * WebKit.gypi:
        * WebKitUnitTests.gyp:

2012-08-27  James Robinson  <jamesr@chromium.org>

        [chromium] Add CompositorSupport interface for constructing compositor classes
        https://bugs.webkit.org/show_bug.cgi?id=95040

        Reviewed by Darin Fisher.

        * src/LinkHighlight.cpp:
        (WebKit::LinkHighlight::LinkHighlight):
        (WebKit::LinkHighlight::startHighlightAnimation):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        * src/WebMediaPlayerClientImpl.h:
        (WebKit):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        * src/WebPluginContainerImpl.h:
        (WebKit):

2012-08-30  Gavin Peters  <gavinp@chromium.org>

        [chromium] Disable CCLayerTreeHostTestScrollMultipleRedraw.runMultiThread
        https://bugs.webkit.org/show_bug.cgi?id=95472

        Unreviewed gardening.

        When landing r127079, this test was re-enabled, and has not passed since. I'm disabling it, and created bug 95473 to track fixing this issue.

        * tests/CCLayerTreeHostTest.cpp:
        (WebKitTests::TEST_F):

2012-08-30  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up some webkit compositor unit tests
        https://bugs.webkit.org/show_bug.cgi?id=95410

        Reviewed by Adrienne Walker.

        This adds includes that were implicitly being picked up, removes ones that weren't being used, removes
        dead code, adds OVERRIDE on functions that OVERRIDE, and deinlines virtuals that the chromium clang style
        plugin is unhappy about.

        * tests/CCAnimationTestCommon.cpp:
        (WebKitTests::FakeFloatAnimationCurve::duration):
        (WebKitTests):
        (WebKitTests::FakeFloatAnimationCurve::getValue):
        (WebKitTests::FakeTransformTransition::duration):
        (WebKitTests::FakeFloatTransition::duration):
        (WebKitTests::FakeLayerAnimationControllerClient::id):
        (WebKitTests::FakeLayerAnimationControllerClient::setOpacityFromAnimation):
        (WebKitTests::FakeLayerAnimationControllerClient::opacity):
        (WebKitTests::FakeLayerAnimationControllerClient::setTransformFromAnimation):
        (WebKitTests::FakeLayerAnimationControllerClient::transform):
        * tests/CCAnimationTestCommon.h:
        (FakeFloatAnimationCurve):
        (FakeTransformTransition):
        (FakeFloatTransition):
        (FakeLayerAnimationControllerClient):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::sampledTexelFormat):
        (WebKitTests):
        (WebKitTests::FakeTiledLayerWithScaledBounds::FakeTiledLayerWithScaledBounds):
        (WebKitTests::FakeTiledLayerChromium::textureManager):
        (WebKitTests::FakeTiledLayerChromium::textureUpdater):
        (WebKitTests::FakeTiledLayerWithScaledBounds::contentBounds):
        (WebKitTests::FakeTextureUploader::isBusy):
        (WebKitTests::FakeTextureUploader::uploadTexture):
        * tests/CCTiledLayerTestCommon.h:
        (FakeLayerTextureUpdater):
        (FakeTiledLayerChromium):
        (FakeTiledLayerWithScaledBounds):
        (FakeTextureUploader):
        * tests/FakeWebCompositorOutputSurface.h:
        * tests/TextureCopierTest.cpp:
        (MockContext):
        (TEST):
        * tests/ThrottledTextureUploaderTest.cpp:
        (WebKit::TEST):
        * tests/WebLayerTreeViewTest.cpp:

2012-08-29  Hironori Bono  <hbono@chromium.org>

        Fix Chromium builds (Win and Mac)
        https://bugs.webkit.org/show_bug.cgi?id=95421

        Reviewed by James Robinson.

        This change replaces 'class WebRect' with 'struct WebRect' to fix build breaks
        on the "Chromium Mac Release" and the "Chromium Win Release" bot caused by
        r127095.

        * public/WebViewClient.h:
        (WebKit):

2012-08-29  Nat Duca  <nduca@chromium.org>

        [chromium] setNeedsAnimate should not cause commitRequested to become true
        https://bugs.webkit.org/show_bug.cgi?id=95393

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestSetNeedsAnimateShouldNotSetCommitRequested):
        (CCLayerTreeHostTestSetNeedsAnimateShouldNotSetCommitRequested::CCLayerTreeHostTestSetNeedsAnimateShouldNotSetCommitRequested):

2012-08-29  Tien-Ren Chen  <trchen@chromium.org>

        [chromium] Implement disambiguation popup (a.k.a. Link Preview)
        https://bugs.webkit.org/show_bug.cgi?id=94182

        Reviewed by Adam Barth.

        In this new implementation, we add a new WebViewClient::handleDisambiguationPopup delegate.
        The disambiguation sequence will be initiated by the gesture event handler
        in WebViewImpl if an ambiguous tap is detected, then
        m_client->handleDisambiguationPopup will be called, so the embedder can
        decide whether to swallow the touch event and show a popup.

        New test: WebFrameTest.DisambiguationPopupTest

        * WebKit.gyp:
        * features.gypi:
        * public/WebInputEvent.h:
        (WebGestureEvent):
        (WebKit::WebGestureEvent::WebGestureEvent):
        * public/WebTouchCandidatesInfo.h: Removed.
        * public/WebView.h:
        (WebKit):
        * public/WebViewClient.h:
        (WebKit):
        (WebViewClient):
        (WebKit::WebViewClient::triggersLinkPreview):
        * src/WebInputEvent.cpp:
        (SameSizeAsWebGestureEvent):
        * src/WebViewImpl.cpp:
        (WebKit):
        (WebKit::WebViewImpl::handleGestureEventWithLinkPreview):
        (WebKit::WebViewImpl::handleGestureEvent):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-29  Dominic Mazzoni  <dmazzoni@google.com>

        AX: Canvas should have a distinct role
        https://bugs.webkit.org/show_bug.cgi?id=95248

        Reviewed by Chris Fleizach.

        Add support for canvas accessibility role.

        * public/WebAccessibilityRole.h:
        * src/AssertMatchingEnums.cpp:

2012-08-29  Alex Sakhartchouk  <alexst@chromium.org>

        [chromium] CCLayerTreeHost::finishCommitOnImplThread wrong setter order
        https://bugs.webkit.org/show_bug.cgi?id=94828

        Reviewed by Adrienne Walker.

        Testing that setDeviceScaleFactor properly changes maxScrollPosition

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-29  James Robinson  <jamesr@chromium.org>

        Unreviewed, rolling out r126956.
        http://trac.webkit.org/changeset/126956
        https://bugs.webkit.org/show_bug.cgi?id=94721

        Breaks several unit tests

        * tests/CCSchedulerTest.cpp:
        (WebKitTests::FakeCCSchedulerClient::reset):
        (WebKitTests::FakeCCSchedulerClient::setHasMoreResourceUpdates):
        (WebKitTests::TEST):
        * tests/CCTextureUpdateControllerTest.cpp:

2012-08-29  James Robinson  <jamesr@chromium.org>

        [chromium] Register/unregister contents layers with GraphicsLayerChromium
        https://bugs.webkit.org/show_bug.cgi?id=95379

        Reviewed by Adrienne Walker.

        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::~WebMediaPlayerClientImpl):
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        (WebKit::WebPluginContainerImpl::~WebPluginContainerImpl):

2012-08-29  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] Add WebSettings support for flag to enable/disable gesture tap highlights.
        https://bugs.webkit.org/show_bug.cgi?id=95119

        Reviewed by Adam Barth.

        Add support to WebSettings for flag to enable/disable gesture tap highlights. Relies on existing tests.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        (WebKit::WebSettingsImpl::setGestureTapHighlightEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        (WebKit::WebSettingsImpl::gestureTapHighlightEnabled):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):

2012-08-29  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove HUD layer when rootLayer is set to null
        https://bugs.webkit.org/show_bug.cgi?id=95257

        Reviewed by James Robinson.

        * WebKit.gypi:
        * tests/CCHeadsUpDisplayTest.cpp: Added.
        (CCHeadsUpDisplayTest):
        (DrawsContentLayerChromium):
        (DrawsContentLayerChromium::create):
        (DrawsContentLayerChromium::DrawsContentLayerChromium):
        (CCHudWithRootLayerChange):
        (CCHudWithRootLayerChange::CCHudWithRootLayerChange):
        (TEST_F):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCThreadedTest.cpp:
        (WebKitTests::CCThreadedTest::runTest):
        * tests/CCThreadedTest.h:
        (WebKitTests::CCThreadedTest::initializeSettings):
        (CCThreadedTest):

2012-08-29  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Add more unit test coverage for semantics of drawableContentRect and visibleContentRect
        https://bugs.webkit.org/show_bug.cgi?id=94542

        Reviewed by Adrienne Walker.

        To make upcoming refactors safer, it was appropriate to (finally)
        add unit tests that check the behavior of drawableContentRect and
        visibleContentRect computations in calculateDrawTransforms.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-08-29  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] Link highlight should clear on page navigation.
        https://bugs.webkit.org/show_bug.cgi?id=95129

        Reviewed by James Robinson.

        Modified WebViewImpl to clear link highlight when navigating to new url.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::didCommitLoad):

2012-08-29  James Robinson  <jamesr@chromium.org>

        [chromium] CCThreadImpl / WebCompositorImpl shouldn't compile from webkit when use_libcc_for_compositor=1
        https://bugs.webkit.org/show_bug.cgi?id=94995

        Reviewed by Adam Barth.

        * WebKit.gyp:

2012-08-28  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Do not clip root layer's subtree to viewport
        https://bugs.webkit.org/show_bug.cgi?id=95235

        Reviewed by Adrienne Walker.

        Existing tests updated, and otherwise this change is already
        covered by layout and unit tests.

        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithTwoOpaqueChildren::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestFilters::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLargePixelsOccludeInsideClipRect::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfClippingSurface::runMyTest):

2012-08-29  Julien Chaffraix  <jchaffraix@webkit.org>

        [Chromium] CCLayerTreeHostTestScrollChildLayer makes the wrong assumptions
        https://bugs.webkit.org/show_bug.cgi?id=95358

        Unreviewed gardening.

        * tests/CCLayerTreeHostTest.cpp:
        Disabled the test until it is fixed.

2012-08-29  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126972.
        http://trac.webkit.org/changeset/126972
        https://bugs.webkit.org/show_bug.cgi?id=95349

        accessibility/canvas-description-and-role.html has been
        failing consistently on several bots and Dominic needs some
        time to investigate why (Requested by jchaffraix on #webkit).

        * public/WebAccessibilityRole.h:
        * src/AssertMatchingEnums.cpp:

2012-08-29  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-29  Dominic Mazzoni  <dmazzoni@google.com>

        AX: Canvas should have a distinct role
        https://bugs.webkit.org/show_bug.cgi?id=95248

        Reviewed by Chris Fleizach.

        Add support for canvas accessibility role.

        * public/WebAccessibilityRole.h:
        * src/AssertMatchingEnums.cpp:

2012-08-28  David Reveman  <reveman@chromium.org>

        [Chromium] Scheduler will never process a commit until it receives a vsync tick.
        https://bugs.webkit.org/show_bug.cgi?id=94721

        Reviewed by James Robinson.

        * tests/CCSchedulerTest.cpp:
        (WebKitTests::FakeCCSchedulerClient::reset):
        (WebKitTests::TEST):
        * tests/CCTextureUpdateControllerTest.cpp:

2012-08-28  Adam Barth  <abarth@webkit.org>

        Fix ASSERT in fast/events/touch/gesture/context-menu-on-two-finger-tap.html

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::detectContentOnTouch):

2012-08-28  Leandro Gracia Gil  <leandrogracia@chromium.org>

        Content detection should not disrupt the page behaviour
        https://bugs.webkit.org/show_bug.cgi?id=94727

        Reviewed by Adam Barth.

        Triggers content detection in the embedder on tap gestures and
        add checks for the appropriate event listeners in order to prevent
        triggering content detection when it would disrupt the page's behaviour.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        (WebKit::WebViewImpl::detectContentOnTouch):
        * tests/WebViewTest.cpp:
        * tests/data/content_listeners.html: Added.

2012-08-28  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126933.
        http://trac.webkit.org/changeset/126933
        https://bugs.webkit.org/show_bug.cgi?id=95261

        Turns out we do need this! (Requested by abarth on #webkit).

        * public/WebWidget.h:
        (WebKit::WebWidget::paint):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::paint):
        * src/WebPagePopupImpl.h:
        (WebPagePopupImpl):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):
        * src/WebPopupMenuImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::paint):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-28  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Remove decodeAudioFileData from PlatformSupport
        https://bugs.webkit.org/show_bug.cgi?id=95250

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-08-28  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126344.
        http://trac.webkit.org/changeset/126344
        https://bugs.webkit.org/show_bug.cgi?id=95253

        This change is no longer needed (Requested by abarth on
        #webkit).

        * public/WebWidget.h:
        (WebKit::WebWidget::paint):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::paint):
        * src/WebPagePopupImpl.h:
        (WebPagePopupImpl):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):
        * src/WebPopupMenuImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::paint):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-28  Dominic Mazzoni  <dmazzoni@google.com>

        AX: Crash due to object getting deleted inside updateBackingStore
        https://bugs.webkit.org/show_bug.cgi?id=94619

        Reviewed by Chris Fleizach.

        Chromium now calls updateBackingStoreAndCheckValidity explicitly,
        so we can now get rid of calls to updateBackingStore in the
        method implementations, and just make sure we're checking isDetached.

        * public/WebAccessibilityObject.h:
        (WebAccessibilityObject):
        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::axID):
        (WebKit::WebAccessibilityObject::accessibilityDescription):
        (WebKit::WebAccessibilityObject::actionVerb):
        (WebKit::WebAccessibilityObject::canSetFocusAttribute):
        (WebKit::WebAccessibilityObject::canSetValueAttribute):
        (WebKit::WebAccessibilityObject::childCount):
        (WebKit::WebAccessibilityObject::childAt):
        (WebKit::WebAccessibilityObject::firstChild):
        (WebKit::WebAccessibilityObject::focusedChild):
        (WebKit::WebAccessibilityObject::lastChild):
        (WebKit::WebAccessibilityObject::nextSibling):
        (WebKit::WebAccessibilityObject::parentObject):
        (WebKit::WebAccessibilityObject::previousSibling):
        (WebKit::WebAccessibilityObject::canSetSelectedAttribute):
        (WebKit::WebAccessibilityObject::isAnchor):
        (WebKit::WebAccessibilityObject::isAriaReadOnly):
        (WebKit::WebAccessibilityObject::isButtonStateMixed):
        (WebKit::WebAccessibilityObject::isChecked):
        (WebKit::WebAccessibilityObject::isCollapsed):
        (WebKit::WebAccessibilityObject::isControl):
        (WebKit::WebAccessibilityObject::isEnabled):
        (WebKit::WebAccessibilityObject::isFocused):
        (WebKit::WebAccessibilityObject::isHovered):
        (WebKit::WebAccessibilityObject::isIndeterminate):
        (WebKit::WebAccessibilityObject::isLinked):
        (WebKit::WebAccessibilityObject::isLoaded):
        (WebKit::WebAccessibilityObject::isMultiSelectable):
        (WebKit::WebAccessibilityObject::isOffScreen):
        (WebKit::WebAccessibilityObject::isPasswordField):
        (WebKit::WebAccessibilityObject::isPressed):
        (WebKit::WebAccessibilityObject::isReadOnly):
        (WebKit::WebAccessibilityObject::isRequired):
        (WebKit::WebAccessibilityObject::isSelected):
        (WebKit::WebAccessibilityObject::isSelectedOptionActive):
        (WebKit::WebAccessibilityObject::isVertical):
        (WebKit::WebAccessibilityObject::isVisible):
        (WebKit::WebAccessibilityObject::isVisited):
        (WebKit::WebAccessibilityObject::accessKey):
        (WebKit::WebAccessibilityObject::ariaHasPopup):
        (WebKit::WebAccessibilityObject::ariaLiveRegionAtomic):
        (WebKit::WebAccessibilityObject::ariaLiveRegionBusy):
        (WebKit::WebAccessibilityObject::ariaLiveRegionRelevant):
        (WebKit::WebAccessibilityObject::ariaLiveRegionStatus):
        (WebKit::WebAccessibilityObject::boundingBoxRect):
        (WebKit::WebAccessibilityObject::estimatedLoadingProgress):
        (WebKit::WebAccessibilityObject::helpText):
        (WebKit::WebAccessibilityObject::headingLevel):
        (WebKit::WebAccessibilityObject::hierarchicalLevel):
        (WebKit::WebAccessibilityObject::hitTest):
        (WebKit::WebAccessibilityObject::keyboardShortcut):
        (WebKit::WebAccessibilityObject::performDefaultAction):
        (WebKit::WebAccessibilityObject::roleValue):
        (WebKit::WebAccessibilityObject::selectionEnd):
        (WebKit::WebAccessibilityObject::selectionStart):
        (WebKit::WebAccessibilityObject::stringValue):
        (WebKit::WebAccessibilityObject::title):
        (WebKit::WebAccessibilityObject::titleUIElement):
        (WebKit::WebAccessibilityObject::url):
        (WebKit::WebAccessibilityObject::valueDescription):
        (WebKit::WebAccessibilityObject::valueForRange):
        (WebKit::WebAccessibilityObject::maxValueForRange):
        (WebKit::WebAccessibilityObject::minValueForRange):
        (WebKit::WebAccessibilityObject::node):
        (WebKit::WebAccessibilityObject::document):
        (WebKit::WebAccessibilityObject::accessibilityIsIgnored):
        (WebKit::WebAccessibilityObject::lineBreaks):
        (WebKit::WebAccessibilityObject::columnCount):
        (WebKit::WebAccessibilityObject::rowCount):
        (WebKit::WebAccessibilityObject::cellForColumnAndRow):
        (WebKit::WebAccessibilityObject::cellColumnIndex):
        (WebKit::WebAccessibilityObject::cellColumnSpan):
        (WebKit::WebAccessibilityObject::cellRowIndex):
        (WebKit::WebAccessibilityObject::cellRowSpan):
        (WebKit::WebAccessibilityObject::scrollToMakeVisible):
        (WebKit::WebAccessibilityObject::scrollToMakeVisibleWithSubFocus):
        (WebKit::WebAccessibilityObject::scrollToGlobalPoint):

2012-08-28  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126914.
        http://trac.webkit.org/changeset/126914
        https://bugs.webkit.org/show_bug.cgi?id=95239

        it breaks everything and fixes nothing (Requested by pizlo on
        #webkit).

        * src/WebGeolocationPermissionRequestManager.cpp:
        (WebGeolocationPermissionRequestManager::remove):
        * src/WebIDBMetadata.cpp:
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        * src/WebIntent.cpp:
        (WebKit::WebIntent::extrasValue):
        * tests/WebSocketExtensionDispatcherTest.cpp:
        (WebCore::TEST_F):

2012-08-28  W. James MacLean  <wjmaclean@chromium.org>

        [unreviewed] Compile fix: windows compiler expects float but find double.
 
        Need to specify a float literal when initialising the highlight animation duration.
 
        * src/LinkHighlight.cpp:
        (WebKit::LinkHighlight::startHighlightAnimation):

2012-08-28  Caio Marcelo de Oliveira Filho  <caio.oliveira@openbossa.org>

        Rename first/second to key/value in HashMap iterators
        https://bugs.webkit.org/show_bug.cgi?id=82784

        Reviewed by Eric Seidel.

        * src/WebGeolocationPermissionRequestManager.cpp:
        (WebGeolocationPermissionRequestManager::remove):
        * src/WebIDBMetadata.cpp:
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        * src/WebIntent.cpp:
        (WebKit::WebIntent::extrasValue):
        * tests/WebSocketExtensionDispatcherTest.cpp:
        (WebCore::TEST_F):

2012-08-28  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] Drastically shorten the link highlight duration.
        https://bugs.webkit.org/show_bug.cgi?id=95216

        Reviewed by James Robinson.

        Parameter change; covered by existing layout tests.

        * src/LinkHighlight.cpp:
        (WebKit::LinkHighlight::startHighlightAnimation):

2012-08-27  Tien-Ren Chen  <trchen@chromium.org>

        [Chromium] Remove stub for WebView::getTouchHighlightQuads()
        https://bugs.webkit.org/show_bug.cgi?id=95164

        Reviewed by Adam Barth.

        Reverts https://bugs.webkit.org/show_bug.cgi?id=92997
        We're uploading a new implementation that no longer uses this API.
        See https://bugs.webkit.org/show_bug.cgi?id=94182

        * WebKit.gyp:
        * public/WebTouchCandidatesInfo.h: Removed.
        * public/WebView.h:
        (WebKit):
        * src/WebViewImpl.cpp:
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-27  Ian Vollick  <vollick@chromium.org>

        [chromium] Should accelerate rotations of >= 180 degrees
        https://bugs.webkit.org/show_bug.cgi?id=94860

        Reviewed by James Robinson.

        Added new unit tests:
          WebTransformOperationTest.transformTypesAreUnique
          WebTransformOperationTest.matchTypesSameLength
          WebTransformOperationTest.identityAlwaysMatches
          WebTransformOperationTest.largeRotationsWithSameAxis
          WebTransformOperationTest.largeRotationsWithSameAxisInDifferentDirection
          WebTransformOperationTest.largeRotationsWithDifferentAxes
          WebTransformOperationTest.blendRotationFromIdentity
          WebTransformOperationTest.blendTranslationFromIdentity
          WebTransformOperationTest.blendScaleFromIdentity
          WebTransformOperationTest.blendSkewFromIdentity
          WebTransformOperationTest.blendPerspectiveFromIdentity
          WebTransformOperationTest.blendRotationToIdentity
          WebTransformOperationTest.blendTranslationToIdentity
          WebTransformOperationTest.blendScaleToIdentity
          WebTransformOperationTest.blendSkewToIdentity
          WebTransformOperationTest.blendPerspectiveToIdentity
          AnimationTranslationUtilTest.createTransformAnimationWithBigRotation
          AnimationTranslationUtilTest.createTransformAnimationWithBigRotationAndEmptyTransformOperationList

        * tests/AnimationTranslationUtilTest.cpp:
        (WebKit::TEST):
        * tests/WebTransformOperationsTest.cpp:
        (TEST):
        (getIdentityOperations):

2012-08-27  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126836.
        http://trac.webkit.org/changeset/126836
        https://bugs.webkit.org/show_bug.cgi?id=95163

        Broke all Apple ports, EFL, and Qt. (Requested by tkent on
        #webkit).

        * src/WebGeolocationPermissionRequestManager.cpp:
        (WebGeolocationPermissionRequestManager::remove):
        * src/WebIDBMetadata.cpp:
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        * src/WebIntent.cpp:
        (WebKit::WebIntent::extrasValue):
        * tests/WebSocketExtensionDispatcherTest.cpp:
        (WebCore::TEST_F):

2012-08-27  Caio Marcelo de Oliveira Filho  <caio.oliveira@openbossa.org>

        Rename first/second to key/value in HashMap iterators
        https://bugs.webkit.org/show_bug.cgi?id=82784

        Reviewed by Eric Seidel.

        * src/WebGeolocationPermissionRequestManager.cpp:
        (WebGeolocationPermissionRequestManager::remove):
        * src/WebIDBMetadata.cpp:
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        * src/WebIntent.cpp:
        (WebKit::WebIntent::extrasValue):
        * tests/WebSocketExtensionDispatcherTest.cpp:
        (WebCore::TEST_F):

2012-08-27  David Reveman  <reveman@chromium.org>

        [Chromium] Stop texture updates when context is lost.
        https://bugs.webkit.org/show_bug.cgi?id=94983

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostTest.cpp:
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::create):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::setContextLostCallback):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::isContextLost):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::beginQueryEXT):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::endQueryEXT):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::getQueryObjectuivEXT):
        (CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext::CompositorFakeWebGraphicsContext3DWithEndQueryCausingLostContext):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources::CCLayerTreeHostTestLostContextWhileUpdatingResources):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources::createOutputSurface):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources::beginTest):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources::commitCompleteOnCCThread):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources::layout):
        (CCLayerTreeHostTestLostContextWhileUpdatingResources::afterTest):
        (TEST_F):

2012-08-27  Dana Jansens  <danakj@chromium.org>

        [chromium] A general mechanism for passing data into and out of appendQuads and quadCuller via CCAppendQuadsData
        https://bugs.webkit.org/show_bug.cgi?id=95109

        Reviewed by Adrienne Walker.

        Update tests to use the new data structure.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        (CCLayerTestCommon::getQuads):
        * tests/MockCCQuadCuller.h:

2012-08-24  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up dependencies of WebScrollbar and WebScrollbarLayer
        https://bugs.webkit.org/show_bug.cgi?id=94996

        Reviewed by Adrienne Walker.

        Fix up tests for API changes.

        * WebKit.gyp:
        * src/WebScrollbarLayerImpl.cpp:
        (WebKit::WebScrollbarLayer::create):
        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::TEST):

2012-08-27  Adrienne Walker  <enne@google.com>

        [chromium] Prevent scrollbar thumb size from changing during compositor zoom
        https://bugs.webkit.org/show_bug.cgi?id=94859

        Reviewed by James Robinson.

        Update test.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-27  Dana Jansens  <danakj@chromium.org>

        [chromium] Have RenderSurface create and add its own generated RenderPass
        https://bugs.webkit.org/show_bug.cgi?id=94957

        Reviewed by Adrienne Walker.

        Test that a RenderSurface generates the RenderPass that we expect.

        * tests/CCRenderSurfaceTest.cpp:

2012-08-27  Justin Novosad  <junov@chromium.org>

        [Chromium] Fixing infinite recursion in Canvas2DLayerManager
        https://bugs.webkit.org/show_bug.cgi?id=95110

        Reviewed by Stephen White.

        Breaking recursion cycle by not reporting a change in memory allocation
        when no memory is freed in FakeCanvas2DLayer::freeMemoryIfPossible.

        * tests/Canvas2DLayerManagerTest.cpp:

2012-08-27  Justin Novosad  <junov@chromium.org>

        [Chromium] Implementing a global limit on memory consumed by deferred 2D canvases
        https://bugs.webkit.org/show_bug.cgi?id=94386

        Reviewed by Stephen White.

        Adding unit tests for WebCore::Canvas2DLayerManager

        * WebKit.gypi:

2012-08-27  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-27  Mikhail Pozdnyakov  <mikhail.pozdnyakov@intel.com>

        Rename RegisterProtocolHandler API to NavigatorContentUtils
        https://bugs.webkit.org/show_bug.cgi?id=94920

        Reviewed by Adam Barth.

        Renaming whatever RegisterProtocolHandler-prefixed to NavigatorContentUtils-prefixed.
        RegisterProtocolHandlerClientImpl is renamed to NavigatorContentUtilsClientImpl.

        * features.gypi:
        * src/ChromeClientImpl.cpp:
        (WebKit):
        (WebKit::NavigatorContentUtilsClientImpl::create):
        (WebKit::NavigatorContentUtilsClientImpl::NavigatorContentUtilsClientImpl):
        (WebKit::NavigatorContentUtilsClientImpl::registerProtocolHandler):
        * src/ChromeClientImpl.h:
        (NavigatorContentUtilsClientImpl):
        (WebKit::NavigatorContentUtilsClientImpl::~NavigatorContentUtilsClientImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        * src/WebViewImpl.h:

2012-08-27  Johnny Ding  <jnd@chromium.org>

        [Chromium-Android]Move webkit_unit_tests_apk and TestWebKitAPI_apk into a
        condition block:['OS=="android" and gtest_target_type == "shared_library"'].
        https://bugs.webkit.org/show_bug.cgi?id=95049

        Reviewed by Adam Barth.

        Move webkit_unit_tests_apk and TestWebKitAPI_apk into block of gtest_target_type == "shared_library"

        * All.gyp:

2012-08-24  Dominic Mazzoni  <dmazzoni@google.com>

        Chromium: WebAccessibilityObject should expose updateBackingStore
        https://bugs.webkit.org/show_bug.cgi?id=94611

        Reviewed by Chris Fleizach.

        This change just exposes a method, with no new tests. Next, Chromium
        will be modified to call this new method, and this will be followed
        by a change that gets rid of calls to updateBackingStore under the
        hood. That last change may add a test or update an existing test.

        * public/WebAccessibilityObject.h:
        (WebAccessibilityObject):
        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::updateBackingStoreAndCheckValidity):
        (WebKit):

2012-08-24  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] WebViewImpl::enableTouchHighlight() should always clear any existing highlight when invoked.
        https://bugs.webkit.org/show_bug.cgi?id=94978

        Reviewed by James Robinson.

        Modified WebViewImpl::enableTouchHighlight() so it always clears any existing highlight, even if no new
        highlight target is found.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::enableTouchHighlight):

2012-08-23  James Robinson  <jamesr@chromium.org>

        [chromium] Convert WebLayerTreeView interface into pure virtual
        https://bugs.webkit.org/show_bug.cgi?id=94866

        Reviewed by Adrienne Walker.

        Updates WebLayerTreeView implementation and callers to new interface. The createGraphicsContext3D() wrapper
        stuff can just go away now since downstream has updated to createOutputSurface().

        * WebKit.gypi:
        * src/WebLayerTreeView.cpp: Removed.
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeView::create):
        (WebKit::WebLayerTreeViewImpl::WebLayerTreeViewImpl):
        (WebKit::WebLayerTreeViewImpl::initialize):
        (WebKit):
        (WebKit::WebLayerTreeViewImpl::setSurfaceReady):
        (WebKit::WebLayerTreeViewImpl::setRootLayer):
        (WebKit::WebLayerTreeViewImpl::clearRootLayer):
        (WebKit::WebLayerTreeViewImpl::compositorIdentifier):
        (WebKit::WebLayerTreeViewImpl::setViewportSize):
        (WebKit::WebLayerTreeViewImpl::layoutViewportSize):
        (WebKit::WebLayerTreeViewImpl::deviceViewportSize):
        (WebKit::WebLayerTreeViewImpl::setDeviceScaleFactor):
        (WebKit::WebLayerTreeViewImpl::deviceScaleFactor):
        (WebKit::WebLayerTreeViewImpl::setBackgroundColor):
        (WebKit::WebLayerTreeViewImpl::setHasTransparentBackground):
        (WebKit::WebLayerTreeViewImpl::setVisible):
        (WebKit::WebLayerTreeViewImpl::setPageScaleFactorAndLimits):
        (WebKit::WebLayerTreeViewImpl::startPageScaleAnimation):
        (WebKit::WebLayerTreeViewImpl::setNeedsAnimate):
        (WebKit::WebLayerTreeViewImpl::setNeedsRedraw):
        (WebKit::WebLayerTreeViewImpl::commitRequested):
        (WebKit::WebLayerTreeViewImpl::composite):
        (WebKit::WebLayerTreeViewImpl::updateAnimations):
        (WebKit::WebLayerTreeViewImpl::compositeAndReadback):
        (WebKit::WebLayerTreeViewImpl::finishAllRendering):
        (WebKit::WebLayerTreeViewImpl::renderingStats):
        (WebKit::WebLayerTreeViewImpl::setFontAtlas):
        (WebKit::WebLayerTreeViewImpl::loseCompositorContext):
        (WebKit::WebLayerTreeViewImpl::willBeginFrame):
        (WebKit::WebLayerTreeViewImpl::didBeginFrame):
        (WebKit::WebLayerTreeViewImpl::animate):
        (WebKit::WebLayerTreeViewImpl::layout):
        (WebKit::WebLayerTreeViewImpl::applyScrollAndScale):
        (WebKit::WebLayerTreeViewImpl::createOutputSurface):
        (WebKit::WebLayerTreeViewImpl::didRecreateOutputSurface):
        (WebKit::WebLayerTreeViewImpl::willCommit):
        (WebKit::WebLayerTreeViewImpl::didCommit):
        (WebKit::WebLayerTreeViewImpl::didCommitAndDrawFrame):
        (WebKit::WebLayerTreeViewImpl::didCompleteSwapBuffers):
        (WebKit::WebLayerTreeViewImpl::scheduleComposite):
        * src/WebLayerTreeViewImpl.h:
        (WebLayerTreeViewImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::renderingStats):
        (WebKit::WebViewImpl::startPageScaleAnimation):
        (WebKit::WebViewImpl::setCompositorSurfaceReady):
        (WebKit::WebViewImpl::animate):
        (WebKit::WebViewImpl::doPixelReadbackToCanvas):
        (WebKit::WebViewImpl::paint):
        (WebKit::WebViewImpl::composite):
        (WebKit::WebViewImpl::setNeedsRedraw):
        (WebKit::WebViewImpl::isInputThrottled):
        (WebKit::WebViewImpl::loseCompositorContext):
        (WebKit::WebViewImpl::setDeviceScaleFactor):
        (WebKit::WebViewImpl::computePageScaleFactorLimits):
        (WebKit::WebViewImpl::setIsTransparent):
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        (WebKit::WebViewImpl::scheduleCompositingLayerSync):
        (WebKit::WebViewImpl::invalidateRootLayerRect):
        (WebKit::WebViewImpl::setBackgroundColor):
        (WebKit::WebViewImpl::scheduleAnimation):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        (WebKit::WebViewImpl::updateLayerTreeViewport):
        (WebKit::WebViewImpl::setVisibilityState):
        * src/WebViewImpl.h:
        (WebKit):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCThreadedTest.cpp:
        * tests/CCThreadedTest.h:
        (WebKitTests::TestHooks::animate):
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKit::GraphicsLayerChromiumTest::~GraphicsLayerChromiumTest):
        (GraphicsLayerChromiumTest):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:
        * tests/WebLayerTreeViewTestCommon.h:
        (MockWebLayerTreeViewClient):

2012-08-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-24  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up WebAnimation animationId/groupId generation
        https://bugs.webkit.org/show_bug.cgi?id=94973

        Reviewed by Adrienne Walker.

        * src/WebAnimationImpl.cpp:
        (WebKit::WebAnimation::create):
        (WebKit::WebAnimationImpl::WebAnimationImpl):
        (WebKit::WebAnimationImpl::id):
        (WebKit):
        * src/WebAnimationImpl.h:
        (WebAnimationImpl):
        * tests/AnimationTranslationUtilTest.cpp:
        (WebKit::animationCanBeTranslated):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::TEST_F):

2012-08-24  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Remove visitedLinkHash from PlatformSupport
        https://bugs.webkit.org/show_bug.cgi?id=94965

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-08-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126620.
        http://trac.webkit.org/changeset/126620
        https://bugs.webkit.org/show_bug.cgi?id=94976

        ASSERT((intptr_t)m_bytesAllocated + deltaBytes > 0) is
        triggering on the bots (Requested by jchaffraix on #webkit).

        * WebKit.gypi:
        * tests/Canvas2DLayerManagerTest.cpp: Removed.

2012-08-24  Justin Novosad  <junov@chromium.org>

        [Chromium] Implementing a global limit on memory consumed by deferred 2D canvases
        https://bugs.webkit.org/show_bug.cgi?id=94386

        Reviewed by Stephen White.

        Adding unit tests for WebCore::Canvas2DLayerManager

        * WebKit.gypi:
        * tests/Canvas2DLayerManagerTest.cpp: Added.
        (FakeCanvas2DLayerBridge):
        (FakeCanvas2DLayerBridge::FakeCanvas2DLayerBridge):
        (FakeCanvas2DLayerBridge::fakeFreeableBytes):
        (Canvas2DLayerManagerTest):
        (Canvas2DLayerManagerTest::storageAllocationTrackingTest):
        (Canvas2DLayerManagerTest::evictionTest):
        (Canvas2DLayerManagerTest::flushEvictionTest):

2012-08-24  Cris Neckar  <cdn@chromium.org>

        Plumb consumeUserGesture() to the chromium platform layer.
        https://bugs.webkit.org/show_bug.cgi?id=9475294867

        Reviewed by Adam Barth.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::consumeUserGesture):
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-08-24  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] gestureTapDown should not select a RenderView node as target.
        https://bugs.webkit.org/show_bug.cgi?id=94956

        Reviewed by James Robinson.

        Add check to prevent selecting a RenderView node as a highlight target.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::bestTouchLinkNode):

2012-08-24  Tommy Widenflycht  <tommyw@google.com>

        MediaStream API: Add readyState functionality to RTCPeerConnection
        https://bugs.webkit.org/show_bug.cgi?id=94813

        Reviewed by Adam Barth.

        * src/AssertMatchingEnums.cpp:

2012-08-24  Dan Carney  <dcarney@google.com>

        [V8] Refactor away IsolatedWorld
        https://bugs.webkit.org/show_bug.cgi?id=93971

        Reviewed by Kentaro Hara.

        Remove IsolatedWorld class as it was 1:1 with DOMWrapperWorld.

        * src/WebViewImpl.cpp:
        (WebKit::WebView::addUserScript):
        (WebKit::WebView::addUserStyleSheet):

2012-08-23  Antoine Labour  <piman@chromium.org>

        [chromium] Fix lost context when textures are evicted
        https://bugs.webkit.org/show_bug.cgi?id=94892

        Reviewed by James Robinson.

        After eviction, the CCPrioritizedTextureManager is in a limbo state
        where all its resources are invalid. If we try to release them we will
        double-destroy them.

        New test: CCLayerTreeHostTestLostContextAfterEvictTextures.

        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestLostContextAfterEvictTextures):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::CCLayerTreeHostTestLostContextAfterEvictTextures):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::beginTest):
        (EvictTexturesAndLoseContextTask):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::EvictTexturesAndLoseContextTask::EvictTexturesAndLoseContextTask):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::EvictTexturesAndLoseContextTask::~EvictTexturesAndLoseContextTask):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::EvictTexturesAndLoseContextTask::run):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::postEvictTexturesAndLoseContext):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::didCommitAndDrawFrame):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::didRecreateOutputSurface):
        (WTF::CCLayerTreeHostTestLostContextAfterEvictTextures::afterTest):
        (WTF):
        (WTF::TEST_F):

2012-08-23  Antoine Labour  <piman@chromium.org>

        [chromium] Add OVERRIDEs in test code
        https://bugs.webkit.org/show_bug.cgi?id=94894

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostTest.cpp:

2012-08-23  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Expose mechanism for database to force a connection to close
        https://bugs.webkit.org/show_bug.cgi?id=91010

        Reviewed by Tony Chang.

        In Chromium, the browsing data deleter has a WebIDBDatabase handle which
        it can use to terminate a connection. This handles forcefully closing
        the front end connections and the back end, to unblock disk cleanup.

        * public/WebIDBDatabase.h:
        (WebKit::WebIDBDatabase::forceClose): Entry point.
        * public/WebIDBDatabaseCallbacks.h:
        (WebKit::WebIDBDatabaseCallbacks::onForcedClose): Plumbing back to front.
        * src/IDBDatabaseCallbacksProxy.cpp:
        (WebKit::IDBDatabaseCallbacksProxy::onForcedClose): Plumbing back to front.
        (WebKit):
        * src/IDBDatabaseCallbacksProxy.h:
        (IDBDatabaseCallbacksProxy): Plumbing.
        * src/WebIDBDatabaseCallbacksImpl.cpp:
        (WebKit::WebIDBDatabaseCallbacksImpl::onForcedClose): Plumbing back to front.
        (WebKit):
        * src/WebIDBDatabaseCallbacksImpl.h:
        (WebIDBDatabaseCallbacksImpl): Plumbing back to front.
        * src/WebIDBDatabaseImpl.cpp:
        (WebKit::WebIDBDatabaseImpl::close): Tidy up dropping the callback reference.
        (WebKit):
        (WebKit::WebIDBDatabaseImpl::forceClose): Terminate the connection by notifying
        the back end and the front end, while avoid re-entrant badness.
        * src/WebIDBDatabaseImpl.h: Header tweak for unit test.
        (WebIDBDatabaseImpl):
        * tests/IDBDatabaseBackendTest.cpp: Added unit test to exercise connections.

2012-08-23  James Robinson  <jamesr@chromium.org>

        [chromium] Convert WebAnimationCurve subtypes into pure virtual
        https://bugs.webkit.org/show_bug.cgi?id=94068

        Reviewed by Adrienne Walker.

        Updates the implementations, some callers and tests of Web*AnimationCurve to its new interface.

        * WebKit.gyp:
        * src/WebAnimation.cpp:
        (WebKit::WebAnimation::initialize):
        * src/WebFloatAnimationCurveImpl.cpp: Renamed from Source/WebKit/chromium/src/WebFloatAnimationCurve.cpp.
        (WebKit):
        (WebKit::WebFloatAnimationCurve::create):
        (WebKit::WebFloatAnimationCurveImpl::WebFloatAnimationCurveImpl):
        (WebKit::WebFloatAnimationCurveImpl::~WebFloatAnimationCurveImpl):
        (WebKit::WebFloatAnimationCurveImpl::type):
        (WebKit::WebFloatAnimationCurveImpl::add):
        (WebKit::WebFloatAnimationCurveImpl::getValue):
        (WebKit::WebFloatAnimationCurveImpl::cloneToCCAnimationCurve):
        * src/WebTransformAnimationCurve.cpp: Removed.
        * tests/WebAnimationTest.cpp:
        (WebKit::TEST):
        * tests/WebFloatAnimationCurveTest.cpp:
        (WebKit::TEST):
        * tests/WebTransformAnimationCurveTest.cpp:
        (WebKit::TEST):

2012-08-23  Kentaro Hara  <haraken@chromium.org>

        [V8] Remove V8Proxy.{h,cpp}
        https://bugs.webkit.org/show_bug.cgi?id=94794

        Reviewed by Dimitri Glazkov.

        Now V8Proxy is no longer used. We can completely remove V8Proxy from the codebase.

        No tests. No change in behavior.

        * src/ChromeClientImpl.cpp:
        * src/WebBindings.cpp:
        * src/WebDOMMessageEvent.cpp:
        * src/WebDevToolsAgentImpl.cpp:
        * src/WebMediaPlayerClientImpl.cpp:

2012-08-23  Dana Jansens  <danakj@chromium.org>

        [chromium] Don't require a RenderSurface* in order to create a RenderPass
        https://bugs.webkit.org/show_bug.cgi?id=94862

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCRendererGLTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):

2012-08-22  James Robinson  <jamesr@chromium.org>

        [chromium] Remove WebLayer::setChildren API
        https://bugs.webkit.org/show_bug.cgi?id=94749

        Reviewed by Adrienne Walker.

        * src/WebLayer.cpp:

2012-08-23  Dana Jansens  <danakj@chromium.org>

        [chromium] Create sharedQuadState at same time as creating quads and give them to the quadSink
        https://bugs.webkit.org/show_bug.cgi?id=94752

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::EvictionTestLayerImpl::appendQuads):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        (CCLayerTestCommon::getQuads):
        (CCLayerTestCommon::coverageVisibleRectOnTileBoundaries):
        (CCLayerTestCommon::coverageVisibleRectIntersectsTiles):
        (CCLayerTestCommon::coverageVisibleRectIntersectsBounds):
        * tests/MockCCQuadCuller.h:
        (WebCore::MockCCQuadCuller::MockCCQuadCuller):
        (MockCCQuadCuller):
        (WebCore::MockCCQuadCuller::quadList):
        (WebCore::MockCCQuadCuller::sharedQuadStateList):

2012-08-23  Pavel Feldman  <pfeldman@chromium.org>

        Not reviewed - fixing input list for timeline inspector module.
        https://bugs.webkit.org/show_bug.cgi?id=94829

        * WebKit.gyp:

2012-08-23  Alexandre Elias  <aelias@chromium.org>

        [chromium] Rename LayerRendererChromium to GL-specific name
        https://bugs.webkit.org/show_bug.cgi?id=94835

        Reviewed by James Robinson.

        Over time, LayerRendererChromium has evolved to be a GL-specific
        subclass of CCRenderer that has no awareness of layers (as it operates
        only with drawQuads).

        This patch renames LayerRendererChromium to CCRendererGL, replaces all
        instances of "layerRenderer" with just "renderer", and removes a
        few unnecessary includes of LayerRendererChromium.h.

        * WebKit.gypi:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::drawLayersOnCCThread):
        * tests/CCRendererGLTest.cpp: Renamed from Source/WebKit/chromium/tests/LayerRendererChromiumTest.cpp.
        (FrameCountingMemoryAllocationSettingContext):
        (FrameCountingMemoryAllocationSettingContext::FrameCountingMemoryAllocationSettingContext):
        (FrameCountingMemoryAllocationSettingContext::prepareTexture):
        (FrameCountingMemoryAllocationSettingContext::setMemoryAllocationChangedCallbackCHROMIUM):
        (FrameCountingMemoryAllocationSettingContext::getString):
        (FrameCountingMemoryAllocationSettingContext::frameCount):
        (FrameCountingMemoryAllocationSettingContext::setMemoryAllocation):
        (FakeCCRendererClient):
        (FakeCCRendererClient::FakeCCRendererClient):
        (FakeCCRendererClient::setFullRootLayerDamageCount):
        (FakeCCRendererClient::rootRenderPass):
        (FakeCCRendererClient::renderPassesInDrawOrder):
        (FakeCCRendererClient::renderPasses):
        (FakeCCRendererClient::memoryAllocationLimitBytes):
        (FakeCCRendererGL):
        (FakeCCRendererGL::FakeCCRendererGL):
        (CCRendererGLTest):
        (CCRendererGLTest::CCRendererGLTest):
        (CCRendererGLTest::SetUp):
        (CCRendererGLTest::TearDown):
        (CCRendererGLTest::swapBuffers):
        (CCRendererGLTest::context):
        (TEST_F):
        (ForbidSynchronousCallContext):
        (ForbidSynchronousCallContext::ForbidSynchronousCallContext):
        (ForbidSynchronousCallContext::getActiveAttrib):
        (ForbidSynchronousCallContext::getActiveUniform):
        (ForbidSynchronousCallContext::getAttachedShaders):
        (ForbidSynchronousCallContext::getAttribLocation):
        (ForbidSynchronousCallContext::getBooleanv):
        (ForbidSynchronousCallContext::getBufferParameteriv):
        (ForbidSynchronousCallContext::getContextAttributes):
        (ForbidSynchronousCallContext::getError):
        (ForbidSynchronousCallContext::getFloatv):
        (ForbidSynchronousCallContext::getFramebufferAttachmentParameteriv):
        (ForbidSynchronousCallContext::getIntegerv):
        (ForbidSynchronousCallContext::getProgramiv):
        (ForbidSynchronousCallContext::getShaderiv):
        (ForbidSynchronousCallContext::getString):
        (ForbidSynchronousCallContext::getProgramInfoLog):
        (ForbidSynchronousCallContext::getRenderbufferParameteriv):
        (ForbidSynchronousCallContext::getShaderInfoLog):
        (ForbidSynchronousCallContext::getShaderPrecisionFormat):
        (ForbidSynchronousCallContext::getShaderSource):
        (ForbidSynchronousCallContext::getTexParameterfv):
        (ForbidSynchronousCallContext::getTexParameteriv):
        (ForbidSynchronousCallContext::getUniformfv):
        (ForbidSynchronousCallContext::getUniformiv):
        (ForbidSynchronousCallContext::getUniformLocation):
        (ForbidSynchronousCallContext::getVertexAttribfv):
        (ForbidSynchronousCallContext::getVertexAttribiv):
        (ForbidSynchronousCallContext::getVertexAttribOffset):
        (TEST):
        (LoseContextOnFirstGetContext):
        (LoseContextOnFirstGetContext::LoseContextOnFirstGetContext):
        (ContextThatDoesNotSupportMemoryManagmentExtensions):
        (ContextThatDoesNotSupportMemoryManagmentExtensions::ContextThatDoesNotSupportMemoryManagmentExtensions):
        (ContextThatDoesNotSupportMemoryManagmentExtensions::prepareTexture):
        (ContextThatDoesNotSupportMemoryManagmentExtensions::setMemoryAllocationChangedCallbackCHROMIUM):
        (ContextThatDoesNotSupportMemoryManagmentExtensions::getString):
        (ClearCountingContext):
        (ClearCountingContext::ClearCountingContext):
        (ClearCountingContext::clear):
        (ClearCountingContext::clearCount):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-23  Stephen White  <senorblanco@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-23  Wei Jia  <wjia@chromium.org>

        create different WebKit::WebMediaPlayer based on URL
        https://bugs.webkit.org/show_bug.cgi?id=91301

        Reviewed by Adam Barth.

        Pass URL to WebFrameClient::createMediaPlayer(). This allows creation
        of different WebMediaPlayer implementations based on the URL.

        * public/WebFrameClient.h:
        (WebKit::WebFrameClient::createMediaPlayer): add URL as additional argument.
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::createWebMediaPlayer): add URL as additional argument.
        (WebKit::WebMediaPlayerClientImpl::loadInternal):

2012-08-23  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Move onSuccess(IDBDatabaseBackendInterface) to IDBOpenDBRequest
        https://bugs.webkit.org/show_bug.cgi?id=94757

        Reviewed by Tony Chang.

        Drop onSuccess(IDBDatabaseBackendImpl) overload from test, as it is no longer
        implemented by IDBRequest.

        * tests/IDBRequestTest.cpp:
        (WebCore::TEST):

2012-08-23  Kenneth Russell  <kbr@google.com>

        Convert ScrollableArea ASSERT_NOT_REACHED virtuals into pure virtuals
        https://bugs.webkit.org/show_bug.cgi?id=93306

        Unreviewed build fix.

        * src/ScrollbarGroup.h:

2012-08-23  Adrienne Walker  <enne@google.com>

        Convert ScrollableArea ASSERT_NOT_REACHED virtuals
        https://bugs.webkit.org/show_bug.cgi?id=93306

        Reviewed by Darin Adler.

        Add implementations where necessary to make derived classes concrete.
        Add OVERRIDE for ScrollableArea functions.

        * src/ScrollbarGroup.h:
        (ScrollbarGroup):
        (WebKit::ScrollbarGroup::scrollCornerRect):
        * tests/ScrollAnimatorNoneTest.cpp:
        (MockScrollableArea):

2012-08-23  David Reveman  <reveman@chromium.org>

        [Chromium] Unnecessary delay when starting to update resources with an inactive vsync timer.
        https://bugs.webkit.org/show_bug.cgi?id=94719

        Reviewed by James Robinson.

        * tests/CCSchedulerTestCommon.h:

2012-08-23  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-22  Alec Flett  <alecflett@chromium.org>

        IndexedDB: tests for injection/extraction of idb keys
        https://bugs.webkit.org/show_bug.cgi?id=94653

        Reviewed by Tony Chang.

        Added unit tests for key injection/extraction using
        SerializedScriptValue. These were moved from chromium, now
        that all uses of the API are through WebKit.

        * tests/IDBKeyPathTest.cpp:
        (WebCore):
        (WebCore::TEST):

2012-08-22  James Robinson  <jamesr@chromium.org>

        [chromium] Change WebLayer from a concrete type to a pure virtual interface
        https://bugs.webkit.org/show_bug.cgi?id=94174

        Reviewed by Adrienne Walker.

        This updates the implementation of the Web*Layer family to the new design and updates callers in WebViewImpl /
        NonCompositedContentHost / LinkHighlight.

        * WebKit.gypi:
        * src/LinkHighlight.cpp:
        (WebKit::LinkHighlight::LinkHighlight):
        (WebKit::LinkHighlight::contentLayer):
        (WebKit::LinkHighlight::clipLayer):
        (WebKit::LinkHighlight::releaseResources):
        (WebKit::LinkHighlight::computeHighlightLayerPathAndPosition):
        (WebKit::LinkHighlight::startHighlightAnimation):
        (WebKit::LinkHighlight::updateGeometry):
        * src/LinkHighlight.h:
        (LinkHighlight):
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::scrollLayer):
        * src/NonCompositedContentHost.h:
        * src/WebContentLayer.cpp: Removed.
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayer::create):
        (WebKit::WebContentLayerImpl::WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::layer):
        (WebKit):
        (WebKit::WebContentLayerImpl::setDoubleSided):
        (WebKit::WebContentLayerImpl::setContentsScale):
        (WebKit::WebContentLayerImpl::setUseLCDText):
        (WebKit::WebContentLayerImpl::setDrawCheckerboardForMissingTiles):
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebExternalTextureLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebExternalTextureLayer.cpp.
        (WebKit):
        (WebKit::WebExternalTextureLayer::create):
        (WebKit::WebExternalTextureLayerImpl::WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::~WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::layer):
        (WebKit::WebExternalTextureLayerImpl::setTextureId):
        (WebKit::WebExternalTextureLayerImpl::setFlipped):
        (WebKit::WebExternalTextureLayerImpl::setUVRect):
        (WebKit::WebExternalTextureLayerImpl::setOpaque):
        (WebKit::WebExternalTextureLayerImpl::setPremultipliedAlpha):
        (WebKit::WebExternalTextureLayerImpl::willModifyTexture):
        (WebKit::WebExternalTextureLayerImpl::setRateLimitContext):
        (WebTextureUpdaterImpl):
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        (WebKit::WebExternalTextureLayerImpl::prepareTexture):
        (WebKit::WebExternalTextureLayerImpl::context):
        * src/WebExternalTextureLayerImpl.h: Copied from Source/Platform/chromium/public/WebVideoLayer.h.
        (WebKit):
        (WebExternalTextureLayerImpl):
        * src/WebIOSurfaceLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebIOSurfaceLayer.cpp.
        (WebKit):
        (WebKit::WebIOSurfaceLayer::create):
        (WebKit::WebIOSurfaceLayerImpl::WebIOSurfaceLayerImpl):
        (WebKit::WebIOSurfaceLayerImpl::~WebIOSurfaceLayerImpl):
        (WebKit::WebIOSurfaceLayerImpl::setIOSurfaceProperties):
        (WebKit::WebIOSurfaceLayerImpl::layer):
        * src/WebIOSurfaceLayerImpl.h: Copied from Source/Platform/chromium/public/WebImageLayer.h.
        (WebCore):
        (WebKit):
        (WebIOSurfaceLayerImpl):
        * src/WebImageLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebSolidColorLayer.cpp.
        (WebKit):
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayerImpl::WebImageLayerImpl):
        (WebKit::WebImageLayerImpl::~WebImageLayerImpl):
        (WebKit::WebImageLayerImpl::layer):
        (WebKit::WebImageLayerImpl::setBitmap):
        * src/WebImageLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebImageLayer.cpp.
        (WebCore):
        (WebKit):
        (WebImageLayerImpl):
        * src/WebLayer.cpp: Removed.
        * src/WebLayerImpl.cpp:
        (WebKit::WebLayer::create):
        (WebKit::WebLayerImpl::WebLayerImpl):
        (WebKit::WebLayerImpl::~WebLayerImpl):
        (WebKit):
        (WebKit::WebLayerImpl::id):
        (WebKit::WebLayerImpl::invalidateRect):
        (WebKit::WebLayerImpl::invalidate):
        (WebKit::WebLayerImpl::addChild):
        (WebKit::WebLayerImpl::insertChild):
        (WebKit::WebLayerImpl::replaceChild):
        (WebKit::WebLayerImpl::setChildren):
        (WebKit::WebLayerImpl::removeFromParent):
        (WebKit::WebLayerImpl::removeAllChildren):
        (WebKit::WebLayerImpl::setAnchorPoint):
        (WebKit::WebLayerImpl::anchorPoint):
        (WebKit::WebLayerImpl::setAnchorPointZ):
        (WebKit::WebLayerImpl::anchorPointZ):
        (WebKit::WebLayerImpl::setBounds):
        (WebKit::WebLayerImpl::bounds):
        (WebKit::WebLayerImpl::setMasksToBounds):
        (WebKit::WebLayerImpl::masksToBounds):
        (WebKit::WebLayerImpl::setMaskLayer):
        (WebKit::WebLayerImpl::setReplicaLayer):
        (WebKit::WebLayerImpl::setOpacity):
        (WebKit::WebLayerImpl::opacity):
        (WebKit::WebLayerImpl::setOpaque):
        (WebKit::WebLayerImpl::opaque):
        (WebKit::WebLayerImpl::setPosition):
        (WebKit::WebLayerImpl::position):
        (WebKit::WebLayerImpl::setSublayerTransform):
        (WebKit::WebLayerImpl::sublayerTransform):
        (WebKit::WebLayerImpl::setTransform):
        (WebKit::WebLayerImpl::transform):
        (WebKit::WebLayerImpl::setDrawsContent):
        (WebKit::WebLayerImpl::drawsContent):
        (WebKit::WebLayerImpl::setPreserves3D):
        (WebKit::WebLayerImpl::setUseParentBackfaceVisibility):
        (WebKit::WebLayerImpl::setBackgroundColor):
        (WebKit::WebLayerImpl::setFilters):
        (WebKit::WebLayerImpl::setBackgroundFilters):
        (WebKit::WebLayerImpl::setDebugBorderColor):
        (WebKit::WebLayerImpl::setDebugBorderWidth):
        (WebKit::WebLayerImpl::setDebugName):
        (WebKit::WebLayerImpl::setAnimationDelegate):
        (WebKit::WebLayerImpl::addAnimation):
        (WebKit::WebLayerImpl::removeAnimation):
        (WebKit::WebLayerImpl::pauseAnimation):
        (WebKit::WebLayerImpl::suspendAnimations):
        (WebKit::WebLayerImpl::resumeAnimations):
        (WebKit::WebLayerImpl::hasActiveAnimation):
        (WebKit::WebLayerImpl::transferAnimationsTo):
        (WebKit::WebLayerImpl::setForceRenderSurface):
        (WebKit::WebLayerImpl::setScrollPosition):
        (WebKit::WebLayerImpl::setScrollable):
        (WebKit::WebLayerImpl::setHaveWheelEventHandlers):
        (WebKit::WebLayerImpl::setShouldScrollOnMainThread):
        (WebKit::WebLayerImpl::setNonFastScrollableRegion):
        (WebKit::WebLayerImpl::setIsContainerForFixedPositionLayers):
        (WebKit::WebLayerImpl::setFixedToContainerLayer):
        (WebKit::WebLayerImpl::layer):
        * src/WebLayerImpl.h:
        (WebCore):
        (WebLayerImpl):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setRootLayer):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::create):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        (WebKit::WebMediaPlayerClientImpl::repaint):
        (WebKit::WebMediaPlayerClientImpl::setOpaque):
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        (WebKit::WebMediaPlayerClientImpl::acceleratedRenderingInUse):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        (WebKit::WebPluginContainerImpl::commitBackingTexture):
        (WebKit::WebPluginContainerImpl::setOpaque):
        (WebKit::WebPluginContainerImpl::platformLayer):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):
        * src/WebScrollableLayer.cpp: Removed.
        * src/WebScrollbarLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebScrollbarLayer.cpp.
        (WebKit):
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayerImpl::WebScrollbarLayerImpl):
        (WebKit::WebScrollbarLayerImpl::~WebScrollbarLayerImpl):
        (WebKit::WebScrollbarLayerImpl::layer):
        (WebKit::WebScrollbarLayerImpl::setScrollLayer):
        * src/WebScrollbarLayerImpl.h: Copied from Source/WebKit/chromium/src/WebSolidColorLayerImpl.h.
        (WebCore):
        (WebKit):
        (WebScrollbarLayerImpl):
        * src/WebSolidColorLayerImpl.cpp:
        (WebKit::WebSolidColorLayer::create):
        (WebKit::WebSolidColorLayerImpl::WebSolidColorLayerImpl):
        (WebKit::WebSolidColorLayerImpl::layer):
        (WebKit):
        (WebKit::WebSolidColorLayerImpl::setBackgroundColor):
        * src/WebSolidColorLayerImpl.h:
        (WebCore):
        (WebKit):
        (WebSolidColorLayerImpl):
        * src/WebVideoLayerImpl.cpp: Copied from Source/WebKit/chromium/src/WebVideoLayer.cpp.
        (WebKit):
        (WebKit::WebVideoLayer::create):
        (WebKit::WebVideoLayerImpl::WebVideoLayerImpl):
        (WebKit::WebVideoLayerImpl::~WebVideoLayerImpl):
        (WebKit::WebVideoLayerImpl::layer):
        (WebKit::WebVideoLayerImpl::active):
        * src/WebVideoLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebVideoLayer.cpp.
        (WebCore):
        (WebKit):
        (WebVideoLayerImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        * src/WebViewImpl.h:
        * tests/ImageLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-22  Alejandro Piñeiro  <apinheiro@igalia.com>

        Dojo toggle buttons should expose ROLE_TOGGLE_BUTTON not ROLE_PUSH_BUTTON
        https://bugs.webkit.org/show_bug.cgi?id=73819

        Reviewed by Chris Fleizach.

        Added a new role, Toggle Button, based on whether aria-pressed is present.
        http://www.w3.org/TR/wai-aria/states_and_properties#aria-pressed

        * public/WebAccessibilityRole.h: added WebAccessibilityRoleToggleButton that
        matchs with WebCore ToggleButtonRole
        * src/AssertMatchingEnums.cpp: added the assert matching rule for
        WebAccessibilityRoleToggleButton and ToggleButtonRole

2012-08-17  Jeffrey Pfau  <jpfau@apple.com>

        Allow blocking of Web SQL databases in third-party web workers
        https://bugs.webkit.org/show_bug.cgi?id=94170

        Reviewed by Adam Barth.

        Web workers did not previously know anything about the document that
        spawned them. This is undefined for shared workers, but for dedicated
        workers, we now pipe the information through.


        * src/WebWorkerClientImpl.cpp:
        (WebKit::WebWorkerClientImpl::startWorkerContext): Pass top document's origin

2012-08-22  Kentaro Hara  <haraken@chromium.org>

        [V8] Move context() from V8Proxy to ScriptController
        https://bugs.webkit.org/show_bug.cgi?id=94593

        Reviewed by Adam Barth.

        To kill V8Proxy, we can move context() from V8Proxy to ScriptController.

        No tests. No change in behavior.

        * src/InspectorFrontendClientImpl.cpp:
        (WebKit::InspectorFrontendClientImpl::windowObjectCleared):
        * src/WebDevToolsFrontendImpl.cpp:
        (WebKit::WebDevToolsFrontendImpl::dispatchOnInspectorFrontend):

2012-08-22  Nikhil Bhargava  <nbhargava@google.com>

        Reduce Font.h includes across project -- improves RenderObject.h compile time
        https://bugs.webkit.org/show_bug.cgi?id=93629

        Reviewed by Eric Seidel.

        Adds includes due to change in RenderStyle.h

        * src/WebFrameImpl.cpp:
        * src/mac/WebSubstringUtil.mm:

2012-08-22  Nikhil Bhargava  <nbhargava@google.com>

        Speed up compilation of tests involving WebTransformationMatrix
        https://bugs.webkit.org/show_bug.cgi?id=94639

        Reviewed by James Robinson.

        EXPECT_TRANSFORMATION_MATRIX_EQ was changed to become mainly a function.
        As a macro that expanded into 16 other macros, it caused an unneeded
        slow down of close to 45s in the compile time of CCLayerTreeHostCommonTest
        Bugs have been filed to clang and gcc noting the errant behavior:
        http://llvm.org/bugs/show_bug.cgi?id=13651 and http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54337

        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeTestCommon.h:
        (WebKitTests):
        (WebKitTests::ExpectTransformationMatrixEq):
        * tests/WebTransformOperationsTest.cpp:
        (TEST):
        (checkProgress):
        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):

2012-08-22  Alexandre Elias  <aelias@google.com>

        [chromium] Add software bitmap resources to CCResourceProvider
        https://bugs.webkit.org/show_bug.cgi?id=93677

        Reviewed by Adrienne Walker.

        Second commit after revert.

        This adds the ability to CCResourceProvider to use software bitmaps.
        They are allocated as plain-old-memory, and exposed as Skia objects.

        We want the ResourceProvider to be able to handle different resource
        types at the same time.  In practice, a default resource type is
        desired for most uses within a single compositor instance, which is
        specified by the default resource type.  Default resource types are
        expected to be mostly 1-to-1 with CCRenderer types.

        New tests added by parametrizing existing CCResourceProvider tests.

        * tests/CCResourceProviderTest.cpp:
        (WebKit::CCResourceProviderTest::getResourcePixels):

2012-08-22  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] Add touch link highlight animation layers.
        https://bugs.webkit.org/show_bug.cgi?id=84487

        Reviewed by James Robinson.

        Adds support for creating composited touch link highlights in renderer thread. Clipping not yet
        implemented for non-composited frames/overflow divs, but scrolling and layout changes are supported.
        Transform support currently limited to translation.

        Unit tests for LinkHighlight revised.

        * WebKit.gyp:
        * src/LinkHighlight.cpp: Added.
        (WebKit):
        (WebKit::LinkHighlight::create):
        (WebKit::LinkHighlight::LinkHighlight):
        (WebKit::LinkHighlight::~LinkHighlight):
        (WebKit::LinkHighlight::contentLayer): Accessor for layer containing highlight.
        (WebKit::LinkHighlight::clipLayer): Accessor for layer that provides clipping for highlight.
        (WebKit::LinkHighlight::releaseResources): Releases Node* for highlight target, clears client/delegate pointers.
        (WebKit::LinkHighlight::computeEnclosingCompositingLayer): Determines which GraphicsLayerChromium to attach highlight to.
        (WebKit::LinkHighlight::computeHighlightLayerPathAndPosition): Determines coordinates of highlight in owning GraphicsLayerChromium's coordinates.
        (WebKit::LinkHighlight::paintContents): If highlight active, paints highlight.
        (WebKit::LinkHighlight::startHighlightAnimation): Called to start highlight animation.
        (WebKit::LinkHighlight::clearGraphicsLayerLinkHighlightPointer): Removes this LinkHighlight's pointer from owning GraphicsLayerChromium.
        (WebKit::LinkHighlight::notifyAnimationStarted): Implements WebAnimationDelegate.
        (WebKit::LinkHighlight::notifyAnimationFinished): Implements WebAnimationDelegate, releases resources when animation completes.
        (WebKit::LinkHighlight::updateGeometry): Invokes computation of which GraphicsLayerChromium to attach to, and highlight shape & position.
            Computations proceed only if preceded by call to invalidate().
        (WebKit::LinkHighlight::clearCurrentGraphicsLayer): Handles notification that current GraphicsLayerChromium* is no longer valid.
        (WebKit::LinkHighlight::invalidate): Sets flag to allow geometry update on next call from WebViewImpl::layout().
        (WebKit::LinkHighlight::layer): Exports WebLayer* for use in GraphicsLayerChromium.
        * src/LinkHighlight.h: Renamed from Source/WebCore/platform/graphics/chromium/LinkHighlight.h.
        (WebCore):
        (WebKit):
        (LinkHighlight):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        (WebKit):
        (WebKit::highlightConditions):
        (WebKit::WebViewImpl::bestTouchLinkNode): Find highlight target node for touch event location.
        (WebKit::WebViewImpl::enableTouchHighlight): Invokes highlight for node at current touch event location.
        (WebKit::WebViewImpl::layout): Adds call to LinkHighlight::updateGeometry().
        * src/WebViewImpl.h:
        (WebKit):
        (WebViewImpl):
        (WebKit::WebViewImpl::linkHighlight):
        * tests/LinkHighlightTest.cpp:
        (WebCore):
        (WebCore::TEST):
        * tests/data/test_touch_link_highlight.html: Added.

2012-08-22  Adam Barth  <abarth@webkit.org>

        WebWidget should be able to paint into a zoomed canvas without aliasing
        https://bugs.webkit.org/show_bug.cgi?id=92043

        Reviewed by James Robinson.

        If accelerated compositing is enabled, WebWidget::paint reads back from
        the compositor rather than re-painting the widget. That approach works
        well if the canvas we're rendering into is at a similar resolution to
        the pixels in the compositor, but if the canvas has been scaled (e.g.,
        to help the user disambiguate links), then reading back from the
        compositor will cause aliasing artifacts.

        This patch adds an option to paint to let the embedder request a
        software re-rendering of the widget to avoid these aliasing artifacts.

        * public/WebWidget.h:
        (WebKit::WebWidget::paint):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::paint):
        * src/WebPagePopupImpl.h:
        (WebPagePopupImpl):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):
        * src/WebPopupMenuImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::canvasBackgroundForTransparencey):
        (WebKit):
        (WebKit::WebViewImpl::paint):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-22  Eric Penner  <epenner@google.com>

        [chromium] Simplify updateContentRect, removing rect parameter, refactor unit tests.
        https://bugs.webkit.org/show_bug.cgi?id=94165

        Reviewed by Adrienne Walker.

        Refactored tests to remove lots of boilerplate code.

        * tests/CCTiledLayerTestCommon.cpp:
        * tests/CCTiledLayerTestCommon.h:
        (FakeTiledLayerChromium):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-22  Iain Merrick  <husky@chromium.org>

        [chromium] Remove WebFrame::setSelectionToRange
        https://bugs.webkit.org/show_bug.cgi?id=94685

        Reviewed by Adam Barth.

        It has basically the same functionality as WebFrame::selectRange.
        The calling code was removed in Chromium patch 152608.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-08-22  Kenneth Russell  <kbr@google.com>

        Unreviewed, rolling out r126319.
        http://trac.webkit.org/changeset/126319
        https://bugs.webkit.org/show_bug.cgi?id=84487

        Broke Chromium Mac build

        * WebKit.gyp:
        * src/LinkHighlight.cpp: Removed.
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        (WebKit::WebViewImpl::computeScaleAndScrollForHitRect):
        (WebKit::WebViewImpl::layout):
        * src/WebViewImpl.h:
        (WebKit):
        (WebViewImpl):
        * tests/LinkHighlightTest.cpp:
        * tests/data/test_touch_link_highlight.html: Removed.

2012-08-22  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] Add touch link highlight animation layers.
        https://bugs.webkit.org/show_bug.cgi?id=84487

        Reviewed by James Robinson.

        Adds support for creating composited touch link highlights in renderer thread. Clipping not yet
        implemented for non-composited frames/overflow divs, but scrolling and layout changes are supported.
        Transform support currently limited to translation.

        Unit tests for LinkHighlight revised.

        * WebKit.gyp:
        * src/LinkHighlight.cpp: Added.
        (WebKit):
        (WebKit::LinkHighlight::create):
        (WebKit::LinkHighlight::LinkHighlight):
        (WebKit::LinkHighlight::~LinkHighlight):
        (WebKit::LinkHighlight::contentLayer): Accessor for layer containing highlight.
        (WebKit::LinkHighlight::clipLayer): Accessor for layer that provides clipping for highlight.
        (WebKit::LinkHighlight::releaseResources): Releases Node* for highlight target, clears client/delegate pointers.
        (WebKit::LinkHighlight::computeEnclosingCompositingLayer): Determines which GraphicsLayerChromium to attach highlight to.
        (WebKit::LinkHighlight::computeHighlightLayerPathAndPosition): Determines coordinates of highlight in owning GraphicsLayerChromium's coordinates.
        (WebKit::LinkHighlight::paintContents): If highlight active, paints highlight.
        (WebKit::LinkHighlight::startHighlightAnimation): Called to start highlight animation.
        (WebKit::LinkHighlight::clearGraphicsLayerLinkHighlightPointer): Removes this LinkHighlight's pointer from owning GraphicsLayerChromium.
        (WebKit::LinkHighlight::notifyAnimationStarted): Implements WebAnimationDelegate.
        (WebKit::LinkHighlight::notifyAnimationFinished): Implements WebAnimationDelegate, releases resources when animation completes.
        (WebKit::LinkHighlight::updateGeometry): Invokes computation of which GraphicsLayerChromium to attach to, and highlight shape & position.
            Computations proceed only if preceded by call to invalidate().
        (WebKit::LinkHighlight::clearCurrentGraphicsLayer): Handles notification that current GraphicsLayerChromium* is no longer valid.
        (WebKit::LinkHighlight::invalidate): Sets flag to allow geometry update on next call from WebViewImpl::layout().
        (WebKit::LinkHighlight::layer): Exports WebLayer* for use in GraphicsLayerChromium.
        * src/LinkHighlight.h: Renamed from Source/WebCore/platform/graphics/chromium/LinkHighlight.h.
        (WebCore):
        (WebKit):
        (LinkHighlight):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):
        (WebKit):
        (WebKit::highlightConditions):
        (WebKit::WebViewImpl::bestTouchLinkNode): Find highlight target node for touch event location.
        (WebKit::WebViewImpl::enableTouchHighlight): Invokes highlight for node at current touch event location.
        (WebKit::WebViewImpl::layout): Adds call to LinkHighlight::updateGeometry().
        * src/WebViewImpl.h:
        (WebKit):
        (WebViewImpl):
        (WebKit::WebViewImpl::linkHighlight):
        * tests/LinkHighlightTest.cpp:
        (WebCore):
        (WebCore::TEST):
        * tests/data/test_touch_link_highlight.html: Added.

2012-08-22  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-21  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126202.
        http://trac.webkit.org/changeset/126202
        https://bugs.webkit.org/show_bug.cgi?id=94657

        Causes assertion failures on Chromium Linux dbg compositing
        layout tests (Requested by dominicc on #webkit).

        * tests/CCResourceProviderTest.cpp:
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        (WebKit::CCResourceProviderTest::getResourcePixels):
        (WebKit::TEST_F):

2012-08-21  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Find-in-page coordinates should use containingBlock
        https://bugs.webkit.org/show_bug.cgi?id=94343

        Reviewed by Julien Chaffraix.

        The current implementation uses the container method to climb the render tree.
        However, it would be more correct and convenient to use containingBlock instead.
        Also, this patch introduces new tests for find-in-page coordinates in tables.

        * src/FindInPageCoordinates.cpp:
        (WebKit::toNormalizedRect): use containingBlock and get rid of the output parameter as it's not required now.
        (WebKit::findInPageRectFromAbsoluteRect): use containingBlock introduce some simplifications.
        * tests/WebFrameTest.cpp: add new tests for tables.
        * tests/data/find_in_page.html:
        * tests/data/find_in_page_frame.html: new tests for tables.

2012-08-21  Alexandre Elias  <aelias@google.com>

        [chromium] Add software bitmap resources to CCResourceProvider
        https://bugs.webkit.org/show_bug.cgi?id=93677

        Reviewed by Adrienne Walker.

        This adds the ability to CCResourceProvider to use software bitmaps.
        They are allocated as plain-old-memory, and exposed as Skia objects.

        We want the ResourceProvider to be able to handle different resource
        types at the same time.  In practice, a default resource type is
        desired for most uses within a single compositor instance, which is
        specified by the default resource type.  Default resource types are
        expected to be mostly 1-to-1 with CCRenderer types.

        New tests added by parametrizing existing CCResourceProvider tests.

        * tests/CCResourceProviderTest.cpp:
        (WebKit::CCResourceProviderTest::getResourcePixels):

2012-08-21  Oli Lan  <olilan@chromium.org>

        [chromium] Add WebView methods setCompositionFromExistingText and extendSelectionAndDelete.
        https://bugs.webkit.org/show_bug.cgi?id=93724

        Reviewed by Ryosuke Niwa.

        This adds two new methods to WebViewImpl.

        1) setCompositionFromExistingText creates a new composition from the existing text
        in the currently focused input field. The new composition is between the two offsets
        provided, relative to the rootEditableElement. The current selection is left unchanged.
        
        2) extendSelectionAndDelete extends the selection by the specified number of characters
        before and after, and then deletes the selection. If the selection is just a caret, the effect
        is to delete the specified number of characters before and after the current editing point.

        These methods will be used e.g. by the Android port to implement IME functionality.

        New tests WebViewTest.ExtendSelectionAndDelete and WebViewTest.SetCompositionFromExistingText
        test the two new methods.       

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setComposingRegion):
        (WebKit):
        (WebKit::extendSelectionAndDelete):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/WebViewTest.cpp:

2012-08-21  Alec Flett  <alecflett@chromium.org>

        IndexedDB: remove old update/openCursor glue
        https://bugs.webkit.org/show_bug.cgi?id=94378

        Reviewed by Tony Chang.

        Remove Chromium/WebKit API for old methods that have now been
        removed from chromium proper.

        * public/WebIDBObjectStore.h:
        * src/IDBObjectStoreBackendProxy.cpp:
        * src/IDBObjectStoreBackendProxy.h:
        (IDBObjectStoreBackendProxy):
        * src/WebIDBObjectStoreImpl.h:
        (WebIDBObjectStoreImpl):

2012-08-21  James Robinson  <jamesr@chromium.org>

        [chromium] Should be able to destroy a CCLayerTreeHost without manually setting the root layer
        https://bugs.webkit.org/show_bug.cgi?id=94631

        Reviewed by Adrienne Walker.

        Tests that destroying a CCLayerTreeHost that still points to a non-null root doesn't crash.

        * tests/LayerChromiumTest.cpp:

2012-08-21  James Robinson  <jamesr@chromium.org>

        Unreviewed, rolling out r126170.
        http://trac.webkit.org/changeset/126170
        https://bugs.webkit.org/show_bug.cgi?id=94614

        I spoke too soon

        * WebKit.gypi:
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::scrollLayer):
        * src/NonCompositedContentHost.h:
        * src/WebContentLayer.cpp: Renamed from Source/WebKit/chromium/src/WebVideoLayerImpl.cpp.
        (WebKit):
        (WebKit::WebContentLayer::create):
        (WebKit::WebContentLayer::clearClient):
        (WebKit::WebContentLayer::setDoubleSided):
        (WebKit::WebContentLayer::setContentsScale):
        (WebKit::WebContentLayer::setUseLCDText):
        (WebKit::WebContentLayer::setDrawCheckerboardForMissingTiles):
        (WebKit::WebContentLayer::WebContentLayer):
        (WebKit::WebContentLayer::operator=):
        (WebKit::WebContentLayer::operator PassRefPtr<ContentLayerChromium>):
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::create):
        (WebKit::WebContentLayerImpl::WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebExternalTextureLayer.cpp: Renamed from Source/WebKit/chromium/src/WebExternalTextureLayerImpl.cpp.
        (WebKit):
        (WebTextureUpdaterImpl):
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        (WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayer::create):
        (WebKit::WebExternalTextureLayer::clearClient):
        (WebKit::WebExternalTextureLayer::setTextureId):
        (WebKit::WebExternalTextureLayer::setFlipped):
        (WebKit::WebExternalTextureLayer::setUVRect):
        (WebKit::WebExternalTextureLayer::setOpaque):
        (WebKit::WebExternalTextureLayer::setPremultipliedAlpha):
        (WebKit::WebExternalTextureLayer::willModifyTexture):
        (WebKit::WebExternalTextureLayer::setRateLimitContext):
        (WebKit::WebExternalTextureLayer::WebExternalTextureLayer):
        * src/WebExternalTextureLayerImpl.h: Removed.
        * src/WebIOSurfaceLayer.cpp: Renamed from Source/WebKit/chromium/src/WebIOSurfaceLayerImpl.cpp.
        (WebKit):
        (WebKit::WebIOSurfaceLayer::create):
        (WebKit::WebIOSurfaceLayer::setIOSurfaceProperties):
        (WebKit::WebIOSurfaceLayer::WebIOSurfaceLayer):
        * src/WebIOSurfaceLayerImpl.h: Removed.
        * src/WebImageLayer.cpp: Renamed from Source/WebKit/chromium/src/WebImageLayerImpl.h.
        (WebKit):
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayer::WebImageLayer):
        (WebKit::WebImageLayer::setBitmap):
        * src/WebLayer.cpp: Added.
        (WebKit):
        (WebKit::WebLayer::create):
        (WebKit::WebLayer::reset):
        (WebKit::WebLayer::assign):
        (WebKit::WebLayer::equals):
        (WebKit::WebLayer::invalidateRect):
        (WebKit::WebLayer::invalidate):
        (WebKit::WebLayer::addChild):
        (WebKit::WebLayer::insertChild):
        (WebKit::WebLayer::replaceChild):
        (WebKit::WebLayer::setChildren):
        (WebKit::WebLayer::removeFromParent):
        (WebKit::WebLayer::removeAllChildren):
        (WebKit::WebLayer::setAnchorPoint):
        (WebKit::WebLayer::anchorPoint):
        (WebKit::WebLayer::setAnchorPointZ):
        (WebKit::WebLayer::anchorPointZ):
        (WebKit::WebLayer::setBounds):
        (WebKit::WebLayer::bounds):
        (WebKit::WebLayer::setMasksToBounds):
        (WebKit::WebLayer::masksToBounds):
        (WebKit::WebLayer::setMaskLayer):
        (WebKit::WebLayer::setReplicaLayer):
        (WebKit::WebLayer::setOpacity):
        (WebKit::WebLayer::opacity):
        (WebKit::WebLayer::setOpaque):
        (WebKit::WebLayer::opaque):
        (WebKit::WebLayer::setPosition):
        (WebKit::WebLayer::position):
        (WebKit::WebLayer::setSublayerTransform):
        (WebKit::WebLayer::sublayerTransform):
        (WebKit::WebLayer::setTransform):
        (WebKit::WebLayer::transform):
        (WebKit::WebLayer::setDrawsContent):
        (WebKit::WebLayer::drawsContent):
        (WebKit::WebLayer::setPreserves3D):
        (WebKit::WebLayer::setUseParentBackfaceVisibility):
        (WebKit::WebLayer::setBackgroundColor):
        (WebKit::WebLayer::setFilters):
        (WebKit::WebLayer::setBackgroundFilters):
        (WebKit::WebLayer::setDebugBorderColor):
        (WebKit::WebLayer::setDebugBorderWidth):
        (WebKit::WebLayer::setDebugName):
        (WebKit::WebLayer::setAnimationDelegate):
        (WebKit::WebLayer::addAnimation):
        (WebKit::WebLayer::removeAnimation):
        (WebKit::WebLayer::pauseAnimation):
        (WebKit::WebLayer::suspendAnimations):
        (WebKit::WebLayer::resumeAnimations):
        (WebKit::WebLayer::hasActiveAnimation):
        (WebKit::WebLayer::transferAnimationsTo):
        (WebKit::WebLayer::setForceRenderSurface):
        (WebKit::WebLayer::clearRenderSurface):
        (WebKit::WebLayer::WebLayer):
        (WebKit::WebLayer::operator=):
        (WebKit::WebLayer::operator PassRefPtr<LayerChromium>):
        * src/WebLayerImpl.cpp:
        (WebKit::WebLayerImpl::create):
        (WebKit::WebLayerImpl::WebLayerImpl):
        (WebKit::WebLayerImpl::~WebLayerImpl):
        * src/WebLayerImpl.h:
        (WebLayerImpl):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setRootLayer):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::create):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        (WebKit::WebMediaPlayerClientImpl::repaint):
        (WebKit::WebMediaPlayerClientImpl::setOpaque):
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        (WebKit::WebMediaPlayerClientImpl::acceleratedRenderingInUse):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        (WebKit::WebPluginContainerImpl::commitBackingTexture):
        (WebKit::WebPluginContainerImpl::setOpaque):
        (WebKit::WebPluginContainerImpl::platformLayer):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):
        * src/WebScrollableLayer.cpp: Renamed from Source/WebKit/chromium/src/WebImageLayerImpl.cpp.
        (WebKit):
        (WebKit::WebScrollableLayer::setScrollPosition):
        (WebKit::WebScrollableLayer::setScrollable):
        (WebKit::WebScrollableLayer::setHaveWheelEventHandlers):
        (WebKit::WebScrollableLayer::setShouldScrollOnMainThread):
        (WebKit::WebScrollableLayer::setNonFastScrollableRegion):
        (WebKit::WebScrollableLayer::setIsContainerForFixedPositionLayers):
        (WebKit::WebScrollableLayer::setFixedToContainerLayer):
        * src/WebScrollbarLayer.cpp: Renamed from Source/WebKit/chromium/src/WebScrollbarLayerImpl.cpp.
        (WebKit):
        (WebKit::WebScrollbarLayer::setScrollLayer):
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayer::WebScrollbarLayer):
        (WebKit::WebScrollbarLayer::operator=):
        (WebKit::WebScrollbarLayer::operator PassRefPtr<ScrollbarLayerChromium>):
        * src/WebScrollbarLayerImpl.h: Removed.
        * src/WebSolidColorLayer.cpp: Copied from Source/Platform/chromium/public/WebSolidColorLayer.h.
        (WebKit):
        (WebKit::WebSolidColorLayer::create):
        (WebKit::WebSolidColorLayer::WebSolidColorLayer):
        (WebKit::WebSolidColorLayer::setBackgroundColor):
        * src/WebSolidColorLayerImpl.cpp:
        (WebKit::WebSolidColorLayerImpl::create):
        (WebKit::WebSolidColorLayerImpl::WebSolidColorLayerImpl):
        * src/WebSolidColorLayerImpl.h:
        (WebSolidColorLayerImpl):
        * src/WebVideoLayer.cpp: Renamed from Source/WebKit/chromium/src/WebVideoLayerImpl.h.
        (WebKit):
        (WebKit::WebVideoLayer::create):
        (WebKit::WebVideoLayer::WebVideoLayer):
        (WebKit::WebVideoLayer::active):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        * src/WebViewImpl.h:
        * tests/ImageLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-21  James Robinson  <jamesr@chromium.org>

        Unreviewed, rolling out r126169.
        http://trac.webkit.org/changeset/126169
        https://bugs.webkit.org/show_bug.cgi?id=94614

        Crashes already fixed downstream

        * WebKit.gypi:
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::scrollLayer):
        * src/NonCompositedContentHost.h:
        * src/WebContentLayer.cpp: Removed.
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayer::create):
        (WebKit::WebContentLayerImpl::WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::layer):
        (WebKit):
        (WebKit::WebContentLayerImpl::setDoubleSided):
        (WebKit::WebContentLayerImpl::setContentsScale):
        (WebKit::WebContentLayerImpl::setUseLCDText):
        (WebKit::WebContentLayerImpl::setDrawCheckerboardForMissingTiles):
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebExternalTextureLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebExternalTextureLayer.cpp.
        (WebKit):
        (WebKit::WebExternalTextureLayer::create):
        (WebKit::WebExternalTextureLayerImpl::WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::~WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::layer):
        (WebKit::WebExternalTextureLayerImpl::setTextureId):
        (WebKit::WebExternalTextureLayerImpl::setFlipped):
        (WebKit::WebExternalTextureLayerImpl::setUVRect):
        (WebKit::WebExternalTextureLayerImpl::setOpaque):
        (WebKit::WebExternalTextureLayerImpl::setPremultipliedAlpha):
        (WebKit::WebExternalTextureLayerImpl::willModifyTexture):
        (WebKit::WebExternalTextureLayerImpl::setRateLimitContext):
        (WebTextureUpdaterImpl):
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        (WebKit::WebExternalTextureLayerImpl::prepareTexture):
        (WebKit::WebExternalTextureLayerImpl::context):
        * src/WebExternalTextureLayerImpl.h: Copied from Source/Platform/chromium/public/WebVideoLayer.h.
        (WebKit):
        (WebExternalTextureLayerImpl):
        * src/WebIOSurfaceLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebIOSurfaceLayer.cpp.
        (WebKit):
        (WebKit::WebIOSurfaceLayer::create):
        (WebKit::WebIOSurfaceLayerImpl::WebIOSurfaceLayerImpl):
        (WebKit::WebIOSurfaceLayerImpl::~WebIOSurfaceLayerImpl):
        (WebKit::WebIOSurfaceLayerImpl::setIOSurfaceProperties):
        (WebKit::WebIOSurfaceLayerImpl::layer):
        * src/WebIOSurfaceLayerImpl.h: Copied from Source/Platform/chromium/public/WebImageLayer.h.
        (WebCore):
        (WebKit):
        (WebIOSurfaceLayerImpl):
        * src/WebImageLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebSolidColorLayer.cpp.
        (WebKit):
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayerImpl::WebImageLayerImpl):
        (WebKit::WebImageLayerImpl::~WebImageLayerImpl):
        (WebKit::WebImageLayerImpl::layer):
        (WebKit::WebImageLayerImpl::setBitmap):
        * src/WebImageLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebImageLayer.cpp.
        (WebCore):
        (WebKit):
        (WebImageLayerImpl):
        * src/WebLayer.cpp: Removed.
        * src/WebLayerImpl.cpp:
        (WebKit::WebLayer::create):
        (WebKit::WebLayerImpl::WebLayerImpl):
        (WebKit::WebLayerImpl::~WebLayerImpl):
        (WebKit):
        (WebKit::WebLayerImpl::id):
        (WebKit::WebLayerImpl::invalidateRect):
        (WebKit::WebLayerImpl::invalidate):
        (WebKit::WebLayerImpl::addChild):
        (WebKit::WebLayerImpl::insertChild):
        (WebKit::WebLayerImpl::replaceChild):
        (WebKit::WebLayerImpl::setChildren):
        (WebKit::WebLayerImpl::removeFromParent):
        (WebKit::WebLayerImpl::removeAllChildren):
        (WebKit::WebLayerImpl::setAnchorPoint):
        (WebKit::WebLayerImpl::anchorPoint):
        (WebKit::WebLayerImpl::setAnchorPointZ):
        (WebKit::WebLayerImpl::anchorPointZ):
        (WebKit::WebLayerImpl::setBounds):
        (WebKit::WebLayerImpl::bounds):
        (WebKit::WebLayerImpl::setMasksToBounds):
        (WebKit::WebLayerImpl::masksToBounds):
        (WebKit::WebLayerImpl::setMaskLayer):
        (WebKit::WebLayerImpl::setReplicaLayer):
        (WebKit::WebLayerImpl::setOpacity):
        (WebKit::WebLayerImpl::opacity):
        (WebKit::WebLayerImpl::setOpaque):
        (WebKit::WebLayerImpl::opaque):
        (WebKit::WebLayerImpl::setPosition):
        (WebKit::WebLayerImpl::position):
        (WebKit::WebLayerImpl::setSublayerTransform):
        (WebKit::WebLayerImpl::sublayerTransform):
        (WebKit::WebLayerImpl::setTransform):
        (WebKit::WebLayerImpl::transform):
        (WebKit::WebLayerImpl::setDrawsContent):
        (WebKit::WebLayerImpl::drawsContent):
        (WebKit::WebLayerImpl::setPreserves3D):
        (WebKit::WebLayerImpl::setUseParentBackfaceVisibility):
        (WebKit::WebLayerImpl::setBackgroundColor):
        (WebKit::WebLayerImpl::setFilters):
        (WebKit::WebLayerImpl::setBackgroundFilters):
        (WebKit::WebLayerImpl::setDebugBorderColor):
        (WebKit::WebLayerImpl::setDebugBorderWidth):
        (WebKit::WebLayerImpl::setDebugName):
        (WebKit::WebLayerImpl::setAnimationDelegate):
        (WebKit::WebLayerImpl::addAnimation):
        (WebKit::WebLayerImpl::removeAnimation):
        (WebKit::WebLayerImpl::pauseAnimation):
        (WebKit::WebLayerImpl::suspendAnimations):
        (WebKit::WebLayerImpl::resumeAnimations):
        (WebKit::WebLayerImpl::hasActiveAnimation):
        (WebKit::WebLayerImpl::transferAnimationsTo):
        (WebKit::WebLayerImpl::setForceRenderSurface):
        (WebKit::WebLayerImpl::setScrollPosition):
        (WebKit::WebLayerImpl::setScrollable):
        (WebKit::WebLayerImpl::setHaveWheelEventHandlers):
        (WebKit::WebLayerImpl::setShouldScrollOnMainThread):
        (WebKit::WebLayerImpl::setNonFastScrollableRegion):
        (WebKit::WebLayerImpl::setIsContainerForFixedPositionLayers):
        (WebKit::WebLayerImpl::setFixedToContainerLayer):
        (WebKit::WebLayerImpl::layer):
        * src/WebLayerImpl.h:
        (WebCore):
        (WebLayerImpl):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setRootLayer):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::create):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        (WebKit::WebMediaPlayerClientImpl::repaint):
        (WebKit::WebMediaPlayerClientImpl::setOpaque):
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        (WebKit::WebMediaPlayerClientImpl::acceleratedRenderingInUse):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        (WebKit::WebPluginContainerImpl::commitBackingTexture):
        (WebKit::WebPluginContainerImpl::setOpaque):
        (WebKit::WebPluginContainerImpl::platformLayer):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):
        * src/WebScrollableLayer.cpp: Removed.
        * src/WebScrollbarLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebScrollbarLayer.cpp.
        (WebKit):
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayerImpl::WebScrollbarLayerImpl):
        (WebKit::WebScrollbarLayerImpl::~WebScrollbarLayerImpl):
        (WebKit::WebScrollbarLayerImpl::layer):
        (WebKit::WebScrollbarLayerImpl::setScrollLayer):
        * src/WebScrollbarLayerImpl.h: Copied from Source/WebKit/chromium/src/WebSolidColorLayerImpl.h.
        (WebCore):
        (WebKit):
        (WebScrollbarLayerImpl):
        * src/WebSolidColorLayerImpl.cpp:
        (WebKit::WebSolidColorLayer::create):
        (WebKit::WebSolidColorLayerImpl::WebSolidColorLayerImpl):
        (WebKit::WebSolidColorLayerImpl::layer):
        (WebKit):
        (WebKit::WebSolidColorLayerImpl::setBackgroundColor):
        * src/WebSolidColorLayerImpl.h:
        (WebCore):
        (WebKit):
        (WebSolidColorLayerImpl):
        * src/WebVideoLayerImpl.cpp: Copied from Source/WebKit/chromium/src/WebVideoLayer.cpp.
        (WebKit):
        (WebKit::WebVideoLayer::create):
        (WebKit::WebVideoLayerImpl::WebVideoLayerImpl):
        (WebKit::WebVideoLayerImpl::~WebVideoLayerImpl):
        (WebKit::WebVideoLayerImpl::layer):
        (WebKit::WebVideoLayerImpl::active):
        * src/WebVideoLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebVideoLayer.cpp.
        (WebCore):
        (WebKit):
        (WebVideoLayerImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        * src/WebViewImpl.h:
        * tests/ImageLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-21  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126076, r126099, and r126106.
        http://trac.webkit.org/changeset/126076
        http://trac.webkit.org/changeset/126099
        http://trac.webkit.org/changeset/126106
        https://bugs.webkit.org/show_bug.cgi?id=94614

        Caused crashes during compositor shutdown in Aura builds of
        Chromium (Requested by kbr_google on #webkit).

        * WebKit.gypi:
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::scrollLayer):
        * src/NonCompositedContentHost.h:
        * src/WebContentLayer.cpp: Renamed from Source/WebKit/chromium/src/WebVideoLayerImpl.cpp.
        (WebKit):
        (WebKit::WebContentLayer::create):
        (WebKit::WebContentLayer::clearClient):
        (WebKit::WebContentLayer::setDoubleSided):
        (WebKit::WebContentLayer::setContentsScale):
        (WebKit::WebContentLayer::setUseLCDText):
        (WebKit::WebContentLayer::setDrawCheckerboardForMissingTiles):
        (WebKit::WebContentLayer::WebContentLayer):
        (WebKit::WebContentLayer::operator=):
        (WebKit::WebContentLayer::operator PassRefPtr<ContentLayerChromium>):
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::create):
        (WebKit::WebContentLayerImpl::WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebExternalTextureLayer.cpp: Renamed from Source/WebKit/chromium/src/WebExternalTextureLayerImpl.cpp.
        (WebKit):
        (WebTextureUpdaterImpl):
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        (WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayer::create):
        (WebKit::WebExternalTextureLayer::clearClient):
        (WebKit::WebExternalTextureLayer::setTextureId):
        (WebKit::WebExternalTextureLayer::setFlipped):
        (WebKit::WebExternalTextureLayer::setUVRect):
        (WebKit::WebExternalTextureLayer::setOpaque):
        (WebKit::WebExternalTextureLayer::setPremultipliedAlpha):
        (WebKit::WebExternalTextureLayer::willModifyTexture):
        (WebKit::WebExternalTextureLayer::setRateLimitContext):
        (WebKit::WebExternalTextureLayer::WebExternalTextureLayer):
        * src/WebExternalTextureLayerImpl.h: Removed.
        * src/WebIOSurfaceLayer.cpp: Renamed from Source/WebKit/chromium/src/WebIOSurfaceLayerImpl.cpp.
        (WebKit):
        (WebKit::WebIOSurfaceLayer::create):
        (WebKit::WebIOSurfaceLayer::setIOSurfaceProperties):
        (WebKit::WebIOSurfaceLayer::WebIOSurfaceLayer):
        * src/WebIOSurfaceLayerImpl.h: Removed.
        * src/WebImageLayer.cpp: Renamed from Source/WebKit/chromium/src/WebImageLayerImpl.h.
        (WebKit):
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayer::WebImageLayer):
        (WebKit::WebImageLayer::setBitmap):
        * src/WebLayer.cpp: Added.
        (WebKit):
        (WebKit::WebLayer::create):
        (WebKit::WebLayer::reset):
        (WebKit::WebLayer::assign):
        (WebKit::WebLayer::equals):
        (WebKit::WebLayer::invalidateRect):
        (WebKit::WebLayer::invalidate):
        (WebKit::WebLayer::addChild):
        (WebKit::WebLayer::insertChild):
        (WebKit::WebLayer::replaceChild):
        (WebKit::WebLayer::setChildren):
        (WebKit::WebLayer::removeFromParent):
        (WebKit::WebLayer::removeAllChildren):
        (WebKit::WebLayer::setAnchorPoint):
        (WebKit::WebLayer::anchorPoint):
        (WebKit::WebLayer::setAnchorPointZ):
        (WebKit::WebLayer::anchorPointZ):
        (WebKit::WebLayer::setBounds):
        (WebKit::WebLayer::bounds):
        (WebKit::WebLayer::setMasksToBounds):
        (WebKit::WebLayer::masksToBounds):
        (WebKit::WebLayer::setMaskLayer):
        (WebKit::WebLayer::setReplicaLayer):
        (WebKit::WebLayer::setOpacity):
        (WebKit::WebLayer::opacity):
        (WebKit::WebLayer::setOpaque):
        (WebKit::WebLayer::opaque):
        (WebKit::WebLayer::setPosition):
        (WebKit::WebLayer::position):
        (WebKit::WebLayer::setSublayerTransform):
        (WebKit::WebLayer::sublayerTransform):
        (WebKit::WebLayer::setTransform):
        (WebKit::WebLayer::transform):
        (WebKit::WebLayer::setDrawsContent):
        (WebKit::WebLayer::drawsContent):
        (WebKit::WebLayer::setPreserves3D):
        (WebKit::WebLayer::setUseParentBackfaceVisibility):
        (WebKit::WebLayer::setBackgroundColor):
        (WebKit::WebLayer::setFilters):
        (WebKit::WebLayer::setBackgroundFilters):
        (WebKit::WebLayer::setDebugBorderColor):
        (WebKit::WebLayer::setDebugBorderWidth):
        (WebKit::WebLayer::setDebugName):
        (WebKit::WebLayer::setAnimationDelegate):
        (WebKit::WebLayer::addAnimation):
        (WebKit::WebLayer::removeAnimation):
        (WebKit::WebLayer::pauseAnimation):
        (WebKit::WebLayer::suspendAnimations):
        (WebKit::WebLayer::resumeAnimations):
        (WebKit::WebLayer::hasActiveAnimation):
        (WebKit::WebLayer::transferAnimationsTo):
        (WebKit::WebLayer::setForceRenderSurface):
        (WebKit::WebLayer::clearRenderSurface):
        (WebKit::WebLayer::WebLayer):
        (WebKit::WebLayer::operator=):
        (WebKit::WebLayer::operator PassRefPtr<LayerChromium>):
        * src/WebLayerImpl.cpp:
        (WebKit::WebLayerImpl::create):
        (WebKit::WebLayerImpl::WebLayerImpl):
        (WebKit::WebLayerImpl::~WebLayerImpl):
        * src/WebLayerImpl.h:
        (WebLayerImpl):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setRootLayer):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::create):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        (WebKit::WebMediaPlayerClientImpl::repaint):
        (WebKit::WebMediaPlayerClientImpl::setOpaque):
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        (WebKit::WebMediaPlayerClientImpl::acceleratedRenderingInUse):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        (WebKit::WebPluginContainerImpl::commitBackingTexture):
        (WebKit::WebPluginContainerImpl::setOpaque):
        (WebKit::WebPluginContainerImpl::platformLayer):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):
        * src/WebScrollableLayer.cpp: Renamed from Source/WebKit/chromium/src/WebImageLayerImpl.cpp.
        (WebKit):
        (WebKit::WebScrollableLayer::setScrollPosition):
        (WebKit::WebScrollableLayer::setScrollable):
        (WebKit::WebScrollableLayer::setHaveWheelEventHandlers):
        (WebKit::WebScrollableLayer::setShouldScrollOnMainThread):
        (WebKit::WebScrollableLayer::setNonFastScrollableRegion):
        (WebKit::WebScrollableLayer::setIsContainerForFixedPositionLayers):
        (WebKit::WebScrollableLayer::setFixedToContainerLayer):
        * src/WebScrollbarLayer.cpp: Renamed from Source/WebKit/chromium/src/WebScrollbarLayerImpl.cpp.
        (WebKit):
        (WebKit::WebScrollbarLayer::setScrollLayer):
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayer::WebScrollbarLayer):
        (WebKit::WebScrollbarLayer::operator=):
        (WebKit::WebScrollbarLayer::operator PassRefPtr<ScrollbarLayerChromium>):
        * src/WebScrollbarLayerImpl.h: Removed.
        * src/WebSolidColorLayer.cpp: Copied from Source/Platform/chromium/public/WebSolidColorLayer.h.
        (WebKit):
        (WebKit::WebSolidColorLayer::create):
        (WebKit::WebSolidColorLayer::WebSolidColorLayer):
        (WebKit::WebSolidColorLayer::setBackgroundColor):
        * src/WebSolidColorLayerImpl.cpp:
        (WebKit::WebSolidColorLayerImpl::create):
        (WebKit::WebSolidColorLayerImpl::WebSolidColorLayerImpl):
        * src/WebSolidColorLayerImpl.h:
        (WebSolidColorLayerImpl):
        * src/WebVideoLayer.cpp: Renamed from Source/WebKit/chromium/src/WebVideoLayerImpl.h.
        (WebKit):
        (WebKit::WebVideoLayer::create):
        (WebKit::WebVideoLayer::WebVideoLayer):
        (WebKit::WebVideoLayer::active):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        * src/WebViewImpl.h:
        * tests/ImageLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-21  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: NMI: rename addMember for strings and KURL to addInstrumentedMember.
        https://bugs.webkit.org/show_bug.cgi?id=94580

        Reviewed by Yury Semikhatsky.

        Drive by fix: immutable ElementAttrybuteData uses the same trick with placement new as in StylePropertySet.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::TEST):
        (WebCore):

2012-08-21  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-20  Kent Tamura  <tkent@chromium.org>

        [Chromium-win] Use native digits in parsing/formatting dates in the textfield part of input[type=date]
        https://bugs.webkit.org/show_bug.cgi?id=94281

        Reviewed by Hajime Morita.

        * tests/LocaleWinTest.cpp:
        (TEST_F): Added formatting and parsing tests for Persian locale to check
        native digit behavior.

2012-08-20  Kent Tamura  <tkent@chromium.org>

        [Chromium] Make the popup positioning code testable
        https://bugs.webkit.org/show_bug.cgi?id=94086

        Reviewed by Hajime Morita.

        * WebKit.gypi: Add PopupContainerTest.cpp.
        * tests/PopupContainerTest.cpp: Added.
        (MockPopupContent):
        (calculatePosition):
        (TEST):

2012-08-20  Scott Graham  <scottmg@chromium.org>

        [Chromium] Fix warnings on Windows builds
        https://bugs.webkit.org/show_bug.cgi?id=94543

        Reviewed by Adrienne Walker.

        * tests/CCMathUtilTest.cpp:

2012-08-20  Adam Klein  <adamk@chromium.org>

        Allow MutationEvents to be enabled/disabled per context
        https://bugs.webkit.org/show_bug.cgi?id=94016

        Reviewed by Ojan Vafai.

        Add Chromium/WebKit API for enabling/disabling MutationEvents via
        WebPermissionClient.

        * public/WebPermissionClient.h:
        (WebPermissionClient):
        (WebKit::WebPermissionClient::allowMutationEvents):
        * src/ContextFeaturesClientImpl.cpp:
        (WebKit::ContextFeaturesClientImpl::askIfIsEnabled):

2012-08-20  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r126095.
        http://trac.webkit.org/changeset/126095
        https://bugs.webkit.org/show_bug.cgi?id=94555

        Breaks compilation of downstream WebWidget::paint
        implementations (Requested by jamesr on #webkit).

        * public/WebWidget.h:
        (WebKit::WebWidget::paint):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::paint):
        * src/WebPagePopupImpl.h:
        (WebPagePopupImpl):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):
        * src/WebPopupMenuImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::paint):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-20  Kentaro Hara  <haraken@chromium.org>

        [V8] Move instrumentedCallFunction() from V8Proxy to ScriptController
        https://bugs.webkit.org/show_bug.cgi?id=94456

        Reviewed by Adam Barth.

        To kill V8Proxy, this patch moves instrumentedCallFunction() from V8Proxy
        to ScriptController. Also this patch renames instrumentedCallFunction()
        to callFunctionWithInstrumentation(), for consistency with callFunction().

        No tests. No change in behavior.

        * src/WebDevToolsFrontendImpl.cpp:
        (WebKit::WebDevToolsFrontendImpl::dispatchOnInspectorFrontend):

2012-08-20  Kentaro Hara  <haraken@chromium.org>

        [V8] Move retrieve{Window,Frame,PerContextData}() from V8Proxy to V8Binding
        https://bugs.webkit.org/show_bug.cgi?id=94460

        Reviewed by Adam Barth.

        To kill V8Proxy, we move retrieve{Window,Frame,PerContextData}()
        from V8Proxy to V8Binding. Also, this patch renames these methods as follows:

        - retrieveWindow() -> toDOMWindow()
        - retrieveFrame() -> toFrameIfNotDetached()
        - retrievePerContextData() -> perContextDataForCurrentWorld()

        No tests. No change in behavior.

        * src/WebBindings.cpp:
        (WebKit::makeIntArrayImpl):
        (WebKit::makeStringArrayImpl):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrame::frameForContext):

2012-08-20  James Robinson  <jamesr@chromium.org>

        [chromium] REGRESSION(126076) Should not touch old GraphicsLayerChromium::m_contentsLayer when setting up a new contents layer
        https://bugs.webkit.org/show_bug.cgi?id=94544

        Reviewed by Adrienne Walker.

        * src/WebLayerImpl.cpp:
        (WebKit::WebLayerImpl::id):
        (WebKit):
        * src/WebLayerImpl.h:
        (WebLayerImpl):

2012-08-20  Kentaro Hara  <haraken@chromium.org>

        [V8] Move collectGarbage() from ScriptController to V8GCController
        https://bugs.webkit.org/show_bug.cgi?id=94455

        Reviewed by Adam Barth.

        - This patch moves collectGarbage() from ScriptController to V8GCController.
        - This patch makes collectGarbage() a static method.
        - This patch removes ScriptController::lowMemoryNotification()
        since it is not used at all.

        No tests. No change in behavior.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::collectGarbage):

2012-08-20  Adam Barth  <abarth@webkit.org>

        WebWidget should be able to paint into a zoomed canvas without aliasing
        https://bugs.webkit.org/show_bug.cgi?id=92043

        Reviewed by James Robinson.

        If accelerated compositing is enabled, WebWidget::paint reads back from
        the compositor rather than re-painting the widget. That approach works
        well if the canvas we're rendering into is at a similar resolution to
        the pixels in the compositor, but if the canvas has been scaled (e.g.,
        to help the user disambiguate links), then reading back from the
        compositor will cause aliasing artifacts.

        This patch adds an option to paint to let the embedder request a
        software re-rendering of the widget to avoid these aliasing artifacts.

        * public/WebWidget.h:
        (WebKit::WebWidget::paint):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::paint):
        * src/WebPagePopupImpl.h:
        (WebPagePopupImpl):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):
        * src/WebPopupMenuImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::canvasBackgroundForTransparencey):
        (WebKit):
        (WebKit::WebViewImpl::paint):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-20  James Robinson  <jamesr@chromium.org>

        Unreviewed. Roll WebKit chromium DEPS forward.

        * DEPS:

2012-08-20  Kentaro Hara  <haraken@chromium.org>

        [V8] Move clearForClose() and clearForNavigation() from V8Proxy to ScriptController
        https://bugs.webkit.org/show_bug.cgi?id=94459

        Reviewed by Adam Barth.

        To kill V8Proxy, we can move clearForClose() and
        clearForNavigation() from V8Proxy to ScriptController.

        No tests. No change in behavior.

        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::detachedFromParent3):

2012-08-20  Kentaro Hara  <haraken@chromium.org>

        [V8] Move mainWorldContext() from V8Proxy to ScriptController
        https://bugs.webkit.org/show_bug.cgi?id=94453

        Reviewed by Adam Barth.

        This patch moves mainWorldContext() from V8Proxy to ScriptController.
        In addition, this patch removes dependency on V8Proxy from WorldContextHandle.

        No tests. No change in behavior.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::mainWorldScriptContext):

2012-08-20  Adam Klein  <adamk@chromium.org>

        Remove redundant TOUCH_LISTENER event type
        https://bugs.webkit.org/show_bug.cgi?id=94524

        Reviewed by Ryosuke Niwa.

        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setIsAcceptingTouchEvents): Remove
        bookkeeping for TOUCH_LISTENER.

2012-08-16  James Robinson  <jamesr@chromium.org>

        [chromium] Change WebLayer from a concrete type to a pure virtual interface
        https://bugs.webkit.org/show_bug.cgi?id=94174

        Reviewed by Adrienne Walker.

        This updates the implementation of the Web*Layer family to the new design and updates callers in WebViewImpl /
        NonCompositedContentHost.

        * WebKit.gyp:
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::scrollLayer):
        * src/NonCompositedContentHost.h:
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayer::create):
        (WebKit::WebContentLayerImpl::WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::~WebContentLayerImpl):
        (WebKit::WebContentLayerImpl::layer):
        (WebKit):
        (WebKit::WebContentLayerImpl::clearClient):
        (WebKit::WebContentLayerImpl::setDoubleSided):
        (WebKit::WebContentLayerImpl::setContentsScale):
        (WebKit::WebContentLayerImpl::setUseLCDText):
        (WebKit::WebContentLayerImpl::setDrawCheckerboardForMissingTiles):
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebExternalTextureLayer.cpp: Removed.
        * src/WebExternalTextureLayerImpl.cpp: Added.
        (WebKit):
        (WebKit::WebExternalTextureLayer::create):
        (WebKit::WebExternalTextureLayerImpl::WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::~WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::layer):
        (WebKit::WebExternalTextureLayerImpl::clearClient):
        (WebKit::WebExternalTextureLayerImpl::setTextureId):
        (WebKit::WebExternalTextureLayerImpl::setFlipped):
        (WebKit::WebExternalTextureLayerImpl::setUVRect):
        (WebKit::WebExternalTextureLayerImpl::setOpaque):
        (WebKit::WebExternalTextureLayerImpl::setPremultipliedAlpha):
        (WebKit::WebExternalTextureLayerImpl::willModifyTexture):
        (WebKit::WebExternalTextureLayerImpl::setRateLimitContext):
        (WebTextureUpdaterImpl):
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        (WebKit::WebExternalTextureLayerImpl::prepareTexture):
        (WebKit::WebExternalTextureLayerImpl::context):
        * src/WebExternalTextureLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebContentLayer.cpp.
        (WebKit):
        (WebExternalTextureLayerImpl):
        * src/WebIOSurfaceLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebIOSurfaceLayer.cpp.
        (WebKit):
        (WebKit::WebIOSurfaceLayer::create):
        (WebKit::WebIOSurfaceLayerImpl::WebIOSurfaceLayerImpl):
        (WebKit::WebIOSurfaceLayerImpl::~WebIOSurfaceLayerImpl):
        (WebKit::WebIOSurfaceLayerImpl::setIOSurfaceProperties):
        (WebKit::WebIOSurfaceLayerImpl::layer):
        * src/WebIOSurfaceLayerImpl.h: Copied from Source/Platform/chromium/public/WebImageLayer.h.
        (WebCore):
        (WebKit):
        (WebIOSurfaceLayerImpl):
        * src/WebImageLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebSolidColorLayer.cpp.
        (WebKit):
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayerImpl::WebImageLayerImpl):
        (WebKit::WebImageLayerImpl::~WebImageLayerImpl):
        (WebKit::WebImageLayerImpl::layer):
        (WebKit::WebImageLayerImpl::setBitmap):
        * src/WebImageLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebImageLayer.cpp.
        (WebCore):
        (WebKit):
        (WebImageLayerImpl):
        * src/WebLayer.cpp: Removed.
        * src/WebLayerImpl.cpp:
        (WebKit::WebLayer::create):
        (WebKit::WebLayerImpl::WebLayerImpl):
        (WebKit::WebLayerImpl::~WebLayerImpl):
        (WebKit):
        (WebKit::WebLayerImpl::invalidateRect):
        (WebKit::WebLayerImpl::invalidate):
        (WebKit::WebLayerImpl::addChild):
        (WebKit::WebLayerImpl::insertChild):
        (WebKit::WebLayerImpl::replaceChild):
        (WebKit::WebLayerImpl::setChildren):
        (WebKit::WebLayerImpl::removeFromParent):
        (WebKit::WebLayerImpl::removeAllChildren):
        (WebKit::WebLayerImpl::setAnchorPoint):
        (WebKit::WebLayerImpl::anchorPoint):
        (WebKit::WebLayerImpl::setAnchorPointZ):
        (WebKit::WebLayerImpl::anchorPointZ):
        (WebKit::WebLayerImpl::setBounds):
        (WebKit::WebLayerImpl::bounds):
        (WebKit::WebLayerImpl::setMasksToBounds):
        (WebKit::WebLayerImpl::masksToBounds):
        (WebKit::WebLayerImpl::setMaskLayer):
        (WebKit::WebLayerImpl::setReplicaLayer):
        (WebKit::WebLayerImpl::setOpacity):
        (WebKit::WebLayerImpl::opacity):
        (WebKit::WebLayerImpl::setOpaque):
        (WebKit::WebLayerImpl::opaque):
        (WebKit::WebLayerImpl::setPosition):
        (WebKit::WebLayerImpl::position):
        (WebKit::WebLayerImpl::setSublayerTransform):
        (WebKit::WebLayerImpl::sublayerTransform):
        (WebKit::WebLayerImpl::setTransform):
        (WebKit::WebLayerImpl::transform):
        (WebKit::WebLayerImpl::setDrawsContent):
        (WebKit::WebLayerImpl::drawsContent):
        (WebKit::WebLayerImpl::setPreserves3D):
        (WebKit::WebLayerImpl::setUseParentBackfaceVisibility):
        (WebKit::WebLayerImpl::setBackgroundColor):
        (WebKit::WebLayerImpl::setFilters):
        (WebKit::WebLayerImpl::setBackgroundFilters):
        (WebKit::WebLayerImpl::setDebugBorderColor):
        (WebKit::WebLayerImpl::setDebugBorderWidth):
        (WebKit::WebLayerImpl::setDebugName):
        (WebKit::WebLayerImpl::setAnimationDelegate):
        (WebKit::WebLayerImpl::addAnimation):
        (WebKit::WebLayerImpl::removeAnimation):
        (WebKit::WebLayerImpl::pauseAnimation):
        (WebKit::WebLayerImpl::suspendAnimations):
        (WebKit::WebLayerImpl::resumeAnimations):
        (WebKit::WebLayerImpl::hasActiveAnimation):
        (WebKit::WebLayerImpl::transferAnimationsTo):
        (WebKit::WebLayerImpl::setForceRenderSurface):
        (WebKit::WebLayerImpl::clearRenderSurface):
        (WebKit::WebLayerImpl::setScrollPosition):
        (WebKit::WebLayerImpl::setScrollable):
        (WebKit::WebLayerImpl::setHaveWheelEventHandlers):
        (WebKit::WebLayerImpl::setShouldScrollOnMainThread):
        (WebKit::WebLayerImpl::setNonFastScrollableRegion):
        (WebKit::WebLayerImpl::setIsContainerForFixedPositionLayers):
        (WebKit::WebLayerImpl::setFixedToContainerLayer):
        (WebKit::WebLayerImpl::layer):
        * src/WebLayerImpl.h:
        (WebCore):
        (WebLayerImpl):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setRootLayer):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::create):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::readyStateChanged):
        (WebKit::WebMediaPlayerClientImpl::repaint):
        (WebKit::WebMediaPlayerClientImpl::setOpaque):
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        (WebKit::WebMediaPlayerClientImpl::acceleratedRenderingInUse):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setBackingTextureId):
        (WebKit::WebPluginContainerImpl::setBackingIOSurfaceId):
        (WebKit::WebPluginContainerImpl::commitBackingTexture):
        (WebKit::WebPluginContainerImpl::setOpaque):
        (WebKit::WebPluginContainerImpl::platformLayer):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):
        * src/WebScrollableLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebScrollableLayer.cpp.
        (WebKit):
        (WebKit::WebScrollableLayer::setScrollPosition):
        (WebKit::WebScrollableLayer::setScrollable):
        (WebKit::WebScrollableLayer::setHaveWheelEventHandlers):
        (WebKit::WebScrollableLayer::setShouldScrollOnMainThread):
        (WebKit::WebScrollableLayer::setNonFastScrollableRegion):
        (WebKit::WebScrollableLayer::setIsContainerForFixedPositionLayers):
        (WebKit::WebScrollableLayer::setFixedToContainerLayer):
        * src/WebScrollbarLayerImpl.cpp: Renamed from Source/WebKit/chromium/src/WebScrollbarLayer.cpp.
        (WebKit):
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayerImpl::WebScrollbarLayerImpl):
        (WebKit::WebScrollbarLayerImpl::~WebScrollbarLayerImpl):
        (WebKit::WebScrollbarLayerImpl::layer):
        (WebKit::WebScrollbarLayerImpl::setScrollLayer):
        * src/WebScrollbarLayerImpl.h: Copied from Source/WebKit/chromium/src/WebSolidColorLayerImpl.h.
        (WebCore):
        (WebKit):
        (WebScrollbarLayerImpl):
        * src/WebSolidColorLayerImpl.cpp:
        (WebKit::WebSolidColorLayer::create):
        (WebKit::WebSolidColorLayerImpl::WebSolidColorLayerImpl):
        (WebKit::WebSolidColorLayerImpl::layer):
        (WebKit):
        (WebKit::WebSolidColorLayerImpl::setBackgroundColor):
        * src/WebSolidColorLayerImpl.h:
        (WebCore):
        (WebKit):
        (WebSolidColorLayerImpl):
        * src/WebVideoLayerImpl.cpp: Copied from Source/WebKit/chromium/src/WebVideoLayer.cpp.
        (WebKit):
        (WebKit::WebVideoLayer::create):
        (WebKit::WebVideoLayerImpl::WebVideoLayerImpl):
        (WebKit::WebVideoLayerImpl::~WebVideoLayerImpl):
        (WebKit::WebVideoLayerImpl::layer):
        (WebKit::WebVideoLayerImpl::active):
        * src/WebVideoLayerImpl.h: Renamed from Source/WebKit/chromium/src/WebVideoLayer.cpp.
        (WebCore):
        (WebKit):
        (WebVideoLayerImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit):
        * src/WebViewImpl.h:
        * tests/ImageLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-20  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] CCMathUtilTest.smallestAngleBetweenVectors unit test failing
        https://bugs.webkit.org/show_bug.cgi?id=94502

        Reviewed by Kenneth Russell.

        The test needed to use EXPECT_FLOAT_EQ instead of EXPECT_EQ. In
        this patch, the test is also re-enabled.

        * tests/CCMathUtilTest.cpp:

2012-08-20  Leandro Gracia Gil  <leandrogracia@chromium.org>

        Move transformFriendlyBoundingBox out of Range
        https://bugs.webkit.org/show_bug.cgi?id=94366

        Reviewed by Ryosuke Niwa.

        Update the WebKit code that makes use of transformFriendlyBoundingBox.

        * src/FindInPageCoordinates.cpp:
        (WebKit::findInPageRectFromRange):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::find):
        (WebKit::WebFrameImpl::selectFindMatch):

2012-08-20  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] detectContentIntentAround has a misleading name
        https://bugs.webkit.org/show_bug.cgi?id=94349

        Reviewed by Adam Barth.

        The current WebViewClient API exposes a method named detectContentIntentAround.
        However, this is not designed to detect any "content intent", but to allow the embedder
        to detect content around a position and fire Android intents if appropriate.

        This patch also disables content detection if the touched node listens to events
        that consume the tap action like clicks, touch events or mouse events.

        * public/WebViewClient.h:
        (WebViewClient):
        (WebKit::WebViewClient::detectContentAround):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::detectContentOnTouch):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-20  Hans Wennborg  <hans@chromium.org>

        Respect runtime flags for Device Orientation and Device Motion
        https://bugs.webkit.org/show_bug.cgi?id=94479

        Reviewed by Adam Barth.

        WebRuntimeFeatures::enableDeviceMotion should not be hard-coded to
        false.

        * src/WebViewImpl.cpp:
        (WebKit::WebView::create):

2012-08-20  David Reveman  <reveman@chromium.org>

        [Chromium] Schedule texture uploads based on hard-coded timer and vsync.
        https://bugs.webkit.org/show_bug.cgi?id=84281

        Reviewed by James Robinson.

        * tests/CCSchedulerTest.cpp:
        (WebKitTests::TEST):
        * tests/CCSchedulerTestCommon.h:
        (WebKitTests::FakeCCTimeSource::FakeCCTimeSource):
        (WebKitTests::FakeCCTimeSource::setNextTickTime):
        (FakeCCTimeSource):
        * tests/CCTextureUpdateControllerTest.cpp:

2012-08-20  Kenneth Russell  <kbr@google.com>

        Unreviewed Chromium rebaselining and test failure suppressions.

        https://bugs.webkit.org/show_bug.cgi?id=94502

        * tests/CCMathUtilTest.cpp:

2012-08-20  Ian Vollick  <vollick@chromium.org>

        [chromium] Add tracing for active composited animations
        https://bugs.webkit.org/show_bug.cgi?id=84210

        Reviewed by James Robinson.

        This patch issues the trace events from the animations. Animations will
        report when they start and finish on the main and impl threads (via
        TRACE_EVENT_ASYNC*), and also issues instant trace events whenever they
        change state.

        * src/WebAnimationImpl.cpp:
        (WebKit::WebAnimationImpl::cloneToCCAnimation):
        * tests/CCAnimationTestCommon.h:

2012-08-20  Sami Kyostila  <skyostil@chromium.org>

        [chromium] Convert screen space scroll gestures to layer space
        https://bugs.webkit.org/show_bug.cgi?id=92499

        Reviewed by James Robinson.

        Added new tests for verifying transformed layer scrolling:

            CCLayerTreeHostImplTest.scrollAxisAlignedRotatedLayer
            CCLayerTreeHostImplTest.scrollNonAxisAlignedRotatedLayer
            CCLayerTreeHostImplTest.scrollScaledLayer

        Also some tests for the introduced math utilities:

            CCMathUtilTest.smallestAngleBetweenVectors
            CCMathUtilTest.vectorProjection

        * src/WebCompositorInputHandlerImpl.cpp:
        (WebKit::WebCompositorInputHandlerImpl::handleInputEventInternal):
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):
        * tests/CCLayerTreeHostImplTest.cpp: Adjusted scroll delta in scrollChildBeyondLimit to avoid triggering the 45 degree rule.
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCMathUtilTest.cpp:
        * tests/WebCompositorInputHandlerImplTest.cpp:
        (MockCCInputHandlerClient):
        (WebKit::TEST_F):

2012-08-20  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: load scripts panel lazily
        https://bugs.webkit.org/show_bug.cgi?id=94416

        Reviewed by Vsevolod Vlasov.

        * WebKit.gyp:

2012-08-19  Kentaro Hara  <haraken@chromium.org>

        [V8] Move contextDebugId() and setContextDebugId() from V8Proxy to ScriptController
        https://bugs.webkit.org/show_bug.cgi?id=94446

        Reviewed by Adam Barth.

        To kill V8Proxy, we can move contextDebugId() and setContextDebugId()
        from V8Proxy to ScriptController.

        No tests. No change in behavior.

        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::WebDevToolsAgentImpl::didCreateScriptContext):

2012-08-20  Kentaro Hara  <haraken@chromium.org>

        [V8] Move V8Proxy::m_extensions to ScriptController
        https://bugs.webkit.org/show_bug.cgi?id=94444

        Reviewed by Adam Barth.

        To kill V8Proxy, this patch moves V8Proxy::m_extensions to ScriptController.

        No tests. No change in behavior.

        * src/WebScriptController.cpp:
        (WebKit::WebScriptController::registerExtension):

2012-08-19  James Robinson  <jamesr@chromium.org>

        [chromium] Put webkit compositor binding files in separate conditionally included gyp section
        https://bugs.webkit.org/show_bug.cgi?id=94392

        Reviewed by Dirk Pranke.

        This allows the use_libcc_for_compositor gyp variable to control whether the webkit bindings are pulled from the
        WebKit repository or an external target.

        * WebKit.gyp:
        * WebKit.gypi:

2012-08-19  Rick Byers  <rbyers@chromium.org>

        [chromium] Add additional fields to WebGestureEvent
        https://bugs.webkit.org/show_bug.cgi?id=94238

        Reviewed by James Robinson.

        Add a union to WebGestureEvent with per-event-type data, as a first
        step to eliminating the overloaded delta fields.

        * public/WebInputEvent.h:
        (WebGestureEvent):
        (WebKit::WebGestureEvent::WebGestureEvent):
        * src/WebInputEvent.cpp:
        (SameSizeAsWebGestureEvent):

2012-08-19  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: load network panel lazily
        https://bugs.webkit.org/show_bug.cgi?id=94414

        Reviewed by Vsevolod Vlasov.

        * WebKit.gyp:

2012-08-18  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: make profiles panel a lazily loaded module.
        https://bugs.webkit.org/show_bug.cgi?id=94351

        Reviewed by Yury Semikhatsky.

        * WebKit.gyp:

2012-08-18  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: load panels code on demand
        https://bugs.webkit.org/show_bug.cgi?id=94326

        Reviewed by Vsevolod Vlasov.

        * WebKit.gyp:
        * scripts/concatenate_js_files.py:
        (OrderedJSFilesExtractor.handle_starttag):
        * scripts/inline_js_imports.py:
        (main):

2012-08-17  Dirk Pranke  <dpranke@chromium.org>

        Unreviewed, rolling out r125897.
        http://trac.webkit.org/changeset/125897
        https://bugs.webkit.org/show_bug.cgi?id=94326

        this patch seems to have broken the inspector on the apple mac bots.

        * WebKit.gyp:
        * scripts/concatenate_js_files.py:
        (OrderedJSFilesExtractor.handle_starttag):
        * scripts/inline_js_imports.py:
        (main):

2012-08-17  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r125922.
        http://trac.webkit.org/changeset/125922
        https://bugs.webkit.org/show_bug.cgi?id=94389

        "Causing failing/crashing tests on Mac bots" (Requested by
        bradee-oh on #webkit).

        * WebKit.gyp:

2012-08-16  James Robinson  <jamesr@chromium.org>

        [chromium] Add Source/WebCore/platform/graphics/chromium/cc/ to include path and remove cc/ prefix from includes
        https://bugs.webkit.org/show_bug.cgi?id=94279

        Reviewed by Adam Barth.

        * src/WebAnimationCurveCommon.cpp:
        * src/WebAnimationImpl.cpp:
        * src/WebCompositorInputHandlerImpl.cpp:
        * src/WebCompositorInputHandlerImpl.h:
        * src/WebExternalTextureLayer.cpp:
        * src/WebFloatAnimationCurve.cpp:
        * src/WebLayerTreeView.cpp:
        * src/WebLayerTreeViewImpl.cpp:
        * src/WebTransformAnimationCurve.cpp:
        * tests/CCActiveAnimationTest.cpp:
        * tests/CCAnimationTestCommon.cpp:
        * tests/CCAnimationTestCommon.h:
        * tests/CCDamageTrackerTest.cpp:
        * tests/CCDelayBasedTimeSourceTest.cpp:
        * tests/CCFrameRateControllerTest.cpp:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerImplTest.cpp:
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerQuadTest.cpp:
        * tests/CCLayerSorterTest.cpp:
        * tests/CCLayerTestCommon.cpp:
        * tests/CCLayerTestCommon.h:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCMathUtilTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        * tests/CCOcclusionTrackerTestCommon.h:
        * tests/CCPrioritizedTextureTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceFiltersTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCResourceProviderTest.cpp:
        * tests/CCSchedulerStateMachineTest.cpp:
        * tests/CCSchedulerTest.cpp:
        * tests/CCSchedulerTestCommon.h:
        * tests/CCScopedTextureTest.cpp:
        * tests/CCScrollbarAnimationControllerLinearFadeTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        * tests/CCTestCommon.h:
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadTaskTest.cpp:
        * tests/CCThreadedTest.cpp:
        * tests/CCThreadedTest.h:
        * tests/CCTiledLayerImplTest.cpp:
        * tests/CCTiledLayerTestCommon.h:
        * tests/CCTimerTest.cpp:
        * tests/ContentLayerChromiumTest.cpp:
        * tests/FakeCCGraphicsContext.h:
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/FloatQuadTest.cpp:
        * tests/GraphicsLayerChromiumTest.cpp:
        * tests/LayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        * tests/MockCCQuadCuller.h:
        * tests/PlatformGestureCurveTest.cpp:
        * tests/ScrollbarLayerChromiumTest.cpp:
        * tests/TextureLayerChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/TreeSynchronizerTest.cpp:
        * tests/WebCompositorInputHandlerImplTest.cpp:
        * tests/WebFloatAnimationCurveTest.cpp:
        * tests/WebTransformAnimationCurveTest.cpp:

2012-08-17  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: make profiles panel a lazily loaded module.
        https://bugs.webkit.org/show_bug.cgi?id=94351

        Reviewed by Yury Semikhatsky.

        * WebKit.gyp:

2012-08-17  Keishi Hattori  <keishi@webkit.org>

        [Chromium] Turn off ENABLE_DATALIST_ELEMENT for Android
        https://bugs.webkit.org/show_bug.cgi?id=94337

        Reviewed by Kent Tamura.

        We shouldn't have turned ENABLE_DATALIST_ELEMENT on for Android.

        * features.gypi:

2012-08-17  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r125892.
        http://trac.webkit.org/changeset/125892
        https://bugs.webkit.org/show_bug.cgi?id=94350

        Broke windows build (Requested by vollick on #webkit).

        * src/WebAnimationImpl.cpp:
        (WebKit::WebAnimationImpl::cloneToCCAnimation):

2012-08-17  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-17  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: load panels code on demand
        https://bugs.webkit.org/show_bug.cgi?id=94326

        Reviewed by Vsevolod Vlasov.

        * WebKit.gyp:
        * scripts/concatenate_js_files.py:
        (OrderedJSFilesExtractor.handle_starttag):
        * scripts/inline_js_imports.py:
        (main):

2012-08-17  Ian Vollick  <vollick@chromium.org>

        [chromium] Add tracing for active composited animations
        https://bugs.webkit.org/show_bug.cgi?id=84210

        Reviewed by James Robinson.

        This patch issues the trace events from the animations. Animations will
        report when they start and finish on the main and impl threads (via
        TRACE_EVENT_ASYNC*), and also issues instant trace events whenever they
        change state.

        * src/WebAnimationImpl.cpp:
        (WebKit::WebAnimationImpl::cloneToCCAnimation):

2012-08-16  Antoine Labour  <piman@chromium.org>

        [chromium] Add resource transfer functions to CCResourceProvider
        https://bugs.webkit.org/show_bug.cgi?id=93524

        Reviewed by James Robinson.

        This adds methods to CCResourceProvider to be able to transport
        resources from a child to a parent.

        Added test to CCResourceProviderTest.

        * tests/CCResourceProviderTest.cpp:
        (WebKit::textureSize):
        (WebKit):
        (WebKit::Texture::Texture):
        (Texture):
        (ContextSharedData):
        (WebKit::ContextSharedData::create):
        (WebKit::ContextSharedData::insertSyncPoint):
        (WebKit::ContextSharedData::genMailbox):
        (WebKit::ContextSharedData::produceTexture):
        (WebKit::ContextSharedData::consumeTexture):
        (WebKit::ContextSharedData::ContextSharedData):
        (WebKit::ResourceProviderContext::create):
        (ResourceProviderContext):
        (WebKit::ResourceProviderContext::insertSyncPoint):
        (WebKit::ResourceProviderContext::waitSyncPoint):
        (WebKit::ResourceProviderContext::genMailboxCHROMIUM):
        (WebKit::ResourceProviderContext::produceTextureCHROMIUM):
        (WebKit::ResourceProviderContext::consumeTextureCHROMIUM):
        (WebKit::ResourceProviderContext::ResourceProviderContext):
        (PendingProduceTexture):
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        (CCResourceProviderTest):
        (WebKit::TEST_F):

2012-08-16  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Frontend and plumbing for integer versions
        https://bugs.webkit.org/show_bug.cgi?id=92897

        Reviewed by Tony Chang.

        * src/IDBCallbacksProxy.cpp:
        (WebKit::IDBCallbacksProxy::onBlocked):
        (WebKit):
        (WebKit::IDBCallbacksProxy::onUpgradeNeeded):
        * src/IDBCallbacksProxy.h:
        (IDBCallbacksProxy):
        * src/IDBDatabaseBackendProxy.cpp:
        (WebKit::IDBDatabaseBackendProxy::setVersion):
        * src/IDBDatabaseCallbacksProxy.cpp:
        (WebKit::IDBDatabaseCallbacksProxy::onVersionChange):
        (WebKit):
        * src/IDBDatabaseCallbacksProxy.h:
        (IDBDatabaseCallbacksProxy):
        * src/IDBFactoryBackendProxy.cpp:
        (WebKit::IDBFactoryBackendProxy::open):
        * src/IDBFactoryBackendProxy.h:
        (IDBFactoryBackendProxy):
        * src/IDBTransactionCallbacksProxy.cpp:
        (WebKit::IDBTransactionCallbacksProxy::onComplete):
        * src/WebIDBCallbacksImpl.cpp:
        (WebKit::WebIDBCallbacksImpl::WebIDBCallbacksImpl):
        (WebKit::WebIDBCallbacksImpl::onSuccess):
        We don't want to create IDBDatabaseBackendProxy again if we've already
        created it during upgradeNeeded.  This makes
        IDBRequest::onSuccess(IDBDatabaseBackend) reuse its previous
        IDBDatabaseBackendInterface if it has one.

        (WebKit::WebIDBCallbacksImpl::onBlocked):
        (WebKit):
        (WebKit::WebIDBCallbacksImpl::onUpgradeNeeded):
        * src/WebIDBCallbacksImpl.h:
        (WebIDBCallbacksImpl):
        * src/WebIDBDatabaseCallbacksImpl.cpp:
        (WebKit::WebIDBDatabaseCallbacksImpl::onVersionChange):
        (WebKit):
        * src/WebIDBDatabaseCallbacksImpl.h:
        (WebIDBDatabaseCallbacksImpl):
        * src/WebIDBDatabaseImpl.cpp:
        (WebKit::WebIDBDatabaseImpl::WebIDBDatabaseImpl):
        (WebKit::WebIDBDatabaseImpl::close):
        (WebKit::WebIDBDatabaseImpl::open):
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):
        * src/WebIDBFactoryImpl.cpp:
        (WebKit::WebIDBFactoryImpl::open):
        * src/WebIDBFactoryImpl.h:
        (WebIDBFactoryImpl):
        * src/WebIDBTransactionCallbacksImpl.cpp:
        (WebKit::WebIDBTransactionCallbacksImpl::onComplete):
        * tests/IDBAbortOnCorruptTest.cpp:
        (WebCore::TEST):
        * tests/IDBDatabaseBackendTest.cpp:

2012-08-16  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r125838.
        http://trac.webkit.org/changeset/125838
        https://bugs.webkit.org/show_bug.cgi?id=94283

        Breaks Mac compile due to bug 74625 (Requested by enne on
        #webkit).

        * tests/CCResourceProviderTest.cpp:
        (WebKit::ResourceProviderContext::create):
        (WebKit::ResourceProviderContext::textureSize):
        (ResourceProviderContext):
        (WebKit::ResourceProviderContext::ResourceProviderContext):
        (WebKit::ResourceProviderContext::Texture::Texture):
        (Texture):
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        (CCResourceProviderTest):
        (WebKit::TEST_F):

2012-08-16  Kenneth Russell  <kbr@google.com>

        Unreviewed, rolling out r125800.
        http://trac.webkit.org/changeset/125800
        https://bugs.webkit.org/show_bug.cgi?id=84281

        Hypothesis that this change caused gpu_throughput_tests to
        start timing out on all platforms on the Chromium GPU
        canaries.

        * tests/CCSchedulerTest.cpp:
        (WebKitTests::TEST):
        * tests/CCSchedulerTestCommon.h:
        (WebKitTests::FakeCCTimeSource::FakeCCTimeSource):
        (FakeCCTimeSource):
        * tests/CCTextureUpdateControllerTest.cpp:

2012-08-16  Antoine Labour  <piman@chromium.org>

        [chromium] Add resource transfer functions to CCResourceProvider
        https://bugs.webkit.org/show_bug.cgi?id=93524

        Reviewed by James Robinson.

        This adds methods to CCResourceProvider to be able to transport
        resources from a child to a parent.

        Added test to CCResourceProviderTest.

        * tests/CCResourceProviderTest.cpp:
        (WebKit::textureSize):
        (WebKit):
        (WebKit::Texture::Texture):
        (Texture):
        (ContextSharedData):
        (WebKit::ContextSharedData::create):
        (WebKit::ContextSharedData::insertSyncPoint):
        (WebKit::ContextSharedData::genMailbox):
        (WebKit::ContextSharedData::produceTexture):
        (WebKit::ContextSharedData::consumeTexture):
        (WebKit::ContextSharedData::ContextSharedData):
        (WebKit::ResourceProviderContext::create):
        (ResourceProviderContext):
        (WebKit::ResourceProviderContext::insertSyncPoint):
        (WebKit::ResourceProviderContext::waitSyncPoint):
        (WebKit::ResourceProviderContext::genMailboxCHROMIUM):
        (WebKit::ResourceProviderContext::produceTextureCHROMIUM):
        (WebKit::ResourceProviderContext::consumeTextureCHROMIUM):
        (WebKit::ResourceProviderContext::ResourceProviderContext):
        (PendingProduceTexture):
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        (CCResourceProviderTest):
        (WebKit::TEST_F):

2012-08-16  Alexandre Elias  <aelias@google.com>

        [chromium] Replace destRect with destOffset in texture upload
        https://bugs.webkit.org/show_bug.cgi?id=94154

        Reviewed by James Robinson.

        Previously, texture upload code implicitly assumed that sourceRect and
        destRect have the same size. The behavior is undefined if they are
        different, since they are used interchangeably and there's no support
        for scaling from one rect to the other. This patch enforces that
        constraint at the interface level by replacing all instances of
        "IntRect destRect" by "IntSize destOffset".

        * tests/CCResourceProviderTest.cpp:
        (WebKit::TEST_F):
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::Texture::updateRect):
        * tests/CCTiledLayerTestCommon.h:
        (Texture):
        (WebKitTests::FakeTextureUploader::uploadTexture):

2012-08-16  James Robinson  <jamesr@chromium.org>

        [chromium] Remove unnecessary tree hierarchy inspection APIs from WebLayer
        https://bugs.webkit.org/show_bug.cgi?id=94229

        Reviewed by Adrienne Walker.

        Remove dead WebLayer function implementations and tests of same.

        * src/WebLayer.cpp:
        * tests/WebLayerTest.cpp:

2012-08-16  David Reveman  <reveman@chromium.org>

        [Chromium] Avoid aliasing global symbol monotonicallyIncreasingTime().
        https://bugs.webkit.org/show_bug.cgi?id=94233

        Reviewed by James Robinson.

        * tests/CCDelayBasedTimeSourceTest.cpp:
        (WebKitTests::TEST):
        * tests/CCFrameRateControllerTest.cpp:
        (WebKitTests::TEST):
        * tests/CCSchedulerTestCommon.h:
        (WebKitTests::FakeCCDelayBasedTimeSource::setMonotonicTimeNow):
        (WebKitTests::FakeCCDelayBasedTimeSource::FakeCCDelayBasedTimeSource):
        (FakeCCDelayBasedTimeSource):

2012-08-16  David Reveman  <reveman@chromium.org>

        [Chromium] Schedule texture uploads based on hard-coded timer and vsync.
        https://bugs.webkit.org/show_bug.cgi?id=84281

        Reviewed by James Robinson.

        * tests/CCSchedulerTest.cpp:
        (WebKitTests::TEST):
        * tests/CCSchedulerTestCommon.h:
        (WebKitTests::FakeCCTimeSource::FakeCCTimeSource):
        (WebKitTests::FakeCCTimeSource::setNextTickTime):
        (FakeCCTimeSource):
        * tests/CCTextureUpdateControllerTest.cpp:

2012-08-16  Dana Jansens  <danakj@chromium.org>

        [chromium] Impl scrolling crashes when the renderer's initialization failed
        https://bugs.webkit.org/show_bug.cgi?id=94232

        Reviewed by James Robinson.

        Also updated the finishAllRenderingAfterContextLost to properly fail
        renderer initialization.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-16  Peter Beverloo  <peter@chromium.org>

        [Chromium] Pass the --strip-binary argument to the apk test generator
        https://bugs.webkit.org/show_bug.cgi?id=94224

        Reviewed by Adam Barth.

        The native test generator currently relies on the $STRIP environment
        variable to be available, which it shouldn't do. Instead, pass it as an
        argument to the script. The $STRIP variable is being deprecated.

        * WebKitUnitTests.gyp:

2012-08-16  James Robinson  <jamesr@chromium.org>

        [chromium] Remove alwaysReserveTextures code - it doesn't do anything
        https://bugs.webkit.org/show_bug.cgi?id=94183

        Reviewed by Dimitri Glazkov.

        Stops attempting to find the scrollbar layers and call setAlwaysReserveTextures() on them since the call doesn't
        do anything.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::setViewport):
        * src/WebLayer.cpp:

2012-08-16  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-16  Keishi Hattori  <keishi@webkit.org>

        DOMWindowPagePopup needs to be installed before loading the html inside the page popup
        https://bugs.webkit.org/show_bug.cgi?id=94193

        Reviewed by Kent Tamura.

        We are using window.pagePopupController.localizeNumberString while loading so we need to install DOMWindowPagePopup before loading the html.

        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::initPage):

2012-08-16  Marja Hölttä  <marja@chromium.org>

        WebHistoryItem: Enable reading selected file names from document state
        https://bugs.webkit.org/show_bug.cgi?id=91231

        Reviewed by Jochen Eisinger.

        This change enables Chromium to set up file permissions properly when
        the session restore feature restores a page with selected files.

        * public/WebHistoryItem.h:
        (WebHistoryItem): Added getReferencedFilePaths.
        * src/WebHistoryItem.cpp:
        (WebKit::WebHistoryItem::getReferencedFilePaths): Extracts selected and posted file paths from a document state.
        (WebKit):

2012-08-15  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] set scissorRect per quad so that quads are correctly clipped
        https://bugs.webkit.org/show_bug.cgi?id=94050

        Reviewed by Adrienne Walker.

        Updated two unit tests to reflect that we need to always scissor,
        until we refactor so that quads do not depend on scissoring.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-16  Hironori Bono  <hbono@chromium.org>

        Prevent showing suggestions when right-clicking a selection range.
        https://bugs.webkit.org/show_bug.cgi?id=94189

        Reviewed by Hajime Morita.

        To emulate Safari, my r120810 changes selection when right-clicking a misspelled
        word. Unfortunately, this change somehow uses VisibleSelection::isCaretOrRange
        and it changes the existing selection when right-clicking a selection which
        includes a misspelled word. This change uses VisibleSelection::isCaret to
        prevent showing suggestions when right-clicking a selection range. (Neither does
        Safari show suggestions when there is a selection range.)

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):

2012-08-15  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-15  Ryosuke Niwa  <rniwa@webkit.org>

        Update manual tests and comments to refer to TestRunner instead of LayoutTestController
        https://bugs.webkit.org/show_bug.cgi?id=94168

        Reviewed by Kent Tamura.

        * public/WebDevToolsAgent.h:
        (WebDevToolsAgent):
        * public/WebView.h:
        (WebView):

2012-08-15  Alec Flett  <alecflett@chromium.org>

        IndexedDB: generate index keys for existing data in createIndex in front end
        https://bugs.webkit.org/show_bug.cgi?id=91125

        Reviewed by Tony Chang.

        Add Chromium API methods to let the renderer process tell the
        browser process about indexing progress.

        * public/WebIDBObjectStore.h:
        (WebKit::WebIDBObjectStore::openCursor):
        * src/IDBObjectStoreBackendProxy.cpp:
        (WebKit::IDBObjectStoreBackendProxy::setIndexKeys):
        (WebKit):
        (WebKit::IDBObjectStoreBackendProxy::setIndexesReady):
        (WebKit::IDBObjectStoreBackendProxy::openCursor):
        * src/IDBObjectStoreBackendProxy.h:
        (IDBObjectStoreBackendProxy):
        * src/WebIDBObjectStoreImpl.cpp:
        (WebKit::WebIDBObjectStoreImpl::setIndexKeys):
        (WebKit):
        (WebKit::WebIDBObjectStoreImpl::setIndexesReady):
        (WebKit::WebIDBObjectStoreImpl::openCursor):
        * src/WebIDBObjectStoreImpl.h:
        (WebIDBObjectStoreImpl):

2012-08-15  Bruno de Oliveira Abinader  <bruno.abinader@basyskom.com>

        [css3-text] Add CSS3 Text decoration compile flag
        https://bugs.webkit.org/show_bug.cgi?id=93863

        Reviewed by Julien Chaffraix.

        This patch handles the compile flag implementation, which will come disabled by
        default, thus not exposing the CSS3 text decoration features to the web, unless
        when explicitly enabling it with "--css3-text-decoration" build parameter.

        * features.gypi:

2012-08-15  Iain Merrick  <husky@chromium.org>

        Refactoring: move EventHandler::targetNode into HitTestResult
        https://bugs.webkit.org/show_bug.cgi?id=94107

        Reviewed by Dimitri Glazkov.

        This static helper method in EventHandler was made public so that
        WebFrameImpl can call it. That's untidy because EventHandler isn't
        really involved. This patch turns it into an instance method of
        HitTestResult (with a wrapper in MouseEventWithHitTestResult for
        convenience).

        Pure refactoring, no behavior change, no new test needed.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::visiblePositionForWindowPoint):

2012-08-15  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Add some ASSERTs
        https://bugs.webkit.org/show_bug.cgi?id=94055

        Reviewed by Ojan Vafai.

        * src/IDBDatabaseBackendProxy.cpp:
        (WebKit::IDBDatabaseBackendProxy::setVersion):

2012-08-15  Ian Vollick  <vollick@chromium.org>

        [chromium] Must account for empty transformation lists when checking for big rotations.
        https://bugs.webkit.org/show_bug.cgi?id=93975

        Reviewed by James Robinson.

        Adds a test to check that creating an animation with a big (> 180
        degree) rotation, where the transform operations list in the 1st
        keyframe is empty fails as expected.

        * tests/AnimationTranslationUtilTest.cpp:
        (WebKit::TEST):
        (WebKit):

2012-08-15  Joshua Bell  <jsbell@chromium.org>

        [chromium] IndexedDB: Delete unused WebKit API cursor accessors
        https://bugs.webkit.org/show_bug.cgi?id=94134

        Reviewed by Adam Barth.

        Last bit of refactor work from http://webkit.org/b/92278 that ships the
        cursor key/primaryKey/value to the front end via success messages, eliminating
        the need for these accessors and the old success messages.

        * public/WebIDBCallbacks.h:
        * public/WebIDBCursor.h:

2012-08-15  Anna Cavender  <annacc@chromium.org>

        Add the timestampOffset attribute to SourceBuffer.
        https://bugs.webkit.org/show_bug.cgi?id=93303

        Reviewed by Dimitri Glazkov.

        On the 30 July 2012 version of the Media Source Extensions spec, a timestampOffset 
        attribute was added to the SourceBuffer object:
        http://dvcs.w3.org/hg/html-media/raw-file/tip/media-source/media-source.html#dom-timestampoffset

        * public/WebMediaPlayer.h:
        (WebKit::WebMediaPlayer::sourceSetTimestampOffset): Add the new method.
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit):
        (WebKit::WebMediaPlayerClientImpl::sourceSetTimestampOffset): Forward the call.
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-08-15  Peter Beverloo  <peter@chromium.org>

        [Chromium] Roll WebKit Chromium DEPS to r151672
        https://bugs.webkit.org/show_bug.cgi?id=94091

        Unreviewed DEPS roll.

        This also adds the new dependency on third_party/skia/gyp/, as was
        introduced in Chromium's revision 151463.

        * DEPS:

2012-08-14  Keishi Hattori  <keishi@webkit.org>

        Share common code between calendar picker and color suggestion picker
        https://bugs.webkit.org/show_bug.cgi?id=93802

        Reviewed by Kent Tamura.

        * src/ColorChooserUIController.cpp:
        (WebKit::ColorChooserUIController::writeDocument):

2012-08-14  Scott Graham  <scottmg@chromium.org>

        [Chromium] Fix warnings on Windows build
        https://bugs.webkit.org/show_bug.cgi?id=93997

        Reviewed by Kentaro Hara.

        Fixes truncation from 'double' to 'float' warnings on Chromium Windows
        build.

        * tests/CCRenderSurfaceFiltersTest.cpp:
        (WebKit::TEST):
        * tests/CCScrollbarAnimationControllerLinearFadeTest.cpp:
        (WebCore::TEST_F):

2012-08-14  Chris Rogers  <crogers@google.com>

        Implement new synchronized audio I/O render method in chromium
        https://bugs.webkit.org/show_bug.cgi?id=93510

        Reviewed by Kenneth Russell.

        The chromium implementation of AudioDestination is being upgraded to
        support synchronized audio I/O.  Other changes on the chromium-side
        can then be tested against something that works in WebKit.

        * src/AudioDestinationChromium.cpp:
        (WebCore::AudioDestinationChromium::AudioDestinationChromium):
        (WebCore::AudioDestinationChromium::render):
        (WebCore):
        (WebCore::AudioDestinationChromium::provideInput):
        * src/AudioDestinationChromium.h:
        (WebCore):
        (AudioDestinationChromium):

2012-08-14  Adam Barth  <abarth@webkit.org>

        Delete Frame::domWindow() and Frame::existingDOMWindow()
        https://bugs.webkit.org/show_bug.cgi?id=93990

        Reviewed by Eric Seidel.

        * src/StorageAreaProxy.cpp:
        (WebCore::StorageAreaProxy::dispatchLocalStorageEvent):
        (WebCore::StorageAreaProxy::dispatchSessionStorageEvent):
        * src/WebDOMMessageEvent.cpp:
        (WebKit::WebDOMMessageEvent::initMessageEvent):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::performance):
        (WebKit::WebFrameImpl::addMessageToConsole):
        (WebKit::WebFrameImpl::unloadListenerCount):
        (WebKit::WebFrameImpl::addEventListener):
        (WebKit::WebFrameImpl::removeEventListener):
        (WebKit::WebFrameImpl::dispatchEvent):
        (WebKit::WebFrameImpl::dispatchMessageEventWithOriginCheck):
        (WebKit::WebFrameImpl::deliverIntent):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::initPage):

2012-08-14  Iain Merrick  <husky@chromium.org>

        [chromium] Add a test to WebFrameTest for selectRange and visiblePositionForWindowPoint.
        https://bugs.webkit.org/show_bug.cgi?id=93108

        Reviewed by Adam Barth.

        Adds a new test WebFrameTest.SelectRange. This tests WebFrameImpl::selectRange,
        and also serves to test WebFrameImpl::visiblePositionForWindowPoint as it is
        used by selectRange.

        The test uses sample files that contain selected text on load. The test uses
        WebViewImpl::selectionBounds to get the coordinates, deselects all, then
        calls WebFrameImpl::selectRange to attempt to reselect the same text.

        Four cases are tested:
        - the basic case
        - the case where the selected text is offscreen due to a scroll
        - the case where the selected text is in an iframe
        - the case where the selected text is in an editable element

        * tests/WebFrameTest.cpp:
        * tests/data/select_range_basic.html: Added.
        * tests/data/select_range_editable.html: Added.
        * tests/data/select_range_iframe.html: Added.
        * tests/data/select_range_scroll.html: Added.

2012-08-14  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Pass cursor continue results back in callback
        https://bugs.webkit.org/show_bug.cgi?id=92278

        Reviewed by Tony Chang.

        Supply the updated cursor key/primaryKey/value in the success callback,
        rather than forcing the callee to make three calls into the back end to
        fetch them. Callbacks onSuccess(cursor) and onSuccessWithContinuation()
        are given the three new payload parameters (and the latter is renamed.)

        * public/WebIDBCallbacks.h:
        (WebIDBCallbacks):
        (WebKit::WebIDBCallbacks::onSuccess): Replace with no-op stub.
        (WebKit::WebIDBCallbacks::onSuccessWithContinuation): Ditto.
        * public/WebIDBCursor.h:
        (WebIDBCursor): Methods can be removed once Chromium is cleaned up.
        * src/IDBCallbacksProxy.cpp: Updated callbacks.
        (WebKit::IDBCallbacksProxy::onSuccess):
        (WebKit):
        * src/IDBCallbacksProxy.h: Updated callbacks.
        (IDBCallbacksProxy):
        * src/IDBCursorBackendProxy.cpp: Remove back end accessors.
        * src/IDBCursorBackendProxy.h:
        (IDBCursorBackendProxy):
        * src/WebIDBCallbacksImpl.cpp: Updated callbacks.
        (WebKit::WebIDBCallbacksImpl::onSuccess):
        * src/WebIDBCallbacksImpl.h: Updated callbacks.
        (WebIDBCallbacksImpl):
        * src/WebIDBCursorImpl.cpp: Remove back end accessors.
        * src/WebIDBCursorImpl.h: Remove back end accessors.
        (WebIDBCursorImpl):
        * tests/IDBAbortOnCorruptTest.cpp: Update test stubs.
        (WebCore::MockIDBCallbacks::onSuccess):
        * tests/IDBDatabaseBackendTest.cpp: Ditto.
        * tests/IDBRequestTest.cpp: Ditto.

2012-08-14  Peter Beverloo  <peter@chromium.org>

        [Chromium] Remove unneeded build logic for Android
        https://bugs.webkit.org/show_bug.cgi?id=93962

        Reviewed by Dimitri Glazkov.

        The Android SDK and NDK have been checked in to the Chromium tree, which
        allows WebKit to leverage those as well. They will already be pulled in
        through a DEPS change made last week, and by not setting the ANDROID_NDK_ROOT
        environment variable, the envsetup.sh will set the project files up
        appropriately for us.

        * DEPS:

2012-08-14  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-14  Peter Beverloo  <peter@chromium.org>

        [Chromium] Fix apk generation for the Android platform
        https://bugs.webkit.org/show_bug.cgi?id=93841

        Unreviewed build fix (step 2).

        The path from webkit_unit_tests isn't robust enough. Use the same
        convention as the Chromium side, i.e. walk up from the ant_build_out path.
        One-line Android-only gyp change.

        * WebKitUnitTests.gyp:

2012-08-14  Peter Beverloo  <peter@chromium.org>

        [Chromium] Fix apk generation for the Android platform
        https://bugs.webkit.org/show_bug.cgi?id=93841

        Unreviewed build fix.

        APK generation was broken as the configuration file assumed compilation
        would only occur in the Chromium tree. Pass the path to Chromium's source
        base directory as a property to ant.

        * WebKitUnitTests.gyp:

2012-08-13  Tom Sepez  <tsepez@chromium.org>

        [chromium] release FrameLoaderClientImpl::m_pluginWidget refptr upon Plugin Document detach.
        https://bugs.webkit.org/show_bug.cgi?id=93283

        Reviewed by Eric Seidel.

        Change the client redirectDataToPlugin method(s) to expect the possibility of
        a NULL argument, NULLing Chromium's refptr that needs to be NULLed.

        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::redirectDataToPlugin):

2012-08-13  Eric Penner  <epenner@google.com>

        [chromium] Paint animated layers immediately to avoid animation hiccups.
        https://bugs.webkit.org/show_bug.cgi?id=93028

        Reviewed by Adrienne Walker.

        Replaced one test. Test painting full animated layer.

        * tests/TiledLayerChromiumTest.cpp:

2012-08-12  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] renderSurface in incorrect space if owning layer has empty but non-zero bounds
        https://bugs.webkit.org/show_bug.cgi?id=93795

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-08-13  James Robinson  <jamesr@chromium.org>

        [chromium] Make WebAnimation a pure virtual interface to hide implementation and avoid unresolved symbols
        https://bugs.webkit.org/show_bug.cgi?id=93907

        Reviewed by Darin Fisher.

        Adds a WebAnimationImpl implementation of the WebAnimation interface.

        * WebKit.gyp:
        * src/WebAnimationImpl.cpp: Renamed from Source/WebKit/chromium/src/WebAnimation.cpp.
        (WebKit):
        (WebKit::WebAnimation::create):
        (WebKit::WebAnimationImpl::targetProperty):
        (WebKit::WebAnimationImpl::iterations):
        (WebKit::WebAnimationImpl::setIterations):
        (WebKit::WebAnimationImpl::startTime):
        (WebKit::WebAnimationImpl::setStartTime):
        (WebKit::WebAnimationImpl::timeOffset):
        (WebKit::WebAnimationImpl::setTimeOffset):
        (WebKit::WebAnimationImpl::alternatesDirection):
        (WebKit::WebAnimationImpl::setAlternatesDirection):
        (WebKit::WebAnimationImpl::cloneToCCAnimation):
        * src/WebAnimationImpl.h: Added.
        (WebCore):
        (WebKit):
        (WebAnimationImpl):
        (WebKit::WebAnimationImpl::WebAnimationImpl):
        (WebKit::WebAnimationImpl::~WebAnimationImpl):
        * src/WebLayer.cpp:
        (WebKit::WebLayer::addAnimation):
        * tests/WebAnimationTest.cpp:
        (WebKit::TEST):

2012-08-10  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up dependencies for Canvas2DLayerBridgeTest and GraphicsLayerChromiumTest unit tests
        https://bugs.webkit.org/show_bug.cgi?id=93757

        Reviewed by Adrienne Walker.

        Breaks up some unit tests and removes unused code to avoid unit tests depending on both non-compositor WebCore
        logic and compositor internals. Canvas2DLayerBridgeTest had some vestigal includes and local variables that
        weren't being used, those are removed. GraphicsLayerChromiumTest was reaching into CC types, but could mostly
        use Platform API types for testing.

        GraphicsLayerChromiumTest had some tests that were verifying that we could correctly translate WebCore
        animation lists into CCAnimation types - these have been moved into AnimationTranslationUtilTest.cpp, since the
        logic under test is in AnimationTranslationUtil. Currently these only test that we accept / reject animations as
        expected. They could be expanded to verify that the animation was translated faithfully, but that would require
        expanding the information exposed on WebAnimation.

        * WebKit.gypi:
        * src/WebLayer.cpp:
        (WebKit::WebLayer::hasActiveAnimation):
        (WebKit):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKit::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKit::GraphicsLayerChromiumTest::~GraphicsLayerChromiumTest):
        (GraphicsLayerChromiumTest):
        (WebKit::TEST_F):
        * tests/WebLayerTreeViewTest.cpp:
        * tests/WebLayerTreeViewTestCommon.h: Added.
        (WebKit):
        (MockWebLayerTreeViewClient):

2012-08-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r125422.
        http://trac.webkit.org/changeset/125422
        https://bugs.webkit.org/show_bug.cgi?id=93902

        Broke the Android canary build (Requested by fmalita on
        #webkit).

        * WebKitUnitTests.gyp:

2012-08-13  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Fix nits in the find-in-page match rects API
        https://bugs.webkit.org/show_bug.cgi?id=93817

        Reviewed by Adam Barth.

        This patch fixes a few pending nits from 93111.

        * src/FindInPageCoordinates.cpp: replace a pointer by a reference in an output argument.
        (WebKit::toNormalizedRect):
        (WebKit::findInPageRectFromAbsoluteRect):

2012-08-13  Peter Beverloo  <peter@chromium.org>

        [Chromium] Fix apk generation for the Android platform
        https://bugs.webkit.org/show_bug.cgi?id=93841

        Reviewed by Dimitri Glazkov.

        APK generation was broken as the configuration file assumed compilation
        would only occur in the Chromium tree. Pass the path to Chromium's source
        base directory as a property to ant.

        * WebKitUnitTests.gyp:

2012-08-13  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-13  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-10  Kinuko Yasuda  <kinuko@chromium.org>

        Support creating File object from FileSystem URL for files in FileSystem API
        https://bugs.webkit.org/show_bug.cgi?id=93706

        Reviewed by Darin Fisher.

        * src/WebBlobData.cpp:
        (WebKit::WebBlobData::itemAt):

2012-08-12  Yuta Kitamura  <yutak@google.com>

        Unreviewed. Fix Chromium's Android build.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::find): Needs parentheses for a function call.

2012-08-12  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Implement the find-in-page match rects API
        https://bugs.webkit.org/show_bug.cgi?id=93111

        Reviewed by Adam Barth.

        Implement the funcionality of the find-in-page match rects API in WebFrame.
        These methods keep a cache of the match rects in a special coordinate system
        (find-in-page coordinates) and update them on size changes. They also allow
        to recover the match closest to a given point, therefore enabling to move
        to find matches when tapping on their corresponding tickmarks.

        * WebKit.gyp: add FindInPageCoordinates.h / cpp.
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::contentsSizeChanged): propagate didChangeContentsSize to WebFrameImpl.
        * src/FindInPageCoordinates.cpp: Added.
        (WebKit):
        (WebKit::toNormalizedRect): auxiliary internal function.
        (WebKit::findInPageRectFromAbsoluteRect): main coordinate conversion function.
        (WebKit::findInPageRectFromRange): convenience conversion function for Ranges.
        * src/FindInPageCoordinates.h: Added.
        (WebCore):
        (WebKit):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::FindMatch::FindMatch): find matches cache constructor.
        (WebKit):
        (WebKit::WebFrameImpl::find): clear match cache when appropriate and zoom into results on the Android port.
        (WebKit::WebFrameImpl::stopFinding): clear matches cache.
        (WebKit::WebFrameImpl::scopeStringMatches): add new results to the matches cache.
        (WebKit::WebFrameImpl::increaseMatchCount): update the matches cache version.
        (WebKit::WebFrameImpl::resetMatchCount): update the matches cache version.
        (WebKit::WebFrameImpl::findMatchMarkersVersion): new API providing the matches cache version.
        (WebKit::WebFrameImpl::clearFindMatchesCache): internal utility method to reset the matches cache.
        (WebKit::WebFrameImpl::isActiveMatchFrameValid): internal utility method to check if the local frame is still in the frame tree.
        (WebKit::WebFrameImpl::updateFindMatchRects): internal utility method to update the match result rects if required.
        (WebKit::WebFrameImpl::activeFindMatchRect): new API providing the active find match rect in find-in-page coordinates.
        (WebKit::WebFrameImpl::findMatchRects): new API returning the valid match rects in find-in-page coordinates.
        (WebKit::WebFrameImpl::appendFindMatchRects): internal utility method to concatenate the match results of multiple frames.
        (WebKit::WebFrameImpl::selectNearestFindMatch): new API selecting the find match closer to a point in find-in-page coordinates.
        (WebKit::WebFrameImpl::nearestFindMatch): internal utility method to find the nearest find match to a point in a frame.
        (WebKit::WebFrameImpl::selectFindMatch): internal utility method to select a match in the cache.
        (WebKit::WebFrameImpl::WebFrameImpl): initialization of new variables.
        (WebKit::WebFrameImpl::didChangeContentsSize): invalidate the cached match rect coordinates on frame content size changes.
        * src/WebFrameImpl.h:
        (WebCore):
        (WebFrameImpl):
        (WebKit::WebFrameImpl::activeMatchFrame): remove unrequired const.
        (WebKit::WebFrameImpl::activeMatch): expose the range of the active match to allow testing.
        (FindMatch): cache structure for find matches.
        * tests/WebFrameTest.cpp: new test case for find-in-page match rects.
        * tests/data/find_in_page.html: Added. Test case layout.
        * tests/data/find_in_page_frame.html: Added. Test case layout.

2012-08-09  James Robinson  <jamesr@chromium.org>

        [chromium] Remove forwarding headers for compositor-related WebKit API and update includes
        https://bugs.webkit.org/show_bug.cgi?id=93669

        Reviewed by Adam Barth.

        This updates all includes for compositor-related headers to refer consistently to the Platform API location and
        removes the now-unneeded forwarding headers in the client API location. I also updated and resorted other
        platform API includes in modified header blocks.

        * WebKit.gyp:
        * public/WebCompositor.h: Removed.
        * public/platform/WebContentLayer.h: Removed.
        * public/platform/WebContentLayerClient.h: Removed.
        * public/platform/WebExternalTextureLayer.h: Removed.
        * public/platform/WebLayer.h: Removed.
        * public/platform/WebLayerTreeView.h: Removed.
        * public/platform/WebLayerTreeViewClient.h: Removed.
        * public/platform/WebSolidColorLayer.h: Removed.
        * src/WebCompositorInputHandlerImpl.h:
        * src/WebContentLayerImpl.cpp:
        * src/WebLayer.cpp:
        * src/WebLayerTreeView.cpp:
        * src/WebLayerTreeViewImpl.cpp:
        * src/WebLayerTreeViewImpl.h:
        * src/WebSolidColorLayer.cpp:
        * src/WebViewImpl.h:
        * tests/Canvas2DLayerBridgeTest.cpp:
        * tests/GraphicsLayerChromiumTest.cpp:
        * tests/TextureLayerChromiumTest.cpp:

2012-08-10  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-10  Iain Merrick  <husky@google.com>

        [chromium] Upstream Android changes to WebFrameImpl::selectRange
        https://bugs.webkit.org/show_bug.cgi?id=92513

        Reviewed by Ryosuke Niwa.

        This change is driven by the Chromium port on the Android platform,
        but it should be suitable for other touch-based platforms. We reuse
        selectionExtentRespectingEditingBoundary (extracted from EventHandler
        into VisibleSelection).

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::selectRange):
        (WebKit::WebFrameImpl::visiblePositionForWindowPoint):

2012-08-10  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove targetSurface pointer from CCRenderPass
        https://bugs.webkit.org/show_bug.cgi?id=93734

        Reviewed by Adrienne Walker.

        Use the RenderPass's damageRect instead of the surface's damageRect
        directly to test the same things without requiring a pointer to
        the surface that generated the RenderPass.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-10  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r125310.
        http://trac.webkit.org/changeset/125310
        https://bugs.webkit.org/show_bug.cgi?id=93739

        The DEPS roll broke Android. One does not simply break
        Android. (Requested by fmalita_ on #webkit).

        * DEPS:

2012-08-10  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-10  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove scissor from the namings in CCOcclusionTracker
        https://bugs.webkit.org/show_bug.cgi?id=93630

        Reviewed by Adrienne Walker.

        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::TestCCOcclusionTrackerWithClip::TestCCOcclusionTrackerWithClip):
        (WebKitTests::TestCCOcclusionTrackerWithClip::setLayerClipRect):
        (WebKitTests::TestCCOcclusionTrackerWithClip::useDefaultLayerClipRect):
        (WebKitTests::TestCCOcclusionTrackerWithClip::layerClipRectInTarget):
        (TestCCOcclusionTrackerWithClip):
        (WebKitTests::CCOcclusionTrackerTestIdentityTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTranslatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceRotatedOffAxis::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithTwoOpaqueChildren::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestFilters::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaDoesOcclude::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithMask::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerClipRectOutsideChild::runMyTest):
        (WebKitTests):
        (WebKitTests::CCOcclusionTrackerTestViewportRectOutsideChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerClipRectOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestViewportRectOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerClipRectPartlyOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestViewportRectPartlyOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerClipRectOverNothing::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestViewportRectOverNothing::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerClipRectForLayerOffOrigin::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOpaqueContentsRegionEmpty::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOpaqueContentsRegionNonEmpty::runMyTest):
        (WebKitTests::CCOcclusionTrackerTest3dTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestUnsorted3dLayers::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransformBehindCamera::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerBehindCameraDoesNotOcclude::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLargePixelsOccludeInsideClipRect::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity1OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity0OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationTranslateOnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesToParent::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithReplicaUnoccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceAndReplicaOccludedDifferently::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTopmostSurfaceIsClippedToViewport::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfClippingSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTwoBackgroundFiltersReduceOcclusionTwice::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilterWithClip::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionBelowBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionIfBackgroundFilterIsOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReduceOcclusionWhenBackgroundFilterIsPartiallyOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestMinimumTrackingSize::runMyTest):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-10  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r125230 and r125238.
        http://trac.webkit.org/changeset/125230
        http://trac.webkit.org/changeset/125238
        https://bugs.webkit.org/show_bug.cgi?id=93698

        Broke ChromiumOS browser tests. (Requested by yutak on
        #webkit).

        * tests/TiledLayerChromiumTest.cpp:

2012-08-09  Eric Penner  <epenner@google.com>

        [chromium] Paint animated layers immediately to avoid animation hiccups.
        https://bugs.webkit.org/show_bug.cgi?id=93028

        Reviewed by Adrienne Walker.

        Replaced one test. Test painting full animated layer.

        * tests/TiledLayerChromiumTest.cpp:

2012-08-09  Nat Duca  <nduca@chromium.org>

        [chromium] Remove missing files from WebKit.gyp introduced by r125219
        https://bugs.webkit.org/show_bug.cgi?id=93671

        Unreviewed. Fixing windows build.

        * WebKit.gyp:

2012-08-09  Alec Flett  <alecflett@chromium.org>

        IndexedDB: add AssertMatchingEnums for Direction and TaskType
        https://bugs.webkit.org/show_bug.cgi?id=93618

        Reviewed by Tony Chang.

        These chromium enums were introduced in a separate patch.

        * src/AssertMatchingEnums.cpp:

2012-08-06  Nat Duca  <nduca@chromium.org>

        [chromium] Expose CCGraphicsContext as WebCompositorOutputSurface
        https://bugs.webkit.org/show_bug.cgi?id=92890

        Reviewed by James Robinson.

        * WebKit.gyp:
        * WebKit.gypi:
        * public/WebSettings.h:
        * public/WebViewClient.h:
        (WebKit):
        (WebViewClient):
        (WebKit::WebViewClient::createOutputSurface):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit):
        (WebGraphicsContextToOutputSurfaceAdapter):
        (WebKit::WebGraphicsContextToOutputSurfaceAdapter::WebGraphicsContextToOutputSurfaceAdapter):
        (WebKit::WebLayerTreeViewClientAdapter::WebLayerTreeViewClientAdapter):
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit::WebViewImpl::createOutputSurface):
        (WebKit):
        (WebKit::WebViewImpl::didRebindGraphicsContext):
        (WebKit::WebViewImpl::didRecreateOutputSurface):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF):
        (WTF::CCLayerTreeHostTestSetSingleLostContext::didRecreateOutputSurface):
        (WTF::CCLayerTreeHostTestSetRepeatedLostContext::didRecreateOutputSurface):
        * tests/CCResourceProviderTest.cpp:
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadedTest.cpp:
        (WebKitTests::TestHooks::createOutputSurface):
        * tests/CCThreadedTest.h:
        (WebKitTests::TestHooks::didRecreateOutputSurface):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):
        * tests/FakeCCGraphicsContext.h:
        (WebKit::createFakeCCGraphicsContext):
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/FakeWebCompositorOutputSurface.h: Copied from Source/WebCore/platform/graphics/chromium/cc/CCGraphicsContext.h.
        (WebKit):
        (FakeWebCompositorOutputSurface):
        (WebKit::FakeWebCompositorOutputSurface::create):
        (WebKit::FakeWebCompositorOutputSurface::FakeWebCompositorOutputSurface):
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-09  Nat Duca  <nduca@chromium.org>

        Unreviewed, rolling out r125212.
        http://trac.webkit.org/changeset/125212
        https://bugs.webkit.org/show_bug.cgi?id=92890

        Compile failure on mac dbg builder

        * WebKit.gyp:
        * WebKit.gypi:
        * public/WebSettings.h:
        * public/WebViewClient.h:
        (WebKit):
        (WebViewClient):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewClientAdapter::WebLayerTreeViewClientAdapter):
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        (WebKit::WebSettingsImpl::setForceSoftwareCompositing):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebKit::WebSettingsImpl::forceSoftwareCompositing):
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit::WebViewImpl::createCompositorGraphicsContext3D):
        (WebKit::WebViewImpl::createContext3D):
        (WebKit::WebViewImpl::didRebindGraphicsContext):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF):
        (WTF::CCLayerTreeHostTestSetSingleLostContext::didRecreateContext):
        (WTF::CCLayerTreeHostTestSetRepeatedLostContext::didRecreateContext):
        * tests/CCResourceProviderTest.cpp:
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadedTest.cpp:
        (WebKitTests::TestHooks::createContext):
        * tests/CCThreadedTest.h:
        (WebKitTests::TestHooks::didRecreateContext):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):
        * tests/FakeCCGraphicsContext.h:
        (WebKit::createFakeCCGraphicsContext):
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/FakeWebCompositorOutputSurface.h: Removed.
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-09  Kentaro Hara  <haraken@chromium.org>

        [V8] Rename V8BindingPerIsolateData to V8PerIsolateData
        https://bugs.webkit.org/show_bug.cgi?id=93592

        Reviewed by Adam Barth.

        For a better name. See discussion in bug 93333.

        No tests. No change in behavior.

        * src/WebKit.cpp:
        (WebKit::initialize):

2012-08-06  Nat Duca  <nduca@chromium.org>

        [chromium] Expose CCGraphicsContext as WebCompositorOutputSurface
        https://bugs.webkit.org/show_bug.cgi?id=92890

        Reviewed by James Robinson.

        * WebKit.gyp:
        * WebKit.gypi:
        * public/WebSettings.h:
        * public/WebViewClient.h:
        (WebKit):
        (WebViewClient):
        (WebKit::WebViewClient::createOutputSurface):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit):
        (WebGraphicsContextToOutputSurfaceAdapter):
        (WebKit::WebGraphicsContextToOutputSurfaceAdapter::WebGraphicsContextToOutputSurfaceAdapter):
        (WebKit::WebLayerTreeViewClientAdapter::WebLayerTreeViewClientAdapter):
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit::WebViewImpl::createOutputSurface):
        (WebKit):
        (WebKit::WebViewImpl::didRebindGraphicsContext):
        (WebKit::WebViewImpl::didRecreateOutputSurface):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF):
        (WTF::CCLayerTreeHostTestSetSingleLostContext::didRecreateOutputSurface):
        (WTF::CCLayerTreeHostTestSetRepeatedLostContext::didRecreateOutputSurface):
        * tests/CCResourceProviderTest.cpp:
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadedTest.cpp:
        (WebKitTests::TestHooks::createOutputSurface):
        * tests/CCThreadedTest.h:
        (WebKitTests::TestHooks::didRecreateOutputSurface):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):
        * tests/FakeCCGraphicsContext.h:
        (WebKit::createFakeCCGraphicsContext):
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/FakeWebCompositorOutputSurface.h: Copied from Source/WebCore/platform/graphics/chromium/cc/CCGraphicsContext.h.
        (WebKit):
        (FakeWebCompositorOutputSurface):
        (WebKit::FakeWebCompositorOutputSurface::create):
        (WebKit::FakeWebCompositorOutputSurface::FakeWebCompositorOutputSurface):
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (TEST):
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-09  Alec Flett  <alecflett@chromium.org>

        IndexedDB: additional chromium signature for openCursor
        https://bugs.webkit.org/show_bug.cgi?id=93637

        Reviewed by Adam Barth.

        Stub out the TaskType-based openCursor in the chromium API.

        * src/WebIDBObjectStoreImpl.cpp:
        (WebKit::WebIDBObjectStoreImpl::openCursor):
        * src/WebIDBObjectStoreImpl.h:
        (WebKit::WebIDBObjectStoreImpl::openCursor):
        (WebIDBObjectStoreImpl):

2012-08-09  Dana Jansens  <danakj@chromium.org>

        [chromium] Do partial-swap scissoring on quads during draw instead of on layers
        https://bugs.webkit.org/show_bug.cgi?id=91800

        Reviewed by Adrienne Walker.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::executeCalculateDrawTransformsAndVisibility):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        Removed tests of the scissor rect here, as they are no longer
        computed within CCLayerTreeHostCommon. Verify that the scissor
        does not affect texture caching in CCLayerTreeHostImplTest now.
        Previous scissor would affect the texture cache decisions, but
        this was incorrect, as damaged areas are always inside the
        scissor rect, and anything outside the scissor rect should
        be considered as valid and complete (assuming no external
        occlusion, which is computed outside the scissor rect now also).

        * tests/CCLayerTreeHostImplTest.cpp:
        Removed didDrawNotCalledOnScissoredLayer test, as this no longer
        applies. didDraw will be called on layers that are outside the
        partial swap rect, regardless.

        Removed partialSwapNoUpdate test, and merged its functionality into
        the partialSwap test while updating its expectations.

        Added textureCachingWithScissor, which is loosely based on the
        CCLayerTreeHostCommonTest.scissorRectWithClip test.

        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::calcDrawEtc):
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::createLayer):
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest::swapBuffers):
        (TEST_F):
        (TEST):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-09  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Pass mask scale and offset to shaders for correct masking
        https://bugs.webkit.org/show_bug.cgi?id=93558

        Reviewed by Adrienne Walker.

        Updated one unit test that needed additional args in a
        constructor, but no change in behavior of the test.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-09  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: add codemirror library as an experiment
        https://bugs.webkit.org/show_bug.cgi?id=93620

        Reviewed by Vsevolod Vlasov.

        * WebKit.gyp:

2012-08-09  Peter Beverloo  <peter@chromium.org>

        Unreviewed, rolling out r125171.
        http://trac.webkit.org/changeset/125171

        Broke the Chromium Android build.

        * DEPS:

2012-08-09  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-09  Keishi Hattori  <keishi@webkit.org>

        Page popups can show up at wrong locations
        https://bugs.webkit.org/show_bug.cgi?id=93556

        Reviewed by Kent Tamura.

        We were showing the popup at wrong positions. When there isn't enough
        room below and above the element it adjusts the position but we weren't
        resetting the adjustment when we resize the popup. This patch will make
        the popup adjust the popup position each time we resize.

        * src/ColorChooserUIController.cpp:
        (WebKit::ColorChooserUIController::contentSize):
        * src/WebPagePopupImpl.cpp:
        (WevKit::PagePopupChromeClient::setWindowRect):
        (WebKit::WebPagePopupImpl::init): Use reposition().
        (WebKit::WebPagePopupImpl::reposition): Repositions the page popup based on the popup size.
        (WebKit):
        (WebKit::WebPagePopupImpl::resize): Use reposition().
        * src/WebPagePopupImpl.h:
        (WebPagePopupImpl):

2012-08-09  Peter Beverloo  <peter@chromium.org>

        [Chromium] Pull in the android_tools directory for Android
        https://bugs.webkit.org/show_bug.cgi?id=84843

        Reviewed by Jochen Eisinger.

        Pull in the android_tools directory for Chromium Android checkouts. This
        repository, living in Chromium's, contains checked in versions of the
        Android NDK and SDK meant to make builds and updates easier.

        * DEPS:

2012-08-08  Shane Stephens  <shanestephens@google.com>

        Compile flag for CSS Hierarchies
        https://bugs.webkit.org/show_bug.cgi?id=92433

        Reviewed by Tony Chang.

        * features.gypi:

2012-08-08  Kent Tamura  <tkent@chromium.org>

        [Chromium-mac] Switch to LocalizedNumberMac from LocalizedNumberICU
        https://bugs.webkit.org/show_bug.cgi?id=93432

        Reviewed by Hajime Morita.

        * tests/LocaleMacTest.cpp:
        Add some tests for number localization. They are similar to tests in
        LocaleWinTest and LocalizedNumberICUTest.cpp
        (LocaleMacTest):
        (LocaleMacTest::decimalSeparator):
        (TEST_F):
        (testNumberIsReversible):
        (testNumbers):

2012-08-08  Adrienne Walker  <enne@google.com>

        [chromium] Move scrollbar pointer into WebScrollbarThemePainter
        https://bugs.webkit.org/show_bug.cgi?id=93541

        Reviewed by James Robinson.

        Fix WebScrollbarThemePainter implementation to make direct calls on
        the scrollbar rather than through the WebScrollbarThemeClientImpl
        adapter.

        * src/WebScrollbarThemePainter.cpp:
        (WebKit::WebScrollbarThemePainter::assign):
        (WebKit::WebScrollbarThemePainter::paintScrollbarBackground):
        (WebKit::WebScrollbarThemePainter::paintTrackBackground):
        (WebKit::WebScrollbarThemePainter::paintBackTrackPart):
        (WebKit::WebScrollbarThemePainter::paintForwardTrackPart):
        (WebKit::WebScrollbarThemePainter::paintBackButtonStart):
        (WebKit::WebScrollbarThemePainter::paintBackButtonEnd):
        (WebKit::WebScrollbarThemePainter::paintForwardButtonStart):
        (WebKit::WebScrollbarThemePainter::paintForwardButtonEnd):
        (WebKit::WebScrollbarThemePainter::paintTickmarks):
        (WebKit::WebScrollbarThemePainter::paintThumb):
        (WebKit::WebScrollbarThemePainter::WebScrollbarThemePainter):
        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::TEST):

2012-08-08  Alexei Svitkine  <asvitkine@chromium.org>

        [chromium/mac] Map NSEventPhaseMayBegin appropriately on 10.8
        https://bugs.webkit.org/show_bug.cgi?id=93535

        Reviewed by Dimitri Glazkov.

        This enables putting two fingers on the track pad to show overlay scroll bars on 10.8+.

        * src/mac/WebInputEventFactory.mm:
        (WebKit::phaseForNSEventPhase):

2012-08-08  James Robinson  <jamesr@chromium.org>

        [chromium] Fix up includes and types in chromium compositor unit tests
        https://bugs.webkit.org/show_bug.cgi?id=93553

        Reviewed by Adrienne Walker.

        This removes some unused GraphicsContext3DPrivate.h includes and adds some includes that were being implicitely
        depending upon - mostly for wtf/PassOwnPtr.h.

        * tests/CCLayerTreeHostTest.cpp:
        (::CCLayerTreeHostTestCommit::beginTest):
        (::CCLayerTreeHostTestCommit::commitCompleteOnCCThread):
        * tests/CCRenderSurfaceFiltersTest.cpp:
        * tests/CompositorFakeWebGraphicsContext3D.h:
        * tests/FakeGraphicsContext3DTest.cpp:
        * tests/FakeWebScrollbarThemeGeometry.h:
        * tests/TextureCopierTest.cpp:
        * tests/ThrottledTextureUploaderTest.cpp:

2012-08-08  Eric Penner  <epenner@google.com>

        [chromium] Refactor tile flags.
        https://bugs.webkit.org/show_bug.cgi?id=93059

        Reviewed by Adrienne Walker.

        Minor fixes to existing tests.

        * tests/TiledLayerChromiumTest.cpp:

2012-08-08  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up WebKit.h and WebKitPlatformSupport.h includes in chromium/src
        https://bugs.webkit.org/show_bug.cgi?id=93539

        Reviewed by Adam Barth.

        Most of these files don't need either WebKit.h or WebKitPlatformSupport.h. Some need <public/Platform.h>, and
        some are relying on the forwarding headers. This updates includes to what is actually needed and points platform
        includes at <public/Foo.h> instead of "platform/Foo.h" where possible.

        * src/ApplicationCacheHostInternal.h:
        * src/AssociatedURLLoader.cpp:
        * src/AsyncFileSystemChromium.cpp:
        (WebCore::AsyncFileSystemChromium::AsyncFileSystemChromium):
        * src/BlobRegistryProxy.cpp:
        * src/ChromiumCurrentTime.cpp:
        * src/ChromiumOSRandomSource.cpp:
        * src/ChromiumThreading.cpp:
        * src/EditorClientImpl.cpp:
        * src/FrameLoaderClientImpl.cpp:
        * src/IDBFactoryBackendProxy.cpp:
        * src/LocalizedStrings.cpp:
        * src/PlatformMessagePortChannel.cpp:
        * src/WebCompositorInputHandlerImpl.cpp:
        * src/WebMediaPlayerClientImpl.cpp:
        * src/WebPluginContainerImpl.cpp:
        * src/WebViewImpl.cpp:
        * src/WebWorkerClientImpl.cpp:
        * src/WorkerAsyncFileSystemChromium.cpp:
        * src/WorkerFileWriterCallbacksBridge.cpp:

2012-08-08  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up includes in compositor unit tests
        https://bugs.webkit.org/show_bug.cgi?id=93531

        Reviewed by Adrienne Walker.

        This removes unused includes and updates Platform API headers to use the <public/Web...> style paths.

        * tests/CCAnimationTestCommon.cpp:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        * tests/CCOcclusionTrackerTest.cpp:
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadedTest.cpp:
        * tests/FakeWebGraphicsContext3D.h:
        * tests/LayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/WebCompositorInputHandlerImplTest.cpp:
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp:

2012-08-07  James Robinson  <jamesr@chromium.org>

        [chromium] Only use public Platform API in NonCompositedContentHost
        https://bugs.webkit.org/show_bug.cgi?id=93423

        Reviewed by Adrienne Walker.

        Switches to using Web*Layer APIs in NonCompositedContentHost instead of reaching in to the LayerChromium and
        updates unit tests for the nonCompositedContent->useLCDText flag rename.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        * src/WebContentLayer.cpp:
        (WebKit::WebContentLayer::setUseLCDText):
        (WebKit):
        (WebKit::WebContentLayer::setDrawCheckerboardForMissingTiles):
        * src/WebViewImpl.cpp:
        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/LayerChromiumTest.cpp:

2012-08-08  Alec Flett  <alecflett@chromium.org>

        IndexedDB: new enums and openCursor stub
        https://bugs.webkit.org/show_bug.cgi?id=93410

        Reviewed by Adam Barth.

        This stubs out the TaskType and Direction enums that will be
        required to land the chromium side of
        https://bugs.webkit.org/show_bug.cgi?id=91125.

        * public/WebIDBCursor.h:
        * public/WebIDBObjectStore.h:
        (WebKit::WebIDBObjectStore::setIndexKeys):
        (WebKit::WebIDBObjectStore::setIndexesReady):
        (WebIDBObjectStore):
        (WebKit::WebIDBObjectStore::openCursor):
        * public/WebIDBTransaction.h:

2012-08-08  Dana Jansens  <danakj@chromium.org>

        [chromium] Enable occlusion tracker in the occlusion tests for surface cacheing
        https://bugs.webkit.org/show_bug.cgi?id=93500

        Reviewed by Adrienne Walker.

        The occlusion tracker is not being used in these tests except to do
        scissoring. We want to test occlusion with these occlusion tests,
        and when scissoring is not part of occlusion tracker, these
        tests would become useless otherwise.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-08  Adam Barth  <abarth@webkit.org>

        Crash when reloading a Chromium "platform" app
        https://bugs.webkit.org/show_bug.cgi?id=93497

        Reviewed by Eric Seidel.

        Test that we don't crash when executing script during the
        didCreateScriptContext callback.

        * tests/WebFrameTest.cpp:
        * tests/data/hello_world.html: Added.

2012-08-07  Joshua Bell  <jsbell@chromium.org>

        Layout Test storage/indexeddb/intversion-omit-parameter.html is flaky
        https://bugs.webkit.org/show_bug.cgi?id=92952

        Reviewed by Tony Chang.

        Added test to exercise WebCore::IDBRequest event callbacks after
        the script context has stopped and ensure no asserts are hit.

        * WebKit.gypi:
        * tests/IDBRequestTest.cpp: Added.
        (WebCore):
        (WebCore::TEST):

2012-08-07  Fady Samuel  <fsamuel@chromium.org>

        Allow plugins to decide whether they are keyboard focusable
        https://bugs.webkit.org/show_bug.cgi?id=88958

        Reviewed by Anders Carlsson.

        * public/WebPlugin.h:
        (WebKit::WebPlugin::supportsKeyboardFocus):
        * src/WebInputEventConversion.cpp:
        (WebKit::WebKeyboardEventBuilder::WebKeyboardEventBuilder):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::supportsKeyboardFocus):
        (WebKit):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):

2012-08-07  Kentaro Hara  <haraken@chromium.org>

        [V8] Implement V8Proxy::registerExtensionIfNeeded() and remove redundant methods
        https://bugs.webkit.org/show_bug.cgi?id=93209

        Reviewed by Adam Barth.

        By implementing V8Proxy::registerExtensionIfNeeded(), we can remove
        registeredExtensionWithV8() and registerExtension().

        No tests. No change in behavior.

        * src/WebScriptController.cpp:
        (WebKit::WebScriptController::registerExtension):

2012-08-07  James Robinson  <jamesr@chromium.org>

        [chromium] Add new gclient-managed cc directory to Source/WebKit/chromium/.gitignore
        https://bugs.webkit.org/show_bug.cgi?id=93403

        Reviewed by Eric Seidel.

        * .gitignore:

2012-08-07  Mihai Parparita  <mihaip@chromium.org>

        [Chromium] Clean up WebScriptController.h comments
        https://bugs.webkit.org/show_bug.cgi?id=93399

        Reviewed by Adam Barth.

        Remove references to overloaded WebScriptController::registerExtension
        variants. They were removed in r68666.

        * public/WebScriptController.h:
        (WebScriptController):

2012-08-07  Kentaro Hara  <haraken@chromium.org>

        [V8] Remove #include Frame.h from V8Binding.h
        https://bugs.webkit.org/show_bug.cgi?id=93326

        Reviewed by Adam Barth.

        We want to remove unnecessary #include in V8Binding.h
        to avoid circular include dependency.

        No tests. No change in behavior.

        * src/WebBindings.cpp:

2012-08-07  James Robinson  <jamesr@chromium.org>

        [chromium] Switch PlatformLayer typedef to Platform API type for PLATFORM(CHROMIUM)
        https://bugs.webkit.org/show_bug.cgi?id=93335

        Reviewed by Adrienne Walker.

        Update for new PlatformLayer typedef. This removes knowledge of WebCore::LayerChromium from all classes
        except for NonCompositedContentHost, which still punches through for a few minor APIs that I'll address
        in a separate patch.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::NonCompositedContentHost::scrollLayer):
        (WebKit::NonCompositedContentHost::notifySyncRequired):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::platformLayer):
        * src/WebPluginContainerImpl.h:
        (WebCore):
        (WebPluginContainerImpl):
        * src/WebScrollableLayer.cpp:
        (WebKit::WebScrollableLayer::setNonFastScrollableRegion):
        (WebKit):
        (WebKit::WebScrollableLayer::setIsContainerForFixedPositionLayers):
        (WebKit::WebScrollableLayer::setFixedToContainerLayer):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setRootGraphicsLayer):
        * tests/Canvas2DLayerBridgeTest.cpp:
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKitTests::TEST_F):

2012-08-07  James Robinson  <jamesr@chromium.org>

        [chromium] Use WebCompositor interface in Platform API instead of CCProxy to query threaded compositor status
        https://bugs.webkit.org/show_bug.cgi?id=93398

        Reviewed by Adam Barth.

        Converts non-compositor code that cares about threaded compositing status over to query WebCompositor instead of
        CCProxy.

        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::supportsType):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::composite):
        (WebKit::WebViewImpl::scheduleAnimation):
        (WebKit::WebViewImpl::scheduleComposite):

2012-08-07  James Robinson  <jamesr@chromium.org>

        [chromium] Move WebCompositor interface into Platform AP
        https://bugs.webkit.org/show_bug.cgi?id=93391

        Reviewed by Adam Barth.

        * WebKit.gyp:
        * public/WebCompositor.h:
        * src/WebLayerTreeViewImpl.cpp:

2012-08-07  Joshua Bell  <jsbell@chromium.org>

        REGRESSION(r124865): It broke the ARM Chromium build
        https://bugs.webkit.org/show_bug.cgi?id=93364

        Reviewed by Csaba Osztrogonác.

        Mark large constant with LL to satisfy a picky compiler.

        * tests/IDBLevelDBCodingTest.cpp:
        (IDBLevelDBCoding::TEST):

2012-08-07  Alexei Filippov  <alexeif@chromium.org>

        Web Inspector: make the MemoryClassInfo class a not-template
        https://bugs.webkit.org/show_bug.cgi?id=93265

        Reviewed by Yury Semikhatsky.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::Instrumented::reportMemoryUsage):
        (WebCore::InstrumentedRefPtr::reportMemoryUsage):
        (WebCore::InstrumentedWithOwnPtr::reportMemoryUsage):
        (WebCore::InstrumentedOther::reportMemoryUsage):
        (WebCore::InstrumentedDOM::reportMemoryUsage):
        (WebCore::NonVirtualInstrumented::reportMemoryUsage):

2012-08-06  Yuta Kitamura  <yutak@chromium.org>

        WebSocket.send() should accept ArrayBufferView
        https://bugs.webkit.org/show_bug.cgi?id=90877

        Reviewed by Kent Tamura.

        * src/WebSocketImpl.cpp:
        (WebKit::WebSocketImpl::sendArrayBuffer):
        Apply change in function signature of WebSocketChannel::send().

2012-08-06  James Robinson  <jamesr@chromium.org>

        [chromium] Remove lingering unwrap<>() calls in GraphicsLayerChromium.cpp
        https://bugs.webkit.org/show_bug.cgi?id=93319

        Reviewed by Adrienne Walker.

        * src/WebLayer.cpp:
        (WebKit::WebLayer::setChildren):
        (WebKit):
        (WebKit::WebLayer::setReplicaLayer):
        (WebKit::WebLayer::setDebugName):
        (WebKit::WebLayer::clearRenderSurface):

2012-08-06  Adrienne Walker  <enne@google.com>

        [chromium] Convert WebScrollbarThemeGeometry from a concrete class to an interface
        https://bugs.webkit.org/show_bug.cgi?id=93308

        Reviewed by James Robinson.

        Now that WebScrollbarThemeGeometry can have different implementations,
        create a FakeWebScrollbarThemeGeometry for testing purposes rather
        than just overriding a geometry-related virtual.

        * WebKit.gyp:
        * WebKit.gypi:
        * src/WebScrollbarLayer.cpp:
        (WebKit::WebScrollbarLayer::create):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/FakeWebScrollbarThemeGeometry.h: Added.
        (WebKit):
        (FakeWebScrollbarThemeGeometry):
        (WebKit::FakeWebScrollbarThemeGeometry::create):
        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::TEST):

2012-08-06  James Robinson  <jamesr@chromium.org>

        [chromium] Update chromium DEPS r150037 -> r150169
        https://bugs.webkit.org/show_bug.cgi?id=93309

        As the title says. Unreviewed.

        * DEPS:

2012-08-06  David Reveman  <reveman@chromium.org>

        [Chromium] Rename CCTextureUpdater to CCTextureUpdateQueue.
        https://bugs.webkit.org/show_bug.cgi?id=93293

        Reviewed by Adrienne Walker.

        * src/WebExternalTextureLayer.cpp:
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/CCTextureUpdateControllerTest.cpp:
        * tests/CCThreadedTest.cpp:
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeTiledLayerChromium::update):
        * tests/CCTiledLayerTestCommon.h:
        (FakeTiledLayerChromium):
        * tests/Canvas2DLayerBridgeTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-08-06  Bear Travis  <betravis@adobe.com>

        [CSS Exclusions] Add a command-line flag to enable / disable exclusions
        https://bugs.webkit.org/show_bug.cgi?id=91420

        Reviewed by Dimitri Glazkov.

        Adding the interface code to expose the css exclusions runtime flag to
        Chromium.

        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures): Adding getters/setters for cssExclusions
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableCSSExclusions):
        (WebKit):
        (WebKit::WebRuntimeFeatures::isCSSExclusionsEnabled):

2012-08-06  Adam Barth  <abarth@webkit.org>

        [Chromium] WebTouchCandidatesInfo should be part of the Client API
        https://bugs.webkit.org/show_bug.cgi?id=93088

        Reviewed by Eric Seidel.

        * WebKit.gyp:
        * public/WebTouchCandidatesInfo.h: Copied from Source/Platform/chromium/public/WebTouchCandidatesInfo.h.
        * src/WebViewImpl.cpp:

2012-08-06  Adrienne Walker  <enne@google.com>

        [chromium] REGRESSION(r124714): webkit_unit_tests asserts in Debug
        https://bugs.webkit.org/show_bug.cgi?id=93297

        Reviewed by James Robinson.

        This is a quick fix to get debug unit tests working again by
        implementing a virtual function that has ASSERT_NOT_REACHED in the
        base class version.

        * tests/ScrollAnimatorNoneTest.cpp:
        (MockScrollableArea::scrollPosition):

2012-08-06  Nasko Oskov  <nasko@chromium.org>

        Adding APIs to Chromium WebKit API to allow for creating and monitoring frame hierarchy.
        https://bugs.webkit.org/show_bug.cgi?id=93127

        Reviewed by Adam Barth.

        Add support in the API to monitor and create frame hierarchy to allow replicating it
        across different instances of WebKit.

        * public/WebDocument.h:
        (WebDocument): Added createElement.
        * public/WebFrame.h: Added assignedName.
        * public/WebFrameClient.h:
        (WebFrameClient):
        (WebKit::WebFrameClient::didCreateFrame): Added to allow embedders to know when frames are created.
        (WebKit::WebFrameClient::willCheckAndDispatchMessageEvent): Added the target frame as a parameter.
        * public/WebNode.h:
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::willCheckAndDispatchMessageEvent):
        * src/WebDocument.cpp:
        (WebKit::WebDocument::createElement): Added to allow for creating frame elements.
        (WebKit):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::uniqueName): Added to migrate callers to the matching WebCore API.
        (WebKit):
        (WebKit::WebFrameImpl::assignedName): Returns the name given to a frame, as opposed 
        to the unique name, generated by WebKit.
        (WebKit::WebFrameImpl::createChildFrame): Added call to the frame client's didCreateFrame.
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebNode.cpp:
        (WebKit::WebNode::appendChild): Added to allow for adding elements to the DOM.
        (WebKit):
        * tests/WebFrameTest.cpp:

2012-08-06  David Reveman  <reveman@chromium.org>

        [Chromium] Refactor CCTextureUpdater into CCTextureUpdater and CCTextureUpdateController.
        https://bugs.webkit.org/show_bug.cgi?id=92596

        Reviewed by Adrienne Walker.

        * WebKit.gypi:
        * src/WebExternalTextureLayer.cpp:
        * tests/CCTextureUpdateControllerTest.cpp: Renamed from Source/WebKit/chromium/tests/CCTextureUpdaterTest.cpp.
        * tests/CCTiledLayerTestCommon.h:
        (WebKitTests::FakeTextureCopier::copyTexture):
        (WebKitTests::FakeTextureUploader::uploadTexture):
        * tests/TextureCopierTest.cpp:
        (TEST):
        * tests/TiledLayerChromiumTest.cpp:

2012-08-06  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Non-preserves-3d requires explicit flattening of screen-space transform.
        https://bugs.webkit.org/show_bug.cgi?id=85808

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-08-06  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: rename WorkerAgent.setWorkerInspectionEnabled to WorkerAgent.enable and make it return error
        https://bugs.webkit.org/show_bug.cgi?id=92545

        Reviewed by Pavel Feldman.

        Replaced Preferences.exposeWorkersInspection with InspectorFrontendHost.canInspectWorkers()
        that tells if inspector front-end on the given platform can launch dedicated worker
        front-end.

        * src/InspectorFrontendClientImpl.cpp:
        (WebKit::InspectorFrontendClientImpl::canInspectWorkers):
        (WebKit):
        * src/InspectorFrontendClientImpl.h:
        (InspectorFrontendClientImpl):
        * src/js/DevTools.js:

2012-08-06  Keishi Hattori  <keishi@webkit.org>

        Remove minimum window size for PagePopup
        https://bugs.webkit.org/show_bug.cgi?id=93100

        Reviewed by Kent Tamura.

        * src/WebPagePopupImpl.cpp: Returns 0x0 so the page popup can be smaller than 100x100.

2012-08-05  Kent Tamura  <tkent@chromium.org>

        [Chromium-win] Use system locale for number representation
        https://bugs.webkit.org/show_bug.cgi?id=93085

        Reviewed by Hajime Morita.

        * WebKit.gypi:
        Don't include Localized*ICUTest.cpp in Windows and OSX. They are unnecessary.
        * tests/LocaleWinTest.cpp:
        (LocaleWinTest): Add some LCID symbols.
        (LocaleWinTest::decimalSeparator):
        A helper for LocaleWinTest.decimalSeparator.
        (TEST_F(LocaleWinTest, decimalSeparator)):
        A test for LocaleWin::localizedDecimalSeparator(). This is a copy of the
        corresponding test in LocalizedNumberICUTest.cpp.
        (testNumberIsReversible):
        A test helper LocaleWinTest.localizedNumberRoundTrip. This is a copy of
        the corresponding test in LocalizedNumberICUTest.cpp.
        (testNumbers): ditto.
        (TEST_F(LocaleWinTest, localizedNumberRoundTrip)):
        Tests for LocaleWin changes. This is a copy of the corresponding tests
        in LocalizedNumberICUTest.cpp.

2012-08-04  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-03  Nico Weber  <thakis@chromium.org>

        [chromium] Add API to make it possible to request all variants of a WebImage
        https://bugs.webkit.org/show_bug.cgi?id=92933

        Reviewed by Adam Barth.

        Part of http://crbug.com/138550

        * src/WebImageSkia.cpp:
        (WebKit::WebImage::framesFromData):
        (WebKit):

2012-08-03  Yaron Friedman  <yfriedman@chromium.org>

        [Chrome-Android] - Prepare apk tests for switch to checked in SDK.
        https://bugs.webkit.org/show_bug.cgi?id=92931

        Reviewed by Adam Barth.

        Pass Android-specific gyp variables to the native test generator
        avoiding any dependencies on environment variables during build time.

        * WebKitUnitTests.gyp:

2012-08-03  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Core upgradeneeded logic
        https://bugs.webkit.org/show_bug.cgi?id=92558

        Reviewed by Ojan Vafai.

        Update overridden methods to match new signatures.

        * tests/IDBAbortOnCorruptTest.cpp:
        (WebCore::FailingBackingStore::createIDBDatabaseMetaData):
        * tests/IDBFakeBackingStore.h:

2012-08-03  Rick Byers  <rbyers@chromium.org>

        Double tap gesture should send dblclick event
        https://bugs.webkit.org/show_bug.cgi?id=92412

        Reviewed by Adam Barth.

        Tweak comment to more completely describe the (lame) overloaded use
        of deltaX in WebGestureEvent, and add a FIXME with the bug to track
        cleaning it up.
        * public/WebInputEvent.h:
        (WebGestureEvent):

2012-08-03  Dave Tu  <dtu@chromium.org>

        [chromium] Remove assert when getting hardware renderingStats in software mode.
        https://bugs.webkit.org/show_bug.cgi?id=92325

        Reviewed by Adrienne Walker.

        If a page caused hardware mode to be turned on, then off, the hardware stats are still valid, so we don't need to assert that we're in hardware mode. Checking if the LayerTreeView is null should be sufficient.

        * public/WebWidget.h:
        (WebWidget):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::renderingStats):
        (WebKit::WebViewImpl::paint):
        * src/WebViewImpl.h:

2012-08-03  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-03  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r124632.
        http://trac.webkit.org/changeset/124632
        https://bugs.webkit.org/show_bug.cgi?id=93154

        Added new WebFrameTest.SelectRange which fails on bots
        (Requested by dimich on #webkit).

        * tests/WebFrameTest.cpp:
        * tests/data/select_range_basic.html: Removed.
        * tests/data/select_range_iframe.html: Removed.
        * tests/data/select_range_scroll.html: Removed.

2012-08-03  Terry Anderson  <tdanderson@chromium.org>

        Apply target fuzzing when sending a context menu event
        https://bugs.webkit.org/show_bug.cgi?id=92914

        Reviewed by Antonio Gomes.

        When constructing a PlatformEvent::GestureLongPress in WebInputEventConversion.cpp,
        use |boundingBox| to specify |m_area|.

        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):

2012-08-03  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Add stubs for the find-in-page match rects API
        https://bugs.webkit.org/show_bug.cgi?id=93110

        Reviewed by Adam Barth.

        The Android port allows tapping on the find-in-page result tickmarks taking
        the user to the corresponding matches. This patch introduces stubs for the
        new required methods in order to achieve WebKit API compatibility for this
        port as soon as possible. The implementation of these methods will be added
        later in https://bugs.webkit.org/show_bug.cgi?id=93111.

        * public/WebFrame.h:
        (WebKit):
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::findMatchMarkersVersion):
        (WebKit):
        (WebKit::WebFrameImpl::activeFindMatchRect):
        (WebKit::WebFrameImpl::findMatchRects):
        (WebKit::WebFrameImpl::selectNearestFindMatch):
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-08-03  Mike West  <mkwst@chromium.org>

        Blocking a plugin via CSP should result in one (and only one) console message.
        https://bugs.webkit.org/show_bug.cgi?id=92649

        Reviewed by Adam Barth.

        * src/LocalizedStrings.cpp:
        (WebCore::blockedPluginByContentSecurityPolicyText):
        (WebCore):
            Adding a stub for the newly added string.

2012-08-03  Oli Lan  <olilan@chromium.org>

        [chromium] Add a test to WebFrameTest for selectRange and visiblePositionForWindowPoint.
        https://bugs.webkit.org/show_bug.cgi?id=93108

        Reviewed by Adam Barth.

        Adds a new test WebFrameTest.SelectRange. This tests WebFrameImpl::selectRange, and also
        serves to test WebFrameImpl::visiblePositionForWindowPoint as it is used by selectRange.

        The test uses sample files that contain selected text on load. The test uses
        WebViewImpl::selectionBounds to retrieve the ends of the selection, then unselects
        and calls WebFrameImpl::selectRange to attempt to reselect the same text.

        Three cases are tested: the normal case, the case where the selected text is offscreen
        due to a scroll, and the case where the selected text is in an iframe. This allows the
        problem cases and fix in https://bugs.webkit.org/show_bug.cgi?id=79117 to be tested.

        * tests/WebFrameTest.cpp:
        * tests/data/select_range_basic.html: Added.
        * tests/data/select_range_iframe.html: Added.
        * tests/data/select_range_scroll.html: Added.

2012-08-03  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: eliminate visitBaseClass method from NMI. It introduces unnecessary complexity.
        https://bugs.webkit.org/show_bug.cgi?id=93129

        Reviewed by Yury Semikhatsky.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::InstrumentedWithOwnPtr::reportMemoryUsage):

2012-08-03  Adam Barth  <abarth@webkit.org>

        V8Proxy::retrieve(*) leads to really obfuscated code and should be removed
        https://bugs.webkit.org/show_bug.cgi?id=93072

        Reviewed by Eric Seidel.

        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::WebDevToolsAgentImpl::didCreateScriptContext):

2012-08-02  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: extend test coverage for nmi code and fix 2 bugs.
        https://bugs.webkit.org/show_bug.cgi?id=92994

        Reviewed by Yury Semikhatsky.

        1) owner object type propagation.
        If a class with object-type DOM has an instrumented member with object-type Other then it has to be recorded as DOM.
        Sample: We have SharedBuffer class and we don't know the object-type for it but we know that it is owned by an object with object-type CachedResourceImage.

        2) the first member of an instrumented non virtual class was skipped even if it was reported properly.
        it happened because the first member has the same address as it's owner

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::TEST):
        (WebCore):
        (InstrumentedOther):
        (WebCore::InstrumentedOther::InstrumentedOther):
        (WebCore::InstrumentedOther::reportMemoryUsage):
        (InstrumentedDOM):
        (WebCore::InstrumentedDOM::InstrumentedDOM):
        (WebCore::InstrumentedDOM::reportMemoryUsage):
        (NonVirtualInstrumented):
        (WebCore::NonVirtualInstrumented::reportMemoryUsage):

2012-08-02  Alec Flett  <alecflett@chromium.org>

        IndexedDB: remove leftover chromium stubs from putIndexWithKeys
        https://bugs.webkit.org/show_bug.cgi?id=93032

        Reviewed by Darin Fisher.

        Remove old chromium APIs that are no longer called by chrome.

        * public/WebIDBCursor.h:
        * public/WebIDBObjectStore.h:
        * public/WebIDBTransaction.h:

2012-08-02  Antoine Labour  <piman@chromium.org>

        [chromium] add lost context test case for HW video decoder
        https://bugs.webkit.org/show_bug.cgi?id=93057

        Reviewed by Adrienne Walker.

        We check that we don't use resources after a lost context (assuming
        proper WebVideoFrameProvider behavior).

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-02  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r124540.
        http://trac.webkit.org/changeset/124540
        https://bugs.webkit.org/show_bug.cgi?id=93055

        Broke compile on Chromium Win bot (Requested by dimich on
        #webkit).

        * tests/IDBAbortOnCorruptTest.cpp:
        (WebCore::FailingBackingStore::createIDBDatabaseMetaData):
        * tests/IDBFakeBackingStore.h:

2012-08-02  Alexandre Elias  <aelias@google.com>

        [chromium] deviceViewportSize cleanup
        https://bugs.webkit.org/show_bug.cgi?id=92794

        Reviewed by Adrienne Walker.

        In the future, CSS layout size will become increasingly disassociated
        from physical device size, and it will become impossible to infer one
        from the other inside the compositor.  Therefore, this patch allows
        deviceViewportSize to be explicitly passed in by the outside client.

        I also renamed the existing viewportSize field to "layoutViewportSize"
        for clarity, and converted its uses to deviceViewportSize since
        that is more appropriate.

        I had to add some default-value scaffolding to WebLayerTreeView in
        order to avoid breaking ui/compositor.  We can delete it once that's
        updated.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setViewportSize):
        (WebKit::WebLayerTreeView::layoutViewportSize):
        (WebKit):
        (WebKit::WebLayerTreeView::deviceViewportSize):
        (WebKit::WebLayerTreeView::setDeviceScaleFactor):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::paint):
        (WebKit::WebViewImpl::updateLayerTreeViewport):

2012-08-02  Adam Barth  <abarth@webkit.org>

        V8Proxy::currentContext() doesn't do anything and should be removed
        https://bugs.webkit.org/show_bug.cgi?id=93041

        Reviewed by Eric Seidel.

        * src/WebBindings.cpp:
        (WebKit::makeIntArrayImpl):
        (WebKit::makeStringArrayImpl):

2012-08-02  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Core upgradeneeded logic
        https://bugs.webkit.org/show_bug.cgi?id=92558

        Reviewed by Ojan Vafai.

        Update overridden methods to match new signatures.

        * tests/IDBAbortOnCorruptTest.cpp:
        (WebCore::FailingBackingStore::createIDBDatabaseMetaData):
        * tests/IDBFakeBackingStore.h:

2012-08-02  Vincent Scheib  <scheib@chromium.org>

        Remove old Pointer Lock API.
        https://bugs.webkit.org/show_bug.cgi?id=88892

        Reviewed by Adam Barth.

        * src/WebViewImpl.cpp:
            Removed #include to old API header.

2012-08-02  Tien-Ren Chen  <trchen@chromium.org>

        [chromium] Add CCScrollbarAnimationController class for compositor scrollbar animation
        https://bugs.webkit.org/show_bug.cgi?id=91688

        Reviewed by Adrienne Walker.

        New unit test ScrollbarLayerChromiumTest.scrollOffsetSynchronization to verify
        scroll offset is updated during tree synchronization and threaded scrolling.
        Another new unit test CCScrollbarAnimationControllerLinearFadeTest to verify
        opacity animates as intended.

        * tests/ScrollbarLayerChromiumTest.cpp:

2012-08-02  Adrienne Walker  <enne@google.com>

        [chromium] Make CCScrollbarLayerImpl handle lost contexts properly
        https://bugs.webkit.org/show_bug.cgi?id=93021

        Reviewed by James Robinson.

        Add CCScrollbarLayerImpl to the dontUseOldResourceAfterLostContext
        test. Additionally, modify this test so that stale resource ids
        properly point at invalid texture ids so that the test actually tests
        what it is supposed to be testing.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-02  Adam Barth  <abarth@webkit.org>

        The generic bindings shouldn't use templates
        https://bugs.webkit.org/show_bug.cgi?id=93016

        Reviewed by Eric Seidel.

        Update #include.

        * src/WebBindings.cpp:

2012-08-02  Peter Beverloo  <peter@chromium.org>

        [Chromium] Add a stub for WebView::getTouchHighlightQuads()
        https://bugs.webkit.org/show_bug.cgi?id=92997

        Reviewed by Adam Barth.

        Chrome on Android will be using this method for the link preview
        implementation, discussion about which is available in Bug 79150. Since
        that system is fairly big, will require refactoring, and the unavailable
        APIs are blocking API compatibility, add a stub for now.

        Together with the WebView API, also add the "WebTouchCandidatesInfo"
        structure which is being used by it.

        * public/WebView.h:
        (WebKit):
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit):
        (WebKit::WebViewImpl::getTouchHighlightQuads):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-02  Hans Wennborg  <hans@chromium.org>

        Speech JavaScript API: Fire speech start event at the same time as sound start event
        https://bugs.webkit.org/show_bug.cgi?id=92971

        Reviewed by Adam Barth.

        Chromium's speech recognizer doesn't differentiate between "sound
        started" and "speech started". Just fire those events at the same
        time, and don't provide functions for them in
        WebSpeechRecognizerClient.

        * public/WebSpeechRecognizerClient.h:
        * src/SpeechRecognitionClientProxy.cpp:
        (WebKit::SpeechRecognitionClientProxy::didStartSound):
        (WebKit::SpeechRecognitionClientProxy::didEndSound):
        * src/SpeechRecognitionClientProxy.h:
        (SpeechRecognitionClientProxy):

2012-08-02  Adam Barth  <abarth@webkit.org>

        [Chromium] WebViewImpl::showTouchHighlightQuads isn't needed for Android
        https://bugs.webkit.org/show_bug.cgi?id=92921

        Reviewed by Nate Chapin.

        We originally added a stub implementation of this function to make
        merging detectContentOnTouch easier, but showTouchHighlightQuads is
        being removed from the chromium-android branch in favor of the code in
        https://bugs.webkit.org/show_bug.cgi?id=84487. This patch removes the
        stub.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::detectContentIntentOnTouch):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-08-02  Peter Beverloo  <peter@chromium.org>

        [Chromium] Toggle the type of ant compile for webkit_unit_tests and TestWebKitAPI
        https://bugs.webkit.org/show_bug.cgi?id=92858

        Reviewed by Adam Barth.

        Now that the sdk_build variable is available, we can remove these two differences
        as well. This goes together with Adam's bug 90920.

        After this patch, the whole Tools/ directory will be unforked :-).

        * WebKitUnitTests.gyp:

2012-08-02  Alexei Filippov  <alexeif@chromium.org>

        Web Inspector: count RenderStyle objects in the native memory profiler
        https://bugs.webkit.org/show_bug.cgi?id=91759

        Reviewed by Yury Semikhatsky.

        Add a test for DataRef<T> wrapped member instrumentation.

        * tests/MemoryInstrumentationTest.cpp:
        (WebCore::InstrumentedRefPtr::create):
        (WebCore::TEST):
        (WebCore):

2012-08-02  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-08-01  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: test native memory instrumentation code with help of unittests
        https://bugs.webkit.org/show_bug.cgi?id=92743

        Reviewed by Yury Semikhatsky.

        Test a part of existing Native Memory Instrumentation code with help of unit tests.
        6 tests were added and two bugs were fixed.
        a drive-by improvement: the method MemoryInstrumentation::addInstrumentedObject
        was marked as private and addRootObject was introduced instead of it.
        The new function also calls processDeferedPointers.

        * WebKit.gypi:
        * tests/MemoryInstrumentationTest.cpp: Added.
        (WebCore):
        (NotInstrumented):
        (Instrumented):
        (WebCore::Instrumented::Instrumented):
        (WebCore::Instrumented::~Instrumented):
        (WebCore::Instrumented::reportMemoryUsage):
        (WebCore::TEST):
        (InstrumentedWithOwnPtr):
        (WebCore::InstrumentedWithOwnPtr::InstrumentedWithOwnPtr):
        (WebCore::InstrumentedWithOwnPtr::reportMemoryUsage):

2012-08-01  Xingnan Wang  <xingnan.wang@intel.com>

        IndexedDB: ObjectStoreMetaDataKey::m_metaDataType should use byte type
        https://bugs.webkit.org/show_bug.cgi?id=92725

        Reviewed by Kentaro Hara.

        Add two new tests in IDBLevelDBCodingTest.cpp. One for an added function decodeByte() and 
        another for verifying that encodeByte() and encodeVarInt() are indentical when the encoded 
        values are <= 127.

        * tests/IDBLevelDBCodingTest.cpp:
        (IDBLevelDBCoding::TEST):
        (IDBLevelDBCoding):

2012-08-01  James Robinson  <jamesr@chromium.org>

        [chromium] Use new-style tracing macros with explicit category
        https://bugs.webkit.org/show_bug.cgi?id=92928

        Reviewed by Adam Barth.

        Set the category explicitly in traces.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::updateAnimations):
        (WebKit::WebViewImpl::layout):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):

2012-08-01  James Robinson  <jamesr@chromium.org>

        [chromium] Move compositor HUD font atlas initialization code out of compositor core
        https://bugs.webkit.org/show_bug.cgi?id=92924

        Reviewed by Adrienne Walker.

        This initializes the compositor's font atlas when initialization the compositor if the "Show FPS counter" or
        "Show layer tree" settings are true.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setFontAtlas):
        (WebKit):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):

2012-08-01  Jian Li  <jianli@chromium.org>

        [chromium] Make WebKit API support draggable region change update
        https://bugs.webkit.org/show_bug.cgi?id=92813

        Reviewed by Adam Barth.

        Introduce WebDraggableRegion and delegate the draggable region update
        call to the new method draggableRegionsChanged in WebViewClient.

        * public/WebDocument.h:
        (WebDocument):
        * public/WebDraggableRegion.h: Added.
        (WebKit):
        (WebDraggableRegion):
        * public/WebViewClient.h:
        (WebViewClient):
        (WebKit::WebViewClient::draggableRegionsChanged):
        * src/ChromeClientImpl.cpp:
        (WebKit):
        (WebKit::ChromeClientImpl::dashboardRegionsChanged):
        * src/ChromeClientImpl.h:
        (ChromeClientImpl):
        * src/WebDocument.cpp:
        (WebKit::WebDocument::draggableRegions):
        (WebKit):

2012-08-01  Antoine Labour  <piman@chromium.org>

        [chromium] factor out the optimization pass in CCRenderSurfaceFilters::apply
        https://bugs.webkit.org/show_bug.cgi?id=92453

        Reviewed by James Robinson.

        This separates the "optimization" pass in CCRenderSurfaceFilters::apply
        to resolve a succession of color matrix filters into a single operation.
        This allows testing of that code.
        This introduces a new generic color matrix WebFilterOperation, which can
        also be used on its own.

        * WebKit.gypi:
        * tests/CCRenderSurfaceFiltersTest.cpp: Added.
        (WebKit):
        (WebKit::isCombined):
        (WebKit::TEST):

2012-08-01  Daniel Murphy  <dmurph@chromium.org>

        Fix for drawing invalid layers in WebViewBenchmarkSupportImpl
        https://bugs.webkit.org/show_bug.cgi?id=92920

        Reviewed by Adrienne Walker.

        The GraphicsLayers without content needed to be skipped.

        * src/WebViewBenchmarkSupportImpl.cpp:
        (WebKit::WebViewBenchmarkSupportImpl::acceleratedPaintUnclipped):

2012-08-01  Jian Li  <jianli@chromium.org>

        Add new CSS property "-webkit-widget-region" to expose dashboard region support for other port
        https://bugs.webkit.org/show_bug.cgi?id=90298

        Reviewed by Adam Barth.

        * features.gypi: Add ENABLE_WIDGET_REGION define.

2012-08-01  Antoine Labour  <piman@chromium.org>

        [chromium] Fix lost context handling on hud layer
        https://bugs.webkit.org/show_bug.cgi?id=92915

        Reviewed by Adrienne Walker.

        On lost context we need to release CCScopedTextures, otherwise later on
        we will try to re-allocate it using a stale CCResourceProvider.

        Test CCLayerTreeHostImplTest.dontUseOldResourcesAfterLostContext
        extended.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-08-01  Nico Weber  <thakis@chromium.org>

        [chromium/mac] Delete WebImageCG.cpp
        https://bugs.webkit.org/show_bug.cgi?id=92910

        Reviewed by James Robinson.

        It's been unused since the switch to skia.
        Also remove now-unneeded *CG.cpp exclusion rule.

        * WebKit.gyp:
        * src/WebImageCG.cpp: Removed.

2012-08-01  Joshua Bell  <jsbell@chromium.org>

        [Chromium] IndexedDB: API stubs to simplify WebIDBCursor API
        https://bugs.webkit.org/show_bug.cgi?id=92414

        Reviewed by Adam Barth.

        Prep work to unblock Chromium changes so that http://webkit.org/b/92278 can land.
        Adds no-op methods which will later be implemented; during the landing sequence,
        Chromium will call both the new methods and the old ones. The end goal is that
        the success callbacks for cursors will include the new key/primaryKey/value rather
        than requiring the callee to call back into the cursor backend to fetch them.

        * public/WebIDBCallbacks.h:
        (WebIDBCallbacks):
        (WebKit::WebIDBCallbacks::onSuccess):

2012-08-01  Peter Beverloo  <peter@chromium.org>

        [Text Autosizing] Provide an API for influencing the font scale factor
        https://bugs.webkit.org/show_bug.cgi?id=92882

        Reviewed by Adam Barth.

        Add an API to change Text Autosizing's font scale factor.

        The font scale factor applied to Text Autosizing influences the sizing
        of text, and will influence the scaling of boosted blocks once the
        implementation progresses. For Android, it will be set to the font size
        chosen in the user's system-wide preferences.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setTextAutosizingFontScaleFactor):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-08-01  Dirk Pranke  <dpranke@chromium.org>

        Roll chromium DEPS to 149416.

        Unreviewed.

        * DEPS:

2012-08-01  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r124334.
        http://trac.webkit.org/changeset/124334
        https://bugs.webkit.org/show_bug.cgi?id=92879

        Broke MemoryInstrumentationTest.sizeOf from webkit_unit_tests
        on Chromium canaries (Requested by apavlov1 on #webkit).

        * WebKit.gypi:
        * tests/MemoryInstrumentationTest.cpp: Removed.

2012-08-01  Ilya Tikhonovsky  <loislo@chromium.org>

        Web Inspector: test native memory instrumentation code with help of unittests
        https://bugs.webkit.org/show_bug.cgi?id=92743

        Reviewed by Yury Semikhatsky.

        Test a part of existing Native Memory Instrumentation code with help of unit tests.
        6 tests were added and two bugs were fixed.

        * WebKit.gypi:
        * tests/MemoryInstrumentationTest.cpp: Added.
        (WebCore):
        (MemoryInstrumentationImpl):
        (WebCore::MemoryInstrumentationImpl::MemoryInstrumentationImpl):
        (WebCore::MemoryInstrumentationImpl::reportedSize):
        (WebCore::MemoryInstrumentationImpl::countObjectSize):
        (WebCore::MemoryInstrumentationImpl::processDeferredInstrumentedPointers):
        (NotInstrumented):
        (Instrumented):
        (WebCore::Instrumented::Instrumented):
        (WebCore::Instrumented::~Instrumented):
        (WebCore::Instrumented::reportMemoryUsage):
        (WebCore::TEST):
        (InstrumentedWithOwnPtr):
        (WebCore::InstrumentedWithOwnPtr::InstrumentedWithOwnPtr):
        (WebCore::InstrumentedWithOwnPtr::reportMemoryUsage):

2012-08-01  Alexei Filippov  <alexeif@chromium.org>

        Web Inspector: count DOM storage cache memory for native snapshot
        https://bugs.webkit.org/show_bug.cgi?id=91617

        Reviewed by Yury Semikhatsky.

        Add memory size used for DOM storage cache reporting interface.

        * src/StorageAreaProxy.cpp:
        (WebCore::StorageAreaProxy::memoryBytesUsedByCache):
        (WebCore):
        * src/StorageAreaProxy.h:
        (StorageAreaProxy):

2012-07-31  Yoshifumi Inoue  <yosin@chromium.org>

        [Chromium] Enable ENABLE_INPUT_TYPE_TIME_MULTIPLE_FIELDS
        https://bugs.webkit.org/show_bug.cgi?id=92822

        Reviewed by Kent Tamura.

        This patch enables ENABLE_INPUT_TYPE_TIME_MULTIPLE_FIELDS for Chromium
        port except for Android.

        * features.gypi: Add ENABLE_INPUT_TYPE_TIME_MULTIPLE_FIELDS=1 to "feature_defines"
        block of OS != "android".

2012-07-31  Yusuf Ozuysal  <yusufo@google.com>

        [chromium]Upstream WebViewImpl:StartPageScaleAnimation changes for Chrome for Android
        https://bugs.webkit.org/show_bug.cgi?id=92698

        Reviewed by Adam Barth.

        Enforce the maximum and minimum scroll positions after the scale has changed.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::startPageScaleAnimation):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-31  Terry Anderson  <tdanderson@chromium.org>

        [chromium] Use the event bounding box when constructing a PlatformEvent::GestureTap
        https://bugs.webkit.org/show_bug.cgi?id=92151

        Reviewed by Darin Fisher.

        Now that gesture events store a bounding box, use |boundingBox| instead of
        |deltaX| and |deltaY| when specifying |m_area|.

        * public/WebInputEvent.h:
        (WebGestureEvent):
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):

2012-07-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-31  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Hit test points are being clipped by layers that should not clip
        https://bugs.webkit.org/show_bug.cgi?id=92786

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostCommonTest.cpp: adds a test where the
          hit-testable layer does not overlap its parent. The parent does
          not clip, so the layer should still be hittable.

2012-07-31  Chris Rogers  <crogers@google.com>

        Allow AudioDestination to support local/live audio input
        https://bugs.webkit.org/show_bug.cgi?id=90318

        Reviewed by Kenneth Russell.

        * src/AudioDestinationChromium.cpp:
        (WebCore::AudioDestination::create):
        (WebCore::AudioDestinationChromium::AudioDestinationChromium):
        (WebCore::AudioDestinationChromium::provideInput):
        (WebCore):
        * src/AudioDestinationChromium.h:
        (AudioDestinationChromium):

2012-07-31  Adam Barth  <abarth@webkit.org>

        [Chromium-Android] We should hueristically detect content intents on touch
        https://bugs.webkit.org/show_bug.cgi?id=92346

        Reviewed by Nate Chapin.

        On Android, when the user touches a block of text, we run a bunch of
        OS-provided hueristics to detect content intents, such as telephone
        numbers and mailing addresses.

        This patch introduces the WebViewClient functions and the
        detectContentIntentOnTouch function, but does not wire the code into
        the event system. There are some decisions to make about how to wire it
        into the event system, we'll tackle in the next patch.

        * public/WebViewClient.h:
        (WebKit::WebViewClient::detectContentIntentAround):
        (WebViewClient):
        (WebKit::WebViewClient::scheduleContentIntent):
        (WebKit::WebViewClient::cancelScheduledContentIntents):
        * src/WebViewImpl.cpp:
        (WebKit):
        (WebKit::tapHighlightColorForNode):
        (WebKit::WebViewImpl::showTouchHighlightQuads):
        (WebKit::WebViewImpl::detectContentIntentOnTouch):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-31  Ian Vollick  <vollick@chromium.org>

        [chromium] Use WebAnimation and related classes in GraphicsLayerChromium and AnimTranslationUtil
        https://bugs.webkit.org/show_bug.cgi?id=90468

        Reviewed by James Robinson.

        * src/WebAnimation.cpp:
        (WebKit::WebAnimation::targetProperty):
        (WebKit):
        (WebKit::WebAnimation::initialize):
        * src/WebLayer.cpp:
        (WebKit::WebLayer::setAnimationDelegate):
        (WebKit):
        (WebKit::WebLayer::addAnimation):
        (WebKit::WebLayer::removeAnimation):
        (WebKit::WebLayer::pauseAnimation):
        (WebKit::WebLayer::suspendAnimations):
        (WebKit::WebLayer::resumeAnimations):
        (WebKit::WebLayer::transferAnimationsTo):
        * tests/CCThreadedTest.cpp:
        * tests/CCThreadedTest.h:
        (TestHooks):
        * tests/WebAnimationTest.cpp:
        (WebKit::TEST):

2012-07-30  Adam Barth  <abarth@webkit.org>

        Typo: doubleTa*b*ZoomAnimationDurationInSeconds in WebViewImpl.cpp
        https://bugs.webkit.org/show_bug.cgi?id=92135

        Reviewed by Kentaro Hara.

        This patch fixes a typo.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::animateZoomAroundPoint):

2012-07-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r124179.
        http://trac.webkit.org/changeset/124179
        https://bugs.webkit.org/show_bug.cgi?id=92730

        Breaks Chromium Linux 32 bots with "error: integer constant is
        too large for 'long' type" in IDBLevelDBCodingTest.cpp
        (Requested by apavlov on #webkit).

        * tests/IDBLevelDBCodingTest.cpp:
        (IDBLevelDBCoding::TEST):

2012-07-30  Keishi Hattori  <keishi@webkit.org>

        Implement datalist UI for input type color for Chromium
        https://bugs.webkit.org/show_bug.cgi?id=92075

        Reviewed by Kent Tamura.

        Integrated ColorChooserProxy and WebColorChooserClientImpl into ColorChooserUIController.
        ColorChooserUIController can control whether to open the color suggestion picker
        popup or the color chooser depending on the responses from ColorChooserClient.

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::createColorChooser): Returns ColorChooserUIController which is a ColorChooser.
        (WebKit::ChromeClientImpl::createWebColorChooser): Returns WebColorChooser that was created by Chromium.
        * src/ChromeClientImpl.h:
        (WebKit):
        (ChromeClientImpl):
        * src/ColorChooserProxy.cpp: Removed.
        * src/ColorChooserProxy.h: Removed.
        * src/ColorChooserUIController.cpp: Added.
        (WebKit):
        (WebKit::ColorChooserUIController::ColorChooserUIController): Controls the UI for color chooser. Opens the color suggestion picker popup or color chooser depending on the ColorChooserClient.
        (WebKit::ColorChooserUIController::~ColorChooserUIController):
        (WebKit::ColorChooserUIController::setSelectedColor):
        (WebKit::ColorChooserUIController::endChooser): This is called by WebCore so we close both the popup and the color chooser.
        (WebKit::ColorChooserUIController::didChooseColor):
        (WebKit::ColorChooserUIController::didEndChooser):
        (WebKit::ColorChooserUIController::contentSize): The popup will be resized later from JS so we return an arbitrary size.
        (WebKit::ColorChooserUIController::writeDocument):
        (WebKit::ColorChooserUIController::setValueAndClosePopup): Performs action based on the numValue.
        (WebKit::ColorChooserUIController::didClosePopup):
        (WebKit::ColorChooserUIController::openPopup): Opens color chooser suggestion popup.
        (WebKit::ColorChooserUIController::closePopup):
        (WebKit::ColorChooserUIController::openColorChooser): Opens color chooser.
        * src/ColorChooserUIController.h: Renamed from Source/WebKit/chromium/src/WebColorChooserClientImpl.h.
        (WebCore):
        (WebKit):
        (ColorChooserUIController):
        * src/WebColorChooserClientImpl.cpp: Removed.

2012-07-30  Ryosuke Niwa  <rniwa@webkit.org>

        Roll out the DEPS roll (r124164) for now since it broke Chromium Mac builds.

        * DEPS:

2012-07-30  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-30  Adrienne Walker  <enne@google.com>

        [chromium] Wrap ScrollbarLayerChromium in WebScrollbarLayer
        https://bugs.webkit.org/show_bug.cgi?id=91032

        Reviewed by James Robinson.

        Add implementation of WebScrollbarLayer to the client API.

        * WebKit.gyp:
        * src/WebScrollbarLayer.cpp: Added.
        (WebKit):
        (WebKit::WebScrollbarLayer::setScrollLayer):
        (WebKit::WebScrollbarLayer::create):
        (WebKit::WebScrollbarLayer::WebScrollbarLayer):
        (WebKit::WebScrollbarLayer::operator=):
        (WebKit::WebScrollbarLayer::operator PassRefPtr<ScrollbarLayerChromium>):

2012-07-30  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        Propagate gesture events to plugins.
        https://bugs.webkit.org/show_bug.cgi?id=92281

        Reviewed by Adam Barth.

        Propagate gesture events to plugins.

        * src/WebInputEventConversion.cpp:
        (WebKit):
        (WebKit::WebGestureEventBuilder::WebGestureEventBuilder):
        * src/WebInputEventConversion.h:
        (WebCore):
        (WebKit):
        (WebGestureEventBuilder):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::handleEvent):
        * src/WebPluginContainerImpl.h:
        (WebCore):
        (WebPluginContainerImpl):

2012-07-30  John Bates  <jbates@google.com>

        Plumb vsync-enabled flag up to compositor thread and support disable-vsync
        https://bugs.webkit.org/show_bug.cgi?id=92323

        Reviewed by James Robinson.

        * public/WebSettings.h:
        * tests/CCFrameRateControllerTest.cpp:
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        (WebKit::WebSettingsImpl::setRenderVSyncEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        (WebKit::WebSettingsImpl::renderVSyncEnabled):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):

2012-07-30  Adrienne Walker  <enne@google.com>

        [chromium] Remove dependency on ScrollbarTheme from the compositor
        https://bugs.webkit.org/show_bug.cgi?id=90528

        Reviewed by James Robinson.

        Add implementations for WebScrollbarThemeGeometry and
        WebScrollbarThemePainter. Fill out additional API calls for
        WebPluginScrollbarImpl since it derives from WebScrollbar.

        Add WebScrollbarImpl to the client API to wrap and own an existing
        WebCore Scrollbar object and provide the WebScrollbar interface.

        By keeping WebScrollbar separate from WebScrollbarThemeGeometry, the
        compositor thread can create its own thread-safe data bag version of a
        WebScrollbar (CCScrollbarLayerImpl::CCScrollbar), but this requires
        WebScrollbarThemeClientImpl.

        WebScrollbarThemeClientImpl does the reverse of WebScrollbarImpl; it
        wraps a WebScrollbar and provides the ScrollbarThemeClient interface.
        This is so that a WebScrollbar can be passed to the geometry and
        painter functions. Then, internally the WebScrollbarThemeClientImpl
        can be used to adapt the WebScrollbar to the ScrollbarThemeClient
        interface so the geometry and painter functions can call direct
        functions on ScrollbarThemeComposite.

        * WebKit.gyp:
        * src/AssertMatchingEnums.cpp:
        * src/ExternalPopupMenu.h:
        (WebKit):
        * src/WebPluginScrollbarImpl.cpp:
        (WebKit::WebPluginScrollbarImpl::WebPluginScrollbarImpl):
        (WebKit::WebPluginScrollbarImpl::location):
        (WebKit):
        (WebKit::WebPluginScrollbarImpl::size):
        (WebKit::WebPluginScrollbarImpl::enabled):
        (WebKit::WebPluginScrollbarImpl::maximum):
        (WebKit::WebPluginScrollbarImpl::totalSize):
        (WebKit::WebPluginScrollbarImpl::isScrollViewScrollbar):
        (WebKit::WebPluginScrollbarImpl::isScrollableAreaActive):
        (WebKit::WebPluginScrollbarImpl::getTickmarks):
        (WebKit::WebPluginScrollbarImpl::controlSize):
        (WebKit::WebPluginScrollbarImpl::pressedPart):
        (WebKit::WebPluginScrollbarImpl::hoveredPart):
        (WebKit::WebPluginScrollbarImpl::scrollbarOverlayStyle):
        (WebKit::WebPluginScrollbarImpl::orientation):
        (WebKit::WebPluginScrollbarImpl::isCustomScrollbar):
        (WebKit::WebPluginScrollbarImpl::onMouseUp):
        (WebKit::WebPluginScrollbarImpl::onMouseMove):
        (WebKit::WebPluginScrollbarImpl::onMouseLeave):
        * src/WebPluginScrollbarImpl.h:
        (WebPluginScrollbarImpl):
        * src/WebScrollbarImpl.cpp: Added.
        (WebKit):
        (WebKit::WebScrollbar::create):
        (WebKit::WebScrollbarImpl::WebScrollbarImpl):
        (WebKit::WebScrollbarImpl::isOverlay):
        (WebKit::WebScrollbarImpl::value):
        (WebKit::WebScrollbarImpl::location):
        (WebKit::WebScrollbarImpl::size):
        (WebKit::WebScrollbarImpl::enabled):
        (WebKit::WebScrollbarImpl::maximum):
        (WebKit::WebScrollbarImpl::totalSize):
        (WebKit::WebScrollbarImpl::isScrollViewScrollbar):
        (WebKit::WebScrollbarImpl::isScrollableAreaActive):
        (WebKit::WebScrollbarImpl::getTickmarks):
        (WebKit::WebScrollbarImpl::controlSize):
        (WebKit::WebScrollbarImpl::pressedPart):
        (WebKit::WebScrollbarImpl::hoveredPart):
        (WebKit::WebScrollbarImpl::scrollbarOverlayStyle):
        (WebKit::WebScrollbarImpl::orientation):
        (WebKit::WebScrollbarImpl::isCustomScrollbar):
        * src/WebScrollbarImpl.h: Copied from Source/Platform/chromium/public/WebScrollbar.h.
        (WebCore):
        (WebKit):
        (WebScrollbarImpl):
        * src/WebScrollbarThemeClientImpl.cpp: Added.
        (WebKit):
        (WebKit::WebScrollbarThemeClientImpl::WebScrollbarThemeClientImpl):
        (WebKit::WebScrollbarThemeClientImpl::x):
        (WebKit::WebScrollbarThemeClientImpl::y):
        (WebKit::WebScrollbarThemeClientImpl::width):
        (WebKit::WebScrollbarThemeClientImpl::height):
        (WebKit::WebScrollbarThemeClientImpl::size):
        (WebKit::WebScrollbarThemeClientImpl::location):
        (WebKit::WebScrollbarThemeClientImpl::parent):
        (WebKit::WebScrollbarThemeClientImpl::root):
        (WebKit::WebScrollbarThemeClientImpl::setFrameRect):
        (WebKit::WebScrollbarThemeClientImpl::frameRect):
        (WebKit::WebScrollbarThemeClientImpl::invalidate):
        (WebKit::WebScrollbarThemeClientImpl::invalidateRect):
        (WebKit::WebScrollbarThemeClientImpl::scrollbarOverlayStyle):
        (WebKit::WebScrollbarThemeClientImpl::getTickmarks):
        (WebKit::WebScrollbarThemeClientImpl::isScrollableAreaActive):
        (WebKit::WebScrollbarThemeClientImpl::isScrollViewScrollbar):
        (WebKit::WebScrollbarThemeClientImpl::convertFromContainingWindow):
        (WebKit::WebScrollbarThemeClientImpl::isCustomScrollbar):
        (WebKit::WebScrollbarThemeClientImpl::orientation):
        (WebKit::WebScrollbarThemeClientImpl::value):
        (WebKit::WebScrollbarThemeClientImpl::currentPos):
        (WebKit::WebScrollbarThemeClientImpl::visibleSize):
        (WebKit::WebScrollbarThemeClientImpl::totalSize):
        (WebKit::WebScrollbarThemeClientImpl::maximum):
        (WebKit::WebScrollbarThemeClientImpl::controlSize):
        (WebKit::WebScrollbarThemeClientImpl::lineStep):
        (WebKit::WebScrollbarThemeClientImpl::pageStep):
        (WebKit::WebScrollbarThemeClientImpl::pressedPart):
        (WebKit::WebScrollbarThemeClientImpl::hoveredPart):
        (WebKit::WebScrollbarThemeClientImpl::styleChanged):
        (WebKit::WebScrollbarThemeClientImpl::enabled):
        (WebKit::WebScrollbarThemeClientImpl::setEnabled):
        (WebKit::WebScrollbarThemeClientImpl::isOverlayScrollbar):
        * src/WebScrollbarThemeClientImpl.h: Added.
        (WebCore):
        (WebKit):
        (WebScrollbarThemeClientImpl):
        * src/WebScrollbarThemeGeometry.cpp: Added.
        (WebKit):
        (WebKit::WebScrollbarThemeGeometry::assign):
        (WebKit::WebScrollbarThemeGeometry::thumbPosition):
        (WebKit::WebScrollbarThemeGeometry::thumbLength):
        (WebKit::WebScrollbarThemeGeometry::trackPosition):
        (WebKit::WebScrollbarThemeGeometry::trackLength):
        (WebKit::WebScrollbarThemeGeometry::hasButtons):
        (WebKit::WebScrollbarThemeGeometry::hasThumb):
        (WebKit::WebScrollbarThemeGeometry::trackRect):
        (WebKit::WebScrollbarThemeGeometry::thumbRect):
        (WebKit::WebScrollbarThemeGeometry::minimumThumbLength):
        (WebKit::WebScrollbarThemeGeometry::scrollbarThickness):
        (WebKit::WebScrollbarThemeGeometry::backButtonStartRect):
        (WebKit::WebScrollbarThemeGeometry::backButtonEndRect):
        (WebKit::WebScrollbarThemeGeometry::forwardButtonStartRect):
        (WebKit::WebScrollbarThemeGeometry::forwardButtonEndRect):
        (WebKit::WebScrollbarThemeGeometry::constrainTrackRectToTrackPieces):
        (WebKit::WebScrollbarThemeGeometry::splitTrack):
        (WebKit::WebScrollbarThemeGeometry::WebScrollbarThemeGeometry):
        * src/WebScrollbarThemePainter.cpp: Added.
        (WebKit):
        (WebKit::WebScrollbarThemePainter::assign):
        (WebKit::WebScrollbarThemePainter::paintScrollbarBackground):
        (WebKit::WebScrollbarThemePainter::paintTrackBackground):
        (WebKit::WebScrollbarThemePainter::paintBackTrackPart):
        (WebKit::WebScrollbarThemePainter::paintForwardTrackPart):
        (WebKit::WebScrollbarThemePainter::paintBackButtonStart):
        (WebKit::WebScrollbarThemePainter::paintBackButtonEnd):
        (WebKit::WebScrollbarThemePainter::paintForwardButtonStart):
        (WebKit::WebScrollbarThemePainter::paintForwardButtonEnd):
        (WebKit::WebScrollbarThemePainter::paintTickmarks):
        (WebKit::WebScrollbarThemePainter::paintThumb):
        (WebKit::WebScrollbarThemePainter::WebScrollbarThemePainter):
        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::MockScrollbar::convertFromContainingWindow):
        (WebCore::MockScrollbar::isOverlayScrollbar):
        (MockScrollbar):
        (WebCore::TEST):

2012-07-30  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r124025.
        http://trac.webkit.org/changeset/124025
        https://bugs.webkit.org/show_bug.cgi?id=92658

        Causes color-suggestion-picker-appearance layout test to time
        out on all Chromium platforms (Requested by tomhudson_ on
        #webkit).

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::createColorChooser):
        * src/ChromeClientImpl.h:
        (WebCore):
        (ChromeClientImpl):
        * src/ColorChooserProxy.cpp: Copied from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebKit):
        (WebKit::ColorChooserProxy::ColorChooserProxy):
        (WebKit::ColorChooserProxy::~ColorChooserProxy):
        (WebKit::ColorChooserProxy::setSelectedColor):
        (WebKit::ColorChooserProxy::endChooser):
        * src/ColorChooserProxy.h: Copied from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebKit):
        (ColorChooserProxy):
        * src/ColorChooserUIController.cpp: Removed.
        * src/WebColorChooserClientImpl.cpp: Copied from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebKit):
        (WebKit::WebColorChooserClientImpl::WebColorChooserClientImpl):
        (WebKit::WebColorChooserClientImpl::~WebColorChooserClientImpl):
        (WebKit::WebColorChooserClientImpl::didChooseColor):
        (WebKit::WebColorChooserClientImpl::didEndChooser):
        * src/WebColorChooserClientImpl.h: Renamed from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebCore):
        (WebKit):
        (WebColorChooserClientImpl):

2012-07-30  Keishi Hattori  <keishi@webkit.org>

        Implement datalist UI for input type color for Chromium
        https://bugs.webkit.org/show_bug.cgi?id=92075

        Reviewed by Kent Tamura.

        Integrated ColorChooserProxy and WebColorChooserClientImpl into ColorChooserUIController.
        ColorChooserUIController can control whether to open the color suggestion picker
        popup or the color chooser depending on the responses from ColorChooserClient.

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::createColorChooser): Returns ColorChooserUIController which is a ColorChooser.
        (WebKit::ChromeClientImpl::createWebColorChooser): Returns WebColorChooser that was created by Chromium.
        * src/ChromeClientImpl.h:
        (WebKit):
        (ChromeClientImpl):
        * src/ColorChooserProxy.cpp: Removed.
        * src/ColorChooserProxy.h: Removed.
        * src/ColorChooserUIController.cpp: Added.
        (WebKit):
        (WebKit::ColorChooserUIController::ColorChooserUIController): Controls the UI for color chooser. Opens the color suggestion picker popup or color chooser depending on the ColorChooserClient.
        (WebKit::ColorChooserUIController::~ColorChooserUIController):
        (WebKit::ColorChooserUIController::setSelectedColor):
        (WebKit::ColorChooserUIController::endChooser): This is called by WebCore so we close both the popup and the color chooser.
        (WebKit::ColorChooserUIController::didChooseColor):
        (WebKit::ColorChooserUIController::didEndChooser):
        (WebKit::ColorChooserUIController::contentSize): The popup will be resized later from JS so we return an arbitrary size.
        (WebKit::ColorChooserUIController::writeDocument):
        (WebKit::ColorChooserUIController::setValueAndClosePopup): Performs action based on the numValue.
        (WebKit::ColorChooserUIController::didClosePopup):
        (WebKit::ColorChooserUIController::openPopup): Opens color chooser suggestion popup.
        (WebKit::ColorChooserUIController::closePopup):
        (WebKit::ColorChooserUIController::openColorChooser): Opens color chooser.
        * src/ColorChooserUIController.h: Renamed from Source/WebKit/chromium/src/WebColorChooserClientImpl.h.
        (WebCore):
        (WebKit):
        (ColorChooserUIController):
        * src/WebColorChooserClientImpl.cpp: Removed.

2012-07-30  Kaustubh Atrawalkar  <kaustubh@motorola.com>

        [DRT] LTC:: pageNumberForElementById() could be moved to Internals
        https://bugs.webkit.org/show_bug.cgi?id=92091

        Reviewed by Hajime Morita.

        Move the pageNumberForElementById from LayoutTestCotroller to Internals and
        remove the old platform specific implementations as it exclusively tests WebCore functionality.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-07-30  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r124004.
        http://trac.webkit.org/changeset/124004
        https://bugs.webkit.org/show_bug.cgi?id=92622

        Broke Android build (Requested by keishi on #webkit).

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::createColorChooser):
        * src/ChromeClientImpl.h:
        (WebCore):
        (ChromeClientImpl):
        * src/ColorChooserProxy.cpp: Copied from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebKit):
        (WebKit::ColorChooserProxy::ColorChooserProxy):
        (WebKit::ColorChooserProxy::~ColorChooserProxy):
        (WebKit::ColorChooserProxy::setSelectedColor):
        (WebKit::ColorChooserProxy::endChooser):
        * src/ColorChooserProxy.h: Copied from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebKit):
        (ColorChooserProxy):
        * src/ColorChooserUIController.cpp: Removed.
        * src/WebColorChooserClientImpl.cpp: Copied from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebKit):
        (WebKit::WebColorChooserClientImpl::WebColorChooserClientImpl):
        (WebKit::WebColorChooserClientImpl::~WebColorChooserClientImpl):
        (WebKit::WebColorChooserClientImpl::didChooseColor):
        (WebKit::WebColorChooserClientImpl::didEndChooser):
        * src/WebColorChooserClientImpl.h: Renamed from Source/WebKit/chromium/src/ColorChooserUIController.h.
        (WebCore):
        (WebKit):
        (WebColorChooserClientImpl):

2012-07-30  Keishi Hattori  <keishi@webkit.org>

        Implement datalist UI for input type color for Chromium
        https://bugs.webkit.org/show_bug.cgi?id=92075

        Reviewed by Kent Tamura.

        Integrated ColorChooserProxy and WebColorChooserClientImpl into ColorChooserUIController.
        ColorChooserUIController can control whether to open the color suggestion picker
        popup or the color chooser depending on the responses from ColorChooserClient.

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::createColorChooser): Returns ColorChooserUIController which is a ColorChooser.
        (WebKit::ChromeClientImpl::createWebColorChooser): Returns WebColorChooser that was created by Chromium.
        * src/ChromeClientImpl.h:
        (WebKit):
        (ChromeClientImpl):
        * src/ColorChooserProxy.cpp: Removed.
        * src/ColorChooserProxy.h: Removed.
        * src/ColorChooserUIController.cpp: Added.
        (WebKit):
        (WebKit::ColorChooserUIController::ColorChooserUIController): Controls the UI for color chooser. Opens the color suggestion picker popup or color chooser depending on the ColorChooserClient.
        (WebKit::ColorChooserUIController::~ColorChooserUIController):
        (WebKit::ColorChooserUIController::setSelectedColor):
        (WebKit::ColorChooserUIController::endChooser): This is called by WebCore so we close both the popup and the color chooser.
        (WebKit::ColorChooserUIController::didChooseColor):
        (WebKit::ColorChooserUIController::didEndChooser):
        (WebKit::ColorChooserUIController::contentSize): The popup will be resized later from JS so we return an arbitrary size.
        (WebKit::ColorChooserUIController::writeDocument):
        (WebKit::ColorChooserUIController::setValueAndClosePopup): Performs action based on the numValue.
        (WebKit::ColorChooserUIController::didClosePopup):
        (WebKit::ColorChooserUIController::openPopup): Opens color chooser suggestion popup.
        (WebKit::ColorChooserUIController::closePopup):
        (WebKit::ColorChooserUIController::openColorChooser): Opens color chooser.
        * src/ColorChooserUIController.h: Renamed from Source/WebKit/chromium/src/WebColorChooserClientImpl.h.
        (WebCore):
        (WebKit):
        (ColorChooserUIController):
        * src/WebColorChooserClientImpl.cpp: Removed.

2012-07-29  Lu Guanqun  <guanqun.lu@intel.com>

        [chromium] pass acceleratePainting info to settings
        https://bugs.webkit.org/show_bug.cgi?id=92467

        Reviewed by Eric Seidel.

        The acceleratePainting info is not passed into settings correctly so
        that GPU composition would not use the code path of accelerated painting.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):

2012-07-29  Rik Cabanier  <cabanier@adobe.com>

        Add ENABLE_CSS_COMPOSITING flag
        https://bugs.webkit.org/show_bug.cgi?id=92553

        Reviewed by Dirk Schulze.

        Adds compiler flag CSS_COMPOSITING to build systems to enable CSS blending and compositing. See spec https://dvcs.w3.org/hg/FXTF/rawfile/tip/compositing/index.html

        * features.gypi:

2012-07-28  Peter Kasting  <pkasting@google.com>

        Sigh.  Just disable all the AutoResize tests after the first three.
        https://bugs.webkit.org/show_bug.cgi?id=92318 

        Unreviewed, making bots happier.

        * tests/WebViewTest.cpp:

2012-07-28  Peter Kasting  <pkasting@google.com>

        Try disabling different test in hopes of tracking down the real problem.
        https://bugs.webkit.org/show_bug.cgi?id=92318 

        Unreviewed, making bots happier.

        * tests/WebViewTest.cpp:

2012-07-27  Peter Kasting  <pkasting@google.com>

        Disable failing test.
        https://bugs.webkit.org/show_bug.cgi?id=92318 

        Unreviewed, making bots happier.

        * tests/WebViewTest.cpp:

2012-07-27  Scott Graham  <scottmg@chromium.org>

        Change navigator.webkitGamepads[] to navigator.webkitGetGamepads()
        https://bugs.webkit.org/show_bug.cgi?id=92533

        Reviewed by Adam Barth.

        Renames for updated access point.

        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableGamepad):
        (WebKit::WebRuntimeFeatures::isGamepadEnabled):

2012-07-27  Kevin Ellis  <kevers@chromium.org>

        [chromium] Calendar for input type=date should be larger on devices that support touch input.
        https://bugs.webkit.org/show_bug.cgi?id=92424

        Reviewed by Kent Tamura.

        Plumbs the deviceSupportsTouch setting through to the popup page so
        that the Calendar popup can be enlarged on screens that support touch
        input.

        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::initPage):

2012-07-27  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-27  Oli Lan  <olilan@chromium.org>

        [chromium] Fix issues in visiblePositionForWindowPoint (offscreen points / iframes).
        https://bugs.webkit.org/show_bug.cgi?id=79117

        Fix two issues in WebFrameImpl::visiblePositionForWindowPoint.

        1) If the point is off-screen, the visiblePosition is clipped to the screen.
           - The fix is to add HitTestRequest::IgnoreClipping.

        2) The result is incorrect if the point is within an iframe.
           - This is because we are calling convertFromContainingWindow twice: once in windowToContents,
             and then explicitly as well.
           - This patch removes the explicit call to convertFromContainingWindow. 

        Reviewed by Adam Barth.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::visiblePositionForWindowPoint):

2012-07-27  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-27  Alec Flett  <alecflett@chromium.org>

        IndexedDB: inject index keys on cursor/objectstore/index get success handlers
        https://bugs.webkit.org/show_bug.cgi?id=91123

        Reviewed by Tony Chang.

        Remove method no longer used.

        * tests/IDBFakeBackingStore.h:

2012-07-26  Yoshifumi Inoue  <yosin@chromium.org>

        [Forms] Introduce runtime feature flags for input type datetime, datetimelocal, month, time, week
        https://bugs.webkit.org/show_bug.cgi?id=92339

        Reviewed by Kent Tamura.

        To detect compilation errors and test failure earlier, I would like
        build and run tests for input type datetime, datetime-local, month,
        time and week with runtime feature flags to avoid behavior changes
        on chromium browser.

        This patch adds query and change functions for runtime features of
        input type datetime, datetime-local, month, time and week to WebRuntimeFeatures
        class for exposing DRT and chromium browser expermental flags.

        * features.gypi: Turn on ENABLE_INPUT_TYPE_DATETIME, ENABLE_INPUT_TYPE_DATETIMELOCAL,
        ENABLE_INPUT_TYPE_MONTH, ENABLE_INPUT_TYPE_TIME, and ENABLE_INPUT_TYPE_WEEK for all OS.
        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures):
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableInputTypeDateTime): Added.
        (WebKit::WebRuntimeFeatures::isInputTypeDateTimeEnabled): Added.
        (WebKit::WebRuntimeFeatures::enableInputTypeDateTimeLocal): Added.
        (WebKit::WebRuntimeFeatures::isInputTypeDateTimeLocalEnabled): Added.
        (WebKit::WebRuntimeFeatures::enableInputTypeMonth): Added.
        (WebKit::WebRuntimeFeatures::isInputTypeMonthEnabled): Added.
        (WebKit::WebRuntimeFeatures::enableInputTypeTime): Added.
        (WebKit::WebRuntimeFeatures::isInputTypeTimeEnabled): Added.
        (WebKit::WebRuntimeFeatures::enableInputTypeWeek): Added.
        (WebKit::WebRuntimeFeatures::isInputTypeWeekEnabled): Added.

2012-07-26  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r123799.
        http://trac.webkit.org/changeset/123799
        https://bugs.webkit.org/show_bug.cgi?id=92431

        broke the Apple Mac build (Requested by bweinstein on
        #webkit).

        * src/WebInputEventConversion.cpp:
        (WebKit):
        * src/WebInputEventConversion.h:
        (WebKit):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::handleEvent):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):

2012-07-26  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        Propagate gesture events to plugins.
        https://bugs.webkit.org/show_bug.cgi?id=92281

        Reviewed by Adam Barth.

        Propagate gesture events to plugins.

        * src/WebInputEventConversion.cpp:
        (WebKit):
        (WebKit::WebGestureEventBuilder::WebGestureEventBuilder):
        * src/WebInputEventConversion.h:
        (WebCore):
        (WebKit):
        (WebGestureEventBuilder):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::handleEvent):
        * src/WebPluginContainerImpl.h:
        (WebCore):
        (WebPluginContainerImpl):

2012-07-26  Adrienne Walker  <enne@google.com>

        [chromium] Remove redundant surface origin transforms
        https://bugs.webkit.org/show_bug.cgi?id=91815

        Reviewed by Stephen White.

        Clean up use of origin transforms in tests. Where possible, test
        against the equivalent draw transform.

        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:

2012-07-25  David Grogan  <dgrogan@chromium.org>

        IndexedDB: WebKit API interfaces for "upgradeneeded" methods and events
        https://bugs.webkit.org/show_bug.cgi?id=92203

        Reviewed by Adam Barth.

        This is the beginning of our typical three-sided-patch process.

        * public/WebIDBCallbacks.h:
        (WebKit::WebIDBCallbacks::onBlocked):
        (WebKit::WebIDBCallbacks::onUpgradeNeeded):
        * public/WebIDBDatabaseCallbacks.h:
        (WebKit::WebIDBDatabaseCallbacks::onVersionChange):
        * public/WebIDBFactory.h:
        (WebIDBFactory):
        (WebKit::WebIDBFactory::open):
        * src/WebIDBFactoryImpl.cpp:
        (WebKit::WebIDBFactoryImpl::open):
        (WebKit):
        * src/WebIDBFactoryImpl.h:
        (WebIDBFactoryImpl):

2012-07-19  Adrienne Walker  <enne@google.com>

        [chromium] Make all compositor screen space transforms operate on content rects
        https://bugs.webkit.org/show_bug.cgi?id=91807

        Reviewed by Kenneth Russell.

        Update tests that deal with screen space transforms to reflect this change.

        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-07-25  Andrew Wilson  <atwilson@chromium.org>

        Unreviewed chromium change to disable failing WebViewTest.AutoResizeInBetweenSizes.
        https://bugs.webkit.org/show_bug.cgi?id=92318

        * tests/WebViewTest.cpp:

2012-07-25  Scott Graham  <scottmg@chromium.org>

        [Chromium] fix double->float warnings in CCLayerTreeHostCommonTest.cpp
        https://bugs.webkit.org/show_bug.cgi?id=92271

        Reviewed by Adrienne Walker.

        Fix compile warnings on Windows.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-07-25  Dana Jansens  <danakj@chromium.org>

        [chromium] Move WebFilterOperations from RenderPassDrawQuad to RenderPass
        https://bugs.webkit.org/show_bug.cgi?id=91885

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):
        (FakeCCRendererClient::rootRenderPass):
        (FakeCCRendererClient::renderPassesInDrawOrder):
        (FakeCCRendererClient::renderPasses):
        (FakeCCRendererClient):
        (TEST_F):
        (TEST):

2012-07-24  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Refactor CCLayerTreeHostCommon: move root layer special case initialization into internal code.
        https://bugs.webkit.org/show_bug.cgi?id=88953

        Reviewed by Adrienne Walker.

        Unit tests updated to account for the new less-special root layer setup.
          - most test cases just needed to remove root->renderSurface()->setContentBounds(), createRenderSurface(), and renderSurfaceLayerList.append().
          - some test cases originally relied on setting some awkward unconventional bounds of the rootLayer that were different than the rootLayer's renderSurface. these tests are updated.
          - a few minor cleanups otherwise.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::executeCalculateDrawTransformsAndVisibility):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::calcDrawEtc):

2012-07-25  Taiju Tsuiki  <tzik@chromium.org>

        FileSystem should provide a way to delete filesystem.
        https://bugs.webkit.org/show_bug.cgi?id=91861

        Reviewed by Adam Barth.

        * public/WebFrameClient.h:
        (WebFrameClient):
        (WebKit::WebFrameClient::deleteFileSystem):
        * src/LocalFileSystemChromium.cpp: Add deleteFileSystem
        (WebCore::deleteFileSystemNotAllowed):
        (WebCore):
        (WebCore::LocalFileSystem::deleteFileSystem):

2012-07-25  Alok Priyadarshi  <alokp@chromium.org>

        [chromium] WebViewBenchmarkSupport::paint API does not work with recording canvas
        https://bugs.webkit.org/show_bug.cgi?id=92008

        Reviewed by Darin Fisher.

        Moved the ownership of canvas to WebViewBenchmarkSupport::PaintClient.

        * public/WebViewBenchmarkSupport.h:
        (PaintClient):
        (WebKit::WebViewBenchmarkSupport::PaintClient::willPaint):
        (WebKit::WebViewBenchmarkSupport::PaintClient::didPaint):
        * src/WebViewBenchmarkSupportImpl.cpp:
        (WebKit::WebViewBenchmarkSupportImpl::paintLayer):
        (WebKit::WebViewBenchmarkSupportImpl::softwarePaint):

2012-07-24  Dana Jansens  <danakj@chromium.org>

        [chromium] Turn the debug HUD into a layer so that it can be drawn as a WebCompositorQuad
        https://bugs.webkit.org/show_bug.cgi?id=92182

        Reviewed by Adrienne Walker.

        * tests/LayerRendererChromiumTest.cpp:
        (TEST):

2012-07-25  Adrienne Walker  <enne@google.com>

        [chromium] Unify compositor quadTransform/drawTransform/originTransform
        https://bugs.webkit.org/show_bug.cgi?id=91417

        Reviewed by Kenneth Russell.

        Clean up tests to refer to the new draw transform semantics.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::createTestTreeWithOneSurface):
        (WebKitTests::createTestTreeWithTwoSurfaces):
        (WebKitTests::TEST_F):
        * tests/CCLayerSorterTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::commitCompleteOnCCThread):
        * tests/CCQuadCullerTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-07-25  Kevin Ellis  <kevers@chromium.org>

        [chromium] Calendar picker popup displays at wrong scale when deviceScaleFactor != 1.
        https://bugs.webkit.org/show_bug.cgi?id=92177

        Manually tested at deviceScaleFactor = 1 and 2.

        Reviewed by Kent Tamura.

        The device scale factor was not being set for the calendar popup. 
        As a result, the popup was rendered too small on hidpi displays.
        This patch sets the device scale factor for any page popup.

        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::initPage):

2012-07-25  MORITA Hajime <morrita@google.com>

        Another unreviewed win build fix against r123569.

        * tests/IDBAbortOnCorruptTest.cpp:

2012-07-25  MORITA Hajime  <morrita@google.com>

        Unreviewed win build fix against r123569.

        * tests/IDBAbortOnCorruptTest.cpp:
        * tests/IDBDatabaseBackendTest.cpp:

2012-07-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-24  Dave Tu  <dtu@chromium.org>

        [chromium] Move renderingStats from WebView to WebWidget.
        https://bugs.webkit.org/show_bug.cgi?id=92184

        Reviewed by Adam Barth.

        We are going to add some rendering stats that work in non-composited mode, so the renderingStats() method should be moved from WebView to WebWidget.

        * public/WebView.h:
        (WebKit):
        (WebView):
        * public/WebWidget.h:
        (WebKit):
        (WebWidget):
        (WebKit::WebWidget::renderingStats):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-24  Alec Flett  <alecflett@chromium.org>

        IndexedDB: fix #include dependencies so IDBRequest isn't an include root
        https://bugs.webkit.org/show_bug.cgi?id=92167

        Reviewed by Tony Chang.

        Remove implicit dependencies due to using IDBRequest.h, and fix all 
        places that break as a result.

        * src/IDBCallbacksProxy.cpp:
        * src/WebIDBDatabaseImpl.cpp:
        * src/WebIDBTransactionImpl.cpp:

2012-07-24  Adam Barth  <abarth@webkit.org>

        [Chromium] Support scrolling and zooming to focused input elements
        https://bugs.webkit.org/show_bug.cgi?id=91661

        Reviewed by Darin Fisher.

        This patch introduces saveScrollAndScaleState and
        restoreScrollAndScaleState, which can be used to save and restore the
        scroll and scale state of the WebView, respectively.  These functions
        will be used by Chromium on Android to save the scale and scrolls state
        before zoom into a text field so that we can "undo" the zoom if the
        user didn't mean to zoom into the text field.

        I wanted to write unit tests for these functions, but it wasn't clear
        to me how to write the test because startPageScaleAnimation appears to
        complete asynchronously.

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::saveScrollAndScaleState):
        (WebKit):
        (WebKit::WebViewImpl::restoreScrollAndScaleState):
        (WebKit::WebViewImpl::resetSavedScrollAndScaleState):
        (WebKit::WebViewImpl::didCommitLoad):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-24  Dave Tu  <dtu@chromium.org>

        [chromium] Add time spent painting to GPU benchmarking renderingStats() API.
        https://bugs.webkit.org/show_bug.cgi?id=90019

        Reviewed by Adrienne Walker.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::renderingStats):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::Texture::prepareRect):
        (WebKitTests::FakeTiledLayerChromium::update):
        * tests/CCTiledLayerTestCommon.h:
        (Texture):
        (FakeTiledLayerChromium):
        * tests/Canvas2DLayerBridgeTest.cpp:
        * tests/ContentLayerChromiumTest.cpp:
        (WebKit::TEST):
        * tests/TiledLayerChromiumTest.cpp:

2012-07-24  Jian Li  <jianli@chromium.org>

        Add per-context setting for html notifications
        https://bugs.webkit.org/show_bug.cgi?id=91295

        Reviewed by Adam Barth.

        Add new per-context feature for chromium port.

        * public/WebPermissionClient.h:
        (WebPermissionClient):
        (WebKit::WebPermissionClient::allowHTMLNotifications):
        * src/ContextFeaturesClientImpl.cpp:
        (WebKit::ContextFeaturesClientImpl::askIfIsEnabled):

2012-07-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r123499.
        http://trac.webkit.org/changeset/123499
        https://bugs.webkit.org/show_bug.cgi?id=92161

        Android fails to compile (Requested by zhenyao on #webkit).

        * src/AssertMatchingEnums.cpp:

2012-07-24  Terry Anderson  <tdanderson@chromium.org>

        [chromium] Add a bounding box member in WebGestureEvent
        https://bugs.webkit.org/show_bug.cgi?id=92144

        Reviewed by Adam Barth.

        The new |boundingBox| member will be used to store the touch region for a WebGestureEvent.
        This will be useful for gesture target fuzzing across multiple different gesture types
        (tap, long press, scroll, etc.)

        * public/WebInputEvent.h:
        (WebGestureEvent):
        * src/WebInputEvent.cpp:
        (SameSizeAsWebGestureEvent):

2012-07-24  Nico Weber  <thakis@chromium.org>

        [chromium/mac] Add cursor resource pngs to the pak file.
        https://bugs.webkit.org/show_bug.cgi?id=92148

        Reviewed by Tony Chang.

        Once https://chromiumcodereview.appspot.com/10817031/ has landed, they can be
        removed from WebCore.gyp's mac_bundle_resources. Part of http://crbug.com/137588

        * WebKit.grd:

2012-07-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r123472.
        http://trac.webkit.org/changeset/123472
        https://bugs.webkit.org/show_bug.cgi?id=92134

        Revert roll to v8 version that crashes sporadically (Requested
        by atwilson on #webkit).

        * DEPS:

2012-07-24  Keishi Hattori  <keishi@webkit.org>

        [Chromium] Page popup should close on mouse down
        https://bugs.webkit.org/show_bug.cgi?id=92092

        Reviewed by Kent Tamura.

        Page popup should close on mouse down because some elements(e.g. <input type=color>) don't have a blur event that
        we can hook to hide the page popup when the user clicks on the page.

        * src/WebPagePopupImpl.h:
        (WebKit::WebPagePopupImpl::hasSamePopupClient): Returns true if the given WebPagePopupImpl have the same popup client.
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleMouseDown): Close all popups when the page is clicked. Checks if the
        mouse down event opened the same popup we just closed.

2012-07-24  Jochen Eisinger  <jochen@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r123463.
        http://trac.webkit.org/changeset/123463
        https://bugs.webkit.org/show_bug.cgi?id=92110

        Broke Android build (Requested by keishi on #webkit).

        * src/WebPagePopupImpl.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleMouseDown):

2012-07-24  Keishi Hattori  <keishi@webkit.org>

        [Chromium] Page popup should close on mouse down
        https://bugs.webkit.org/show_bug.cgi?id=92092

        Reviewed by Kent Tamura.

        Page popup should close on mouse down because some elements(e.g. <input type=color>) don't have a blur event that
        we can hook to hide the page popup when the user clicks on the page.

        * src/WebPagePopupImpl.h:
        (WebKit::WebPagePopupImpl::hasSamePopupClient): Returns true if the given WebPagePopupImpl have the same popup client.
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleMouseDown): Close all popups when the page is clicked. Checks if the
        mouse down event opened the same popup we just closed.

2012-07-24  Anthony Scian  <ascian@rim.com>

        Web Inspector [JSC]: Enable initiator column in network panel.
        https://bugs.webkit.org/show_bug.cgi?id=65533

        Reviewed by Vsevolod Vlasov.

        With 40118 fixed for webkit, Preferences.displayInitiator should be set to true.
        Removed references to it since the optionality is no longer required.

        Test: http/tests/inspector/network/network-initiator.html

        * src/js/DevTools.js:

2012-07-24  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-23  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move layoutTestMode to WebCore
        https://bugs.webkit.org/show_bug.cgi?id=92010

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):
        * src/WebKit.cpp:
        (WebKit::setLayoutTestMode):
        (WebKit::layoutTestMode):

2012-07-23  Dave Tu  <dtu@chromium.org>

        [chromium] Add droppedFrameCount to renderingStats.
        https://bugs.webkit.org/show_bug.cgi?id=91694

        Reviewed by Adrienne Walker.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::renderingStats):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestScrollMultipleRedraw::drawLayersOnCCThread):

2012-07-23  Brian Anderson  <brianderson@chromium.org>

        [chromium] Use shallow flushes that don't glFlush
        https://bugs.webkit.org/show_bug.cgi?id=90325

        Reviewed by Kenneth Russell.

        Changed CCTextureUpdaterTest to recognize shallowFlushCHROMIUM().

        * tests/CCTextureUpdaterTest.cpp:

2012-07-23  Adrienne Walker  <enne@google.com>

        [chromium] Add more compositor unit tests for high DPI transforms
        https://bugs.webkit.org/show_bug.cgi?id=91917

        Reviewed by Kenneth Russell.

        The current set of high DPI tests only deal with layers in a render
        surface. Add some extra tests for non-surface layers. Also add a test
        to make sure that an owning layer in a surface doesn't differ from a
        non-owning layer in high DPI circumstances.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-07-23  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Fix unit tests in debug mode after r123375
        https://bugs.webkit.org/show_bug.cgi?id=92030

        Reviewed by Adrienne Walker.

        Fixed two unit tests that were causing debug assertions because
        they gave calcDrawTransforms an empty sized root layer.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-07-23  Simon Fraser  <simon.fraser@apple.com>

        Part 2 of: Implement sticky positioning
        https://bugs.webkit.org/show_bug.cgi?id=90046

        Reviewed by Ojan Vafai.

        Turn on ENABLE_CSS_STICKY_POSITION.

        * features.gypi:

2012-07-23  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Refactor CCLayerTreeHostCommon: clean up clipRect and drawableContentRect design
        https://bugs.webkit.org/show_bug.cgi?id=80622

        Reviewed by Adrienne Walker.

        Many tests needed to be updated because the semantics of the layer tree have changed:
          - a few tests that were no longer applicable were removed.
          - many tests needed to have fixed initialization, properly
            setting surface contentRect and rootLayer bounds.
          - because clipRect and usesLayerClipping no longer exists, those places in code had to be removed/changed
          - the scissorRect tests needed to have updated expectations
            because after this patch, the rootLayer Surface now clips
            to its contentBounds.
          - the clipRect tests were changed to test the layer's new semantics for the drawableContentRect instead.

        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::calcDrawEtc):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity1OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity0OnMainThread::runMyTest):
        * tests/LayerChromiumTest.cpp:

2012-07-23  Daniel Cheng  <dcheng@chromium.org>

        [chromium] Fix build on Ubuntu Precise.
        https://bugs.webkit.org/show_bug.cgi?id=92021

        Reviewed by Adrienne Walker.

        Remove an array that's written but never read.

        * tests/CCResourceProviderTest.cpp:
        (WebKit::TEST_F):

2012-07-23  Nate Chapin  <japhet@chromium.org>

        Add WebTextInputType enum values for text areas and
        content-editable.
        https://bugs.webkit.org/show_bug.cgi?id=91654

        Reviewed by Adam Barth.

        No new tests, no behavior change without corresponding chromium.org changes.

        * public/WebTextInputType.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::textInputType):

2012-07-23  Pierre Rossi  <pierre.rossi@gmail.com>

        Unify numTouchEventHandlersChanged and needTouchEvents in the chrome client
        https://bugs.webkit.org/show_bug.cgi?id=91006

        Reviewed by Ryosuke Niwa.

        Rename the functions to follow a more boolean logic.

        * public/WebViewClient.h:
        (WebKit::WebViewClient::hasTouchEventHandlers):
        * src/ChromeClientImpl.cpp:
        (WebKit):
        (WebKit::ChromeClientImpl::needTouchEvents):
        * src/ChromeClientImpl.h:
        (ChromeClientImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::hasTouchEventHandlers):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-23  Simon Fraser  <simon.fraser@apple.com>

        Implement sticky positioning
        https://bugs.webkit.org/show_bug.cgi?id=90046

        Reviewed by Ojan Vafai.

        Add ENABLE_CSS_STICKY_POSITION, defaulting to off initially.
        
        * features.gypi:

2012-07-23  Peter Beverloo  <peter@chromium.org>

        [Chromium] Buildfix for fixing gclient on the Chromium Windows bot
        https://bugs.webkit.org/show_bug.cgi?id=91977

        Unreviewed build fix.

        Add the tools/isolate directory to the Windows checkout as these files
        currently are missing during gyp generation. maruel introduced the need
        for these in this isolate refactoring, specifically this Chromium CL:
        http://src.chromium.org/viewvc/chrome?view=rev&revision=147689

        * DEPS:

2012-07-22  Kent Tamura  <tkent@chromium.org>

        [Chromium-Mac] Fix a build error.

        * DEPS: Add third_party/GTM.

2012-07-23  Kent Tamura  <tkent@chromium.org>

        Rename ENABLE_METER_TAG and ENABLE_PROGRESS_TAG to ENABLE_METER_ELEMENT and ENABLE_PROGRESS_ELEMENT respectively
        https://bugs.webkit.org/show_bug.cgi?id=91941

        Reviewed by Kentaro Hara.

        A flag name for an elmement should be ENABLE_*_ELEMENT.

        * features.gypi:

2012-07-22  Kent Tamura  <tkent@chromium.org>

        Rename ENABLE_DETAILS to ENABLE_DETAILS_ELEMENT
        https://bugs.webkit.org/show_bug.cgi?id=91928

        Reviewed by Kentaro Hara.

        A flag name for an elmement should be ENABLE_*_ELEMENT.

        * features.gypi:

2012-07-21  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-20  Kent Tamura  <tkent@chromium.org>

        Rename ENABLE_DATALIST to ENABLE_DATALIST_ELEMENT
        https://bugs.webkit.org/show_bug.cgi?id=91846

        Reviewed by Kentaro Hara.

        A flag name for an elmement should be ENABLE_*_ELEMENT.

        * features.gypi:
        * src/WebInputElement.cpp:
        (WebKit::WebInputElement::dataListOptions):

2012-07-20  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Simplify backend interface classes
        https://bugs.webkit.org/show_bug.cgi?id=91901

        Reviewed by Tony Chang.

        Remove unnecessary method stubs from proxy class.

        * src/IDBTransactionBackendProxy.cpp:
        * src/IDBTransactionBackendProxy.h:
        (IDBTransactionBackendProxy):

2012-07-20  Scott Graham  <scottmg@chromium.org>

        Add windows native versions of bison, flex and gperf.

        Reviewed by Tony Chang.

        * DEPS:

2012-07-20  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Include intVersion when converting between WebCore and WebKit IDBMetadata types
        https://bugs.webkit.org/show_bug.cgi?id=91414

        Reviewed by Adam Barth.

        * src/AssertMatchingEnums.cpp:
        * src/WebIDBMetadata.cpp:
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        (WebKit::WebIDBMetadata::operator IDBDatabaseMetadata):

2012-07-20  Robert Sesek  <rsesek@chromium.org>

        [chromium][Mac] Switch the MACOSX_DEPLOYMENT_TARGET to 10.6
        https://bugs.webkit.org/show_bug.cgi?id=91752

        Reviewed by Eric Seidel.

        Use 10.6 NSScreen/NSColorSpace APIs to determine if the screen is
        monochrome rather than comparing against deprecated colorspace names.

        * src/mac/WebScreenInfoFactory.mm:
        (WebKit::WebScreenInfoFactory::screenInfo):

2012-07-20  Daniel Murphy  <dmurph@chromium.org>

        Introduce WebViewBenchmarkSupport for performance experiments on a real WebView
        https://bugs.webkit.org/show_bug.cgi?id=88271

        Reviewed by Darin Fisher.

        * WebKit.gyp:
        * public/WebView.h:
        (WebKit):
        (WebView):
        (WebKit::WebView::benchmarkSupport):
        * public/WebViewBenchmarkSupport.h: Added.
        (WebKit):
        (WebViewBenchmarkSupport):
        (PaintClient):
        (WebKit::WebViewBenchmarkSupport::PaintClient::willPaint):
        (WebKit::WebViewBenchmarkSupport::PaintClient::didPaint):
        (WebKit::WebViewBenchmarkSupport::PaintClient::~PaintClient):
        (WebKit::WebViewBenchmarkSupport::~WebViewBenchmarkSupport):
        * src/WebViewBenchmarkSupportImpl.cpp: Added.
        (WebKit):
        (WebKit::WebViewBenchmarkSupportImpl::paintLayer):
        (WebKit::WebViewBenchmarkSupportImpl::acceleratedPaintUnclipped):
        (WebKit::WebViewBenchmarkSupportImpl::softwarePaint):
        (WebKit::WebViewBenchmarkSupportImpl::paint):
        * src/WebViewBenchmarkSupportImpl.h: Added.
        (WebCore):
        (WebKit):
        (WebViewBenchmarkSupportImpl):
        (WebKit::WebViewBenchmarkSupportImpl::WebViewBenchmarkSupportImpl):
        (WebKit::WebViewBenchmarkSupportImpl::~WebViewBenchmarkSupportImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::benchmarkSupport):
        (WebKit):
        (WebKit::WebViewImpl::rootGraphicsLayer):
        * src/WebViewImpl.h:
        (WebKit):
        (WebViewImpl):

2012-07-20  Han Shen  <shenhan@google.com>

        [Chromium] Compilation fails under gcc 4.7
        https://bugs.webkit.org/show_bug.cgi?id=90227

        Reviewed by Tony Chang.

        Disable warnings about c++0x compatibility in gcc newer than 4.6.

        * WebKit.gyp:
        * WebKitUnitTests.gyp:

2012-07-20  Adam Barth  <abarth@webkit.org>

        [Chromium] Add WebView::zoomToFindInPageRect for Android
        https://bugs.webkit.org/show_bug.cgi?id=91801

        Reviewed by Tony Chang.

        On Android, when you find in page, we scale the viewport to reveal what
        you've found (because the screen is small). This function instructs the
        WebView to zoom to display a given rect.

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::animateZoomAroundPoint):
            - This function is a bit more general than necessary for this patch
              because it is also used in other cases for animating a zoom
              around a given point (e.g., double-tap to zoom). These uses will
              be upstreamed in later patches.
        (WebKit::WebViewImpl::zoomToFindInPageRect):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-19  Luke Macpherson   <macpherson@chromium.org>

        Enable CSS variables compile time flag in Chrome.
        https://bugs.webkit.org/show_bug.cgi?id=91708

        Reviewed by Dimitri Glazkov.

        Flips the ENABLE_CSS_VARIABLES compile flag on for Chrome. There is also a run-time flag that is off by default,
        so this should not have a user visible effect other than making the variables runtime flag visible at chrome://flags/

        * features.gypi:

2012-07-19  Wei James  <james.wei@intel.com>

        enable Web Audio for chromium android port
        https://bugs.webkit.org/show_bug.cgi?id=89428

        Reviewed by Kenneth Russell.

        * features.gypi:

2012-07-19  Adam Barth  <abarth@webkit.org>

        [Chromium] Support external autofill popups
        https://bugs.webkit.org/show_bug.cgi?id=91651

        Reviewed by Darin Fisher.

        This looks like the last piece needed to support external autofill
        popups. This function just lets the embedder select an index
        (presumably because the user picked an index from the external autofill
        popup).

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::selectAutofillSuggestionAtIndex):
        (WebKit):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-19  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Textures drawn during occlusion are incorrectly re-used when unoccluded.
        https://bugs.webkit.org/show_bug.cgi?id=91537

        Reviewed by Adrienne Walker.

        Added unit tests to test texture caching with clipping and
        occlusion. Removed some minor code duplication when initializing
        layers for various scenarios.

        MockCCQuadCuller can now implement CCQuadSink.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/MockCCQuadCuller.h:
        (WebCore::MockCCQuadCuller::MockCCQuadCuller):

2012-07-19  Adam Barth  <abarth@webkit.org>

        [Chromium] WebView is missing isSelectionEditable and backgroundColor which are used by chromium-android
        https://bugs.webkit.org/show_bug.cgi?id=91671

        Reviewed by Darin Fisher.

        I haven't studied what these APIs are used for downstream, but they
        seem harmless enough.

        * public/WebView.h:
        (WebView):
        * public/WebWidget.h:
        (WebWidget):
        (WebKit::WebWidget::backgroundColor):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::isSelectionEditable):
        (WebKit):
        (WebKit::WebViewImpl::backgroundColor):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-19  Andrew Scherkus  <scherkus@chromium.org>

        [chromium] Move WebAudioSourceProvider destructor from public to protected
        https://bugs.webkit.org/show_bug.cgi?id=91669

        Reviewed by Darin Fisher.

        The lifetime of a WebAudioSourceProvider is managed by the implementor
        and should never be deallocted by WebKit.

        * public/WebAudioSourceProvider.h:
        (WebAudioSourceProvider):

2012-07-19  Tony Chang  <tony@chromium.org>

        Unreviewed, rolling out r123036.
        http://trac.webkit.org/changeset/123036
        https://bugs.webkit.org/show_bug.cgi?id=91555

        Triggers some DCHECKs in Chromium browser_tests

        * public/WebTextInputType.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::textInputType):

2012-07-19  Joshua Bell  <jsbell@chromium.org>

        Roll out r121610 and r122487 which may have been causing flaky crashes
        https://bugs.webkit.org/show_bug.cgi?id=91637

        Reviewed by Kentaro Hara.

        Flaky crashes started in random tests following r121610. It's not clear
        that r121610 is to blame, but we'd like to prove or disprove it.
        If this doesn't resolve the crashes, this patch should be rolled out.

        * src/WebBindings.cpp:
        (WebKit::getRangeImpl):
        (WebKit::getElementImpl):
        (WebKit::getArrayBufferImpl):
        (WebKit::getArrayBufferViewImpl):
        (WebKit::WebBindings::toV8Value):

2012-07-19  Sami Kyostila  <skyostil@chromium.org>

        [chromium] Remove duplicate mock CCLayerTreeHostClient
        https://bugs.webkit.org/show_bug.cgi?id=89457

        Reviewed by Adrienne Walker.

        This test can reuse the existing CCFakeLayerTreeHostClient.

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::MockLayerTreeHost::create):

2012-07-19  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-18  Ryosuke Niwa  <rniwa@webkit.org>

        Chromium build fix attempt. Don't use anonymous namespace.

        * tests/TextureCopierTest.cpp:

2012-07-18  Antoine Labour  <piman@chromium.org>

        [chromium] Introduce CCResourceProvider, replacing TextureAllocator and hiding textures from clients to allow transport
        https://bugs.webkit.org/show_bug.cgi?id=91044

        Reviewed by Adrienne Walker.

        This does several things:
        - Add a CCResourceProvider class, that hides textures and the 3D context
        from layers (except those that need it). Instead layers manage
        "resources". In the future, resources are expected to be transportable
        to a "parent" CCResourceProvider to allow flattening of nested
        compositors.
        - Replace texture ids by resource ids in DrawQuads (allowing them to be
        serializable).
        - Replace TextureAllocator uses by the CCResourceProvider class.
        - Upload of data is done through the CCResourceProvider instead of
        explicit GL calls.
        - External textures are wrapped into a resource at draw time (see
        caveat/FIXME in CCTextureLayerImpl).
        - Rendering with the resources is done through an explicit
        beginRenderFrom/endRenderFrom that exposes the texture only between that
        pair.
        - Merge all the LayerTextureSubImage instances (one per layer), into a
        single instance on the CCResourceProvider.

        Added CCResourceProviderTest, the refactoring is covered by existing tests.

        * WebKit.gypi:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::CCPrioritizedTextureTest::CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::createManager):
        (WTF::CCPrioritizedTextureTest::validateTexture):
        (WTF::CCPrioritizedTextureTest::resourceProvider):
        (CCPrioritizedTextureTest):
        (WTF::TEST_F):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCResourceProviderTest.cpp: Added.
        (WebKit):
        (ResourceProviderContext):
        (WebKit::ResourceProviderContext::create):
        (WebKit::ResourceProviderContext::bindTexture):
        (WebKit::ResourceProviderContext::createTexture):
        (WebKit::ResourceProviderContext::deleteTexture):
        (WebKit::ResourceProviderContext::texStorage2DEXT):
        (WebKit::ResourceProviderContext::texImage2D):
        (WebKit::ResourceProviderContext::texSubImage2D):
        (WebKit::ResourceProviderContext::getPixels):
        (WebKit::ResourceProviderContext::textureCount):
        (WebKit::ResourceProviderContext::textureSize):
        (WebKit::ResourceProviderContext::ResourceProviderContext):
        (WebKit::ResourceProviderContext::Texture::Texture):
        (Texture):
        (WebKit::ResourceProviderContext::allocateTexture):
        (WebKit::ResourceProviderContext::setPixels):
        (CCResourceProviderTest):
        (WebKit::CCResourceProviderTest::CCResourceProviderTest):
        (WebKit::CCResourceProviderTest::context):
        (WebKit::CCResourceProviderTest::getResourcePixels):
        (WebKit::TEST_F):
        * tests/CCScopedTextureTest.cpp:
        (WebKitTests::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::createLayer):
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::Texture::updateRect):
        * tests/CCTiledLayerTestCommon.h:
        (Texture):
        (WebKitTests::FakeTextureCopier::copyTexture):
        (WebKitTests::FakeTextureCopier::flush):
        (WebKitTests::FakeTextureUploader::uploadTexture):
        * tests/ContentLayerChromiumTest.cpp:
        (WebKit::TEST):
        * tests/FakeCCGraphicsContext.h: Copied from Source/WebCore/platform/graphics/chromium/cc/CCTexture.h.
        (WebKit):
        (WebKit::createFakeCCGraphicsContext):
        * tests/LayerRendererChromiumTest.cpp:
        (FakeLayerRendererChromium::FakeLayerRendererChromium):
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (LayerRendererChromiumTest::context):
        (LayerRendererChromiumTest):
        (TEST_F):
        (TEST):
        * tests/TextureCopierTest.cpp:
        * tests/TextureManagerTest.cpp:
        (WTF::TextureManagerTest::TextureManagerTest):
        (WTF::TextureManagerTest::createTextureManager):
        (WTF::TextureManagerTest::requestTexture):
        (TextureManagerTest):
        * tests/TiledLayerChromiumTest.cpp:

2012-07-18  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Add intVersion to chromium/public/WebIDBMetadata.h
        https://bugs.webkit.org/show_bug.cgi?id=91408

        Reviewed by Adam Barth.

        This is in support of the new upgradeneeded versioning api.
        intVersion will eventually replace the WebString version member.

        * public/WebIDBMetadata.h:
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        The spec uses unsigned long long for version numbers but we use signed
        long long so that we can use -1 as a sentinel. It indicates that a
        database still uses a string version.

2012-07-18  Adam Barth  <abarth@webkit.org>

        Disable printing on chromium-android
        https://bugs.webkit.org/show_bug.cgi?id=91550

        Reviewed by Tony Chang.

        We don't implement printing on Android.

        * features.gypi:
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::printPage):

2012-07-18  Alexandre Elias  <aelias@google.com>

        [chromium] Ubercomp: add id to SharedQuadState
        https://bugs.webkit.org/show_bug.cgi?id=91670

        Reviewed by Adrienne Walker.

        This assigns an integer ID to SharedQuadState objects and a
        corresponding ID to quads.  This ID is unique only within a
        RenderPass and currently is just set to the index in the shared quad
        state list.  This is redundant with the pointer and exists to
        simplify serialization.

        I found out that pointer rewriting within a pickler is blocked by
        pointers to memory being const there, so the reassignment will have to
        be performed in the application layer anyway.  In that case, it's
        simplest to add some ID integers.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        (CCLayerTestCommon::getQuads):

2012-07-18  Nate Chapin  <japhet@chromium.org>

        Add WebTextInputType enum values for text areas and
        content-editable.
        https://bugs.webkit.org/show_bug.cgi?id=91654

        Reviewed by Adam Barth.

        No new tests, no behavior change without corresponding chromium.org changes.

        * public/WebTextInputType.h:
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::textInputType):

2012-07-18  Alexandre Elias  <aelias@google.com>

        [chromium] Ubercomp: clean up CCRenderer interface
        https://bugs.webkit.org/show_bug.cgi?id=91555

        Reviewed by Adrienne Walker.

        I replaced the one-by-one RenderPass calls with a new drawFrame()
        method that directly takes a CCRenderPassList, and moved a small
        amount of code from CCLayerTreeHostImpl to implement it.  In ubercomp
        mode, we will produce a frame bundle rather than a command-stream, so
        the full list is easier to work with.

        Also, give empty default implementations for the methods that don't
        need to do anything in a non-GL context, and make private
        setScissorToRect.

        * tests/LayerRendererChromiumTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):
        (FakeCCRendererClient::renderPasses):
        (FakeCCRendererClient):
        (TEST_F):
        (TEST):

2012-07-18  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Fix some coding style violations
        https://bugs.webkit.org/show_bug.cgi?id=91565

        Reviewed by Tony Chang.

        * tests/IDBLevelDBCodingTest.cpp:
        (IDBLevelDBCoding::TEST):

2012-07-18  Tony Chang  <tony@chromium.org>

        [chromium] Unreviewed, fix some MSVC compile warnings.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-07-18  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call SQLiteFileSystem-related functions directly
        https://bugs.webkit.org/show_bug.cgi?id=91631

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        * src/PlatformSupport.cpp:
        (WebCore):

2012-07-18  Tony Chang  <tony@chromium.org>

        [chromium] Unreviewed, more compile fixes on Chromium Win.

        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):

2012-07-18  Tony Chang  <tony@chromium.org>

        [chromium] Fix compile on Windows.

        148>tests\LayerChromiumTest.cpp(510): warning C4305: 'argument' : truncation from 'double' to 'float'

        * tests/LayerChromiumTest.cpp:

2012-07-18  Alec Flett  <alecflett@chromium.org>

        Implement putIndexKeys in WebIDBObjectStoreImpl
        https://bugs.webkit.org/show_bug.cgi?id=91546

        Reviewed by Darin Fisher.

        Implement putIndexKeys in the chromium API, so it is callable
        from chromium.

        * src/WebIDBObjectStoreImpl.cpp:
        (WebKit::WebIDBObjectStoreImpl::putWithIndexKeys):
        (WebKit):
        * src/WebIDBObjectStoreImpl.h:
        (WebIDBObjectStoreImpl):

2012-07-18  Tony Chang  <tony@chromium.org>

        [chromium] Unreviewed compile fix for Android.

        More sqrt fixes.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-07-18  Tony Chang  <tony@chromium.org>

        [chromium] Unreviewed compile fix for Android.
        
        Source/WebKit/chromium/tests/CCDamageTrackerTest.cpp: In member function 'virtual void<unnamed>::CCDamageTrackerTest_verifyDamageForTransformedLayer_Test::TestBody()':
        Source/WebKit/chromium/tests/CCDamageTrackerTest.cpp:332: error: call of overloaded 'sqrt(int)' is ambiguous

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):

2012-07-18  Varun Jain  <varunjain@chromium.org>

        [chromium] Drag image for image elements should be scaled with device scale factor.
        https://bugs.webkit.org/show_bug.cgi?id=89688

        Reviewed by Adam Barth.

        * src/DragClientImpl.cpp:
        (WebKit::DragClientImpl::startDrag):
        * tests/DragImageTest.cpp:
        (WebCore::TEST):

2012-07-18  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Fix style for numeric literals in chromium unit test code
        https://bugs.webkit.org/show_bug.cgi?id=91635

        Reviewed by Adrienne Walker.

        Where possible, removed ".0" and "f" suffixes on numeric literals,
        to be more consistent with WebKit style rules.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerQuadTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/LayerChromiumTest.cpp:
        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):

2012-07-17  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Remove awkward anchorPoint usage that implicity affects layer position
        https://bugs.webkit.org/show_bug.cgi?id=91472

        Reviewed by Adrienne Walker.

        Unit tests were updated to account for the fact that anchorPoint
        and position are now separated.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-07-18  Yoshifumi Inoue  <yosin@chromium.org>

        Decimal::toString should not round integer value.
        https://bugs.webkit.org/show_bug.cgi?id=91481

        Reviewed by Kent Tamura.

        This patch adds a new test cases for Decimal::toString() for failed
        value and maximum coefficient value with various exponent.

        * tests/DecimalTest.cpp:
        (TEST_F): DecimalTest.toString: Add test cases for big coefficient values.

2012-07-18  Hans Wennborg  <hans@chromium.org>

        Add copy constructor to WebSpeechGrammar.h
        https://bugs.webkit.org/show_bug.cgi?id=91484

        Reviewed by Adam Barth.

        Provide user-defined copy constructor (and assign function) for WebSpeechGrammar.
        Without this, we were hitting the implicit copy constructor, which in
        turn used the implicit copy constructor of WebPrivatePtr. This was bad,
        because the implicit copy constructor wouldn't increace the reference
        count on the wrapped object, causing us to crash.

        Also add one for WebSpeechRecognitionResult; haven't seen any problems
        here, but I noticed it was missing.

        * public/WebSpeechGrammar.h:
        (WebKit::WebSpeechGrammar::WebSpeechGrammar):
        (WebSpeechGrammar):
        * public/WebSpeechRecognitionResult.h:
        (WebKit::WebSpeechRecognitionResult::WebSpeechRecognitionResult):
        (WebSpeechRecognitionResult):
        * src/WebSpeechGrammar.cpp:
        (WebKit::WebSpeechGrammar::assign):
        (WebKit):

2012-07-17  Yoshifumi Inoue  <yosin@chromium.org>

        Decimal constructor with 99999999999999999 loses last digit
        https://bugs.webkit.org/show_bug.cgi?id=91579

        Reviewed by Kent Tamura.

        This patch adds test cases for Decimal::EncodedData constructors for
        testing edge cases in addition to common cases which they aren't
        covered by other test cases.

        * tests/DecimalTest.cpp:
        (EXPECT_DECIMAL_ENCODED_DATA_EQ): Introduce a new macro for ease of
        writing test cases for verifying components of Decimal::EncodedData.
        (TEST_F): Added a new test entry DecimalTest.Constructor.

2012-07-17  Yoshifumi Inoue  <yosin@chromium.org>

        Test cases in DecimalTest should use EXPECT_STREQ for ease of debugging test case
        https://bugs.webkit.org/show_bug.cgi?id=91572

        Reviewed by Kent Tamura.

        This patch introduces EXPECT_DECIMAL_STREQ macro to replace EXPECT_EQ
        with String class for displaying text string rather than object dump
        for ease of debugging test cases.

        * tests/DecimalTest.cpp:
        (DecimalTest::stepDown): Changed to return Decimal instead of String
        to use EXPECT_DECIMAL_STREQ.
        (DecimalTest::stepUp): ditto.
        (TEST_F): Replaced EXPECT_EQ + String class to EXPECT_DECIMAL_STREQ.

2012-07-17  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Key generator state not maintained across connections
        https://bugs.webkit.org/show_bug.cgi?id=91456

        Reviewed by Tony Chang.

        Add stub method implementations to test class.

        * tests/IDBFakeBackingStore.h:

2012-07-17  Tony Chang  <tony@chromium.org>

        Unreviewed, rolling out r122884.
        http://trac.webkit.org/changeset/122884
        https://bugs.webkit.org/show_bug.cgi?id=91408

        Broke the chromium-win build.

        * public/WebIDBMetadata.h:
        (WebIDBMetadata):
        (WebKit::WebIDBMetadata::WebIDBMetadata):

2012-07-17  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Add intVersion to chromium/public/WebIDBMetadata.h
        https://bugs.webkit.org/show_bug.cgi?id=91408

        Reviewed by Adam Barth.

        This is in support of the new upgradeneeded versioning api.
        intVersion will eventually replace the WebString version member.

        * public/WebIDBMetadata.h:
        (WebIDBMetadata): The spec uses unsigned long long for version
        numbers but we use int64_t here so that we can use -1 as a sentinel.
        It indicates that a database still uses a string version.

2012-07-17  Tony Chang  <tony@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-17  Vivek Galatage  <vivekgalatage@gmail.com>

        Web Inspector: refactor InspectorController::connectFrontend() to accept InspectorFrontendChannel.
        https://bugs.webkit.org/show_bug.cgi?id=91196

        Reviewed by Pavel Feldman.

        Refactoring InspectorClients. InspectorClient::openInspectorFrontend
        now returning the InspectorFrontendChannel.

        * src/InspectorClientImpl.cpp:
        (WebKit::InspectorClientImpl::openInspectorFrontend):
        * src/InspectorClientImpl.h:
        (InspectorClientImpl):
        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::WebDevToolsAgentImpl::reattach):
        (WebKit::WebDevToolsAgentImpl::openInspectorFrontend):
        * src/WebDevToolsAgentImpl.h:
        (WebDevToolsAgentImpl):

2012-07-16  Adam Barth  <abarth@webkit.org>

        Unreviewed. Remove two empty directories.

        * public/linuxish: Removed.
        * src/linuxish: Removed.

2012-07-16  Gyuyoung Kim  <gyuyoung.kim@samsung.com>

        Add RegisterProtocolHandlerClient to the Modules/protocolhandler
        https://bugs.webkit.org/show_bug.cgi?id=90940

        Reviewed by Hajime Morita.

        As a step to let protocol handler be moved to the modules, RegisterProtocolHandlerClient needs
        to be added to the Modules/protocolhandler. Because ChromeClient has some virtual functions for
        protocol handlers, virtual functions should be moved to RegisterProtocolHandlerClient.

        In order to support this, RegisterProtocolHandlerClientImpl class is added to ChromeClientImpl files.

        In addition, existing functions related to protocol handler in ChromeClientImpl class are moved to
        RegisterProtocolHandlerClientImpl class.

        * WebKit.gyp:
        * src/ChromeClientImpl.cpp: Implement RegisterProtocolHandlerClientImpl class.
        (WebKit):
        (WebKit::RegisterProtocolHandlerClientImpl::create):
        (WebKit::RegisterProtocolHandlerClientImpl::RegisterProtocolHandlerClientImpl):
        (WebKit::RegisterProtocolHandlerClientImpl::registerProtocolHandler):
        * src/ChromeClientImpl.h:
        (ChromeClientImpl):
        (RegisterProtocolHandlerClientImpl):
        (WebKit::RegisterProtocolHandlerClientImpl::~RegisterProtocolHandlerClientImpl):
        (WebKit):
        * src/WebViewImpl.cpp: Register RegisterProtocolHandlerClientImpl in order to support supplement.
        (WebKit::WebViewImpl::WebViewImpl):
        * src/WebViewImpl.h:

2012-07-16  Yoshifumi Inoue  <yosin@chromium.org>

        REGRESSION(r122552): DecimalTest tests (CeilingSmallExponent and FloorSmallExponent) started failing.
        https://bugs.webkit.org/show_bug.cgi?id=91244

        Reviewed by Kent Tamura.

        This patch enables and updates disabled test cases of DecimalTest
        caused by fixes in r122552 of Decimal::ceiling() and Decimal::floor()
        for small fraction numbers and added test cases. Fixes in r122552
        itself is correct however, it didn't update existing tests for very small
        fraction numbers.

        * tests/DecimalTest.cpp:
        (TEST_F): CeilingSmallExponent: Change expected value to 1 for ceiling(1e-1000),
        ceiling rounds number toward positive infinity.
        (TEST_F): FloorSmallExponent: Change expected value to -1 for floor(-1e-1000),
        floor rounds number toward negative infinity.

2012-07-16  Koji Ishii  <kojiishi@gmail.com>

        Vertical alternate glyph (GSUB) support for OpenTypeVerticalData
        https://bugs.webkit.org/show_bug.cgi?id=81389

        Reviewed by Tony Chang.

        Tests for pointer validations for OpenType tables.

        * WebKit.gypi:
        * tests/OpenTypeVerticalDataTest.cpp: Added.
        (WebCore):
        (TestTable):
        (WebCore::TestTable::validateOffset):
        (WebCore::TEST):

2012-07-16  Alexandre Elias  <aelias@google.com>

        [chromium] Fix WebFrameTest flakiness due to synthetic mouse events
        https://bugs.webkit.org/show_bug.cgi?id=91428

        Reviewed by Adam Barth.

        Synthetic mouse move events on scrolling can cause segfaults in
        WebFrameTest due to delayed callbacks on the message loop after
        state destruction. This is currently only affecting
        the Android port, but has the potential to affect other platforms in the
        future.

        We can avoid the issue by disabling the deviceSupportsMouse
        setting, which shouldn't be needed by any WebFrameTest.

        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::createWebViewAndLoad):

2012-07-16  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Introduce putWithIndexKeys and calculate them in the renderer
        https://bugs.webkit.org/show_bug.cgi?id=90923

        Reviewed by Darin Fisher.

        Stub out implementations of putWithIndexKeys(), already implemented
        on the chromium side.

        * public/WebIDBObjectStore.h:
        (WebKit::WebIDBObjectStore::putWithIndexKeys):
        * src/IDBObjectStoreBackendProxy.cpp:
        (WebKit::IDBObjectStoreBackendProxy::putWithIndexKeys):
        (WebKit):
        * src/IDBObjectStoreBackendProxy.h:
        (IDBObjectStoreBackendProxy):

2012-07-16  Adrienne Walker  <enne@google.com>

        [chromium] Unify compositor quad transforms into content space
        https://bugs.webkit.org/show_bug.cgi?id=91350

        Reviewed by Kenneth Russell.

        Update tests to add bounds/contentBounds properties to layers. This
        exposed a bug in the quad culler tests where the draw transform was
        incorrectly being set to the origin transform rather than being a
        transform that operates on centered layer rects. Fixed this bug.

        * tests/CCQuadCullerTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::createLayer):

2012-07-16  Adrienne Walker  <enne@google.com>

        [chromium] Unify compositor quad transforms into content space
        https://bugs.webkit.org/show_bug.cgi?id=91350

        Reviewed by Kenneth Russell.

        Update tests to add bounds/contentBounds properties to layers. This
        exposed a bug in the quad culler tests where the draw transform was
        incorrectly being set to the origin transform rather than being a
        transform that operates on centered layer rects. Fixed this bug.

        * tests/CCQuadCullerTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::createLayer):

2012-07-16  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove targetRenderSurface concept, give layers a renderTarget which is the layer whose coordinate space they draw into
        https://bugs.webkit.org/show_bug.cgi?id=91288

        Reviewed by Adrienne Walker.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity1OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity0OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationTranslateOnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithReplicaUnoccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceAndReplicaOccludedDifferently::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfClippingSurface::runMyTest):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeTiledLayerChromium::setTexturePriorities):
        * tests/LayerChromiumTest.cpp:

2012-07-16  Sami Kyostila  <skyostil@chromium.org>

        [chromium] Only apply page scale delta to root scroll layer
        https://bugs.webkit.org/show_bug.cgi?id=91374

        Reviewed by Adrienne Walker.

        New unit test
        CCLayerTreeHostImplTest.pageScaleDeltaAppliedToRootScrollLayerOnly to verify
        the transformation of child layer while pinch zooming.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-16  Kihong Kwon  <kihong.kwon@samsung.com>

        Remove setController from BatteryClient
        https://bugs.webkit.org/show_bug.cgi?id=90944

        Reviewed by Adam Barth.

        Remove virtual identifier from setController because setController is removed from WebCore::BatteryClient.
        In addition, BatteryController is set to instance of BatteryClientImpl in the constructor of WebViewImpl.

        * src/BatteryClientImpl.h:
        (BatteryClientImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):

2012-07-16  Dana Jansens  <danakj@chromium.org>

        [chromium] Incorrect assertion: Replicas will cause a RenderPass to be removed twice
        https://bugs.webkit.org/show_bug.cgi?id=91328

        Reviewed by Adrienne Walker.

        Add replicas to the surfaces in the test.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::beginTest):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::afterTest):
        (CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit):

2012-07-13  Eric Penner  <epenner@google.com>

        [chromium] Add 'self-managed' option to CCPrioritizedTexture to enable render-surface and canvas use cases.
        https://bugs.webkit.org/show_bug.cgi?id=91177

        Reviewed by Adrienne Walker.

        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::TEST_F):
        * tests/TiledLayerChromiumTest.cpp:

2012-07-13  Brian Anderson  <brianderson@chromium.org>

        Add flushes to CCTextureUpdater::update
        https://bugs.webkit.org/show_bug.cgi?id=89035

        Reviewed by Adrienne Walker.

        CCTextureUpdaterTest added to verify texture upload/flushing patterns.

        * WebKit.gypi:
        * tests/CCTextureUpdaterTest.cpp: Added.

2012-07-13  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Re-enable indexeddb in test_shell
        https://bugs.webkit.org/show_bug.cgi?id=91161

        Reviewed by Tony Chang.

        IDB used to be allowed to run if webView->permissionClient() was NULL,
        as is the case in test_shell. This was inadvertently changed in
        http://wkb.ug/90310.

        We still don't have an automated test for this (http://crbug.com/113738)
        Tested manually:

        * In test_shell:
        1) Open an IDB page
        2) Verify IDB has permission to open a DB

        * In chrome:
        1) Open an IDB page
        2) Verify IDB has permission to open a DB
        3) Revoke IDB permissions in chrome://chrome/settings/content
        4) Reload the IDB page
        5) Verify IDB doesn't have permission to open a DB

        * src/IDBFactoryBackendProxy.cpp:
        (WebKit::IDBFactoryBackendProxy::allowIndexedDB):

2012-07-13  Wei James  <james.wei@intel.com>

        enable TestWebKitAPI/webkit_unit_tests apk on x86 android platform by adding abi support
        https://bugs.webkit.org/show_bug.cgi?id=91194

        Reviewed by Adam Barth.

        * WebKitUnitTests.gyp:

2012-07-13  Dana Jansens  <danakj@chromium.org>

        webkit_unit_test CCLayerTreeHostImplTest.testRemoveRenderPasses started failing.
        https://bugs.webkit.org/show_bug.cgi?id=91245

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-13  Vsevolod Vlasov  <vsevik@chromium.org>

        Unreviewed gardening: skip failing webkit unit test.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-13  Vsevolod Vlasov  <vsevik@chromium.org>

        Unreviewed gardening, skip failing webkit_unit_tests.

        * tests/DecimalTest.cpp:
        (TEST_F):

2012-07-13  Kent Tamura  <tkent@chromium.org>

        Make calendar pickers testable
        https://bugs.webkit.org/show_bug.cgi?id=84827

        Reviewed by Hajime Morita.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::ChromeClientImpl):
        Initialize m_pagePopupDriver with the WebViewImpl.
        (WebKit::ChromeClientImpl::openPagePopup):
        Just calls PagePoupDriver::openPagePopup().
        (WebKit::ChromeClientImpl::closePagePopup):
        Just calls PagePoupDriver::closePagePopup().
        (WebKit::ChromeClientImpl::setPagePopupDriver):
        * src/ChromeClientImpl.h:
        (ChromeClientImpl): Add setPagePopupDriver
        * src/WebViewImpl.h:
        (WebViewImpl):
        WebViewImpl implements PagePopupDriver. openPagePopup() and
        closePagePopup() override members of PagePopupDriver.

2012-07-13  Yoshifumi Inoue  <yosin@chromium.org>

        REGRESSION(r119948): [Forms] Spin button Up/Down actions make value to zero for input type "number" when step mismatched
        https://bugs.webkit.org/show_bug.cgi?id=91197

        Reviewed by Kent Tamura.

        This patch adds test cases for Decimal::ceiling() and floor() of
        positive/negative small fractional numbers.

        * tests/DecimalTest.cpp:
        (TEST_F):

2012-07-12  Adrienne Walker  <enne@google.com>

        [chromium] Root invalidations for RTL pages need to be in the right space
        https://bugs.webkit.org/show_bug.cgi?id=91155

        Reviewed by Kenneth Russell.

        The root layer has a translation on it when placed in the tree, so any
        invalidations on this layer likewise need to be adjusted.

        This adjustment is due to the fact that compositor layers all have the
        origin in the upper left corner of the layer, but this is not always
        the origin for graphics layers. Rather than making compositor layers
        have to deal with a potential offset, we change the transform when
        inserting the layer into the tree. Invalidations need to be similarly
        transformed from document space into compositor layer space.

        The need for this offset is due to the definition of the initial
        containing block. RTL pages (pages with dir=RTL on the body) start
        scrolled all the way to the right, and the origin is in the upper left
        hand corner of this initial viewport. Thus on RTL pages with
        horizontal overflow, the left of the document is in negative CSS
        space.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::invalidateRect):

2012-07-12  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove the RenderPass pointer from RenderPassDrawQuad
        https://bugs.webkit.org/show_bug.cgi?id=91023

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-12  Adam Barth  <abarth@webkit.org>

        [Chromium] WebSettings should be sorted
        https://bugs.webkit.org/show_bug.cgi?id=91157

        Reviewed by Eric Seidel.

        This might be my OCD, but IMHO this file would be cleaner if we listed
        the settings in alphabetic order.

        * public/WebSettings.h:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        (WebKit::WebSettingsImpl::forceSoftwareCompositing):
        (WebKit::WebSettingsImpl::viewportEnabled):
        (WebKit::WebSettingsImpl::maxUntiledLayerSize):

2012-07-12  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Enable IDBFactory.deleteDatabase() and webkitGetDatabaseNames() in Workers
        https://bugs.webkit.org/show_bug.cgi?id=90310

        Reviewed by Tony Chang.

        * src/IDBFactoryBackendProxy.cpp:
        (WebKit::IDBFactoryBackendProxy::allowIndexedDB): Consolidates user-prompting logic.
        (WebKit::getWebFrame): Helper to dig out frame from Document, or null for Worker.
        (WebKit::IDBFactoryBackendProxy::getDatabaseNames):
        (WebKit):
        (WebKit::IDBFactoryBackendProxy::open):
        (WebKit::IDBFactoryBackendProxy::deleteDatabase):
        * src/IDBFactoryBackendProxy.h: Update method signatures to match interface.
        (WebCore):
        (IDBFactoryBackendProxy):

2012-07-12  Dana Jansens  <danakj@chromium.org>

        [chromium] The root layer should not try create a second RenderSurface for itself
        https://bugs.webkit.org/show_bug.cgi?id=91124

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-12  Eric Penner  <epenner@google.com>

        [chromium] Use CCTexture/TextureAllocator and remove TextureManager
        https://bugs.webkit.org/show_bug.cgi?id=91001

        Reviewed by Adrienne Walker.

        Deleting old texture manager tests.

        * WebKit.gypi:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::CCPrioritizedTextureTest::texturesMemorySize):
        * tests/CCThreadedTest.cpp:
        * tests/CCTiledLayerTestCommon.h:
        * tests/Canvas2DLayerBridgeTest.cpp:
        * tests/TextureManagerTest.cpp: Removed.

2012-07-12  Robert Sesek  <rsesek@chromium.org>

        [chromium][Mac] r122400 broke 10.6 build
        https://bugs.webkit.org/show_bug.cgi?id=91103

        Reviewed by Tony Chang.

        Use the right availability macros for forward-declaring methods and
        defining constants.

        * src/mac/WebInputEventFactory.mm:

2012-07-12  Tony Chang  <tony@chromium.org>

        [chromium] Remove drag and drop API methods that are no longer used
        https://bugs.webkit.org/show_bug.cgi?id=90996

        Reviewed by Adam Barth.

        In r117327, we added a parameter for modifier keys to these methods.
        Chromium has since switched to using the methods that require the
        extra parameter so we can remove these methods.

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::dragTargetDragEnter):
        (WebKit::WebViewImpl::dragTargetDragOver):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-12  Tony Chang  <tony@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-12  Adam Barth  <abarth@webkit.org>

        [Chromium] Delete last mention of Hixie76 in WebKit/chromium
        https://bugs.webkit.org/show_bug.cgi?id=91099

        Reviewed by Tony Chang.

        This deprecated API is no longer used anywhere.

        * public/WebSettings.h:
        (WebKit::WebSettings::setDefaultDeviceScaleFactor):

2012-07-12  Tony Chang  <tony@chromium.org>

        Unreviewed, rolling out r122477.
        http://trac.webkit.org/changeset/122477
        https://bugs.webkit.org/show_bug.cgi?id=91103

        Broke Chromium Mac build

        * src/mac/WebInputEventFactory.mm:

2012-07-12  Robert Sesek  <rsesek@chromium.org>

        [chromium][Mac] r122400 broke 10.6 build
        https://bugs.webkit.org/show_bug.cgi?id=91103

        Reviewed by Tony Chang.

        Use the right availability macros for forward-declaring methods and
        defining constants.

        * src/mac/WebInputEventFactory.mm:

2012-07-12  Peter Beverloo  <peter@chromium.org>

        [Chromium] Enable building APKs for TestWebKitAPI and webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=90989

        Reviewed by Adam Barth.

        Add dependencies on the webkit_unit_tests_apk and TestWebKitAPI_apk
        targets for Android, making sure that we're generating the packages.

        * All.gyp:

2012-07-12  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Remove unrequired API in WebSurroundingText.
        https://bugs.webkit.org/show_bug.cgi?id=91067

        Reviewed by Adam Barth.

        Remove the unused first initialize method from WebSurroundingText.
        Now both Chromium and LayoutTestController use the second method.

        * public/WebSurroundingText.h:
        (WebSurroundingText):
        * src/WebSurroundingText.cpp:

2012-07-11  Mark Rowe  <mrowe@apple.com>

        <http://webkit.org/b/91015> Remove BUILDING_ON / TARGETING macros in favor of system availability macros

        This removal was handled by a script that translates the relevant macros in to the equivalent checks
        using the system availability macros.

        Reviewed by Filip Pizlo.

        * src/mac/WebInputEventFactory.mm:

2012-07-11  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-11  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r122358.
        http://trac.webkit.org/changeset/122358
        https://bugs.webkit.org/show_bug.cgi?id=91037

        Build break on WebKit Win (Requested by hayato on #webkit).

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::dragTargetDragEnter):
        (WebKit):
        (WebKit::WebViewImpl::dragTargetDragOver):
        (WebKit::WebViewImpl::dragTargetDrop):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-11  Alexandre Elias  <aelias@google.com>

        [chromium] Move compositor quads to Platform/chromium/public
        https://bugs.webkit.org/show_bug.cgi?id=90582

        Reviewed by Adrienne Walker.

        This moves CCSharedQuadState, CCDrawQuad, and all but two CC*DrawQuad
        classes to the WebKit namespace, as a first step to pushing them
        across the process boundary for the ubercompositor.

        - The intent is to serialize the class hierarchy using the same
        mechanism as WebInputEvent.  In order to do this, there are three
        requirements: pure POD data, a method returning size, and a packing
        pragma.

        - Private data members are fine with this kind of serializer, and a
        default constructor is not needed.  Because of that, we can maintain
        the same encapsulation and convenient APIs (behind
        WEBKIT_IMPLEMENTATION) as the original classes.  To ease the
        transition, the original WebCore headers still exist and typedef to
        the new classes.

        - However, SharedQuadState will be serialized using the normal
        IPC_STRUCT_TRAITS macro, so I made its members public.  A custom
        serializer (on quad lists) will maintain the pointers from quads to
        SharedQuadStates.

        - I converted the Material casting mechanism to materialCast() methods
        living in the derived classes.  That way, the WebCompositorQuad header
        doesn't need to know about all its derived classes.

        - Quad classes not yet transitioned can still be used in
        non-ubercompositor mode.  CCRenderPassDrawQuad and CCYUVVideoDrawQuad
        are currently non-POD and I left them in their original files.

        This approach is the best I've found so far, since it preserves all
        WebCore-facing APIs and avoids unnecessary code duplication (new quad
        types or members can be added by modifying only one place).  There
        also should not be an unreasonable amount of custom serializer code
        required.

        * tests/CCLayerTestCommon.cpp:
        (CCLayerTestCommon::verifyQuadsExactlyCoverRect):
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):

2012-07-11  Dana Jansens  <danakj@chromium.org>

        [chromium] Rename layerRect to contentRect for rects that live in content space
        https://bugs.webkit.org/show_bug.cgi?id=90843

        Reviewed by Adrienne Walker.

        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceRotatedOffAxis::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLargePixelsOccludeInsideClipRect::runMyTest):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/CCTiledLayerImplTest.cpp:
        (CCLayerTestCommon::createLayer):
        (CCLayerTestCommon::TEST):
        (CCLayerTestCommon::getQuads):
        (CCLayerTestCommon::coverageVisibleRectIntersectsTiles):
        (CCLayerTestCommon::coverageVisibleRectIntersectsBounds):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::prepareToUpdate):
        (WebKitTests::FakeTiledLayerChromium::update):
        * tests/CCTiledLayerTestCommon.h:
        (FakeTiledLayerChromium):
        * tests/LayerChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-07-11  Dana Jansens  <danakj@chromium.org>

        [chromium] Minimum size used for occlusion tracking should be a setting on CCLayerTreeHost
        https://bugs.webkit.org/show_bug.cgi?id=90993

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-11  Adam Barth  <abarth@webkit.org>

        [Chromium] Enable LEGACY_VIEWPORT_ADAPTION
        https://bugs.webkit.org/show_bug.cgi?id=90991

        Reviewed by Tony Chang.

        Chromium wishes to support LEGACY_VIEWPORT_ADAPTION. I actually thought
        this was enabled before, but the enable bit got lost in the shuffle.

        * features.gypi:

2012-07-11  Tony Chang  <tony@chromium.org>

        [chromium] Remove drag and drop API methods that are no longer used
        https://bugs.webkit.org/show_bug.cgi?id=90996

        Reviewed by Adam Barth.

        In r117327, we added a parameter for modifier keys to these methods.
        Chromium has since switched to using the methods that require the
        extra parameter so we can remove these methods.

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::dragTargetDragEnter):
        (WebKit::WebViewImpl::dragTargetDragOver):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-07-11  Shawn Singh  <shawnsingh@chromium.org>

        Unreviewed build fix, forgot to add URLTestHelpers.* when landing r122344

        * tests/URLTestHelpers.cpp: Added.
        (URLTestHelpers):
        (WebKit::URLTestHelpers::registerMockedURLFromBaseURL):
        (WebKit::URLTestHelpers::registerMockedURLLoad):
        * tests/URLTestHelpers.h: Added.
        (WebKit):
        (URLTestHelpers):
        (WebKit::URLTestHelpers::toKURL):

2012-07-11  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Use WEBKIT_IMPLEMENTATION == 1 for webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=90094

        Reviewed by Adrienne Walker.

        This patch adds the WEBKIT_IMPLEMENTATION = 1 define to
        WebKitUnitTests.gyp. To get it to compile correctly, some string
        and URL code was refactored and fixed, in particular GURL usage is
        replaced with KURL usage.

        * WebKit.gyp:
        added WEBKIT_IMPLEMENTATION == 1 for unit test code when in shared library
        added URLTestHelpers to exclusion in shared library build, because it depends on webkit_support

        * WebKit.gypi:
        added URLTestHelpers.h and .cpp to the build process

        * WebKitUnitTests.gyp:
        added WEBKIT_IMPLEMENTATION == 1 for unit test code when not in shared library.
        note that in shared library build, RunAllTests.cpp does not have WEBKIT_IMPLEMENTATION == 1.

        * public/WebDOMMessageEvent.h:
        (WebKit::WebDOMMessageEvent::WebDOMMessageEvent):
        * tests/AssociatedURLLoaderTest.cpp:
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Added.
        (URLTestHelpers):
        (WebKit::URLTestHelpers::registerMockedURLFromBaseURL):
        (WebKit::URLTestHelpers::registerMockedURLLoad):
        * tests/URLTestHelpers.h: Copied from Source/WebKit/chromium/public/WebDOMMessageEvent.h.
        (WebKit):
        (URLTestHelpers):
        (WebKit::URLTestHelpers::toKURL):
        * tests/WebFrameTest.cpp:
        * tests/WebPageNewSerializerTest.cpp:
        * tests/WebPageSerializerTest.cpp:
        * tests/WebViewTest.cpp:

2012-07-10  Pavel Feldman  <pfeldman@chromium.org>

        Web Inspector: migrate from background images to CSS for statusbar rendering.
        https://bugs.webkit.org/show_bug.cgi?id=90902

        Reviewed by Vsevolod Vlasov.

        * WebKit.gypi:
        * src/js/Images/statusbarBackgroundChromium.png: Removed.
        * src/js/Images/statusbarBottomBackgroundChromium.png: Removed.
        * src/js/Images/statusbarButtonsChromium.png: Removed.
        * src/js/Images/statusbarMenuButtonChromium.png: Removed.
        * src/js/Images/statusbarMenuButtonSelectedChromium.png: Removed.
        * src/js/devTools.css:
        (.status-bar-background):

2012-07-11  Kenichi Ishibashi  <bashi@chromium.org>

        [Chromium] Adding HarfBuzz-ng for Linux
        https://bugs.webkit.org/show_bug.cgi?id=90362

        Reviewed by Tony Chang.

        * features.gypi: Added use_harfbuzz_ng variable. If the value is set, USE(HARFBUZZ_NG) is defined.

2012-07-10  Hayato Ito  <hayato@chromium.org>

        Unreviewed gardening.

        Android builder started to fail after r122292.
        My best guess is that '--ant-compile' does not take an argument.

        * WebKitUnitTests.gyp:

2012-07-10  Yoshifumi Inoue  <yosin@chromium.org>

        [Chromium-Windows] Implement functions for localized time format information
        https://bugs.webkit.org/show_bug.cgi?id=90236

        Reviewed by Kent Tamura.

        This patch introduces test cases for date and time format related
        functions in LocaleWin.

        * tests/LocaleWinTest.cpp:
        (LocaleWinTest):
        (LocaleWinTest::dateComponents): Added.
        (LocaleWinTest::msForDate): Moved inside class LocaleWinTest.
        (LocaleWinTest::formatDate): Added.
        (LocaleWinTest::parseDate): Added.
        (LocaleWinTest::dateFormatText): Added.
        (LocaleWinTest::firstDayOfWeek): Added.
        (LocaleWinTest::monthLabel): Added.
        (LocaleWinTest::weekDayShortLabel): Added.
        (LocaleWinTest::timeFormatText): Added.
        (LocaleWinTest::shortTimeFormatText): Added.
        (LocaleWinTest::timeAMPMLabel): Added.
        (TEST_F):

2012-07-10  Adam Barth  <abarth@webkit.org>

        [Chromium-Android] Add apk test targets for webkit_unit_tests and TestWebKitAPI
        https://bugs.webkit.org/show_bug.cgi?id=90918

        Reviewed by Tony Chang.

        The rules are similar to what we have added for DumpRenderTree apk.
        All references to gtest_target_type can be removed once we enable APK
        tests on the all bots.

        * WebKitUnitTests.gyp:

2012-07-10  Kevin Ellis  <kevers@chromium.org>

        Input elements with type=range do not have default touch handlers.
        https://bugs.webkit.org/show_bug.cgi?id=88807

        Reviewed by Antonio Gomes.

        Adds flag to enable native handling of touch events for input elements
        with type=range.

        * features.gypi:

2012-07-10  Adam Klein  <adamk@chromium.org>

        [Chromium] REGRESSION(r121909): m_currentInputEvent never set
        https://bugs.webkit.org/show_bug.cgi?id=90914

        Reviewed by Abhishek Arya.

        The always-null m_currentInputEvent causes a regression when
        middle-clicking on a link that calls window.open('...', '_blank');
        that new tab should open in the background, but instead opens in the
        foreground (see code in ChromeClientImpl::getNavigationPolicy()).

        Fix usage of TemporaryChange to specify a local variable name so that
        m_currentInputEvent is actually set for the duration of handleInputEvent.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleInputEvent): Name the TemporaryChange instance.

2012-07-10  Adam Barth  <abarth@webkit.org>

        WebCore::Settings for Hixie76 WebSocket protocol doesn't do anything and should be removed
        https://bugs.webkit.org/show_bug.cgi?id=90910

        Reviewed by Eric Seidel.

        * public/WebSettings.h:
        (WebKit::WebSettings::setHixie76WebSocketProtocolEnabled):
        * src/WebSettingsImpl.cpp:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebSharedWorkerImpl.cpp:
        (WebKit::WebSharedWorkerImpl::initializeLoader):

2012-07-09  Dana Jansens  <danakj@chromium.org>

        [chromium] Replace use of ManagedTexture with CCScopedTexture for impl thread and remove implTextureManager from LayerRendererChromium
        https://bugs.webkit.org/show_bug.cgi?id=90841

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-07-10  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium-Android] Use default font rendering styles in FontPlatformData::querySystemForRenderStyle()
        https://bugs.webkit.org/show_bug.cgi?id=90826

        Reviewed by Adam Barth.

        * WebKit.gyp:
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getRenderStyleForStrike): Call style.setDefault() on Android or when the font is not specified.

2012-07-10  Dana Jansens  <danakj@chromium.org>

        [chromium] Avoid allocating render pass textures that have no content
        https://bugs.webkit.org/show_bug.cgi?id=90702

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::ContentLayerChromiumWithUpdateTracking::ContentLayerChromiumWithUpdateTracking):
        (CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::beginTest):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::didCommit):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestSurfaceNotAllocatedForLayersOutsideMemoryLimit::afterTest):
        (WTF):

2012-07-10  Leandro Gracia Gil  <leandrogracia@chromium.org>

        Unreviewed Chromium build fix for mac-release.

        Fixing clang build after https://bugs.webkit.org/show_bug.cgi?id=90807

        * public/WebSurroundingText.h:
        (WebKit):

2012-07-10  Leandro Gracia Gil  <leandrogracia@chromium.org>

        WebSurroundingText layout tests should use the same code path as the rest of the feature.
        https://bugs.webkit.org/show_bug.cgi?id=90807

        Reviewed by Adam Barth.

        Replace the offset-based initialize method used only by LayoutTestController
        with a point-based version to follow the same code path.

        * public/WebSurroundingText.h:
        (WebKit):
        (WebSurroundingText):
        * src/WebSurroundingText.cpp:
        (WebKit::WebSurroundingText::initialize):

2012-07-10  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r122207.
        http://trac.webkit.org/changeset/122207
        https://bugs.webkit.org/show_bug.cgi?id=90874

        Broke the cr-windows bot (Requested by beverloo on #webkit).

        * DEPS:

2012-07-10  Jochen Eisinger  <jochen@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-09  Matt Falkenhagen  <falken@chromium.org>

        Add ENABLE_DIALOG_ELEMENT and skeleton files
        https://bugs.webkit.org/show_bug.cgi?id=90521

        Reviewed by Kent Tamura.

        * features.gypi:
        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures):
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableDialogElement):
        (WebKit):
        (WebKit::WebRuntimeFeatures::isDialogElementEnabled):

2012-07-09  Yoshifumi Inoue  <yosin@chromium.org>

        [Chromium-Mac] Implement functions for localized time format information
        https://bugs.webkit.org/show_bug.cgi?id=90237

        Reviewed by Kent Tamura.

        * tests/LocaleMacTest.cpp:
        (LocaleMacTest):
        (LocaleMacTest::timeFormatText):
        (LocaleMacTest::shortTimeFormatText):
        (LocaleMacTest::timeAMPMLabel):
        (TEST_F):

2012-07-09  Eric Penner  <epenner@google.com>

        [chromium] Merge updates and idle updates into one pass
        https://bugs.webkit.org/show_bug.cgi?id=90324

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::ContentLayerChromiumWithUpdateTracking::resetPaintContentsCount):
        (WTF::ContentLayerChromiumWithUpdateTracking::ContentLayerChromiumWithUpdateTracking):
        (ContentLayerChromiumWithUpdateTracking):
        (WTF::CCLayerTreeHostTestOpacityChange::afterTest):
        * tests/CCTiledLayerTestCommon.h:
        (FakeTiledLayerChromium):
        * tests/TiledLayerChromiumTest.cpp:

2012-07-09  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Introduce LocaleMac class
        https://bugs.webkit.org/show_bug.cgi?id=90248

        Reviewed by Kent Tamura.

        This patch added tests for LocaleMac class.

        * WebKit.gypi:
        * tests/LocaleMacTest.cpp: Added.
        (LocaleMacTest):
        (LocaleMacTest::dateComponents):
        (LocaleMacTest::msForDate):
        (LocaleMacTest::formatDate):
        (LocaleMacTest::parseDate):
        (LocaleMacTest::dateFormatText):
        (LocaleMacTest::firstDayOfWeek):
        (LocaleMacTest::monthLabel):
        (LocaleMacTest::weekDayShortLabel):
        (TEST_F):

2012-07-09  Dana Jansens  <danakj@chromium.org>

        [chromium] Create CCScopedTexture class for creating/freeing textures
        https://bugs.webkit.org/show_bug.cgi?id=89485

        Reviewed by Adrienne Walker.

        * WebKit.gypi:
        * tests/CCScopedTextureTest.cpp: Added.
        (WebKitTests):
        (WebKitTests::TEST):
        (TrackingTextureAllocator):
        (WebKitTests::TrackingTextureAllocator::TrackingTextureAllocator):
        (WebKitTests::TrackingTextureAllocator::numTextures):

2012-07-09  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Remove obsolete accessor plumbing
        https://bugs.webkit.org/show_bug.cgi?id=90812

        Reviewed by Tony Chang.

        * public/WebIDBCursor.h: Remove direction.
        * public/WebIDBDatabase.h: Remove name, version, objectStoreNames;
        (WebKit::WebIDBDatabase::metadata):
        * public/WebIDBIndex.h: Remove name, keyPath, unique, multiEntry;
        * public/WebIDBObjectStore.h: Remove name, keyPath, indexNames, autoIncrement;
        * src/IDBDatabaseBackendProxy.cpp: Remove plumbing.
        * src/IDBDatabaseBackendProxy.h: Remove plumbing.
        (IDBDatabaseBackendProxy):
        * src/IDBIndexBackendProxy.cpp: Remove plumbing.
        * src/IDBIndexBackendProxy.h: Remove plumbing.
        (IDBIndexBackendProxy):
        * src/IDBObjectStoreBackendProxy.cpp: Remove plumbing.
        * src/IDBObjectStoreBackendProxy.h: Remove plumbing.
        (IDBObjectStoreBackendProxy):
        * src/IDBTransactionBackendProxy.cpp: Remove plumbing.
        * src/IDBTransactionBackendProxy.h: Assert stub is not used - only needed
        by real IDBTransactionBackendImpl
        (WebKit::IDBTransactionBackendProxy::mode):
        * src/WebIDBTransactionImpl.cpp: Remove plumbing.
        * src/WebIDBTransactionImpl.h: Remove plumbing.

2012-07-09  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r122161.
        http://trac.webkit.org/changeset/122161
        https://bugs.webkit.org/show_bug.cgi?id=90837

        failed to compile on chromium webkit linux bot (Requested by
        shawnsingh on #webkit).

        * WebKit.gypi:
        * WebKitUnitTests.gyp:
        * public/WebDOMMessageEvent.h:
        * tests/AssociatedURLLoaderTest.cpp:
        (WebKit::AssociatedURLLoaderTest::AssociatedURLLoaderTest):
        (WebKit::AssociatedURLLoaderTest::SetUp):
        (WebKit::AssociatedURLLoaderTest::CheckMethodFails):
        (WebKit::AssociatedURLLoaderTest::CheckHeaderFails):
        (WebKit::AssociatedURLLoaderTest::CheckAccessControlHeaders):
        (WebKit::TEST_F):
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::registerMockedURLLoad):
        (FrameTestHelpers):
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        (FrameTestHelpers):
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        (WebKit::SelectPopupMenuTest::registerMockedURLLoad):
        (WebKit::SelectPopupMenuTest::loadFrame):
        (WebKit::TEST_F):
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Removed.
        * tests/URLTestHelpers.h: Removed.
        * tests/WebFrameTest.cpp:
        (WebKit::WebFrameTest::registerMockedHttpURLLoad):
        (WebKit::WebFrameTest::registerMockedChromeURLLoad):
        (WebKit::TEST_F):
        * tests/WebPageNewSerializerTest.cpp:
        (WebKit::WebPageNewSerializeTest::registerMockedURLLoad):
        (WebPageNewSerializeTest):
        (WebKit::WebPageNewSerializeTest::setUpCSSTestPage):
        (WebKit::WebPageNewSerializeTest::loadURLInTopFrame):
        (WebKit::WebPageNewSerializeTest::resourceVectorContains):
        (WebKit::TEST_F):
        * tests/WebPageSerializerTest.cpp:
        (WebKit::WebPageSerializerTest::registerMockedURLLoad):
        (WebKit::WebPageSerializerTest::loadURLInTopFrame):
        (WebKit::WebPageSerializerTest::webVectorContains):
        (WebKit::TEST_F):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):
        (WebKit::WebViewTest::testAutoResize):
        (WebKit::WebViewTest::testTextInputType):

2012-07-09  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Use WEBKIT_IMPLEMENTATION == 1 for webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=90094

        Reviewed by Adam Barth.

        This patch adds the WEBKIT_IMPLEMENTATION = 1 define to
        WebKitUnitTests.gyp. To get it to compile correctly, some string
        and URL code was refactored, and GURL types were replaced with KURL types.

        * WebKit.gypi:
        * WebKitUnitTests.gyp:
        * public/WebDOMMessageEvent.h:
        (WebKit::WebDOMMessageEvent::WebDOMMessageEvent):
        * tests/AssociatedURLLoaderTest.cpp:
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Added.
        (URLTestHelpers):
        (WebKit::URLTestHelpers::registerMockedURLFromBaseURL):
        (WebKit::URLTestHelpers::registerMockedURLLoad):
        * tests/URLTestHelpers.h: Copied from Source/WebKit/chromium/public/WebDOMMessageEvent.h.
        (WebKit):
        (URLTestHelpers):
        (WebKit::URLTestHelpers::toKURL):
        * tests/WebFrameTest.cpp:
        * tests/WebPageNewSerializerTest.cpp:
        * tests/WebPageSerializerTest.cpp:
        * tests/WebViewTest.cpp:

2012-07-09  Dana Jansens  <danakj@chromium.org>

        [chromium] Decouple RenderPass drawing from CCRenderSurface
        https://bugs.webkit.org/show_bug.cgi?id=90573

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):

2012-07-09  Adam Klein  <adamk@chromium.org>

        Rename WebCore::WebKitMutationObserver to WebCore::MutationObserver
        https://bugs.webkit.org/show_bug.cgi?id=90810

        Reviewed by Ojan Vafai.

        * src/WebKit.cpp:

2012-07-09  Leandro Gracia Gil  <leandrogracia@chromium.org>

        SurroundingText should not advance character iterators if they are at end.
        https://bugs.webkit.org/show_bug.cgi?id=90560

        Reviewed by Ryosuke Niwa.

        Moving the check for null visible positions to WebCore as it makes no
        sense to be in a platform-specific code.

        * src/WebSurroundingText.cpp:
        (WebKit::WebSurroundingText::initialize):

2012-07-09  Dana Jansens  <danakj@chromium.org>

        [chromium] Create render surfaces on main thread only for the current frame
        https://bugs.webkit.org/show_bug.cgi?id=89793

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-07-02  Ryosuke Niwa  <rniwa@webkit.org>

        Make HTMLCollection RefCounted
        https://bugs.webkit.org/show_bug.cgi?id=90414

        Reviewed by Sam Weinig.

        * src/WebPageSerializer.cpp:
        (WebCore::retrieveResourcesForFrame):
        * src/WebPageSerializerImpl.cpp:
        (WebKit::WebPageSerializerImpl::collectTargetFrames):

2012-07-09  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r122107.
        http://trac.webkit.org/changeset/122107
        https://bugs.webkit.org/show_bug.cgi?id=90794

        Build failure on Mac debug bots (Requested by falken_ on
        #webkit).

        * features.gypi:
        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures):
        * src/WebRuntimeFeatures.cpp:

2012-07-09  Matt Falkenhagen  <falken@chromium.org>

        Add ENABLE_DIALOG_ELEMENT and skeleton files
        https://bugs.webkit.org/show_bug.cgi?id=90521

        Reviewed by Kent Tamura.

        * features.gypi:
        * public/WebRuntimeFeatures.h:
        (WebRuntimeFeatures):
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableDialogElement):
        (WebKit):
        (WebKit::WebRuntimeFeatures::isDialogElementEnabled):

2012-07-09  MORITA Hajime  <morrita@google.com>

        [Chromium] ContextFeaturesClient::isEnabled is slow
        https://bugs.webkit.org/show_bug.cgi?id=90367

        Reviewed by Kent Tamura.

        ContextFeaturesClientImpl::isEnabled touches a heavy part in chrome
        where locks are acquired for each invocation.

        This change introduces a set of caches to avoid such slow calls.
        The cache class ContextFeaturesCache is implemented as a
        Supplement of ScriptExecutionContext because the flag bits
        depend on the domain of each Document.

        * src/ContextFeaturesClientImpl.cpp:
        (ContextFeaturesCache): Added.
        (Entry): Added.
        (WebKit::ContextFeaturesCache::Entry::Entry):
        (WebKit::ContextFeaturesCache::Entry::isEnabled):
        (WebKit::ContextFeaturesCache::Entry::set):
        (WebKit::ContextFeaturesCache::Entry::needsRefresh):
        (WebKit::ContextFeaturesCache::entryFor):
        (WebKit):
        (WebKit::ContextFeaturesCache::supplementName):
        (WebKit::ContextFeaturesCache::from):
        (WebKit::ContextFeaturesCache::refreshAgainst):
        (WebKit::ContextFeaturesClientImpl::isEnabled):
        (WebKit::ContextFeaturesClientImpl::urlDidChange): Added to invoke refrshAgainst.
        (WebKit::ContextFeaturesClientImpl::askIfIsEnabled):
        * src/ContextFeaturesClientImpl.h:
        (ContextFeaturesClientImpl):

2012-07-09  Vsevolod Vlasov  <vsevik@chromium.org>

        Unreviewed chromium inspector test fix.

        * src/js/Tests.js:
        (.TestSuite.prototype.nonAnonymousUISourceCodes_):

2012-07-05  Yoshifumi Inoue  <yosin@chromium.org>

        Unreviewed Chromium gardening. Roll Chromium DEPS

        * DEPS: 145501 => 145569

2012-07-05  Yoshifumi Inoue  <yosin@chromium.org>

        Unreviewed Chromium gardening - Disable WebAnimationTest for Linux and Windows.
        https://bugs.webkit.org/show_bug.cgi?id=90651

        * tests/WebAnimationTest.cpp:
        (WebKit):
        (WebKit::TEST):

2012-07-05  Ian Vollick  <vollick@chromium.org>

        [chromium] Create a WebKit::Web* wrapper for the cc animation classes
        https://bugs.webkit.org/show_bug.cgi?id=90303

        Reviewed by James Robinson.

        * WebKit.gyp:
        * WebKit.gypi:
        * src/WebAnimation.cpp: Added.
        (WebKit):
        (WebKit::WebAnimation::iterations):
        (WebKit::WebAnimation::setIterations):
        (WebKit::WebAnimation::startTime):
        (WebKit::WebAnimation::setStartTime):
        (WebKit::WebAnimation::timeOffset):
        (WebKit::WebAnimation::setTimeOffset):
        (WebKit::WebAnimation::alternatesDirection):
        (WebKit::WebAnimation::setAlternatesDirection):
        (WebKit::WebAnimation::toCCActiveAnimation):
        (WebKit::WebAnimation::initialize):
        (WebKit::WebAnimation::destroy):
        * src/WebAnimationCurveCommon.cpp: Added.
        (WebKit):
        (WebKit::createTimingFunction):
        * src/WebAnimationCurveCommon.h: Added.
        (WebCore):
        (WebKit):
        * src/WebFloatAnimationCurve.cpp: Added.
        (WebKit):
        (WebKit::WebFloatAnimationCurve::add):
        (WebKit::WebFloatAnimationCurve::toCCAnimationCurve):
        (WebKit::WebFloatAnimationCurve::initialize):
        (WebKit::WebFloatAnimationCurve::destroy):
        * src/WebTransformAnimationCurve.cpp: Added.
        (WebKit):
        (WebKit::WebTransformAnimationCurve::add):
        (WebKit::WebTransformAnimationCurve::toCCAnimationCurve):
        (WebKit::WebTransformAnimationCurve::initialize):
        (WebKit::WebTransformAnimationCurve::destroy):
        * tests/WebAnimationTest.cpp: Added.
        * tests/WebFloatAnimationCurveTest.cpp: Added.
        * tests/WebTransformAnimationCurveTest.cpp: Added.

2012-07-05  Vincent Scheib  <scheib@chromium.org>

        [Chromium] Clear m_currentInputEvent after handled by pointerLockMouseEvent().
        https://bugs.webkit.org/show_bug.cgi?id=90391

        WebViewImpl::handleInputEvent was keeping a pointer to an input event that would
        later be accessed. When in pointer lock, that pointer was not being cleared.
        Code modified to use TemporaryChange to automatically clear the pointer at all
        method exit points.

        Reviewed by Abhishek Arya.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleInputEvent):

2012-07-05  John Mellor  <johnme@chromium.org>

        Text Autosizing: Add test framework and simple test.
        https://bugs.webkit.org/show_bug.cgi?id=90561

        ENABLE(TEXT_AUTOSIZING) is now on in Chromium (but disabled at runtime).
        This allows it to be used in Layout Tests (and in future by Web
        Inspector's mobile device emulation).

        Reviewed by Adam Barth.

        * features.gypi:

2012-07-05  Oli Lan  <olilan@chromium.org>

        [chromium] Add a method didChangeFormState to WebViewClient.
        https://bugs.webkit.org/show_bug.cgi?id=90563

        Reviewed by Adam Barth.

        This patch adds a new method didChangeFormState to WebViewClient,
        and calls it from ChromeClientImpl::formStateDidChange with the changed node.

        This new method can be used for example by the Android port to update the browser's
        IME when the state of the currently focused text node has changed. To facilitate this
        usage, a focused() method has been added to WebNode.

        A new test has been added to WebViewTest. This test checks that didChangeFormState
        is called when an input's value is changed, and also checks that WebNode::focused() returns
        the correct value for the provided node, in both the focused and non-focused cases.

        * public/WebNode.h:
        * public/WebViewClient.h:
        (WebKit::WebViewClient::didChangeFormState):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::formStateDidChange):
        * src/WebNode.cpp:
        (WebKit::WebNode::focused):
        (WebKit):
        * tests/WebViewTest.cpp:
        (FormChangeWebViewClient):
        (WebKit::FormChangeWebViewClient::didChangeFormState):
        (WebKit::FormChangeWebViewClient::reset):
        (WebKit::FormChangeWebViewClient::called):
        (WebKit::FormChangeWebViewClient::focused):
        (WebKit):
        (WebKit::TEST_F):
        * tests/data/input_field_set_value_while_focused.html: Added.
        * tests/data/input_field_set_value_while_not_focused.html: Added.

2012-07-04  Yoshifumi Inoue  <yosin@chromium.org>

        Unreviewed, Chromium gardening. Roll Chromium DEPS.

        * DEPS: chromium_rev: 145322 => 145501

2012-07-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Respect memory needed for RenderSurfaces when reserving contents textures
        https://bugs.webkit.org/show_bug.cgi?id=89901

        Reviewed by Adrienne Walker.

        * tests/CCPrioritizedTextureTest.cpp:
        (WTF::CCPrioritizedTextureTest::createManager):
        (WTF::TEST_F):
        (WTF):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeTiledLayerChromium::setTexturePriorities):
        (WebKitTests):
        * tests/CCTiledLayerTestCommon.h:
        (FakeTiledLayerChromium):
        * tests/TiledLayerChromiumTest.cpp:

2012-07-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Clear RenderSurfaces still when no idle paint will be done
        https://bugs.webkit.org/show_bug.cgi?id=90553

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestCompositeAndReadbackCleanup):
        (WTF::CCLayerTreeHostTestCompositeAndReadbackCleanup::CCLayerTreeHostTestCompositeAndReadbackCleanup):
        (WTF::CCLayerTreeHostTestCompositeAndReadbackCleanup::beginTest):
        (WTF::CCLayerTreeHostTestCompositeAndReadbackCleanup::afterTest):
        (WTF):

2012-07-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove CCLayerTreeHostTestThreadOnly class to cleanup CCLayerTreeHostTests
        https://bugs.webkit.org/show_bug.cgi?id=90556

        Reviewed by Adrienne Walker.

        Currently many tests that run both single and threaded versions subclass
        from CCLayerTreeHostTestThreadOnly just from copy/pasting. The class
        only adds a runTestThreaded() which calls runTest(true). Many other
        tests do run only in threaded mode call runTest(true) themselves, making
        for an inconsistent mess.

        We remove CCLayerTreeHostTestThreadOnly class, so we don't have tests
        inheriting it that are not thread-only. And now all tests that are
        thread-only call runTest(true) consistently.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TEST_F):

2012-07-04  John Mellor  <johnme@chromium.org>

        Text Autosizing: Add compile flag and runtime setting
        https://bugs.webkit.org/show_bug.cgi?id=87394

        This patch renames Font Boosting to Text Autosizing and adds compile guards around the runtime setting.

        Reviewed by Adam Barth.

        * features.gypi:
        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setTextAutosizingEnabled):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-07-04  Ian Vollick  <vollick@chromium.org>

        [chromium] Correctly reject accelerated animations with certain rotations.
        https://bugs.webkit.org/show_bug.cgi?id=89768

        Reviewed by James Robinson.

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::TEST_F):
        (WebKitTests):

2012-07-03  Alex Sakhartchouk  <alexst@chromium.org>

        [chromium] Avoid calling getUniformLocation??() in the compositor startup
        https://bugs.webkit.org/show_bug.cgi?id=90217

        Reviewed by Adrienne Walker.

        Fixing the build error.

        * tests/TextureCopierTest.cpp:

2012-07-03  Erik Arvidsson  <arv@chromium.org>

        [V8] Remove enableFasterDOMStoreAccess which is never used
        https://bugs.webkit.org/show_bug.cgi?id=90489

        Reviewed by Adam Barth.

        * src/WebScriptController.cpp:
        (WebKit::WebScriptController::enableV8SingleThreadMode):

2012-07-03  Tony Chang  <tony@chromium.org>

        [chromium] Unreviewed, update .gitignore to handle VS2010 files.

        * .gitignore:

2012-07-03  Tony Chang  <tony@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-03  Charles Wei  <charles.wei@torchmobile.com.cn>

        IndexedDB: should make the LevelDB persistant to the directory indicated in PageGroupSettings::indexedDBDataBasePath
        https://bugs.webkit.org/show_bug.cgi?id=88338

        Reviewed by David Levin.

        * src/WebSharedWorkerImpl.cpp:
        (WebKit::WebSharedWorkerImpl::startWorkerContext):
        * src/WebWorkerClientImpl.cpp:
        (WebKit::WebWorkerClientImpl::startWorkerContext):

2012-07-02  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-07-02  Leandro Gracia Gil  <leandrogracia@chromium.org>

        [Chromium] Implement a Layout Test for editing/SurroundingText
        https://bugs.webkit.org/show_bug.cgi?id=82461

        Reviewed by Ryosuke Niwa.

        Allow passing nodes as arguments for layout test methods.

        * public/WebBindings.h:
        (WebBindings):
        * src/WebBindings.cpp:
        (WebKit::getNodeImpl):
        (WebKit):
        (WebKit::WebBindings::getNode):

2012-07-02  Benjamin Poulain  <bpoulain@apple.com>

        Do not do any logging initialization when logging is disabled
        https://bugs.webkit.org/show_bug.cgi?id=90228

        Reviewed by Simon Fraser.

        * src/WebKit.cpp:
        (WebKit::enableLogChannel):

2012-07-01  Keishi Hattori  <keishi@webkit.org>

        Unreviewed, rolling out r121650.
        http://trac.webkit.org/changeset/121650
        https://bugs.webkit.org/show_bug.cgi?id=90303

        runhooks is failing for chromium win bots and
        WebAnimationTest.DefaultSettings is crashing

        * WebKit.gyp:
        * WebKit.gypi:
        * src/WebAnimation.cpp: Removed.
        * src/WebAnimationCurveCommon.cpp: Removed.
        * src/WebAnimationCurveCommon.h: Removed.
        * src/WebFloatAnimationCurve.cpp: Removed.
        * src/WebTransformAnimationCurve.cpp: Removed.
        * tests/WebAnimationTest.cpp: Removed.
        * tests/WebFloatAnimationCurveTest.cpp: Removed.
        * tests/WebTransformAnimationCurveTest.cpp: Removed.

2012-07-01  Ian Vollick  <vollick@chromium.org>

        [chromium] Create a WebKit::Web* wrapper for the cc animation classes
        https://bugs.webkit.org/show_bug.cgi?id=90303

        Reviewed by James Robinson.

        * WebKit.gyp:
        * WebKit.gypi:
        * src/WebAnimation.cpp: Added.
        (WebKit):
        (WebKit::WebAnimation::iterations):
        (WebKit::WebAnimation::setIterations):
        (WebKit::WebAnimation::startTime):
        (WebKit::WebAnimation::setStartTime):
        (WebKit::WebAnimation::timeOffset):
        (WebKit::WebAnimation::setTimeOffset):
        (WebKit::WebAnimation::alternatesDirection):
        (WebKit::WebAnimation::setAlternatesDirection):
        (WebKit::WebAnimation::toCCActiveAnimation):
        (WebKit::WebAnimation::initialize):
        (WebKit::WebAnimation::destroy):
        * src/WebAnimationCurveCommon.cpp: Added.
        (WebKit):
        (WebKit::createTimingFunction):
        * src/WebAnimationCurveCommon.h: Added.
        (WebCore):
        (WebKit):
        * src/WebFloatAnimationCurve.cpp: Added.
        (WebKit):
        (WebKit::WebFloatAnimationCurve::add):
        (WebKit::WebFloatAnimationCurve::toCCAnimationCurve):
        (WebKit::WebFloatAnimationCurve::initialize):
        (WebKit::WebFloatAnimationCurve::destroy):
        * src/WebTransformAnimationCurve.cpp: Added.
        (WebKit):
        (WebKit::WebTransformAnimationCurve::add):
        (WebKit::WebTransformAnimationCurve::toCCAnimationCurve):
        (WebKit::WebTransformAnimationCurve::initialize):
        (WebKit::WebTransformAnimationCurve::destroy):
        * tests/WebAnimationTest.cpp: Added.
        * tests/WebFloatAnimationCurveTest.cpp: Added.
        * tests/WebTransformAnimationCurveTest.cpp: Added.

2012-06-30  Ian Vollick  <vollick@chromium.org>

        [chromium] CanvasLayerTextureUpdater needs to convert opaque rects back to content space.
        https://bugs.webkit.org/show_bug.cgi?id=90092

        The CanvasLayerTextureUpdater currently receives its opaque rects in
        layer space, but is expected to return them in content space and does
        not convert them. This patch adds this conversion. To avoid numerical
        errors, this patch also switches to using float rects to store opaque
        rects where appropriate.

        Reviewed by Adrienne Walker.

        * WebKit.gypi:
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TestOpacityChangeLayerDelegate::paintContents):
        (WTF::MockContentLayerDelegate::paintContents):
        * tests/ContentLayerChromiumTest.cpp: Added.
        (WebKit):
        (OpaqueRectDrawingGraphicsContextPainter):
        (WebKit::OpaqueRectDrawingGraphicsContextPainter::OpaqueRectDrawingGraphicsContextPainter):
        (WebKit::OpaqueRectDrawingGraphicsContextPainter::~OpaqueRectDrawingGraphicsContextPainter):
        (MockContentLayerDelegate):
        (WebKit::MockContentLayerDelegate::MockContentLayerDelegate):
        (WebKit::TEST):
        * tests/LayerChromiumTest.cpp:
        * tests/OpaqueRectTrackingContentLayerDelegateTest.cpp:
        (WebCore::TEST_F):
        * tests/TiledLayerChromiumTest.cpp:
        * tests/WebLayerTest.cpp:

2012-06-29  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Keep direction on IDBCursor to avoid calls to back end
        https://bugs.webkit.org/show_bug.cgi?id=90114

        Stop plumbing IDBCursorBackendInterface::direction() through API.

        Reviewed by Tony Chang.

        * src/IDBCursorBackendProxy.cpp:
        * src/IDBCursorBackendProxy.h:
        (IDBCursorBackendProxy):
        * src/WebIDBCursorImpl.cpp:
        * src/WebIDBCursorImpl.h:
        (WebIDBCursorImpl):

2012-06-29  Adam Barth  <abarth@webkit.org>

        [Chromium] WebFontRendering.cpp requires some OS(ANDROID) ifdefs to build downstream
        https://bugs.webkit.org/show_bug.cgi?id=90292

        Reviewed by Nate Chapin.

        These ifdefs are required to build this file downstream. There's some
        sublte difference between how the OS flags are set upstream and
        downstream. This is on our list of issues to resolve, but in the
        meantime, this patch makes these files identical upstream and
        downstream to reduce noise in the upstreaming queue.

        * src/linux/WebFontRendering.cpp:
        (WebKit::WebFontRendering::setSubpixelPositioning):

2012-06-29  Eric Penner  <epenner@google.com>

        [chromium] Adding PrioritizedTexture and replacing ContentsTextureManager
        https://bugs.webkit.org/show_bug.cgi?id=84308

        Reviewed by Adrienne Walker.

        * WebKit.gypi:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::commitCompleteOnCCThread):
        * tests/CCPrioritizedTextureTest.cpp: Added.
        (WTF):
        (CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::~CCPrioritizedTextureTest):
        (WTF::CCPrioritizedTextureTest::texturesMemorySize):
        (WTF::CCPrioritizedTextureTest::createManager):
        (WTF::CCPrioritizedTextureTest::validateTexture):
        (WTF::CCPrioritizedTextureTest::allocator):
        (WTF::TEST_F):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::Texture::Texture):
        (WebKitTests::FakeLayerTextureUpdater::Texture::updateRect):
        (WebKitTests::FakeLayerTextureUpdater::createTexture):
        (WebKitTests::FakeTiledLayerChromium::FakeTiledLayerChromium):
        (WebKitTests::FakeTiledLayerWithScaledBounds::FakeTiledLayerWithScaledBounds):
        * tests/CCTiledLayerTestCommon.h:
        (Texture):
        (FakeLayerTextureUpdater):
        (FakeTiledLayerChromium):
        (FakeTiledLayerWithScaledBounds):
        * tests/TiledLayerChromiumTest.cpp:

2012-06-29  Ian Vollick  <vollick@chromium.org>

        [chromium] Roll chromium rev to 144906
        https://bugs.webkit.org/show_bug.cgi?id=90278

        Unreviewed. Deps roll.

        * DEPS:

2012-06-29  Alexander Pavlov  <apavlov@chromium.org>

        Web Inspector: [Device Metrics] "Fit window" option inhibits adjusting the page zoom factor
        https://bugs.webkit.org/show_bug.cgi?id=90187

        Reviewed by Vsevolod Vlasov.

        This change fixes the stale zoom factor, which does not get updated upon browser window resize in the "Fit window" mode.
        The expected test results have little to do with actual dimensions of the test page in Chrome on a real mobile device,
        since Chrome on the mobile uses a different zooming technique (pageScaleFactor-based viewport using layout width
        rather than plain pageZoomFactor) and font boosting, which has not been upstreamed yet.

        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::DeviceMetricsSupport::autoZoomPageToFitWidth):
        (WebKit::DeviceMetricsSupport::ensureOriginalZoomFactor):

2012-06-29  Konrad Piascik  <kpiascik@rim.com>

        Don't hardcode target dpi of 160 (it should be 96 on desktop)
        https://bugs.webkit.org/show_bug.cgi?id=88114

        Reviewed by Adam Barth.

        Updated the call to computeViewportAttributes.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::dispatchViewportPropertiesDidChange):

2012-06-29  Amy Ousterhout  <aousterh@chromium.org>

        Deleting unused function in WebDeviceOrientation
        https://bugs.webkit.org/show_bug.cgi?id=90185

        Reviewed by Adam Barth.

        Deleting the unused copy assignment function in WebDeviceOrientation.

        * public/WebDeviceOrientation.h:
        (WebDeviceOrientation):
        * src/WebDeviceOrientation.cpp:

2012-06-29  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Implement Date Time format parser
        https://bugs.webkit.org/show_bug.cgi?id=89963

        Reviewed by Kent Tamura.

        This patch adds an unit test for date time format parser if
        ENABLE(INPUT_TYPE_TIME_MULTIPLE_FIELDS) is true.

        * tests/DateTimeFormatTest.cpp: Added.
        (DateTimeFormatTest):
        (Token):
        (DateTimeFormatTest::Token::Token):
        (DateTimeFormatTest::Token::operator==):
        (DateTimeFormatTest::Token::toString):
        (Tokens):
        (DateTimeFormatTest::Tokens::Tokens):
        (DateTimeFormatTest::Tokens::operator==):
        (DateTimeFormatTest::Tokens::toString):
        (DateTimeFormatTest::parse):
        (DateTimeFormatTest::single):
        (TokenHandler):
        (DateTimeFormatTest::TokenHandler::~TokenHandler):
        (DateTimeFormatTest::TokenHandler::fieldType):
        (DateTimeFormatTest::TokenHandler::tokens):
        (DateTimeFormatTest::TokenHandler::visitField):
        (DateTimeFormatTest::TokenHandler::visitLiteral):
        (operator<<):
        (TEST_F):

2012-06-28  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Implement IDBTransaction internal active flag
        https://bugs.webkit.org/show_bug.cgi?id=89379

        Reviewed by Tony Chang.

        To match the IDB spec, transactions that have had no requests
        filed against them should commit, not abort. This requires plumbing
        through the commit() call from front-end to back-end.

        * src/IDBTransactionBackendProxy.cpp:
        (WebKit::IDBTransactionBackendProxy::commit):
        (WebKit):
        * src/IDBTransactionBackendProxy.h:
        (IDBTransactionBackendProxy):
        * src/WebIDBTransactionImpl.cpp:
        (WebKit::WebIDBTransactionImpl::commit):
        (WebKit):
        * src/WebIDBTransactionImpl.h:

2012-06-28  Adrienne Walker  <enne@google.com>

        [chromium] Split WebScrollbar into WebPluginScrollbar and WebScrollbar
        https://bugs.webkit.org/show_bug.cgi?id=90117

        Reviewed by James Robinson.

        Convert WebScrollbar/WebScrollbarClient/WebScrollbarImpl to be
        WebPluginScrollbar, WebPluginScrollbarClient, and
        WebPluginScrollbarImpl. Modify ScrollbarGroup
        to use this instead.

        WebScrollbar is now the base interface for a pre-existing scrollbar
        that is accessed in a const manner. It also provides all of the common
        WebKit ScrollTypes.h enums. WebPluginScrollbar is now a scrollbar that
        has been externally created and is externally modified in terms of its
        position, invalidation, and painting.

        This is a pre-refactoring for adding Web versions of ScrollbarTheme
        into the Platform directory which will operate on WebScrollbar, but
        that don't need all of what WebPluginScrollbar provides.

        As WebScrollbar is moved to Platform, WebKit.gyp now must depend on
        Platform as well.

        * WebKit.gyp:
        * public/WebPluginScrollbar.h:
        (WebKit):
        (WebPluginScrollbar):
        (WebKit::WebPluginScrollbar::~WebPluginScrollbar):
        * public/WebPluginScrollbarClient.h:
        (WebKit):
        (WebPluginScrollbarClient):
        * public/WebScrollbar.h: Removed.
        * public/WebScrollbarClient.h: Removed.
        * src/AssertMatchingEnums.cpp:
        * src/ScrollbarGroup.cpp:
        (WebKit::ScrollbarGroup::scrollbarCreated):
        (WebKit::ScrollbarGroup::scrollbarDestroyed):
        (WebKit::ScrollbarGroup::scrollSize):
        (WebKit::ScrollbarGroup::scrollPosition):
        (WebKit::ScrollbarGroup::contentsSize):
        * src/ScrollbarGroup.h:
        (WebKit):
        (ScrollbarGroup):
        * src/WebPluginScrollbarImpl.cpp: Renamed from Source/WebKit/chromium/src/WebScrollbarImpl.cpp.
        (WebKit):
        (WebKit::WebPluginScrollbar::createForPlugin):
        (WebKit::WebPluginScrollbar::defaultThickness):
        (WebKit::WebPluginScrollbarImpl::WebPluginScrollbarImpl):
        (WebKit::WebPluginScrollbarImpl::~WebPluginScrollbarImpl):
        (WebKit::WebPluginScrollbarImpl::setScrollOffset):
        (WebKit::WebPluginScrollbarImpl::invalidateScrollbarRect):
        (WebKit::WebPluginScrollbarImpl::getTickmarks):
        (WebKit::WebPluginScrollbarImpl::convertFromContainingViewToScrollbar):
        (WebKit::WebPluginScrollbarImpl::scrollbarStyleChanged):
        (WebKit::WebPluginScrollbarImpl::isOverlay):
        (WebKit::WebPluginScrollbarImpl::value):
        (WebKit::WebPluginScrollbarImpl::setLocation):
        (WebKit::WebPluginScrollbarImpl::setValue):
        (WebKit::WebPluginScrollbarImpl::setDocumentSize):
        (WebKit::WebPluginScrollbarImpl::scroll):
        (WebKit::WebPluginScrollbarImpl::paint):
        (WebKit::WebPluginScrollbarImpl::handleInputEvent):
        (WebKit::WebPluginScrollbarImpl::onMouseDown):
        (WebKit::WebPluginScrollbarImpl::onMouseUp):
        (WebKit::WebPluginScrollbarImpl::onMouseMove):
        (WebKit::WebPluginScrollbarImpl::onMouseLeave):
        (WebKit::WebPluginScrollbarImpl::onMouseWheel):
        (WebKit::WebPluginScrollbarImpl::onKeyDown):
        * src/WebPluginScrollbarImpl.h: Added.
        (WebCore):
        (WebKit):
        (WebPluginScrollbarImpl):
        (WebKit::WebPluginScrollbarImpl::scrollOffset):
        (WebKit::WebPluginScrollbarImpl::scrollbar):
        * src/WebScrollbarImpl.h: Removed.

2012-06-28  Adam Barth  <abarth@webkit.org>

        [Chromium] On Android, we should be able to ask the embedder what intents exist in a region of the page
        https://bugs.webkit.org/show_bug.cgi?id=90210

        Reviewed by Dimitri Glazkov.

        This patch introduces a function that asks the embedder to analyze the
        region around a hit test result for interesting content, like phone
        numbers, email addresses, or physical addresses. The embedder then
        responds with the "most interesting" content, together with an intent
        URL for enacting the intent embodied by that content.

        This function will be used in a subsequent patch to detect content
        after touch events.

        * WebKit.gyp:
        * public/WebContentDetectionResult.h: Added.
        (WebKit):
        (WebContentDetectionResult):
        (WebKit::WebContentDetectionResult::WebContentDetectionResult):
        (WebKit::WebContentDetectionResult::isValid):
        (WebKit::WebContentDetectionResult::range):
        (WebKit::WebContentDetectionResult::string):
        (WebKit::WebContentDetectionResult::intent):
        * public/WebViewClient.h:
        (WebViewClient):
        (WebKit::WebViewClient::detechContentAround):

2012-06-28  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Hook up render-side key ASSERTing for get()
        https://bugs.webkit.org/show_bug.cgi?id=90001

        Reviewed by Tony Chang.

        Hook up Chromium WebKit API to new onSuccess handler.

        * src/WebIDBCallbacksImpl.cpp:
        (WebKit::WebIDBCallbacksImpl::onSuccess):
        * tests/IDBAbortOnCorruptTest.cpp:
        (WebCore::MockIDBCallbacks::onSuccess):
        * tests/IDBDatabaseBackendTest.cpp:

2012-06-28  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-28  Alpha Lam  <hclam@chromium.org>

        Unreviewed, rolling out r121463.
        http://trac.webkit.org/changeset/121463
        https://bugs.webkit.org/show_bug.cgi?id=90094

        Broke Windows build.

        * WebKit.gypi:
        * WebKitUnitTests.gyp:
        * public/WebDOMMessageEvent.h:
        * tests/AssociatedURLLoaderTest.cpp:
        (WebKit::AssociatedURLLoaderTest::AssociatedURLLoaderTest):
        (WebKit::AssociatedURLLoaderTest::SetUp):
        (WebKit::AssociatedURLLoaderTest::CheckMethodFails):
        (WebKit::AssociatedURLLoaderTest::CheckHeaderFails):
        (WebKit::AssociatedURLLoaderTest::CheckAccessControlHeaders):
        (WebKit::TEST_F):
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::registerMockedURLLoad):
        (FrameTestHelpers):
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        (FrameTestHelpers):
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        (WebKit::SelectPopupMenuTest::registerMockedURLLoad):
        (WebKit::SelectPopupMenuTest::loadFrame):
        (WebKit::TEST_F):
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Removed.
        * tests/URLTestHelpers.h: Removed.
        * tests/WebFrameTest.cpp:
        (WebKit::WebFrameTest::registerMockedHttpURLLoad):
        (WebKit::WebFrameTest::registerMockedChromeURLLoad):
        (WebKit::TEST_F):
        * tests/WebPageNewSerializerTest.cpp:
        (WebKit::WebPageNewSerializeTest::registerMockedURLLoad):
        (WebPageNewSerializeTest):
        (WebKit::WebPageNewSerializeTest::setUpCSSTestPage):
        (WebKit::WebPageNewSerializeTest::loadURLInTopFrame):
        (WebKit::WebPageNewSerializeTest::resourceVectorContains):
        (WebKit::TEST_F):
        * tests/WebPageSerializerTest.cpp:
        (WebKit::WebPageSerializerTest::registerMockedURLLoad):
        (WebKit::WebPageSerializerTest::loadURLInTopFrame):
        (WebKit::WebPageSerializerTest::webVectorContains):
        (WebKit::TEST_F):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):
        (WebKit::WebViewTest::testAutoResize):
        (WebKit::WebViewTest::testTextInputType):

2012-06-28  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Use WEBKIT_IMPLEMENTATION == 1 for webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=90094

        Reviewed by Adam Barth.

        This patch adds the WEBKIT_IMPLEMENTATION = 1 define to
        WebKitUnitTests.gyp. To get it to compile correctly, some string
        and URL code was refactored and fixed.

        * WebKit.gypi:
        * WebKitUnitTests.gyp:
        * public/WebDOMMessageEvent.h:
        (WebKit::WebDOMMessageEvent::WebDOMMessageEvent):
        * tests/AssociatedURLLoaderTest.cpp:
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Added.
        (URLTestHelpers):
        (WebKit::URLTestHelpers::registerMockedURLFromBaseURL):
        (WebKit::URLTestHelpers::registerMockedURLLoad):
        * tests/URLTestHelpers.h: Copied from Source/WebKit/chromium/public/WebDOMMessageEvent.h.
        (WebKit):
        (URLTestHelpers):
        (WebKit::URLTestHelpers::toKURL):
        * tests/WebFrameTest.cpp:
        * tests/WebPageNewSerializerTest.cpp:
        * tests/WebPageSerializerTest.cpp:
        * tests/WebViewTest.cpp:

2012-06-28  Oli Lan  <olilan@chromium.org>

        [chromium] Change WebViewImpl::textInputInfo to use root editable element.
        https://bugs.webkit.org/show_bug.cgi?id=90179

        Reviewed by Adam Barth.

        WebViewImpl::textInputInfo currently returns text value and offsets relative to the
        focused node. For contenteditable nodes, this may not give the expected result.

        This patch changes the method to return value and offsets for the root editable element.
        This also allows the implementation to be simplified somewhat.

        This also ensures that the offsets returned will use the same basis as the recently added
        method Editor::setSelectionOffsets (and WebViewImpl::setEditableSelectionOffsets).

        Testing for textInputInfo has been added to WebViewTest.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::textInputInfo):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):

2012-06-28  James Robinson  <jamesr@chromium.org>

        [chromium] Should schedule a commit when dropping contents textures
        https://bugs.webkit.org/show_bug.cgi?id=90031

        Reviewed by Adrienne Walker.

        Adds a somewhat vacuous test unit test for committing when releasing textures.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-27  Dana Jansens  <danakj@chromium.org>

        [chromium] Do not multiply bounds by contentsScale in TiledLayerChromium and CanvasLayerTextureUpdater
        https://bugs.webkit.org/show_bug.cgi?id=90103

        Reviewed by Adrienne Walker.

        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::prepareToUpdate):
        * tests/CCTiledLayerTestCommon.h:
        (FakeTiledLayerChromium):
        * tests/TiledLayerChromiumTest.cpp:

2012-06-28  Dan Alcantara  <dfalcantara@chromium.org>

        [chromium] Introduce way to reload a page using the original request URL
        https://bugs.webkit.org/show_bug.cgi?id=89788

        Reviewed by Adam Barth.

        Adds a new reload method for cases where we need to override the URL
        when reloading a page. This is needed for situations where a server
        redirects navigation based on information that may have changed since
        the last time the page was loaded.
        
        User agents, for example, can cause a server to redirect to the mobile
        version of a page.  Changing to the desktop version by switching user agents
        requires loading a URL from before the redirect occurred.

        Also adds a unit test to confirm that scroll position and page scale are
        saved when the reload occurs.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::reloadWithGivenURL):
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setClearPageScaleFactorOnLoad):
        (WebKit):
        (WebKit::WebViewImpl::didCommitLoad):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-06-28  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r121395.
        http://trac.webkit.org/changeset/121395
        https://bugs.webkit.org/show_bug.cgi?id=90143

        Patch causes crashes in fast/workers/worker-context-gc.html
        (Requested by zdobersek on #webkit).

        * src/WebSharedWorkerImpl.cpp:
        (WebKit::WebSharedWorkerImpl::startWorkerContext):
        * src/WebWorkerClientImpl.cpp:
        (WebKit::WebWorkerClientImpl::startWorkerContext):

2012-06-28  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Implement functions for localized time format information
        https://bugs.webkit.org/show_bug.cgi?id=89965

        Reviewed by Kent Tamura.

        This patch adds new test LocalizedDateICUTest if ENABLE(INPUT_TYPE_TIME_MULTIPLE_FIELDS)
        is true.

        * WebKit.gypi:
        * tests/LocalizedDateICUTest.cpp: Added.
        (LocalizedDateICUTest):
        (Labels):
        (LocalizedDateICUTest::Labels::Labels):
        (LocalizedDateICUTest::Labels::operator==):
        (LocalizedDateICUTest::Labels::toString):
        (LocalizedDateICUTest::labels):
        (LocalizedDateICUTest::localizedDateFormatText):
        (LocalizedDateICUTest::localizedShortDateFormatText):
        (LocalizedDateICUTest::timeAMPMLabels):
        (operator<<):
        (TEST_F):

2012-06-27  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r121405.
        http://trac.webkit.org/changeset/121405
        https://bugs.webkit.org/show_bug.cgi?id=90135

        broke windows build (Requested by shawnsingh_ on #webkit).

        * WebKit.gypi:
        * WebKitUnitTests.gyp:
        * public/WebDOMMessageEvent.h:
        * tests/AssociatedURLLoaderTest.cpp:
        (WebKit::AssociatedURLLoaderTest::AssociatedURLLoaderTest):
        (WebKit::AssociatedURLLoaderTest::SetUp):
        (WebKit::AssociatedURLLoaderTest::CheckMethodFails):
        (WebKit::AssociatedURLLoaderTest::CheckHeaderFails):
        (WebKit::AssociatedURLLoaderTest::CheckAccessControlHeaders):
        (WebKit::TEST_F):
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::registerMockedURLLoad):
        (FrameTestHelpers):
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        (FrameTestHelpers):
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        (WebKit::SelectPopupMenuTest::registerMockedURLLoad):
        (WebKit::SelectPopupMenuTest::loadFrame):
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Removed.
        * tests/URLTestHelpers.h: Removed.
        * tests/WebFrameTest.cpp:
        (WebKit::WebFrameTest::registerMockedHttpURLLoad):
        (WebKit::WebFrameTest::registerMockedChromeURLLoad):
        (WebKit::TEST_F):
        * tests/WebPageNewSerializerTest.cpp:
        (WebKit::WebPageNewSerializeTest::registerMockedURLLoad):
        (WebPageNewSerializeTest):
        (WebKit::WebPageNewSerializeTest::setUpCSSTestPage):
        (WebKit::WebPageNewSerializeTest::loadURLInTopFrame):
        (WebKit::WebPageNewSerializeTest::resourceVectorContains):
        (WebKit::TEST_F):
        * tests/WebPageSerializerTest.cpp:
        (WebKit::WebPageSerializerTest::registerMockedURLLoad):
        (WebKit::WebPageSerializerTest::loadURLInTopFrame):
        (WebKit::WebPageSerializerTest::webVectorContains):
        (WebKit::TEST_F):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):
        (WebKit::WebViewTest::testAutoResize):
        (WebKit::WebViewTest::testTextInputType):

2012-06-27  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Use WEBKIT_IMPLEMENTATION == 1 for webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=90094

        Reviewed by James Robinson.

        This patch adds the WEBKIT_IMPLEMENTATION = 1 define to
        WebKitUnitTests.gyp. To get it to compile correctly, some string
        and URL code was refactored and fixed.

        * WebKit.gypi:
        * WebKitUnitTests.gyp:
        * public/WebDOMMessageEvent.h:
        (WebKit::WebDOMMessageEvent::WebDOMMessageEvent):
        * tests/AssociatedURLLoaderTest.cpp:
        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::loadFrame):
        * tests/FrameTestHelpers.h:
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/PopupMenuTest.cpp:
        * tests/RunAllTests.cpp:
        * tests/URLTestHelpers.cpp: Added.
        (URLTestHelpers):
        (WebKit::URLTestHelpers::registerMockedURLFromBaseURL):
        (WebKit::URLTestHelpers::registerMockedURLLoad):
        * tests/URLTestHelpers.h: Copied from Source/WebKit/chromium/public/WebDOMMessageEvent.h.
        (WebKit):
        (URLTestHelpers):
        (WebKit::URLTestHelpers::toKURL):
        * tests/WebFrameTest.cpp:
        * tests/WebPageNewSerializerTest.cpp:
        * tests/WebPageSerializerTest.cpp:
        * tests/WebViewTest.cpp:

2012-06-27  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Implement localizedDecimalSeparator function
        https://bugs.webkit.org/show_bug.cgi?id=90036

        Reviewed by Kent Tamura.

        This patch adds test case for localizedDecimalSeparator().

        * tests/LocalizedNumberICUTest.cpp:
        (testDecimalSeparator):
        (TEST):

2012-06-27  Yusuke Sato  <yusukes@chromium.org>

        [chromium] Improve keyboardEvent() so a web page could receive a DOM3 spec compliant keyboard event.
        https://bugs.webkit.org/show_bug.cgi?id=89637

        Reviewed by Tony Chang.

        This is a Gtk port of http://crrev.com/142209.

        Normalizes event->state to make it Windows/Mac compatible. Since the
        way of setting modifier mask on X is very different than Windows/Mac
        as shown in http://crbug.com/127142#c8, the normalization is necessary.

        * src/gtk/WebInputEventFactory.cpp:
        (WebKit):
        (WebKit::normalizeEventState):
        (WebKit::WebInputEventFactory::keyboardEvent):

2012-06-27  James Robinson  <jamesr@chromium.org>

        [chromium] Use SkColor in compositor internals
        https://bugs.webkit.org/show_bug.cgi?id=90108

        Reviewed by Adrienne Walker.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::setBackgroundColor):
        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCSolidColorLayerImplTest.cpp:
        (CCLayerTestCommon::TEST):
        * tests/LayerChromiumTest.cpp:

2012-06-27  Charles Wei  <charles.wei@torchmobile.com.cn>

        IndexedDB: should make the LevelDB persistant to the directory indicated in PageGroupSettings::indexedDBDataBasePath
        https://bugs.webkit.org/show_bug.cgi?id=88338

        Reviewed by David Levin.

        * src/WebSharedWorkerImpl.cpp:
        (WebKit::WebSharedWorkerImpl::startWorkerContext):
        * src/WebWorkerClientImpl.cpp:
        (WebKit::WebWorkerClientImpl::startWorkerContext):

2012-06-27  Joshua Bell  <jsbell@chromium.org>

        [Chromium] IndexedDB: Expose WebIDBTransaction::commit() method in public API
        https://bugs.webkit.org/show_bug.cgi?id=90089

        Reviewed by James Robinson.

        Prep work for http://webkit.org/b/89379 which requires empty transactions to
        trigger a commit from the front-end.

        * public/WebIDBTransaction.h:
        (WebKit::WebIDBTransaction::commit):

2012-06-27  Josh Horwich  <jhorwich@chromium.org>

        [chromium] Expose device scale factor in WebPluginContainer
        https://bugs.webkit.org/show_bug.cgi?id=87874

        Reviewed by Adam Barth.

        * public/WebPluginContainer.h:
        (WebPluginContainer):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::deviceScaleFactor):
        (WebKit):
        (WebKit::WebPluginContainerImpl::pageScaleFactor):
        (WebKit::WebPluginContainerImpl::pageZoomFactor):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):

2012-06-27  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] out-of-order assert in WebViewImpl setDeviceScaleFactor
        https://bugs.webkit.org/show_bug.cgi?id=90006

        The assert in WebViewImpl::setDeviceScaleFactor should test for non-scaling
        after we have set both m_DeviceScaleInCompositor and page()->deviceScaleFactor()
        instead of in between.

        Reviewed by James Robinson.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setDeviceScaleFactor):

2012-06-26  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-26  James Robinson  <jamesr@chromium.org>

        [chromium] Remove WebView::graphicsContext3D getter
        https://bugs.webkit.org/show_bug.cgi?id=89916

        Reviewed by Adrienne Walker.

        Removes WebView::graphicsContext3D getter. This getter was used to access the compositor's context, which is an
        inherently dangerous operation since the compositor context may not be safe to use on the main thread and has
        somewhat complicated creation / recreation semantics. A shared context is exposed
        (WebView::sharedGraphicsContext3D) for callers who may want access to a context in a share group with the
        compositor.

        * public/WebView.h:
        (WebView):
        * src/WebLayerTreeView.cpp:
        * src/WebViewImpl.cpp:
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-06-26  Peter Beverloo  <peter@chromium.org>

        [Chromium] Decrease the number of conditional blocks in features.gypi
        https://bugs.webkit.org/show_bug.cgi?id=90013

        Reviewed by Adam Barth.

        Consolidate two Android-specific and accelerated-compositing-specific
        conditional blocks into other blocks which serve an identical purpose.

        * features.gypi:

2012-06-26  Dave Tu  <dtu@chromium.org>

        [chromium] Expose rendering statistics to WebWidget.
        https://bugs.webkit.org/show_bug.cgi?id=88268

        Reviewed by James Robinson.

        The WebKit side of a basic framework for exposing rendering statistics
        to Chromium's --enable-benchmarking extension.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::renderingStatistics):
        (WebKit):

2012-06-25  James Robinson  <jamesr@chromium.org>

        [chromium] Add WebLayer API for scrolling
        https://bugs.webkit.org/show_bug.cgi?id=89913

        Reviewed by Adrienne Walker.

        Use WebScrollableLayer type in NonCompositedContentHost.

        * WebKit.gyp:
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::setScrollLayer):
        (WebKit::reserveScrollbarLayers):
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::haveScrollLayer):
        (WebKit):
        (WebKit::NonCompositedContentHost::scrollLayer):
        * src/NonCompositedContentHost.h:
        (WebCore):
        * src/WebContentLayer.cpp:
        (WebKit::WebContentLayer::WebContentLayer):
        * src/WebLayer.cpp:
        (WebKit::WebLayer::numberOfChildren):
        (WebKit):
        (WebKit::WebLayer::childAt):
        (WebKit::WebLayer::setAlwaysReserveTextures):
        * src/WebScrollableLayer.cpp:
        (WebKit):
        (WebKit::WebScrollableLayer::setScrollPosition):
        (WebKit::WebScrollableLayer::setScrollable):
        (WebKit::WebScrollableLayer::setHaveWheelEventHandlers):
        (WebKit::WebScrollableLayer::setShouldScrollOnMainThread):

2012-06-26  Ian Vollick  <vollick@chromium.org>

        [chromium] The single thread proxy should not automatically tick new animations.
        https://bugs.webkit.org/show_bug.cgi?id=89996

        Reviewed by James Robinson.

        * WebKit.gypi:
        * tests/CCSingleThreadProxyTest.cpp: Removed.

2012-06-26  Ian Vollick  <vollick@chromium.org>

        [chromium] Layer chromium should need a redraw after getting its first non-empty bounds.
        https://bugs.webkit.org/show_bug.cgi?id=89784

        Reviewed by James Robinson.

        Previously, we'd only set needs redraw if the old bounds were zero,
        and the new bounds were non-zero, but we should actually have 
        checked that the old bounds were non-empty.

        * tests/LayerChromiumTest.cpp:

2012-06-26  James Robinson  <jamesr@chromium.org>

        [chromium] Remove dead compositor-related API from GraphicsContext3DPrivate / Extensions3DChromium
        https://bugs.webkit.org/show_bug.cgi?id=89933

        Reviewed by Kenneth Russell.

        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):

2012-06-26  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Fix incorrect #ifdef WEBKIT_IMPLEMENTATION statements
        https://bugs.webkit.org/show_bug.cgi?id=89931

        Reviewed by James Robinson.

        WEBKIT_IMPLEMENTATION is defined as either 0 or 1, so the usage of
        #ifdef or #if have different behavior. There are some places in
        the code that use "#ifdef WEBKIT_IMLPEMENTATION", but they should
        actually be "#if WEBKIT_IMPLEMENTATION". This patch fixes those
        #ifdef statements.

        * public/WebTextRun.h:
        (WebTextRun):
        * public/linux/WebFontRenderStyle.h:

2012-06-26  Jun Mukai  <mukai@chromium.org>

        Allow using <input type="color"> UI in ChromeOS.
        https://bugs.webkit.org/show_bug.cgi?id=89944

        Reviewed by Kent Tamura.

        http://crrev.com/144111 adds the UI of <input type="color"> for
        ChromeOS, so now we can set its flag too.

        * features.gypi:

2012-06-25  Ryosuke Niwa  <rniwa@webkit.org>

        Get rid of firstItem and nextItem from HTMLCollection
        https://bugs.webkit.org/show_bug.cgi?id=89923

        Reviewed by Andreas Kling.

        Re-implement WebNodeCollection::firstItem() and WebNodeCollection::nextItem() in WebKit code
        because we got rid of it from WebCore implementation.

        This is an extremely poor API and we shouldn't be exposing it in the future.

        * public/WebNodeCollection.h:
        (WebKit::WebNodeCollection::WebNodeCollection):
        (WebNodeCollection):
        * src/WebNodeCollection.cpp:
        (WebKit::WebNodeCollection::nextItem):
        (WebKit::WebNodeCollection::firstItem):
        * src/WebPageSerializerImpl.cpp:
        (WebKit::WebPageSerializerImpl::collectTargetFrames):

2012-06-25  Luke Macpherson  <macpherson@chromium.org>

        Add runtime flag to enable/disable CSS variables (in addition to existing compile-time flag).
        https://bugs.webkit.org/show_bug.cgi?id=89542

        Reviewed by Dimitri Glazkov.

        * features.gypi:
        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setExperimentalCSSVariablesEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-25  Adrienne Walker  <enne@google.com>

        [chromium] Add WebPluginScrollbar and WebPluginScrollbarClient stub implementations
        https://bugs.webkit.org/show_bug.cgi?id=89928

        Reviewed by Darin Fisher.

        These classes are just typedef'd to be the non-Plugin version. The
        next step is to change Chromium to use the Plugin version, then move
        most of WebPluginScrollbar to a WebScrollbar in Platform to separate
        out the base functionality, while providing the same top level API.

        * WebKit.gyp:
        * public/WebPluginScrollbar.h: Added.
        (WebKit):
        * public/WebPluginScrollbarClient.h: Added.
        (WebKit):

2012-06-25  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-25  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r121206.
        http://trac.webkit.org/changeset/121206
        https://bugs.webkit.org/show_bug.cgi?id=89935

        [chromium] webkit_unit_tests
        WebViewTest.MHTMLWithMissingResourceFinishesLoading crash
        (Requested by ukai on #webkit).

        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (WebKit::FrameTestHelpers::registerMockedURLLoad):
        (WebKit::FrameTestHelpers::createWebViewAndLoad):
        * tests/FrameTestHelpers.h:
        (FrameTestHelpers):
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/WebFrameTest.cpp:
        (WebKit::WebFrameTest::registerMockedHttpURLLoad):
        (WebKit::WebFrameTest::registerMockedChromeURLLoad):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):
        (WebKit::WebViewTest::testAutoResize):
        (WebKit::WebViewTest::testTextInputType):

2012-06-25  Adam Barth  <abarth@webkit.org>

        [Chromium] Let the embedder override the max page scale factor set by the page
        https://bugs.webkit.org/show_bug.cgi?id=89406

        Reviewed by James Robinson.

        Chrome on Android has an option to force the web site to allow page
        scaling (for accessibility). This patch adds
        WebView::setIgnoreViewportTagMaximumScale, which instructs the WebView
        to ignore the maximum scale factor supplied by by the page in the
        viewport meta tag.

        This patch is a bit different from how this is implemented on the
        chromium-android branch, but I'll clean up the branch once this patch
        lands.

        * public/WebView.h:
        (WebView):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::dispatchViewportPropertiesDidChange):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setIgnoreViewportTagMaximumScale):
        (WebKit):
        * src/WebViewImpl.h:
        (WebViewImpl):
        (WebKit::WebViewImpl::ignoreViewportTagMaximumScale):
        * tests/WebFrameTest.cpp:
        (WebKit::TEST_F):
        (WebKit):

2012-06-25  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r121176.
        http://trac.webkit.org/changeset/121176
        https://bugs.webkit.org/show_bug.cgi?id=89934

        [chromium] browser_tests assert failed:
        FATAL:native_theme_win.cc(1541)] Check failed: false. Invalid
        part: 16 (Requested by ukai on #webkit).

        * src/PlatformSupport.cpp:

2012-06-25  Jay Civelli  <jcivelli@chromium.org>

        Fix progress load reporting for MHTML documents.

        MHTML documents containing references to resources they don't include
        never finish loading.
        https://bugs.webkit.org/show_bug.cgi?id=71859

        Reviewed by Nate Chapin.

        * tests/EventListenerTest.cpp:
        * tests/FrameTestHelpers.cpp:
        (FrameTestHelpers):
        (WebKit::FrameTestHelpers::registerMockedURLLoad):
        (WebKit::FrameTestHelpers::registerMockedURLLoadAsHTML):
        (WebKit::FrameTestHelpers::createWebViewAndLoad):
        * tests/FrameTestHelpers.h:
        (FrameTestHelpers):
        * tests/ListenerLeakTest.cpp:
        (WebKit::ListenerLeakTest::RunTest):
        * tests/WebFrameTest.cpp:
        (WebKit::WebFrameTest::registerMockedHttpURLLoad):
        (WebKit::WebFrameTest::registerMockedChromeURLLoad):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):
        (WebKit::WebViewTest::testAutoResize):
        (WebKit::WebViewTest::testTextInputType):
        (TestWebViewClient):
        (WebKit::TestWebViewClient::TestWebViewClient):
        (WebKit::TestWebViewClient::didStartLoading):
        (WebKit::TestWebViewClient::didStopLoading):
        (WebKit::TestWebViewClient::didChangeLoadProgress):
        (WebKit::TestWebViewClient::loadingStarted):
        (WebKit::TestWebViewClient::loadingStopped):
        (WebKit::TestWebViewClient::loadProgress):
        (WebKit):

2012-06-25  James Robinson  <jamesr@chromium.org>

        [chromium] Use WebGraphicsContext3D in compositor implementation
        https://bugs.webkit.org/show_bug.cgi?id=89700

        Reviewed by Adrienne Walker.

        Updates tests for refactor, mostly by removing unnecessary GraphicsContext3D wrapper around mock contexts.

        * WebKit.gypi:
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::context):
        * src/WebLayerTreeViewImpl.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestAtomicCommit::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommit::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::drawLayersOnCCThread):
        * tests/CCSingleThreadProxyTest.cpp:
        * tests/CCThreadedTest.cpp:
        (WebKitTests::TestHooks::createContext):
        * tests/CCThreadedTest.h:
        (TestHooks):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):
        * tests/CompositorFakeGraphicsContext3D.h: Removed.
        * tests/DrawingBufferChromiumTest.cpp: Removed.
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/FakeGraphicsContext3DTest.cpp:
        (TEST):
        * tests/GraphicsLayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeLayerRendererChromium::FakeLayerRendererChromium):
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (LayerRendererChromiumTest):
        (TEST_F):
        (TEST):
        * tests/TextureCopierTest.cpp:
        * tests/ThrottledTextureUploaderTest.cpp:
        (WebKit::TEST):
        * tests/TiledLayerChromiumTest.cpp:

2012-06-25  Kausalya Madhusudhanan  <kmadhusu@chromium.org>

        [Chromium] Add a chromium-webkit API to create a serializable file system.
        https://bugs.webkit.org/show_bug.cgi?id=89776

        In order to send a DOMFileSystem as part of WebIntent payload data it
        should be serializable. Therefore, I added an API that allows us to
        create serializable file system in chromium code.

        Reviewed by Adam Barth.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::createSerializableFileSystem):
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-06-25  Alpha Lam  <hclam@chromium.org>

        Unreviewed, rolling out r121178.
        http://trac.webkit.org/changeset/121178
        https://bugs.webkit.org/show_bug.cgi?id=89784

        New unit test added is failing on WebKit Linux (dbg)

        * tests/LayerChromiumTest.cpp:

2012-06-25  Alpha Lam  <hclam@chromium.org>

        Unreviewed, rolling out r121129.
        http://trac.webkit.org/changeset/121129
        https://bugs.webkit.org/show_bug.cgi?id=89542

        Chromium ASan failure: crbug.com/134402

        * features.gypi:
        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-25  Alpha Lam  <hclam@chromium.org>

        Roll Chromium DEPS to r144020
        https://bugs.webkit.org/show_bug.cgi?id=89912

        Build fixed now! Unreviewed.

        Rolled DEPS to fix chromium build.
        Patch by Scott Graham <scottmg@chromium.org>.

        * DEPS:

2012-06-25  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Stub out new onSuccess() handler for chromium
        https://bugs.webkit.org/show_bug.cgi?id=89895

        This is the chromium side of a refactor which will
        introduce an onSuccess() method which includes the raw
        SerializedScriptValue to the frontend, so the primaryKey
        injection can happen in the front end, rather than
        the V8 helper process.

        Reviewed by Darin Fisher.

        * public/WebIDBCallbacks.h:
        (WebKit):
        (WebKit::WebIDBCallbacks::onSuccess):
        * src/IDBCallbacksProxy.cpp:
        (WebKit::IDBCallbacksProxy::onSuccess):
        * src/IDBCallbacksProxy.h:
        (IDBCallbacksProxy):
        * src/WebIDBCallbacksImpl.cpp:
        (WebKit::WebIDBCallbacksImpl::onSuccess):
        (WebKit):
        * src/WebIDBCallbacksImpl.h:
        (WebIDBCallbacksImpl):

2012-06-25  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Remove unused backend property accessors
        https://bugs.webkit.org/show_bug.cgi?id=89893

        Reviewed by Darin Fisher.

        Following the "metadata" API addition in trac.webkit.org/changeset/121059
        per-property accessors can be removed from the Chromium WebKit API.

        * src/WebIDBDatabaseImpl.cpp: Removed name, version, objectStoreNames.
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):
        * src/WebIDBIndexImpl.cpp: Removed name, keyPath, unique, multiEntry.
        * src/WebIDBIndexImpl.h:
        (WebIDBIndexImpl):
        * src/WebIDBObjectStoreImpl.cpp: Removed name, keyPath, autoIncrement, indexNames.
        * src/WebIDBObjectStoreImpl.h:
        (WebIDBObjectStoreImpl):

2012-06-25  Ian Vollick  <vollick@chromium.org>

        [chromium] Layer chromium should need a redraw after getting its first non-empty bounds.
        https://bugs.webkit.org/show_bug.cgi?id=89784

        Reviewed by James Robinson.

        Previously, we'd only set needs redraw if the old bounds were zero,
        and the new bounds were non-zero, but we should actually have 
        checked that the old bounds were non-empty.

        * tests/LayerChromiumTest.cpp:

2012-06-25  Scott Graham  <scottmg@chromium.org>

        Plumb Scrollbar button dimensions down to WebThemeEngine
        https://bugs.webkit.org/show_bug.cgi?id=89264

        Reviewed by James Robinson.

        Rather than making the height of the scrollbar buttons the same as the
        width of the scrollbar, delegate to the WebThemeEngine. This allows
        matching the Aura theme rather than the standard Windows theme.

        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getThemePartSize):
        (WebCore):

2012-06-25  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] RenderPass textures are evicted at the end of every frame
        https://bugs.webkit.org/show_bug.cgi?id=89786

        Reviewed by Adrienne Walker.

        Added unit tests to verify large textures are staying in memory
        and available for render pass optimization.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-25  Kinuko Yasuda  <kinuko@chromium.org>

        Heap-use-after-free in WebKit::MainThreadFileSystemCallbacks
        https://bugs.webkit.org/show_bug.cgi?id=87019

        Reviewed by David Levin.

        Should not access the CallbacksBridge's member field after it's freed.

        * src/WorkerFileSystemCallbacksBridge.cpp:
        (WebKit::WorkerFileSystemCallbacksBridge::cleanUpAfterCallback):

2012-06-24  Luke Macpherson  <macpherson@chromium.org>

        Add runtime flag to enable/disable CSS variables (in addition to existing compile-time flag).
        https://bugs.webkit.org/show_bug.cgi?id=89542

        Reviewed by Dimitri Glazkov.

        * features.gypi:
        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setExperimentalCSSVariablesEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-23  Kwang Yul Seo  <skyul@company100.net>

        [chromium] Return has value, in function returning void
        https://bugs.webkit.org/show_bug.cgi?id=89822

        Reviewed by Adam Barth.

        A followup for r121091.

        * src/WebHistoryItem.cpp:
        (WebKit::WebHistoryItem::setPageScaleFactor):
        * src/WebImageLayer.cpp:
        (WebKit::WebImageLayer::setBitmap):
        * src/WebLayer.cpp:
        (WebKit::WebLayer::setMaskLayer):
        * src/WebOptionElement.cpp:
        (WebKit::WebOptionElement::setValue):
        (WebKit::WebOptionElement::setDefaultSelected):

2012-06-23  Kwang Yul Seo  <skyul@company100.net>

        [chromium] Return has value, in function returning void
        https://bugs.webkit.org/show_bug.cgi?id=89805

        Reviewed by Adam Barth.

        Make WebFrameImpl::replaceSelection not return a value because it is a function returning void.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::replaceSelection):

2012-06-22  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-22  David Grogan  <dgrogan@chromium.org>

        IndexedDB: Avoid infinite loop if we try to encode -1 for leveldb
        https://bugs.webkit.org/show_bug.cgi?id=89625

        Reviewed by Tony Chang.

        * tests/IDBLevelDBCodingTest.cpp:
        (IDBLevelDBCoding::TEST):

2012-06-22  Michael Nordman  <michaeln@google.com>

        [chromium] WebKit API plumbing for applicationCache.abort() 
        https://bugs.webkit.org/show_bug.cgi?id=89792

        Reviewed by Darin Fisher.

        * public/WebApplicationCacheHost.h:
        (WebKit::WebApplicationCacheHost::abort):
        * src/ApplicationCacheHost.cpp:
        (WebCore::ApplicationCacheHost::abort):

2012-06-22  James Robinson  <jamesr@chromium.org>

        [chromium] LayerRendererChromium is not getting visibility messages in single threaded compositing mode.
        https://bugs.webkit.org/show_bug.cgi?id=89045

        Reviewed by Adrienne Walker.

        Based on patch by Michal Mocny <mmocny@google.com>.

        Update various test fixtures and tests to cover scheduling, visibility, and resource allocation changes.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestAbortFrameWhenInvisible):
        (WTF::CCLayerTreeHostTestAbortFrameWhenInvisible::CCLayerTreeHostTestAbortFrameWhenInvisible):
        (WTF::CCLayerTreeHostTestAbortFrameWhenInvisible::beginTest):
        (WTF::CCLayerTreeHostTestAbortFrameWhenInvisible::afterTest):
        (WTF):
        (WTF::TEST_F):
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/CCSchedulerStateMachineTest.cpp:
        (WebCore::TEST):
        * tests/CCTiledLayerTestCommon.h:
        * tests/FakeWebGraphicsContext3D.h:
        (WebKit::FakeWebGraphicsContext3D::FakeWebGraphicsContext3D):
        (FakeWebGraphicsContext3D):
        (WebKit::FakeWebGraphicsContext3D::createTexture):
        * tests/LayerRendererChromiumTest.cpp:
        (TEST_F):
        * tests/TiledLayerChromiumTest.cpp:


2012-06-22  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        [chromium] Notify the document if a plugin accepts touch input events
        https://bugs.webkit.org/show_bug.cgi?id=89769

        Reviewed by Adam Barth.

        The browser sends touch events to webkit only if webkit has any touch-event handlers. So it is
        necessary to notify the document when a plugin starts accepting touch-events so that it can in
        turn tell the browser to send it touch events.

        * public/WebPluginContainer.h:
        (WebPluginContainer):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::setIsAcceptingTouchEvents):
        (WebKit):
        (WebKit::WebPluginContainerImpl::WebPluginContainerImpl):
        (WebKit::WebPluginContainerImpl::~WebPluginContainerImpl):
        * src/WebPluginContainerImpl.h:
        (WebPluginContainerImpl):

2012-06-22  Kenneth Russell  <kbr@google.com>

        Unreviewed, rolling out r121064.
        http://trac.webkit.org/changeset/121064
        https://bugs.webkit.org/show_bug.cgi?id=88268

        Broke Chromium Mac build.

        * public/WebView.h:
        (WebKit):
        (WebView):
        * src/WebLayerTreeView.cpp:
        * src/WebViewImpl.cpp:
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestScrollSimple::layout):
        (WTF::CCLayerTreeHostTestScrollMultipleRedraw::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommitAndDrawFrame):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommit):

2012-06-22  Dave Tu  <dtu@chromium.org>

        [chromium] Expose rendering statistics to WebWidget.
        https://bugs.webkit.org/show_bug.cgi?id=88268

        Reviewed by James Robinson.

        The WebKit side of a basic framework for exposing rendering statistics
        to Chromium's --enable-benchmarking extension.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::renderingStatistics):
        (WebKit):

2012-06-22  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Do not accumulate occlusion from 3d layers on the main thread
        https://bugs.webkit.org/show_bug.cgi?id=89704

        Reviewed by James Robinson.

        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::calcDrawEtc):
        (WebKitTests):
        (CCOcclusionTrackerTestUnsorted3dLayers):
        (WebKitTests::CCOcclusionTrackerTestUnsorted3dLayers::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLargePixelsOccludeInsideClipRect::runMyTest):

2012-06-22  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Snapshot metadata in front end to avoid IPC round-trips
        https://bugs.webkit.org/show_bug.cgi?id=88467

        Reviewed by Tony Chang.

        Add conversions to/from WebCore IDB metadata type and plumbing for routing the
        IDBDatabaseBackendInterface::metadata() call through the public API..

        * WebKit.gyp: New file added.
        * public/WebIDBMetadata.h: Conversion functions.
        (WebCore):
        (WebIDBMetadata):
        * src/IDBDatabaseBackendProxy.cpp: Plumbing.
        (WebKit::IDBDatabaseBackendProxy::metadata):
        (WebKit):
        * src/IDBDatabaseBackendProxy.h: Plumbing.
        (IDBDatabaseBackendProxy):
        * src/WebIDBDatabaseImpl.cpp: Plumbing.
        (WebKit::WebIDBDatabaseImpl::metadata):
        (WebKit):
        * src/WebIDBDatabaseImpl.h: Plumbing.
        (WebKit):
        (WebIDBDatabaseImpl):
        * src/WebIDBMetadata.cpp: Added - conversion functions.
        (WebKit):
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        (WebKit::WebIDBMetadata::operator IDBDatabaseMetadata):

2012-06-22  Fady Samuel  <fsamuel@chromium.org>

        [Chromium] Browser Plugin: Expose advanceFocus to WebKit API so that guests can advance focus of theirs embedders
        https://bugs.webkit.org/show_bug.cgi?id=88827

        Reviewed by Darin Fisher.

        A browser plugin needs to be able to tells its embedder when the guest
        is done tabbing through controls and wants its embedder to advance its
        tab position.

        * public/WebView.h:
        (WebView):
        (WebKit::WebView::advanceFocus):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::advanceFocus):
        (WebKit):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-06-22  Jeff Timanus  <twiz@chromium.org>

        [Chromium] Change implementing a fast-path for copying GPU-accelerated Canvas2D instances to WebGL textures.
        https://bugs.webkit.org/show_bug.cgi?id=86275

        This change adds the necessary plumbing to the various rendering contexts to copy the backing store texture of
        a Canvas2D instance to be copied to a WebGL texture.  The GL_CHROMIUM_copy_texture extension is necessary
        because the backing-store for a GPU-accelerated skia Canvas2D is normally in BGRA format, which is not supported
        by glCopyTexImage.

        Reviewed by Kenneth Russell.

        * DEPS: Rolled chromium to 143630 to fix chromium-linux ews failures.

2012-06-22  Kenneth Russell  <kbr@google.com>

        Unreviewed, rolling out r121025.
        http://trac.webkit.org/changeset/121025
        https://bugs.webkit.org/show_bug.cgi?id=89580

        Caused crash in
        EventHandler.shouldTurnVerticalTicksIntoHorizontal webkit unit
        test on 10.7

        * WebKit.gypi:
        * tests/EventHandlerTest.cpp: Removed.

2012-06-22  Peter Beverloo  <peter@chromium.org>

        [Chromium] Disable c++0x compatibility warnings in JavaScriptCore.gyp when building for Android
        https://bugs.webkit.org/show_bug.cgi?id=88853

        Reviewed by Steve Block.

        The Android exclusions were necessary to fix a gyp generation error, as
        the gcc_version variable wasn't being defined for Android. Remove these
        exceptions when Chromium is able to define the gcc_version variable.

        * WebKit.gyp:
        * WebKitUnitTests.gyp:

2012-06-22  Robert Kroeger  <rjkroege@chromium.org>

        Suppress horizontal conversion of PlatformWheelEvents when hasPreciseScrollingDeltas is true
        https://bugs.webkit.org/show_bug.cgi?id=89580

        WebKit GTK and Chromium Linux force vertical wheel events to
        scroll horizontally when over horizontal scroll bars.  This is
        undesirable for touchpad scrolling with hasPreciseScrollingDeltas() == true.

        Added unit tests to show that
        EventHandler::shouldTurnVerticalTicksIntoHorizontal() is true
        only for PlatformWheelEvents when !hasPreciseScrollingDeltas().

        Reviewed by Adam Barth.

        * WebKit.gypi:
        * tests/EventHandlerTest.cpp: Added.
        (MockScrollbar):
        (MockScrollbar::MockScrollbar):
        (MockScrollbar::~MockScrollbar):
        (MockHitTestResult):
        (MockHitTestResult::MockHitTestResult):
        (MockHitTestResult::scrollbar):
        (MockPlatformWheelEvent):
        (MockPlatformWheelEvent::MockPlatformWheelEvent):
        (EventHandlerTest):
        (EventHandlerTest::EventHandlerTest):
        (EventHandlerTest::externalShouldTurnVerticalTicksIntoHorizontal):
        (TEST):

2012-06-22  Amy Ousterhout  <aousterh@chromium.org>

        Renamed DeviceOrientation to DeviceOrientationData
        https://bugs.webkit.org/show_bug.cgi?id=88663

        Reviewed by Steve Block.

        Updated files to use the renamed DeviceOrientationData instead of DeviceOrientation.
        This change makes DeviceOrientationData consistent with DeviceMotionData.
        
        * public/WebDeviceOrientation.h:
        (WebDeviceOrientation):
        * src/DeviceOrientationClientProxy.cpp:
        (WebKit::DeviceOrientationClientProxy::lastOrientation):
        * src/DeviceOrientationClientProxy.h:
        (DeviceOrientationClientProxy):
        * src/WebDeviceOrientation.cpp:
        (WebKit::WebDeviceOrientation::WebDeviceOrientation):
        (WebKit::WebDeviceOrientation::operator=):
        (WebKit::WebDeviceOrientation::operator PassRefPtr<WebCore::DeviceOrientationData>):
        * src/WebDeviceOrientationController.cpp:
        (WebKit::WebDeviceOrientationController::didChangeDeviceOrientation):

2012-06-22  Joseph Pecoraro  <pecoraro@apple.com>

        Web Inspector: InspectorState::updateCookie should not do JSON serialization if unsupported
        https://bugs.webkit.org/show_bug.cgi?id=89743

        The Chromium port does want InspectorState updates.

        Reviewed by Yury Semikhatsky.

        * src/InspectorClientImpl.h:
        (WebKit::InspectorClientImpl::supportsInspectorStateUpdates):
        * src/WebDevToolsAgentImpl.h:
        (WebKit::WebDevToolsAgentImpl::supportsInspectorStateUpdates):

2012-06-21  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120982.
        http://trac.webkit.org/changeset/120982
        https://bugs.webkit.org/show_bug.cgi?id=89740

        [chromium] ASSERTION FAILED:
        m_allocatedTextureIds.contains(textureId) (Requested by ukai
        on #webkit).

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestVisibilityAndAllocationControlDrawing):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::beginTest):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommitAndDrawFrame):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommit):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::afterTest):
        (WTF):
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/CCSchedulerStateMachineTest.cpp:
        (WebCore::TEST):
        * tests/CCTiledLayerTestCommon.h:
        (WebKitTests::FakeTextureAllocator::createTexture):
        (WebKitTests::FakeTextureAllocator::deleteTexture):
        * tests/FakeWebGraphicsContext3D.h:
        (WebKit::FakeWebGraphicsContext3D::createTexture):
        (FakeWebGraphicsContext3D):
        * tests/LayerRendererChromiumTest.cpp:
        (TEST_F):
        * tests/TiledLayerChromiumTest.cpp:

2012-06-21  James Robinson  <jamesr@chromium.org>

        [chromium] Initialize compositor's visibility state upon initialization
        https://bugs.webkit.org/show_bug.cgi?id=89712

        Reviewed by Adrienne Walker.

        A given WebViewImpl's visibility state might change any number of times before compositing is enabled. If the
        visibility state is not the default (visible) when the compositor is initialized, we need to let it know the
        correct visibility state or it will start ticking uselessly in threaded mode.

        Tested manually, there's no way to create a new WebViewImpl in a non-visible state in a WebKit test that I know
        of.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):

2012-06-21  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        [chromium] Add touch-event support for WebPluginContainerImpl
        https://bugs.webkit.org/show_bug.cgi?id=89089

        Reviewed by Adam Barth.

        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::handleEvent):
        * src/WebPluginContainerImpl.h:
        (WebCore):
        (WebPluginContainerImpl):

2012-06-21  Oli Lan  <olilan@chromium.org>

        Add methods to select between offsets in an editable field.
        https://bugs.webkit.org/show_bug.cgi?id=89098

        Reviewed by Ryosuke Niwa.

        Reviewed by Ryosuke Niwa.

        This adds a new method WebViewImpl::setEditableSelectionOffsets, which
        can be used to select between two character positions in the node
        currently beign edited.

        The offsets are assumed to be relative to the rootEditableElement.
        
        This can be used for IME features that require the ability to manipulate
        the selection, for example on Android where the method InputConnection#setSelection
        is used.

        This method calls a new method Editor::setSelectionOffsets.

        The method works for inputs/textareas (i.e. text form controls) and
        contenteditable nodes, and the new test in WebViewTest tests both these cases.

        * public/WebView.h:
        (WebView):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setEditableSelectionOffsets):
        (WebKit):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/WebViewTest.cpp:
        (WebKit::TEST_F):
        (WebKit):
        * tests/data/content_editable_populated.html: Added.
        * tests/data/input_field_populated.html: Added.

2012-06-19  James Robinson  <jamesr@chromium.org>

        [chromium] LayerRendererChromium is not getting visibility messages in single threaded compositing mode.
        https://bugs.webkit.org/show_bug.cgi?id=89045

        Reviewed by Adrienne Walker.

        Based on patch by Michal Mocny <mmocny@google.com>.

        Update various test fixtures and tests to cover scheduling, visibility, and resource allocation changes.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (CCLayerTreeHostTestAbortFrameWhenInvisible):
        (WTF::CCLayerTreeHostTestAbortFrameWhenInvisible::CCLayerTreeHostTestAbortFrameWhenInvisible):
        (WTF::CCLayerTreeHostTestAbortFrameWhenInvisible::beginTest):
        (WTF::CCLayerTreeHostTestAbortFrameWhenInvisible::afterTest):
        (WTF):
        (WTF::TEST_F):
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/CCSchedulerStateMachineTest.cpp:
        (WebCore::TEST):
        * tests/CCTiledLayerTestCommon.h:
        * tests/FakeWebGraphicsContext3D.h:
        (WebKit::FakeWebGraphicsContext3D::FakeWebGraphicsContext3D):
        (FakeWebGraphicsContext3D):
        (WebKit::FakeWebGraphicsContext3D::createTexture):
        * tests/LayerRendererChromiumTest.cpp:
        (TEST_F):
        * tests/TiledLayerChromiumTest.cpp:


2012-06-21  Mike West  <mkwst@chromium.org>

        [Chromium] Enable CSP_NEXT on the Chromium port.
        https://bugs.webkit.org/show_bug.cgi?id=89683

        Reviewed by Adam Barth.

        Enable CSP 1.1 on the Chromium port. This has zero practical effect,
        as no CSP 1.1 patches have landed yet. But it will. Oh it will.

        * features.gypi: ENABLE_CSP_NEXT=1

2012-06-21  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Implement spec behavior for multiEntry indexes with invalid/duplicate subkeys
        https://bugs.webkit.org/show_bug.cgi?id=86123

        Reviewed by Darin Fisher.

        Add matching isValid() to WebIDBKey to match the one in IDBKey.

        * public/WebIDBKey.h:
        * src/WebIDBKey.cpp:
        (WebKit::WebIDBKey::isValid):
        (WebKit):
        * src/WebIDBKeyRange.cpp:
        (WebKit::WebIDBKeyRange::assign):

2012-06-21  Ian Vollick  <vollick@chromium.org>

        [chromium] Overlays when using the web inspector are blurry with device scale factor > 1
        https://bugs.webkit.org/show_bug.cgi?id=89676

        Reviewed by James Robinson.

        Whenever we construct a GraphicsLayerChromium, make initialize the
        device and page scale factors, if possible.

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::TEST_F):
        (WebKitTests):

2012-06-21  Min Qin  <qinmin@chromium.org>

        remove ENABLE_FULLSCREEN_MEDIA_CONTROL flag
        https://bugs.webkit.org/show_bug.cgi?id=89614

        Reviewed by Eric Carlson.

        Since desktop chrome now has fullscreen button, we don't need this flag anymore

        * features.gypi:

2012-06-20  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Damage tracker is not used without partial swap, causing valid render passes to be removed
        https://bugs.webkit.org/show_bug.cgi?id=89589

        Reviewed by Adrienne Walker.

        Added unit tests to check surface texture caching when partial
        swap is not used.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-20  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120889.
        http://trac.webkit.org/changeset/120889
        https://bugs.webkit.org/show_bug.cgi?id=89630

        [Chromium] webkit_unit_tests didDrawNotCalledOnHiddenLayer
        start failing (Requested by ukai on #webkit).

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-20  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Damage tracker is not used without partial swap, causing valid render passes to be removed
        https://bugs.webkit.org/show_bug.cgi?id=89589

        Reviewed by Adrienne Walker.

        Added unit tests to check surface texture caching when partial
        swap is not used.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-20  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Remove redundant IDBObjectStore.delete() overloads
        https://bugs.webkit.org/show_bug.cgi?id=89587

        Reviewed by Darin Fisher.

        * public/WebIDBObjectStore.h: Add note to remove overload when Chromium is updated.
        (WebIDBObjectStore):
        * src/IDBObjectStoreBackendProxy.cpp: Delete IDBKey overload.
        * src/IDBObjectStoreBackendProxy.h: Delete IDBKey overload.
        (IDBObjectStoreBackendProxy):
        * src/WebIDBObjectStoreImpl.cpp: Delete IDBKey overload.
        * src/WebIDBObjectStoreImpl.h: Delete IDBKey overload.
        (WebIDBObjectStoreImpl):

2012-06-20  Garret Kelly  <gdk@chromium.org>

        Moving cookieEnabled/setCookieEnabled from Page to Settings, and
        exposing through WebSettings.
        https://bugs.webkit.org/show_bug.cgi?id=89545

        Reviewed by Adam Barth.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setCookieEnabled):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-20  Raymes Khoury  <raymes@chromium.org>

        Perform hit-test from correct frame in isRectTopmost()
        https://bugs.webkit.org/show_bug.cgi?id=89492

        Reviewed by Levi Weintraub.

        Hit-testing was being performed from the main frame, which gave the
        incorrect result if the plugin was in a different frame.

        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::isRectTopmost):

2012-06-20  Alexandre Elias  <aelias@google.com>

        [chromium] Support mobile device rotation resizing
        https://bugs.webkit.org/show_bug.cgi?id=86819

        Reviewed by Adam Barth.

        Resizes on a mobile device are caused either by rotation or
        on-screen-keyboard bringup, and need different treatment to remain
        naturally laid out, scaled and scrolled without disorienting the user.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::resize):

2012-06-19  James Robinson  <jamesr@chromium.org>

        [chromium] Separate LayerRenderer initialization from updateLayers
        https://bugs.webkit.org/show_bug.cgi?id=89525

        Reviewed by Adrienne Walker.

        Update tests to call initializeLayerRendererIfNeeded() before calling updateLayers() to reflect what the proxies
        do.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/TiledLayerChromiumTest.cpp:

2012-06-20  Christopher Cameron  <ccameron@chromium.org>

        [chromium] webkit-backface-visibility doesn't work with video
        https://bugs.webkit.org/show_bug.cgi?id=88908

        When determining a contents layer's backface culling, use the parent
        layer's transform and backface-visibility properties. Track which
        layers need this special treatment with useParentBackfaceVisibility
        and setUseParentBackfaceVisibility functions in WebCore::LayerChromium,
        WebKit::WebLayer, and WebCore::CCLayerImpl.

        Reviewed by Adrienne Walker.

        * src/WebLayer.cpp:
            (WebKit::WebLayer::setUseParentBackfaceVisibility):
                Add an accessor to specify that a layer should use its parent's
                backface culling behavior.

2012-06-20  Ian Vollick  <vollick@chromium.org>

        [chromium] Make sure that render surfaces are not pixel doubled with a device scale factor of 2
        https://bugs.webkit.org/show_bug.cgi?id=86882

        Reviewed by Adrienne Walker.

        To ensure that render surfaces are not pixel doubled when device scale factor is
        two, the render surface's owning layer's draw transform is scaled by the
        contents scale (in the same way that the parent matrix is scaled by the device
        scale factor). The transformedLayerRect's dimensions also need to be in pixel
        space. The surface origin transform should not scale, but needs to offset the
        correct number of pixels, and the replica transforms need to be modified to
        account for the scaling.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-20  Joshua Bell  <jsbell@chromium.org>

        Unreviewed build fix.

        * tests/IDBDatabaseBackendTest.cpp:
        (WebCore::MockIDBCallbacks::~MockIDBCallbacks):
        (WebCore::FakeIDBDatabaseCallbacks::~FakeIDBDatabaseCallbacks):

2012-06-20  Joshua Bell  <jsbell@chromium.org>

        [Chromium] IndexedDB: Don't close database if pending connections are in flight
        https://bugs.webkit.org/show_bug.cgi?id=89512

        Reviewed by Tony Chang.

        * tests/IDBDatabaseBackendTest.cpp:
        (MockIDBCallbacks):
        (WebCore::MockIDBCallbacks::create):
        (WebCore::MockIDBCallbacks::MockIDBCallbacks):
        (WebCore):
        (FakeIDBDatabaseCallbacks):
        (WebCore::FakeIDBDatabaseCallbacks::create):
        (WebCore::FakeIDBDatabaseCallbacks::FakeIDBDatabaseCallbacks):
        (WebCore::TEST):

2012-06-20  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Remove redundant #includes in compositor
        https://bugs.webkit.org/show_bug.cgi?id=89503

        Reviewed by Adrienne Walker.

        Minor adjustments to #include statements to remove
        dependencies. No new tests.

        * src/WebCompositorImpl.cpp:
        * src/WebLayerTreeView.cpp:
        * tests/CCLayerTestCommon.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/CCTiledLayerImplTest.cpp:
        * tests/ImageLayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-06-20  Hans Wennborg  <hans@chromium.org>

        Speech JavaScript API: add SpeechRecognition.maxAlternatives attribute
        https://bugs.webkit.org/show_bug.cgi?id=89459

        Reviewed by Eric Seidel.

        Plumbing for the maxAlternatives attribute.

        * public/WebSpeechRecognitionParams.h:
        (WebKit::WebSpeechRecognitionParams::WebSpeechRecognitionParams):
        (WebKit::WebSpeechRecognitionParams::maxAlternatives):
        (WebSpeechRecognitionParams):
        * src/SpeechRecognitionClientProxy.cpp:
        (WebKit::SpeechRecognitionClientProxy::start):
        * src/SpeechRecognitionClientProxy.h:
        (SpeechRecognitionClientProxy):

2012-06-20  Hironori Bono  <hbono@chromium.org>

        [chromium] Select the marker range when right-clicking on a marker.
        https://bugs.webkit.org/show_bug.cgi?id=89331

        Reviewed by Hajime Morita.

        Chromium always selects only one word when right-clicking on a spelling marker.
        This prevents selecting whole region specified by a marker if the marker
        consists of two or more words. This change retrieves a range coverted by a
        marker and select the range. This emulates the behavior of Mac Chromium and it
        does not need any workarounds for Mac.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):

2012-06-19  Kenneth Russell  <kbr@google.com>

        Unreviewed, rolling out r120772.
        http://trac.webkit.org/changeset/120772
        https://bugs.webkit.org/show_bug.cgi?id=89503

        Broke build on Chromium Mac

        * src/WebCompositorImpl.cpp:
        * src/WebLayerTreeView.cpp:
        * tests/CCLayerTestCommon.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/CCTiledLayerImplTest.cpp:
        * tests/ImageLayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-06-19  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Remove redundant #includes in compositor
        https://bugs.webkit.org/show_bug.cgi?id=89503

        Reviewed by Adrienne Walker.

        Minor adjustments to #include statements to remove
        dependencies. No new tests.

        * src/WebCompositorImpl.cpp:
        * src/WebLayerTreeView.cpp:
        * tests/CCLayerTestCommon.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        * tests/CCQuadCullerTest.cpp:
        * tests/CCTiledLayerImplTest.cpp:
        * tests/ImageLayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:

2012-06-19  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Add new type (and chromium webkit API) for metadata snapshot
        https://bugs.webkit.org/show_bug.cgi?id=88678

        Reviewed by Darin Fisher.

        * WebKit.gyp:
        * public/WebIDBDatabase.h:
        (WebKit::WebIDBDatabase::metadata):
        * public/WebIDBKeyPath.h:
        (WebIDBKeyPath):
        (WebKit::WebIDBKeyPath::WebIDBKeyPath):
        (WebKit::WebIDBKeyPath::~WebIDBKeyPath):
        (WebKit::WebIDBKeyPath::operator=): Used by Chromium backend.
        * public/WebIDBMetadata.h: Added new type.
        (WebKit):
        (WebIDBMetadata):
        (WebKit::WebIDBMetadata::WebIDBMetadata):
        (ObjectStore):
        (WebKit::WebIDBMetadata::ObjectStore::ObjectStore):
        (Index):
        (WebKit::WebIDBMetadata::Index::Index):
        * src/WebIDBKeyPath.cpp: Conform to normal WebXXX patern.
        (WebKit::WebIDBKeyPath::assign):
        (WebKit):
        (WebKit::WebIDBKeyPath::reset):

2012-06-19  Amy Ousterhout  <aousterh@chromium.org>

        [Chromium] Style Fix in WebDeviceOrientationController
        https://bugs.webkit.org/show_bug.cgi?id=89337

        Reviewed by Steve Block.

        Changing a local variable from a PassRefPtr to a RefPtr in order to be consistent with the style guide.

        * src/WebDeviceOrientationController.cpp:
        (WebKit::WebDeviceOrientationController::didChangeDeviceOrientation):

2012-06-19  Peter Wang  <peter.wang@torchmobile.com.cn>

        Remove the function ScriptDebugServer::supportsNativeBreakpoints()
        https://bugs.webkit.org/show_bug.cgi?id=88759

        Reviewed by Pavel Feldman.

        * src/js/DevTools.js:

2012-06-19  Yury Semikhatsky  <yurys@chromium.org>

        [Chromium] Web Inspector: remove unnecessary indirection from message loop instrumentation
        https://bugs.webkit.org/show_bug.cgi?id=89443

        Removed start/stopMainThreadMonitoring methods from WebDevToolsAgentClient
        and WebDevToolsAgentImpl. The functionality is now implemented inside
        InspectorClientImpl.

        Reviewed by Vsevolod Vlasov.

        * public/WebDevToolsAgentClient.h:
        * src/InspectorClientImpl.cpp:
        (WebKit::InspectorClientImpl::clearBrowserCookies):
        (WebKit::InspectorClientImpl::startMainThreadMonitoring):
        (WebKit::InspectorClientImpl::stopMainThreadMonitoring):
        (WebKit::InspectorClientImpl::willProcessTask):
        (WebKit):
        (WebKit::InspectorClientImpl::didProcessTask):
        * src/InspectorClientImpl.h:
        (InspectorClientImpl):
        * src/WebDevToolsAgentImpl.cpp:
        * src/WebDevToolsAgentImpl.h:
        (WebDevToolsAgentImpl):

2012-06-19  Mike West  <mkwst@chromium.org>

        Introduce ENABLE_CSP_NEXT configuration flag.
        https://bugs.webkit.org/show_bug.cgi?id=89300

        Reviewed by Adam Barth.

        The 1.0 draft of the Content Security Policy spec is just about to
        move to Last Call. We'll hide work on the upcoming 1.1 spec behind
        this ENABLE flag, disabled by default.

        Spec: https://dvcs.w3.org/hg/content-security-policy/raw-file/tip/csp-specification.dev.html

        * features.gypi:

2012-06-19  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120586.
        http://trac.webkit.org/changeset/120586
        https://bugs.webkit.org/show_bug.cgi?id=89444

        doesn't fix mac issue (Requested by morrita on #webkit).

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::replaceMisspelledRange):

2012-06-19  Mike West  <mkwst@chromium.org>

        Add a scheme registry for bypassing Content Security Policy.
        https://bugs.webkit.org/show_bug.cgi?id=89373

        Reviewed by Adam Barth.

        * public/WebSecurityPolicy.h:
        (WebSecurityPolicy):
        * src/WebSecurityPolicy.cpp:
        (WebKit::WebSecurityPolicy::registerURLSchemeAsBypassingContentSecurityPolicy):
        (WebKit):

2012-06-18  Adam Barth  <abarth@webkit.org>

        [Chromium] GesturePinchBegin and friends are gesture events
        https://bugs.webkit.org/show_bug.cgi?id=89398

        Reviewed by James Robinson.

        * public/WebInputEvent.h:
        (WebKit::WebInputEvent::isGestureEventType):

2012-06-18  Amy Ousterhout  <aousterh@chromium.org>

        [Chromium] DeviceOrientation Cleanup
        https://bugs.webkit.org/show_bug.cgi?id=89354

        Reviewed by Kent Tamura.

        * public/WebDeviceOrientation.h: added const-qualifiers to getters, simplified an overly-complicated parameter to two functions
        (WebKit::WebDeviceOrientation::isNull):
        (WebKit::WebDeviceOrientation::canProvideAlpha):
        (WebKit::WebDeviceOrientation::alpha):
        (WebKit::WebDeviceOrientation::canProvideBeta):
        (WebKit::WebDeviceOrientation::beta):
        (WebKit::WebDeviceOrientation::canProvideGamma):
        (WebKit::WebDeviceOrientation::gamma):
        (WebKit::WebDeviceOrientation::canProvideAbsolute):
        (WebKit::WebDeviceOrientation::absolute):
        (WebDeviceOrientation):
        * public/WebDeviceOrientationClient.h: added WEBKIT_ASSERT_NOT_REACHED to virtual functions
        (WebKit::WebDeviceOrientationClient::setController):
        (WebKit::WebDeviceOrientationClient::startUpdating):
        (WebKit::WebDeviceOrientationClient::stopUpdating):
        (WebKit::WebDeviceOrientationClient::lastOrientation):
        * public/WebDeviceOrientationClientMock.h: added OVERRIDE specifier for virtual functions
        (WebDeviceOrientationClientMock):
        * src/DeviceOrientationClientProxy.h: designated functions as 'virtual' and added OVERRIDE specifier
        (DeviceOrientationClientProxy):
        * src/WebDeviceOrientation.cpp: simplified overly-complicated parameter to two functions 
        (WebKit::WebDeviceOrientation::WebDeviceOrientation):
        (WebKit::WebDeviceOrientation::operator=):

2012-06-18  Ami Fischman  <fischman@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-14  James Robinson  <jamesr@chromium.org>

        [chromium] Use WebImageLayer in GraphicsLayerChromium for image layers
        https://bugs.webkit.org/show_bug.cgi?id=89150

        Reviewed by Adrienne Walker.

        Implementation of WebImageLayer. Note: This could (should?) live in WebCore/platform/chromium/support/, but it's
        here to be next to the other Web*Layer.cpp implementation files.

        * WebKit.gyp:
        * src/WebImageLayer.cpp: Added.
        (WebKit):
        (WebKit::WebImageLayer::create):
        (WebKit::WebImageLayer::WebImageLayer):
        (WebKit::WebImageLayer::setBitmap):

2012-06-14  James Robinson  <jamesr@chromium.org>

        [chromium] GraphicsLayerChromium should use WebContentLayer directly
        https://bugs.webkit.org/show_bug.cgi?id=89145

        Reviewed by Adrienne Walker.

        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::paintContents):
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTestMainThreadTypes::createLayer):
        * tests/OpaqueRectTrackingContentLayerDelegateTest.cpp:
        (WebCore):
        (WebCore::OpaqueRectTrackingContentLayerDelegateTest::OpaqueRectTrackingContentLayerDelegateTest):
        (WebCore::OpaqueRectTrackingContentLayerDelegateTest::canvasRect):
        (WebCore::TEST_F):
        * tests/WebLayerTest.cpp:

2012-06-18  Ilya Sherman  <isherman@chromium.org>

        [Chromium] Ensure layout has happened before calling into hasNonEmptyBoundingBox()
        Also update existing code to use updateLayoutIgnorePendingStylesheets()
        https://bugs.webkit.org/show_bug.cgi?id=89258

        Reviewed by James Robinson.

        * src/WebNode.cpp:
        (WebKit::WebNode::isFocusable): Use updateLayoutIgnorePendingStylesheets()
        (WebKit::WebNode::hasNonEmptyBoundingBox): Force layout before checking the bounding box

2012-06-18  Ian Vollick  <vollick@chromium.org>

        [chromium] Ensure that skipping frames during an accelerated animation doesn't cause starvation
        https://bugs.webkit.org/show_bug.cgi?id=87766

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF):
        (CCLayerTreeHostTestCheckerboardDoesNotStarveDraws):
        (WTF::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws):
        (WTF::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws::beginTest):
        (WTF::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws::afterTest):
        (WTF::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws::animateLayers):
        (WTF::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestCheckerboardDoesNotStarveDraws::prepareToDrawOnCCThread):
        (WTF::TEST_F):
        * tests/CCSchedulerStateMachineTest.cpp:
        (WebCore::TEST):
        (WebCore):
        * tests/CCThreadedTest.cpp:
        (WebKitTests::MockLayerTreeHostImpl::prepareToDraw):
        * tests/CCThreadedTest.h:
        (WebKitTests::TestHooks::prepareToDrawOnCCThread):

2012-06-18  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium] Change back "linuxish" to "linux" and include WebFontRendering.cpp on Android
        https://bugs.webkit.org/show_bug.cgi?id=89228

        Reviewed by Tony Chang.

        * WebKit.gyp:
        * public/linux/WebFontRendering.h:
        (WebKit):
        (WebFontRendering):
        * public/linuxish/WebFontRendering.h: Removed.
        * src/linux/WebFontRendering.cpp: Renamed from Source/WebKit/chromium/src/linuxish/WebFontRendering.cpp.
        (WebKit):
        (WebKit::WebFontRendering::setHinting):
        (WebKit::WebFontRendering::setAutoHint):
        (WebKit::WebFontRendering::setUseBitmaps):
        (WebKit::WebFontRendering::setAntiAlias):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):
        (WebKit::WebFontRendering::setLCDOrder):
        (WebKit::WebFontRendering::setLCDOrientation):

2012-06-18  Hironori Bono  <hbono@chromium.org>

        [chromium] Spellchecker should show suggestions only when right-clicking a misspelled word.
        https://bugs.webkit.org/show_bug.cgi?id=89331

        Reviewed by Hajime Morita.

        When a selection includes two or more misspelled words, it is not so easy to
        select one word from them and to show its suggestions. To avoid this problem,
        this change shows suggestions only when the selection is collapsed. For this
        case, we can use Range::setStart and setEnd to convert a DocumentMarker to a
        Range.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Added a check that the selection is collapsed.
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::replaceMisspelledRange): Added a check that the selection is collapsed. Also, use Range::setStart() and Range::setEnd() to get the marker range to emulate the behavior of DocumentMarker::markersInRange().

2012-06-14  Kinuko Yasuda  <kinuko@chromium.org>

        [chromium] Cleanup: remove PlatformSupport::createAsyncFileSystem as it's no longer used
        https://bugs.webkit.org/show_bug.cgi?id=89083

        Reviewed by Kentaro Hara.

        * src/PlatformSupport.cpp:

2012-06-15  Kinuko Yasuda  <kinuko@chromium.org>

        XHR_RESPONSE_BLOB is not enabled on some platforms
        https://bugs.webkit.org/show_bug.cgi?id=88859

        Reviewed by Adam Barth.

        Removing XHR_RESPONSE_BLOB since the current implementation has
        no platform-specific part.

        * src/PlatformSupport.cpp:
        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enableXHRResponseBlob):
        (WebKit::WebRuntimeFeatures::isXHRResponseBlobEnabled):

2012-06-17  MORITA Hajime  <morrita@google.com>

        Unreviewed build fix.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-17  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Compositor should avoid drawing quads when cached textures are available and contents unchanged
        https://bugs.webkit.org/show_bug.cgi?id=88482

        Reviewed by Adrienne Walker.

        Added tests to verify quad removal algorithm. Added infrastructure
        code to generate custom render passes out of a script encoded as C
        string.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerImplTest.cpp:
        (WebCore):
        (WebCore::TEST):
        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-16  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] Make the deviceScaleFactor dynamically adjustable.
        https://bugs.webkit.org/show_bug.cgi?id=88916

        Reviewed by James Robinson.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCSettings): Removed unused
        static deviceScaleFactor.
        (WebKit::WebLayerTreeView::setDeviceScaleFactor):
        (WebKit):
        (WebKit::WebLayerTreeView::deviceScaleFactor):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setDeviceScaleFactor): Push the dynamic deviceScaleFactor
        to the compositor as required.
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * tests/CCLayerTreeHostTest.cpp: Tests use dynamic setDeviceScaleFactor.
        (WTF::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers):
        (WTF::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::beginTest):
        (WTF::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::commitCompleteOnCCThread):

2012-06-16  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120536.
        http://trac.webkit.org/changeset/120536
        https://bugs.webkit.org/show_bug.cgi?id=89296

        Does not compile on chromium-linux (Requested by abarth on
        #webkit).

        * WebKit.gyp:
        * public/linux/WebFontRendering.h:
        * public/linuxish/WebFontRendering.h: Renamed from Source/WebKit/chromium/public/WebFontRendering.h.
        (WebKit):
        (WebFontRendering):
        * src/linuxish/WebFontRendering.cpp: Renamed from Source/WebKit/chromium/src/WebFontRendering.cpp.
        (WebKit):
        (WebKit::WebFontRendering::setHinting):
        (WebKit::WebFontRendering::setAutoHint):
        (WebKit::WebFontRendering::setUseBitmaps):
        (WebKit::WebFontRendering::setAntiAlias):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):
        (WebKit::WebFontRendering::setLCDOrder):
        (WebKit::WebFontRendering::setLCDOrientation):

2012-06-16  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120539.
        http://trac.webkit.org/changeset/120539
        https://bugs.webkit.org/show_bug.cgi?id=89295

        Does not compile on chromium-mac (Requested by abarth on
        #webkit).

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerImplTest.cpp:
        (WebCore):
        (WebCore::TEST):
        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-16  Zeev Lieber  <zlieber@chromium.org>

        [Chromium] Compositor should avoid drawing quads when cached textures are available and contents unchanged
        https://bugs.webkit.org/show_bug.cgi?id=88482

        Reviewed by Adrienne Walker.

        Added tests to verify quad removal algorithm. Added infrastructure
        code to generate custom render passes out of a script
        encoded as C string.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):
        * tests/CCLayerImplTest.cpp:
        (WebCore):
        (WebCore::TEST):
        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-16  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium] Move chromium/public/linuxish/WebFontRendering.h out of linuxish directory
        https://bugs.webkit.org/show_bug.cgi?id=89228

        Reverse dependency originally from WebCore::FontPlatformDataHarfBuzz to WebKit::WebFontRendering
        so that WebKit::WebFontRendering can be platform-independent.

        This also avoids the ambiguous name 'linuxish'.

        Reviewed by Tony Chang.

        * WebKit.gyp:
        * public/WebFontRendering.h: Copied from Source/WebKit/chromium/public/linuxish/WebFontRendering.h. Added getters under WEBKIT_IMPLEMENTATION.
        (WebFontRendering):
        * public/linux/WebFontRendering.h:
        * public/linuxish: Removed.
        * public/linuxish/WebFontRendering.h: Removed.
        * src/WebFontRendering.cpp: Copied from Source/WebKit/chromium/src/linuxish/WebFontRendering.cpp. Changed setters to be independent of platform-dependent implementation and added getters.
        (WebKit):
        (WebKit::WebFontRendering::setHinting):
        (WebKit::WebFontRendering::hinting):
        (WebKit::WebFontRendering::setAutoHint):
        (WebKit::WebFontRendering::autoHint):
        (WebKit::WebFontRendering::setUseBitmaps):
        (WebKit::WebFontRendering::useBitmaps):
        (WebKit::WebFontRendering::setAntiAlias):
        (WebKit::WebFontRendering::antiAlias):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::subpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):
        (WebKit::WebFontRendering::subpixelPositioning):
        * src/linuxish: Removed.
        * src/linuxish/WebFontRendering.cpp: Removed.

2012-06-16  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-16  Dan Alcantara  <dfalcantara@chromium.org>

        [chromium] WebFrameClient::userAgentOverride() should take in a WebFrame* as its first argument
        https://bugs.webkit.org/show_bug.cgi?id=89233

        Reviewed by Darin Fisher.

        Adds a WebFrame* to the WebFrameClient::userAgentOverride() function.

        * public/WebFrameClient.h:
        (WebKit::WebFrameClient::userAgentOverride):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::userAgent):
        * tests/FrameLoaderClientImplTest.cpp:

2012-06-15  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120511.
        http://trac.webkit.org/changeset/120511
        https://bugs.webkit.org/show_bug.cgi?id=89255

        Breaks at least Android builder (Requested by wangxianzhu on
        #webkit).

        * WebKit.gyp:
        * public/linux/WebFontRendering.h:
        * public/linuxish/WebFontRendering.h: Renamed from Source/WebKit/chromium/public/WebFontRendering.h.
        (WebKit):
        (WebFontRendering):
        * src/linuxish/WebFontRendering.cpp: Renamed from Source/WebKit/chromium/src/WebFontRendering.cpp.
        (WebKit):
        (WebKit::WebFontRendering::setHinting):
        (WebKit::WebFontRendering::setAutoHint):
        (WebKit::WebFontRendering::setUseBitmaps):
        (WebKit::WebFontRendering::setAntiAlias):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):
        (WebKit::WebFontRendering::setLCDOrder):
        (WebKit::WebFontRendering::setLCDOrientation):

2012-06-15  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium] Move chromium/public/linuxish/WebFontRendering.h out of linuxish directory
        https://bugs.webkit.org/show_bug.cgi?id=89228

        Reverse dependency originally from WebCore::FontPlatformDataHarfBuzz to WebKit::WebFontRendering
        so that WebKit::WebFontRendering can be platform-independent.

        This also avoids the ambiguous name 'linuxish'.

        Reviewed by Tony Chang.

        * WebKit.gyp:
        * public/WebFontRendering.h: Copied from Source/WebKit/chromium/public/linuxish/WebFontRendering.h. Added getters under WEBKIT_IMPLEMENTATION.
        (WebFontRendering):
        * public/linux/WebFontRendering.h:
        * public/linuxish: Removed.
        * public/linuxish/WebFontRendering.h: Removed.
        * src/WebFontRendering.cpp: Copied from Source/WebKit/chromium/src/linuxish/WebFontRendering.cpp. Changed setters to be independent of platform-dependent implementation and added getters.
        (WebKit):
        (WebKit::WebFontRendering::setHinting):
        (WebKit::WebFontRendering::hinting):
        (WebKit::WebFontRendering::setAutoHint):
        (WebKit::WebFontRendering::autoHint):
        (WebKit::WebFontRendering::setUseBitmaps):
        (WebKit::WebFontRendering::useBitmaps):
        (WebKit::WebFontRendering::setAntiAlias):
        (WebKit::WebFontRendering::antiAlias):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::subpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):
        (WebKit::WebFontRendering::subpixelPositioning):
        * src/linuxish: Removed.
        * src/linuxish/WebFontRendering.cpp: Removed.

2012-06-15  Tony Chang  <tony@chromium.org>

        [chromium] Remove WebKit/chromium/public/gtk/WebFontInfo.h since it's no longer referenced.
        https://bugs.webkit.org/show_bug.cgi?id=89251

        Reviewed by Adam Barth.

        This was a forwarding header when we moved the file to public/linux.

        * public/gtk/WebFontInfo.h: Removed.

2012-06-15  Bill Budge  <bbudge@chromium.org>

        AssociatedURLLoader should allow trusted clients to read all headers, not just exposed ones.
        https://bugs.webkit.org/show_bug.cgi?id=89185

        Reviewed by Adam Barth.

        This change adds an option to turn off whitelist filtering of response headers for CORS loads,
        and modifies AssociatedURLLoader check for that before filtering.

        * public/WebURLLoaderOptions.h:
        (WebKit::WebURLLoaderOptions::WebURLLoaderOptions):
        (WebURLLoaderOptions):
        * src/AssociatedURLLoader.cpp:
        (WebKit::AssociatedURLLoader::ClientAdapter::didReceiveResponse):
        * tests/AssociatedURLLoaderTest.cpp:
        (WebKit):
        (WebKit::TEST_F):

2012-06-15  Sami Kyostila  <skyostil@chromium.org>

        [chromium] Allow scrolling non-root layers in the compositor thread
        https://bugs.webkit.org/show_bug.cgi?id=73350

        Reviewed by James Robinson.

        New unit tests to verify layer scrolling behavior and the associated
        utility functions.

        * src/WebCompositorInputHandlerImpl.cpp:
        (WebKit::WebCompositorInputHandlerImpl::handleInputEventInternal):
        (WebKit::WebCompositorInputHandlerImpl::handleGestureFling):
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::MockContentLayerDelegate::paintContents):
        (CCLayerTreeHostTestScrollChildLayer):
        (WTF::CCLayerTreeHostTestScrollChildLayer::CCLayerTreeHostTestScrollChildLayer):
        (WTF::CCLayerTreeHostTestScrollChildLayer::beginTest):
        (WTF::CCLayerTreeHostTestScrollChildLayer::applyScrollAndScale):
        (WTF::CCLayerTreeHostTestScrollChildLayer::beginCommitOnCCThread):
        (WTF::CCLayerTreeHostTestScrollChildLayer::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestScrollChildLayer::afterTest):
        (WTF):
        (WTF::TEST_F):
        * tests/WebCompositorInputHandlerImplTest.cpp:
        (WebKit::TEST_F):

2012-06-15  Hironori Bono  <hbono@chromium.org>

        Allow platforms to choose whether to remove markers on editing
        https://bugs.webkit.org/show_bug.cgi?id=88838

        Reviewed by Hajime Morita.

        This change implements EditorClientImpl::checkGrammarOfString so
        DumpRenderTree can run grammar tests.

        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled): Return true also when unified text-checking is enabled.
        (WebKit::EditorClientImpl::shouldEraseMarkersAfterChangeSelection): ditto.
        (WebKit::EditorClientImpl::checkGrammarOfString): Implement this function with our unified text-checker.

2012-06-14  Kent Tamura  <tkent@chromium.org>

        Support file extensions in HTMLInputElement::accept
        https://bugs.webkit.org/show_bug.cgi?id=88298

        Reviewed by Hajime Morita.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::runOpenPanel):
        Use FileChooserSettings::acceptTypes() to get both of MIME types and file extensions.

2012-06-14  Kaustubh Atrawalkar  <kaustubh@motorola.com>

        Remove support for counterValueForElementById from chromium port
        https://bugs.webkit.org/show_bug.cgi?id=88851

        Reviewed by Adam Barth.

        Moved the counterValueForElementById from LayoutTestCotroller to Internals so
        remove the old platform specific implementations as it exclusively tests WebCore functionality.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-06-14  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium-Android] Initialize font rendering in DumpRenderTree
        https://bugs.webkit.org/show_bug.cgi?id=89133

        Reviewed by Adam Barth.

        * src/linuxish/WebFontRendering.cpp:
        (WebKit::WebFontRendering::setSubpixelPositioning): Now calls WebFontInfo::setSubpixelPositioning to avoid API users from calling both and simplify platform differences at call sites.

2012-06-14  Tony Chang  <tony@chromium.org>

        [chromium] Port IFrameRedirectTest.Test from test_shell_tests to webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=89132

        Reviewed by Adam Barth.

        This test is currently in src/webkit/glue/iframe_redirect_unittest.cc
        and uses test_shell's layoutTestController. Moving this will make
        it easier to get rid of layoutTestController in test_shell.

        * tests/WebFrameTest.cpp:
        (WebKit::TEST_F):
        (WebKit):
        * tests/data/iframe_redirect.html: Added.

2012-06-14  David Reveman  <reveman@chromium.org>

        [Chromium] Sub-pixel text rendering is incorrectly used for WebView with transparent background.
        https://bugs.webkit.org/show_bug.cgi?id=89033

        Reviewed by James Robinson.

        Add canvas background argument to PageWidgetDelegate::paint and call
        PlatformCanvasSkia::setDrawingToImageBuffer to ensure that sub-pixel
        rendering is only used when WebView has opaque background.

        * src/PageWidgetDelegate.cpp:
        (WebKit::PageWidgetDelegate::paint):
        * src/PageWidgetDelegate.h:
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::paint):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::paint):

2012-06-14  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] CCLayerTreeHostCommonTest.verifyHitTestingForSingleLayer failing in debug
        https://bugs.webkit.org/show_bug.cgi?id=89065

        Reviewed by James Robinson.

        A debug assertion was being triggered in the hit-testing unit
        tests because I accidentally forgot to set the
        DebugScopedSetImplThread for the tests.

        This patch also re-enables the disabled broken test.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-14  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium] Add setAutoHint() and setUseBitmaps() in WebFontRendering
        https://bugs.webkit.org/show_bug.cgi?id=89014

        Reviewed by James Robinson.

        * public/linuxish/WebFontRendering.h:
        (WebFontRendering):
        * src/linuxish/WebFontRendering.cpp:
        (WebKit):
        (WebKit::WebFontRendering::setAutoHint):
        (WebKit::WebFontRendering::setUseBitmaps):
        (WebKit::WebFontRendering::setAntiAlias):

2012-06-14  Daniel Erat  <derat@chromium.org>

        [chromium/linux] Drop deprecated WebFontRenderStyle::useSubpixel
        https://bugs.webkit.org/show_bug.cgi?id=88263

        Reviewed by Adam Barth.

        This removes the useSubpixel member, which was replaced by
        useSubpixelRendering.  Chrome has been updated to set only the
        useSubpixelRendering field.

        No test updates since the existing behavior shouldn't change.

        * public/linux/WebFontInfo.h:
        (WebFontInfo):
        * public/linux/WebFontRenderStyle.h:
        * src/linux/WebFontInfo.cpp:
        (WebKit::WebFontInfo::renderStyleForStrike):
        * src/linux/WebFontRenderStyle.cpp:
        (WebKit::WebFontRenderStyle::toFontRenderStyle):
        (WebKit::WebFontRenderStyle::setDefaults):

2012-06-14  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] For hit testing in CCLayerTreeHostCommon, need to check that the transform is invertible before inverting it.
        https://bugs.webkit.org/show_bug.cgi?id=89049

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-14  Ian Vollick  <vollick@chromium.org>

        [chromium] Certain settings in CCSettings could be global
        https://bugs.webkit.org/show_bug.cgi?id=88384

        Reviewed by James Robinson.

        * WebKit.gypi:
        * public/WebCompositor.h:
        (WebCompositor):
        * public/WebSettings.h:
        * src/WebCompositorImpl.cpp:
        (WebKit::WebCompositor::shutdown):
        (WebKit):
        (WebKit::WebCompositor::setPerTilePaintingEnabled):
        (WebKit::WebCompositor::setPartialSwapEnabled):
        (WebKit::WebCompositor::setAcceleratedAnimationEnabled):
        * src/WebLayerTreeView.cpp:
        (WebKit):
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):
        * src/WebSettingsImpl.cpp:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF):
        (CCLayerTreeHostTestShortlived1):
        (WTF::CCLayerTreeHostTestShortlived1::CCLayerTreeHostTestShortlived1):
        (WTF::CCLayerTreeHostTestShortlived1::beginTest):
        (WTF::CCLayerTreeHostTestShortlived1::afterTest):
        * tests/CCTestCommon.h: Added.
        (WebKitTests):
        (CCScopedSettings):
        (WebKitTests::CCScopedSettings::CCScopedSettings):
        (WebKitTests::CCScopedSettings::~CCScopedSettings):
        * tests/CCThreadedTest.cpp:
        (WebKitTests::MockLayerTreeHostImpl::create):
        (WebKitTests::MockLayerTreeHostImpl::MockLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (WebKitTests::CCThreadedTest::runTest):
        * tests/CCThreadedTest.h:
        (CCThreadedTest):
        (MockLayerTreeHostImpl):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        * tests/LayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest):
        (TEST_F):
        (TEST):
        * tests/TextureLayerChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/TreeSynchronizerTest.cpp:
        (WebKitTests::TEST):

2012-06-14  James Robinson  <jamesr@chromium.org>

        [chromium] Move opaque rectangle tracking logic out of compositor core
        https://bugs.webkit.org/show_bug.cgi?id=89031

        Reviewed by Adrienne Walker.

        Moves the grayscale/subpixel AA text decision into NonCompositedContentHost and removes one layer of indirection
        betwen NCCH and WVI that existed only for historical reasons.

        Ports the opaque rect tracking tests that were in LayerTextureUpdaterTest to
        OpaquerectTrackingContentLayerDelegateTest to reflect the move in responsibilities.

        * WebKit.gypi:
        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::NonCompositedContentHost):
        (WebKit::NonCompositedContentHost::setOpaque):
        (WebKit::NonCompositedContentHost::paintContents):
        * src/NonCompositedContentHost.h:
        (WebCore):
        (WebKit):
        (WebKit::NonCompositedContentHost::create):
        (NonCompositedContentHost):
        * src/WebContentLayerImpl.cpp:
        (WebKit::WebContentLayerImpl::paintContents):
        * src/WebContentLayerImpl.h:
        (WebContentLayerImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::paintRootLayer):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TestOpacityChangeLayerDelegate::paintContents):
        (WTF::MockContentLayerDelegate::paintContents):
        * tests/LayerChromiumTest.cpp:
        * tests/LayerTextureUpdaterTest.cpp: Removed.
        * tests/OpaqueRectTrackingContentLayerDelegateTest.cpp: Added.
        (WebCore):
        (PaintCallback):
        (TestLayerPainterChromium):
        (WebCore::TestLayerPainterChromium::TestLayerPainterChromium):
        (WebCore::PaintFillAlpha::operator()):
        (WebCore::PaintFillPartialOpaque::PaintFillPartialOpaque):
        (PaintFillPartialOpaque):
        (WebCore::PaintFillPartialOpaque::operator()):
        (OpaqueRectTrackingContentLayerDelegateTest):
        (WebCore::OpaqueRectTrackingContentLayerDelegateTest::OpaqueRectTrackingContentLayerDelegateTest):
        (WebCore::OpaqueRectTrackingContentLayerDelegateTest::skCanvas):
        (WebCore::OpaqueRectTrackingContentLayerDelegateTest::canvasRect):
        (WebCore::TEST_F):

2012-06-14  Justin Novosad  <junov@chromium.org>

        [Chromium] webkitImageSmoothingEnabled canvas property does not work on redraw
        https://bugs.webkit.org/show_bug.cgi?id=89018

        Reviewed by Stephen White.

        Rolling chromium DEPS to 141884

        * DEPS:

2012-06-14  Alexander Pavlov  <apavlov@chromium.org>

        [Chromium] Unreviewed, build fix for Mac 10.5

        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::DeviceMetricsSupport::autoZoomPageToFitWidth):

2012-06-14  Eugene Klyuchnikov  <eustas.bug@gmail.com>

        Web Inspector: Refactor message loop instrumentation.
        https://bugs.webkit.org/show_bug.cgi?id=88978

        Reviewed by Pavel Feldman.

        1) Remove "messageLoop" term
        2) Reuse WebThread::TaskObserver interface
        3) Move implementation (from embedder) to platform code.

        * public/WebDevToolsAgent.h:
        (WebDevToolsAgent):
        * public/WebDevToolsAgentClient.h:
        (WebDevToolsAgentClient):
        (WebKit::WebDevToolsAgentClient::startMainThreadMonitoring): Renamed medthod.
        (WebKit::WebDevToolsAgentClient::stopMainThreadMonitoring): Ditto.
        * src/InspectorClientImpl.cpp:
        (WebKit::InspectorClientImpl::startMainThreadMonitoring): Ditto.
        (WebKit::InspectorClientImpl::stopMainThreadMonitoring): Ditto.
        * src/InspectorClientImpl.h:
        (InspectorClientImpl):
        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::WebDevToolsAgentImpl::startMainThreadMonitoring): Use platform threading.
        (WebKit::WebDevToolsAgentImpl::stopMainThreadMonitoring): Ditto.
        (WebKit::WebDevToolsAgentImpl::willProcessTask): Renamed medthod.
        (WebKit::WebDevToolsAgentImpl::didProcessTask): Ditto.
        * src/WebDevToolsAgentImpl.h:
        (WebDevToolsAgentImpl):
        * src/WebKit.cpp:

2012-06-14  Alexander Pavlov  <apavlov@chromium.org>

        Web Inspector: [Device Metrics] "Fit window" results in duplicate rescaling in WebDevToolsAgentImpl::autoZoomPageToFitWidth()
        https://bugs.webkit.org/show_bug.cgi?id=89092

        Reviewed by Pavel Feldman.

        Do not apply the sizeRatio after it has been applied in scaledEmulatedFrameSize().

        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::DeviceMetricsSupport::autoZoomPageToFitWidth):
        (WebKit::DeviceMetricsSupport::ensureOriginalZoomFactor):

2012-06-14  Yoshifumi Inoue  <yosin@chromium.org>

        [Chromium][Forms] We should remove ENABLE_INPUT_TYPE_TIME=0 and so on to allows us to override them by ~/.gyp/include.gypi
        https://bugs.webkit.org/show_bug.cgi?id=89062

        Reviewed by Kent Tamura.

        This patch removes ENABLE_INPUT_TYPE_*=0 from default entry of feature_defines to
        allows us overriding by ~/.gyp/include.gypi

        * features.gypi: Remove ENABLE_INPUT_TYPE_DATETIME=0, ENABLE_INPUT_TYPE_DATETIMELOCAL=0,
        and so on.

2012-06-14  Min Qin  <qinmin@google.com>

        Remove the const keyword from MediaPlayerPrivate::enterFullscreen()
        https://bugs.webkit.org/show_bug.cgi?id=89044

        Reviewed by Adam Barth.

        enterFullscreen() should be treated similarly as exitFullscreen() as it could alter the player state.
        This reverts the change from r120213.

        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::enterFullscreen):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-06-14  Dan Alcantara  <dfalcantara@chromium.org>

        [chromium] Rename WebFrameClient::userAgent() to better reflect what it does
        https://bugs.webkit.org/show_bug.cgi?id=89028

        Reviewed by Adam Barth.

        Renames WebFrameClient::userAgent() to userAgentOverride() and makes it return
        the user agent override string directly.

        * public/WebFrameClient.h:
        (WebFrameClient):
        (WebKit::WebFrameClient::userAgentOverride):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::userAgent):
        * tests/FrameLoaderClientImplTest.cpp:

2012-06-13  Jesse Greenwald  <jgreenwald@google.com>

        [Chromium] Add WebDocument.images
        https://bugs.webkit.org/show_bug.cgi?id=88837

        Reviewed by Adam Barth.

        This method is needed on Android to support the existing
        WebView.documentHasImages Java API.

        * public/WebDocument.h:
        (WebDocument):
        * src/WebDocument.cpp:
        (WebKit::WebDocument::images):
        (WebKit):

2012-06-13  Dominic Cooney  <dominicc@chromium.org>

        Unreviewed: Disable verifyHitTestingForSingleLayer.
        https://bugs.webkit.org/show_bug.cgi?id=89065

        It is failing on canary debug bots.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120268.
        http://trac.webkit.org/changeset/120268
        https://bugs.webkit.org/show_bug.cgi?id=89060

        WebCompositor::setPerTilePaintingEnabled hits an assertion in
        DEBUG (Requested by dominicc|work on #webkit).

        * WebKit.gypi:
        * public/WebCompositor.h:
        (WebCompositor):
        * public/WebSettings.h:
        * src/WebCompositorImpl.cpp:
        (WebKit::WebCompositor::shutdown):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCSettings):
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setPerTilePaintingEnabled):
        (WebKit):
        (WebKit::WebSettingsImpl::setPartialSwapEnabled):
        (WebKit::WebSettingsImpl::setThreadedAnimationEnabled):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        * tests/CCTestCommon.h: Removed.
        * tests/CCThreadedTest.cpp:
        (WebKitTests::MockLayerTreeHostImpl::create):
        (WebKitTests::MockLayerTreeHostImpl::MockLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (WebKitTests::CCThreadedTest::runTest):
        * tests/CCThreadedTest.h:
        (CCThreadedTest):
        (MockLayerTreeHostImpl):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        * tests/LayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest):
        (TEST_F):
        (TEST):
        * tests/TextureLayerChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/TreeSynchronizerTest.cpp:
        (WebKitTests::TEST):

2012-06-13  Hironori Bono  <hbono@chromium.org>

        [chromium] Add WebFrame::replaceMisspelledRange
        https://bugs.webkit.org/show_bug.cgi?id=88618

        Reviewed by Kent Tamura.

        This change adds WebFrame::replaceMisspelledRange, which replaces the range of a
        misspelled marker with text so Chromium can use it for replacing misspelled
        words with suggetions.

        * public/WebFrame.h:
        (WebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::replaceMisspelledRange):
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):

2012-06-13  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium] Let Android and Linux share WebFontRendering decl/impl.
        https://bugs.webkit.org/show_bug.cgi?id=88802

        Reviewed by Adam Barth.

        * WebKit.gyp:
        * public/linux/WebFontRendering.h: Temporarily forwards to the new file under linuxish.
        * public/linuxish: Added.
        * public/linuxish/WebFontRendering.h: Copied from chromium/public/linux/WebFontRendering.h.
        * src/linux/WebFontRendering.cpp: Removed.
        * src/linuxish: Added.
        * src/linuxish/WebFontRendering.cpp: Copied from chromium/src/linux/WebFontRendering.cpp.

2012-06-13  Ian Vollick  <vollick@chromium.org>

        [chromium] Certain settings in CCSettings could be global
        https://bugs.webkit.org/show_bug.cgi?id=88384

        Reviewed by James Robinson.

        * WebKit.gypi:
        * public/WebCompositor.h:
        (WebCompositor):
        * public/WebSettings.h:
        * src/WebCompositorImpl.cpp:
        (WebKit::WebCompositor::shutdown):
        (WebKit):
        (WebKit::WebCompositor::setPerTilePaintingEnabled):
        (WebKit::WebCompositor::setPartialSwapEnabled):
        (WebKit::WebCompositor::setAcceleratedAnimationEnabled):
        * src/WebLayerTreeView.cpp:
        (WebKit):
        (WebKit::WebLayerTreeView::Settings::operator CCLayerTreeSettings):
        * src/WebSettingsImpl.cpp:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::WebViewImpl):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF):
        (CCLayerTreeHostTestShortlived1):
        (WTF::CCLayerTreeHostTestShortlived1::CCLayerTreeHostTestShortlived1):
        (WTF::CCLayerTreeHostTestShortlived1::beginTest):
        (WTF::CCLayerTreeHostTestShortlived1::afterTest):
        * tests/CCTestCommon.h: Added.
        (WebKitTests):
        (CCScopedSettings):
        (WebKitTests::CCScopedSettings::CCScopedSettings):
        (WebKitTests::CCScopedSettings::~CCScopedSettings):
        * tests/CCThreadedTest.cpp:
        (WebKitTests::MockLayerTreeHostImpl::create):
        (WebKitTests::MockLayerTreeHostImpl::MockLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (WebKitTests::CCThreadedTest::runTest):
        * tests/CCThreadedTest.h:
        (CCThreadedTest):
        (MockLayerTreeHostImpl):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        * tests/LayerChromiumTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (LayerRendererChromiumTest):
        (TEST_F):
        (TEST):
        * tests/TextureLayerChromiumTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/TreeSynchronizerTest.cpp:
        (WebKitTests::TEST):

2012-06-13  Dana Jansens  <danakj@chromium.org>

        [chromium] Assert if iterating an invalid RenderSurfaceLayerList, where a layer in the list has no RenderSurface
        https://bugs.webkit.org/show_bug.cgi?id=89004

        Reviewed by Adrienne Walker.

        * tests/CCLayerIteratorTest.cpp:

2012-06-13  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Implement hit-testing for impl-side input handling in accelerated compositor
        https://bugs.webkit.org/show_bug.cgi?id=88972

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-13  David Reveman  <reveman@chromium.org>

        [Chromium] Crash when WebViewImpl::setIsTransparent is called before the WebLayerTreeView has been initialized.
        https://bugs.webkit.org/show_bug.cgi?id=89013

        Reviewed by James Robinson.

        Add !m_layerTreeView.isNull() check to WebViewImpl::setIsTransparent.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsTransparent):

2012-06-13  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120220.
        http://trac.webkit.org/changeset/120220
        https://bugs.webkit.org/show_bug.cgi?id=89021

        The patch broke build Chromium Win Release (Requested by
        wangxianzhu on #webkit).

        * WebKit.gyp:
        * public/linux/WebFontRendering.h:
        (WebKit):
        (WebFontRendering):
        * public/linuxish/WebFontRendering.h: Removed.
        * src/linux/WebFontRendering.cpp: Renamed from Source/WebKit/chromium/src/linuxish/WebFontRendering.cpp.
        (WebKit):
        (WebKit::WebFontRendering::setHinting):
        (WebKit::WebFontRendering::setAntiAlias):
        (WebKit::WebFontRendering::setSubpixelGlyphs):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):
        (WebKit::WebFontRendering::setLCDOrder):
        (WebKit::WebFontRendering::setLCDOrientation):

2012-06-13  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium] Let Android and Linux share WebFontRendering decl/impl.
        https://bugs.webkit.org/show_bug.cgi?id=88802

        Reviewed by Adam Barth.

        * WebKit.gyp:
        * public/linux/WebFontRendering.h: Temporarily forwards to the new file under linuxish.
        * public/linuxish: Added.
        * public/linuxish/WebFontRendering.h: Copied from chromium/public/linux/WebFontRendering.h.
        * src/linux/WebFontRendering.cpp: Removed.
        * src/linuxish: Added.
        * src/linuxish/WebFontRendering.cpp: Copied from chromium/src/linux/WebFontRendering.cpp.

2012-06-13  Martin Kosiba  <mkosiba@google.com>

        [Chromium] WebFrameImpl::find doesn't work for searching from a selection.
        https://bugs.webkit.org/show_bug.cgi?id=88885

        Reviewed by Adam Barth.

        Remember the active match not just until the seatchText changes but for the entire find session.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::find):
        (WebKit::WebFrameImpl::setFindEndstateFocusAndSelection):

2012-06-13  Peter Beverloo  <peter@chromium.org>

        [Chromium] Fix Clang build with USE(NATIVE_FULLSCREEN_VIDEO)=1
        https://bugs.webkit.org/show_bug.cgi?id=88987

        Reviewed by Simon Hausmann.

        The enterFullscreen method is declared as const by MediaPlayerPrivateInterface,
        so this one should be declared as such as well.

        Patch by Evgeniy Stepanov <eugenis@google.com>

        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::enterFullscreen):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-06-13  MORITA Hajime  <morrita@google.com>

        REGRESSION(r118098): <content> element does not render distributed children when cloned from another document
        https://bugs.webkit.org/show_bug.cgi?id=88148

        Reviewed by Dimitri Glazkov.

        - Added ContextFeaturesClientImpl which implements WebCore::ContextFeaturesClient.
        - Replaced PagePopupFrameLoaderClient with PagePopupFeaturesClient.

        * WebKit.gyp:
        * public/WebPermissionClient.h:
        (WebKit):
        (WebKit::WebPermissionClient::allowWebComponents):
        * src/ContextFeaturesClientImpl.cpp: Renamed from Source/WebCore/bindings/generic/ContextEnabledFeatures.cpp.
        (WebKit):
        (WebKit::ContextFeaturesClientImpl::isEnabled):
        * src/ContextFeaturesClientImpl.h: Renamed from Source/WebCore/bindings/generic/ContextEnabledFeatures.h.
        (WebKit):
        (ContextFeaturesClientImpl):
        (WebKit::ContextFeaturesClientImpl::ContextFeaturesClientImpl):
        (WebKit::ContextFeaturesClientImpl::setPermissionClient):
        * src/FrameLoaderClientImpl.cpp:
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):
        * src/WebPagePopupImpl.cpp:
        (PagePopupFeaturesClient):
        (WebKit::PagePopupFeaturesClient::isEnabled):
        (WebKit):
        (WebKit::WebPagePopupImpl::initPage):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setPermissionClient):
        (WebKit::WebViewImpl::WebViewImpl):
        * src/WebViewImpl.h:
        (WebKit):

2012-06-12  Ian Vollick  <vollick@chromium.org>

        [chromium] Roll chromium rev in DEPS
        https://bugs.webkit.org/show_bug.cgi?id=88934

        Reviewed by James Robinson.

        Rolling to 141410

        * DEPS:

2012-06-12  James Robinson  <jamesr@chromium.org>

        [chromium] Port Canvas2DLayerBridge over to WebExternalTextureLayer
        https://bugs.webkit.org/show_bug.cgi?id=88597

        Reviewed by Adrienne Walker.

        Implementations for new WebExternalTextureLayer APIs, updates test.

        * src/WebExternalTextureLayer.cpp:
        (WebKit::WebExternalTextureLayer::willModifyTexture):
        (WebKit):
        (WebKit::WebExternalTextureLayer::setRateLimitContext):
        * tests/Canvas2DLayerBridgeTest.cpp:
        (Canvas2DLayerBridgeTest::fullLifecycleTest):

2012-06-12  Adrienne Walker  <enne@google.com>

        [chromium] Paint scrollbars on WebKit thread and composite those textures
        https://bugs.webkit.org/show_bug.cgi?id=88145

        Reviewed by James Robinson.

        Remove scrollbarLayerLostContext test that no longer makes sense. The
        compositor won't draw at all after a lost context if it has no
        contents.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-12  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: ObjectStore/Index shouldn't hold reference to backing store
        https://bugs.webkit.org/show_bug.cgi?id=83074

        Reviewed by Tony Chang.

        * WebKit.gypi:
        * tests/IDBDatabaseBackendTest.cpp: Added.
        (WebCore):
        (WebCore::TEST):

2012-06-12  Dana Jansens  <danakj@chromium.org>

        [chromium] Set contentBounds() on impl layers in CCLayerTreeHostCommonTests
        https://bugs.webkit.org/show_bug.cgi?id=88903

        Reviewed by Adrienne Walker.

        Without setting the contentBounds() on impl layers, the visibleLayerRect
        will be wrong. This is not the case for main-thread layers, which most
        of the tests in this file use. But this is a potential serious confusion
        for future test implementors so I'd like to make it explicit now.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-12  Dana Jansens  <danakj@chromium.org>

        [chromium] Return empty visibleLayerRect for layers with empty content bounds
        https://bugs.webkit.org/show_bug.cgi?id=88901

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-12  Mark Mentovai  <mark@chromium.org>

        [chromium mac] Don't #include things in subframeworks of
        ApplicationServices.framework.

        #including the umbrella <ApplicatonServices/ApplicationServices.h>
        exposed an ambiguous name, FontMetrics, that needs to be fully
        qualified as WebCore::FontMetrics.

        https://bugs.webkit.org/show_bug.cgi?id=88569

        Reviewed by Stephen White.

        * src/WebFontImpl.cpp:
        (WebKit::WebFontImpl::estimateTextBounds):

2012-06-12  James Robinson  <jamesr@chromium.org>

        [chromium] REGRESSION(119769): Canvas2DLayerBridge may go away before its TextureLayerChromium
        https://bugs.webkit.org/show_bug.cgi?id=88910

        Reviewed by Adrienne Walker.

        New unit test to verify that we can still update a TextureLayerChromium after the bridge owning it has gone
        away.

        * tests/Canvas2DLayerBridgeTest.cpp:

2012-06-12  Adrienne Walker  <enne@google.com>

        [chromium] Fix incorrect LayerChromium scroll position for RTL overflow pages
        https://bugs.webkit.org/show_bug.cgi?id=88887

        Reviewed by James Robinson.

        The scroll position on layers needs to take into account the scroll
        origin, since RTL pages start scrolled all the way to the right.
        Otherwise, when scrolling left the scroll position incorrectly will go
        negative, causing havok in scrollbar theme code that just assumes that
        it's always scrolled all the way to the left.

        Also, now that the scroll origin is passed into NCCH, handle
        scrollOrigin.y() for layer adjusting. This is always zero in practice,
        but it seemed awkward to just drop it and that assumption could always
        change in the future.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::setViewport):
        (WebKit::NonCompositedContentHost::paintContents):
        * src/NonCompositedContentHost.h:
        (NonCompositedContentHost):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::updateLayerTreeViewport):

2012-06-12  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Make damage tracking more robust to early exits
        https://bugs.webkit.org/show_bug.cgi?id=84803

        Reviewed by James Robinson.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::clearDamageForAllSurfaces):
        (WebKitTests::TEST_F):

2012-06-12  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r120051.
        http://trac.webkit.org/changeset/120051
        https://bugs.webkit.org/show_bug.cgi?id=88852

        some tests are crashing (Requested by morrita on #webkit).

        * WebKit.gyp:
        * public/WebPermissionClient.h:
        (WebKit::WebPermissionClient::allowWebComponents):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::allowShadowDOM):
        (WebKit):
        (WebKit::FrameLoaderClientImpl::allowStyleScoped):
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):
        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::initPage):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setPermissionClient):
        (WebKit::WebViewImpl::WebViewImpl):
        * src/WebViewImpl.h:
        (WebKit):

2012-06-12  MORITA Hajime  <morrita@google.com>

        REGRESSION(r118098): <content> element does not render distributed children when cloned from another document
        https://bugs.webkit.org/show_bug.cgi?id=88148

        Reviewed by Dimitri Glazkov.

        - Added ContextFeaturesClientImpl which implements WebCore::ContextFeaturesClient.
        - Replaced PagePopupFrameLoaderClient with PagePopupFeaturesClient.

        * WebKit.gyp:
        * public/WebPermissionClient.h:
        (WebKit):
        (WebKit::WebPermissionClient::allowWebComponents):
        * src/ContextFeaturesClientImpl.cpp: Renamed from Source/WebCore/bindings/generic/ContextEnabledFeatures.cpp.
        (WebKit):
        (WebKit::ContextFeaturesClientImpl::isEnabled):
        * src/ContextFeaturesClientImpl.h: Renamed from Source/WebCore/bindings/generic/ContextEnabledFeatures.h.
        (WebKit):
        (ContextFeaturesClientImpl):
        (WebKit::ContextFeaturesClientImpl::ContextFeaturesClientImpl):
        (WebKit::ContextFeaturesClientImpl::setPermissionClient):
        * src/FrameLoaderClientImpl.cpp:
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):
        * src/WebPagePopupImpl.cpp:
        (PagePopupFeaturesClient):
        (WebKit::PagePopupFeaturesClient::isEnabled):
        (WebKit):
        (WebKit::WebPagePopupImpl::initPage):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setPermissionClient):
        (WebKit::WebViewImpl::WebViewImpl):
        * src/WebViewImpl.h:
        (WebKit):

2012-06-11  Nico Weber  <thakis@chromium.org>

        Remove unused member variables found by clang's -Wunused-private-field
        https://bugs.webkit.org/show_bug.cgi?id=88812

        Reviewed by Anders Carlsson.

        * src/AudioDestinationChromium.cpp:
        (WebCore::AudioDestinationChromium::AudioDestinationChromium):
        * src/AudioDestinationChromium.h:
        (AudioDestinationChromium):
        * src/InspectorFrontendClientImpl.cpp:
        (WebKit::InspectorFrontendClientImpl::InspectorFrontendClientImpl):
        * src/InspectorFrontendClientImpl.h:
        (InspectorFrontendClientImpl):
        * src/WebFrameImpl.cpp:
        (ChromePluginPrintContext):
        * src/WebInputEvent.cpp:
        * src/WorkerAsyncFileSystemChromium.cpp:
        (WebCore::WorkerAsyncFileSystemChromium::createWorkerFileSystemCallbacksBridge):
        * src/WorkerAsyncFileWriterChromium.cpp:
        (WebCore::WorkerAsyncFileWriterChromium::WorkerAsyncFileWriterChromium):
        * src/WorkerAsyncFileWriterChromium.h:
        (WorkerAsyncFileWriterChromium):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestSetVisible::CCLayerTreeHostTestSetVisible):
        (CCLayerTreeHostTestSetVisible):

2012-06-11  Vincent Scheib  <scheib@chromium.org>

        Consolidate Pointer Lock runtime enabled flags to just one.
        https://bugs.webkit.org/show_bug.cgi?id=88810

        Reviewed by Dimitri Glazkov.

        * src/WebRuntimeFeatures.cpp:
        (WebKit::WebRuntimeFeatures::enablePointerLock):
        (WebKit::WebRuntimeFeatures::isPointerLockEnabled):

2012-06-11  Alexis Menard  <alexis.menard@openbossa.org>

        [CSS3 Backgrounds and Borders] Protect box-decoration-break behind a feature flag.
        https://bugs.webkit.org/show_bug.cgi?id=88804

        Reviewed by Tony Chang.

        Protect box-decoration-break behind a feature flag enabled by default.

        * features.gypi:

2012-05-11  James Robinson  <jamesr@chromium.org>

        [chromium] Port DrawingBufferChromium from TextureLayerChromium over to WebExternalTextureLayer
        https://bugs.webkit.org/show_bug.cgi?id=86273

        Reviewed by Adrienne Walker.

        * src/WebExternalTextureLayer.cpp:
        (WebTextureUpdaterImpl):
        (WebKit::WebTextureUpdaterImpl::WebTextureUpdaterImpl):
        (WebKit):
        (WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayerImpl::WebExternalTextureLayerImpl):
        (WebKit::WebExternalTextureLayer::create):
        (WebKit::WebExternalTextureLayer::clearClient):
        (WebKit::WebExternalTextureLayer::setOpaque):
        (WebKit::WebExternalTextureLayer::setPremultipliedAlpha):

2012-06-11  Dana Jansens  <danakj@chromium.org>

        [chromium] Separate CCVideoDrawQuad and from the layer tree and video provider by removing ManagedTexture and WebVideoFrame pointers from the quad
        https://bugs.webkit.org/show_bug.cgi?id=88363

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCTiledLayerTestCommon.h:
        (WebKitTests::FakeTextureCopier::copyToTexture):
        * tests/Canvas2DLayerChromiumTest.cpp:

2012-06-11  Joshua Bell  <jsbell@chromium.org>

        IndexedDB: Object stores are not successfully deleted
        https://bugs.webkit.org/show_bug.cgi?id=88788

        Reviewed by Tony Chang.

        * tests/IDBLevelDBCodingTest.cpp:
        (IDBLevelDBCoding::TEST):

2012-06-11  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Implement position:fixed in compositor thread
        https://bugs.webkit.org/show_bug.cgi?id=70103

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:

2012-06-11  Sam Weinig  <sam@webkit.org>

        Remove support for disconnected/excluded from search frames, they are not used by Safari anymore
        https://bugs.webkit.org/show_bug.cgi?id=88723

        Reviewed by Dan Bernstein.

        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::scopeStringMatches):

2012-06-11  Varun Jain  <varunjain@chromium.org>

        [chromium] WebInputEvent::isGestureEventType should return true for GestureTwoFingerTap
        https://bugs.webkit.org/show_bug.cgi?id=88789

        Reviewed by Adam Barth.

        * public/WebInputEvent.h:
        (WebKit::WebInputEvent::isGestureEventType):

2012-06-11  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call shared timer functions directly
        https://bugs.webkit.org/show_bug.cgi?id=88781

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-06-11  Amy Ousterhout  <aousterh@chromium.org>

        [Chromium] Removing long WebDeviceOrientation constructor
        https://bugs.webkit.org/show_bug.cgi?id=88779

        Reviewed by Adam Barth.

        Removing the WebDeviceOrientation constructor with nine parameters.
        Chromium has been changed to use the default constructor and setter
        functions instead (see https://chromiumcodereview.appspot.com/10542025/).

        * public/WebDeviceOrientation.h:

2012-06-11  David Dorwin  <ddorwin@chromium.org>

        [chromium] Provide access to the WebPlugin created by the helper plugin widget
        https://bugs.webkit.org/show_bug.cgi?id=88028

        Reviewed by Adam Barth.

        A WebPlugin is created when the document created by createHelperPlugin() is laid out.
        Expose it so the embedder can interact with the plugin instance.

        * public/WebHelperPlugin.h:
        (WebKit):
        (WebHelperPlugin):
        * public/WebMediaPlayerClient.h:
        (WebKit):
        * public/WebPlugin.h:
        (WebKit::WebPlugin::isPlaceholder):
        (WebPlugin):
        * src/WebHelperPluginImpl.cpp:
        (WebKit::WebHelperPluginImpl::WebHelperPluginImpl):
        (WebKit):
        (WebKit::WebHelperPluginImpl::getPlugin):
        (WebKit::WebHelperPluginImpl::initPage):
        (WebKit::WebHelperPluginImpl::close):
        * src/WebHelperPluginImpl.h:
        (WebKit):
        (WebHelperPluginImpl):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::createHelperPlugin):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):
        * src/WebPagePopupImpl.cpp:

2012-06-05  Dana Jansens  <danakj@chromium.org>

        [chromium] Free texture from CCIOSurfaceLayerImpl when it is destroyed
        https://bugs.webkit.org/show_bug.cgi?id=88371

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-11  Kent Tamura  <tkent@chromium.org>

        [Chromium] Should call frameDetached() in WebPagePopupImpl::close()
        https://bugs.webkit.org/show_bug.cgi?id=88754

        Reviewed by Adam Barth.

        * src/WebPagePopupImpl.cpp:
        (WebKit::WebPagePopupImpl::close): Calls FrameLoader::frameDetached().

2012-06-11  Min Qin  <qinmin@google.com>

        Adding a flag to show fullscreen media controls in chromium
        https://bugs.webkit.org/show_bug.cgi?id=88266

        Reviewed by Adam Barth.

        Adding a flag to the gyp file so that we can enable fullscreen media control
        
        * features.gypi:

2012-06-09  Eugene Klyuchnikov  <eustas.bug@gmail.com>

        Web Inspector: Add message loop instrumentation to public API and timeline agent
        https://bugs.webkit.org/show_bug.cgi?id=88639

        Reviewed by Vsevolod Vlasov.

        Message loop instrumentation will show when the render thread is busy.
        That way developer can discover if a render thread business causes low fps, or not.

        * public/WebDevToolsAgent.h:
        (WebDevToolsAgent):
        * public/WebDevToolsAgentClient.h:
        (WebDevToolsAgentClient):
        (WebKit::WebDevToolsAgentClient::startMessageLoopMonitoring):
        Request message loop notifications.
        (WebKit::WebDevToolsAgentClient::stopMessageLoopMonitoring):
        Cancel message loop notifications.
        * src/InspectorClientImpl.cpp:
        (WebKit::InspectorClientImpl::startMessageLoopMonitoring):
        Request message loop notifications.
        (WebKit):
        (WebKit::InspectorClientImpl::stopMessageLoopMonitoring):
        Cancel message loop notifications.
        * src/InspectorClientImpl.h:
        (InspectorClientImpl):
        * src/WebDevToolsAgentImpl.cpp:
        (WebKit::WebDevToolsAgentImpl::startMessageLoopMonitoring):
        Request message loop notifications.
        (WebKit):
        (WebKit::WebDevToolsAgentImpl::stopMessageLoopMonitoring):
        Cancel message loop notifications.
        (WebKit::WebDevToolsAgentImpl::instrumentWillProcessTask):
        Message loop notification.
        (WebKit::WebDevToolsAgentImpl::instrumentDidProcessTask):
        Ditto.
        * src/WebDevToolsAgentImpl.h:
        (WebDevToolsAgentImpl):

2012-06-08  David Reveman  <reveman@chromium.org>

        [Chromium] Compositor doesn't support translucent root layers.
        https://bugs.webkit.org/show_bug.cgi?id=87821

        Reviewed by James Robinson.

        * src/NonCompositedContentHost.cpp:
        (WebKit::NonCompositedContentHost::setOpaque):
        (WebKit):
        * src/NonCompositedContentHost.h:
        (NonCompositedContentHost):
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setHasTransparentBackground):
        (WebKit):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsTransparent):
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (ClearCountingContext):
        (ClearCountingContext::ClearCountingContext):
        (ClearCountingContext::clear):
        (ClearCountingContext::clearCount):
        (TEST):

2012-06-08  Ian Vollick  <vollick@chromium.org>

        [chromium] Single thread proxy's animation timer should short circuit if the layer renderer has not been initialized
        https://bugs.webkit.org/show_bug.cgi?id=88668

        Reviewed by James Robinson.

        * WebKit.gypi:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestWriteLayersRedraw::beginTest):
        (WTF::CCLayerTreeHostTestWriteLayersAfterVisible::commitCompleteOnCCThread):
        (WTF):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::CCLayerTreeHostTestLayerAddedWithAnimation):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::didAddAnimation):
        (CCLayerTreeHostTestLayerAddedWithAnimation):
        * tests/CCSingleThreadProxyTest.cpp: Added.
        (FakeWebGraphicsContext3DMakeCurrentFails):
        (FakeWebGraphicsContext3DMakeCurrentFails::makeContextCurrent):
        (CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation):
        (CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation::CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation):
        (CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation::beginTest):
        (CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation::animateLayers):
        (CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation::didRecreateContext):
        (CCSingleThreadProxyTestInitializeLayerRendererFailsAfterAddAnimation::afterTest):
        (TEST_F):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer::CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer::beginTest):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer::animateLayers):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer::didRecreateContext):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer::didAddAnimation):
        (CCSingleThreadProxyTestDidAddAnimationBeforeInitializingLayerRenderer::afterTest):
        * tests/CCThreadedTest.cpp: Added.
        (WebKitTests):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::create):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::createTexture):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::deleteTexture):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::bindTexture):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::numTextures):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::texture):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::resetTextures):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::numUsedTextures):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::usedTexture):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::resetUsedTextures):
        (WebKitTests::CompositorFakeWebGraphicsContext3DWithTextureTracking::CompositorFakeWebGraphicsContext3DWithTextureTracking):
        (WebKitTests::TestHooks::createContext):
        (WebKitTests::MockLayerTreeHostImpl::create):
        (WebKitTests::MockLayerTreeHostImpl::beginCommit):
        (WebKitTests::MockLayerTreeHostImpl::commitComplete):
        (WebKitTests::MockLayerTreeHostImpl::prepareToDraw):
        (WebKitTests::MockLayerTreeHostImpl::drawLayers):
        (WebKitTests::MockLayerTreeHostImpl::animateLayers):
        (WebKitTests::MockLayerTreeHostImpl::lowFrequencyAnimationInterval):
        (WebKitTests::MockLayerTreeHostImpl::MockLayerTreeHostImpl):
        (MockLayerTreeHost):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (MockLayerTreeHostClient):
        (WebKitTests::MockLayerTreeHostClient::create):
        (WebKitTests::MockLayerTreeHostClient::MockLayerTreeHostClient):
        (TimeoutTask):
        (WebKitTests::TimeoutTask::TimeoutTask):
        (WebKitTests::TimeoutTask::clearTest):
        (WebKitTests::TimeoutTask::~TimeoutTask):
        (WebKitTests::TimeoutTask::run):
        (BeginTask):
        (WebKitTests::BeginTask::BeginTask):
        (WebKitTests::BeginTask::~BeginTask):
        (WebKitTests::BeginTask::run):
        (EndTestTask):
        (WebKitTests::EndTestTask::EndTestTask):
        (WebKitTests::EndTestTask::~EndTestTask):
        (WebKitTests::EndTestTask::clearTest):
        (WebKitTests::EndTestTask::run):
        (WebKitTests::CCThreadedTest::CCThreadedTest):
        (WebKitTests::CCThreadedTest::endTest):
        (WebKitTests::CCThreadedTest::endTestAfterDelay):
        (WebKitTests::CCThreadedTest::postSetNeedsAnimateToMainThread):
        (WebKitTests::CCThreadedTest::postAddAnimationToMainThread):
        (WebKitTests::CCThreadedTest::postAddInstantAnimationToMainThread):
        (WebKitTests::CCThreadedTest::postSetNeedsCommitToMainThread):
        (WebKitTests::CCThreadedTest::postAcquireLayerTextures):
        (WebKitTests::CCThreadedTest::postSetNeedsRedrawToMainThread):
        (WebKitTests::CCThreadedTest::postSetNeedsAnimateAndCommitToMainThread):
        (WebKitTests::CCThreadedTest::postSetVisibleToMainThread):
        (WebKitTests::CCThreadedTest::postDidAddAnimationToMainThread):
        (WebKitTests::CCThreadedTest::doBeginTest):
        (WebKitTests::CCThreadedTest::timeout):
        (WebKitTests::CCThreadedTest::scheduleComposite):
        (WebKitTests::CCThreadedTest::onEndTest):
        (WebKitTests::CCThreadedTest::dispatchSetNeedsAnimate):
        (WebKitTests::CCThreadedTest::dispatchAddInstantAnimation):
        (WebKitTests::CCThreadedTest::dispatchAddAnimation):
        (WebKitTests::CCThreadedTest::dispatchSetNeedsAnimateAndCommit):
        (WebKitTests::CCThreadedTest::dispatchSetNeedsCommit):
        (WebKitTests::CCThreadedTest::dispatchAcquireLayerTextures):
        (WebKitTests::CCThreadedTest::dispatchSetNeedsRedraw):
        (WebKitTests::CCThreadedTest::dispatchSetVisible):
        (WebKitTests::CCThreadedTest::dispatchSetInvisible):
        (WebKitTests::CCThreadedTest::dispatchComposite):
        (WebKitTests::CCThreadedTest::dispatchDidAddAnimation):
        (WebKitTests::CCThreadedTest::runTest):
        * tests/CCThreadedTest.h: Added.
        (WebCore):
        (WebKit):
        (WebKitTests):
        (TestHooks):
        (WebKitTests::TestHooks::beginCommitOnCCThread):
        (WebKitTests::TestHooks::commitCompleteOnCCThread):
        (WebKitTests::TestHooks::prepareToDrawOnCCThread):
        (WebKitTests::TestHooks::drawLayersOnCCThread):
        (WebKitTests::TestHooks::animateLayers):
        (WebKitTests::TestHooks::willAnimateLayers):
        (WebKitTests::TestHooks::applyScrollAndScale):
        (WebKitTests::TestHooks::updateAnimations):
        (WebKitTests::TestHooks::layout):
        (WebKitTests::TestHooks::didRecreateContext):
        (WebKitTests::TestHooks::didAddAnimation):
        (WebKitTests::TestHooks::didCommit):
        (WebKitTests::TestHooks::didCommitAndDrawFrame):
        (WebKitTests::TestHooks::scheduleComposite):
        (WebKitTests::TestHooks::notifyAnimationStarted):
        (WebKitTests::TestHooks::notifyAnimationFinished):
        (CCThreadedTest):
        (WebKitTests::CCThreadedTest::clearTimeout):
        (WebKitTests::CCThreadedTest::clearEndTestTask):
        (WebKitTests::CCThreadedTest::layerTreeHost):
        (CCThreadedTestThreadOnly):
        (WebKitTests::CCThreadedTestThreadOnly::runTestThreaded):
        (MockLayerTreeHostImpl):
        (CompositorFakeWebGraphicsContext3DWithTextureTracking):

2012-06-08  David Grogan  <dgrogan@chromium.org>

        IndexedDB: rename some instances of open to registerFrontendCallbacks
        https://bugs.webkit.org/show_bug.cgi?id=88611

        Reviewed by Tony Chang.

        * src/IDBDatabaseBackendProxy.cpp:
        (WebKit::IDBDatabaseBackendProxy::registerFrontendCallbacks):
        * src/IDBDatabaseBackendProxy.h:
        (IDBDatabaseBackendProxy):
        * src/WebIDBDatabaseImpl.cpp:
        (WebKit::WebIDBDatabaseImpl::open):
        * src/WebIDBDatabaseImpl.h:
        (WebIDBDatabaseImpl):

2012-06-08  Dana Jansens  <danakj@chromium.org>

        [chromium] Skip willDraw() and didDraw() on fully occluded layers
        https://bugs.webkit.org/show_bug.cgi?id=88435

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-08  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up some unnecessary LayerChromium.h includes
        https://bugs.webkit.org/show_bug.cgi?id=88599

        Reviewed by Adam Barth.

        Removes unused include, update comment.

        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::platformLayer):
        (WebKit::WebMediaPlayerClientImpl::paint):

2012-06-08  Jochen Eisinger  <jochen@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-08  Ian Vollick  <vollick@chromium.org>

        [chromium] Accelerated animations should use WebTransformOperations
        https://bugs.webkit.org/show_bug.cgi?id=87686

        Reviewed by James Robinson.

        CCTransformKeyframe new owns a WebTransformOperations rather than a
        TransformOperations. LayerChromium's API has been changed so that
        LayerChromium::addAnimation should take only a CCActiveAnimation.
        GraphicsLayerChromium is new responsible for translating to
        WebTransformOperations and creating CCActiveAnimations. Tests that use
        the public API (that is, they call addAnimation with KeyframeValueList
        and Animation arguments) have been moved to GraphicsLayerChromiumTest.

        * tests/CCAnimationTestCommon.cpp:
        (WebCore::addOpacityTransition):
        (WebCore::addAnimatedTransform):
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (MockLayerTreeHostClient):
        (WebKitTests):
        (MockLayerTreeHost):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::~GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::expectTranslateX):
        (WebKitTests::TEST_F):
        * tests/LayerChromiumTest.cpp:

2012-06-08  Robert Kroeger  <rjkroege@chromium.org>

        More than 8 fingers get ignored by touch
        https://bugs.webkit.org/show_bug.cgi?id=88359

        Reviewed by James Robinson.

        * public/WebInputEvent.h: Increase of TouchPoints per TouchEvent from 8 to 12.

2012-06-08  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-08  Taiju Tsuiki  <tzik@chromium.org>

        Add FileSystem item to storage tree.
        https://bugs.webkit.org/show_bug.cgi?id=72691

        Reviewed by Vsevolod Vlasov.

        * src/js/DevTools.js:

2012-06-08  Peter Beverloo  <peter@chromium.org>

        [Chromium] Re-enable SHARED_WORKERS for Android until a build fix has been resolved.
        https://bugs.webkit.org/show_bug.cgi?id=88637

        Unreviewed build fix.

        Linking content_shell on the Chromium side fails due to an unresolved
        call to WebSharedWorker::create(). Since this blocks WebKit rolls,
        temporarily re-enable the feature until this has been solved.

        * features.gypi:

2012-06-07  Nico Weber  <thakis@chromium.org>

        [chromium/mac] Improve deviceDPI, rect, and availableRect computation
        https://bugs.webkit.org/show_bug.cgi?id=88596

        Reviewed by Adam Barth.

        Set deviceDPI to 160 for normal displays and 320 for HiDPI displays.
        (Why 160? That's what chromium's render_view.cc assumes as default
        single-resolution resolution at the moment. The only other place
        where this number gets used is fixed layout mode, which is currently
        not enabled.)

        Also fix rect and availableRect computations: They get returned in
        user space already.

        Needed for http://crbug.com/31960.

        * src/mac/WebScreenInfoFactory.mm:
        (WebKit::toUserSpace):
        (WebKit::deviceScaleFactor):
        (WebKit):
        (WebKit::WebScreenInfoFactory::screenInfo):

2012-06-07  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move didStartWorkerRunLoop to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=88562

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-06-05  James Robinson  <jamesr@chromium.org>

        [chromium] Move deferral-related logic out of Canvas2DLayerChromium
        https://bugs.webkit.org/show_bug.cgi?id=86050

        Reviewed by Stephen White.

        * WebKit.gypi:
        * tests/Canvas2DLayerBridgeTest.cpp: Renamed from tests/Canvas2DLayerChromiumTest
        (Canvas2DLayerBridgeTest):
        (Canvas2DLayerBridgeTest::fullLifecycleTest):

2012-06-07  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119744.
        http://trac.webkit.org/changeset/119744
        https://bugs.webkit.org/show_bug.cgi?id=88584

        Fails assertions in debug builds (Requested by jamesr_ on
        #webkit).

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-07  Adam Barth  <abarth@webkit.org>

        Settings::defaultDeviceScaleFactor is redundant with Page::deviceScaleFactor
        https://bugs.webkit.org/show_bug.cgi?id=88375

        Reviewed by James Robinson.

        * public/WebSettings.h:
        (WebKit::WebSettings::setDefaultDeviceScaleFactor):
        (WebSettings):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::dispatchViewportPropertiesDidChange):
        * src/WebSettingsImpl.cpp:
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        * tests/WebFrameTest.cpp:
        (WebKit::TEST_F):

2012-06-07  Peter Beverloo  <peter@chromium.org>

        [Chromium] features.gypi should have the correct definitions for Android
        https://bugs.webkit.org/show_bug.cgi?id=88533

        Reviewed by Adam Barth.

        Make all features which are enabled on Android but disabled on other platforms,
        or are disabled on Android while enabled on other platforms, conditional. This
        also means that the selection of code compiled for Android will slightly change.

        This change also removes the enable_viewport variable as the value of this is
        no longer respected by WebKit - it's enabled by default for all of Chromium.
        Furthermore, ENABLE_OVERFLOW_SCROLLING is now listed in features.gypi again.

        * features.gypi:

2012-06-07  Dana Jansens  <danakj@chromium.org>

        [chromium] Free texture from CCIOSurfaceLayerImpl when it is destroyed
        https://bugs.webkit.org/show_bug.cgi?id=88371

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-07  Ami Fischman  <fischman@chromium.org>

        Plumb CORS attribute information from HTMLMediaElement to media players so it can be used
        https://bugs.webkit.org/show_bug.cgi?id=88349

        Reviewed by Adam Barth.

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/AssertMatchingEnums.cpp:
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::loadInternal):
        (WebKit::WebMediaPlayerClientImpl::didPassCORSAccessCheck):
        (WebKit):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-06-07  Daniel Erat  <derat@chromium.org>

        Add setting to enable subpixel-positioned text on Linux.
        https://bugs.webkit.org/show_bug.cgi?id=88263

        Reviewed by Tony Chang.

        Add subpixel positioning field to WebFontRenderStyle and rename
        subpixel rendering field.  Make similar changes in
        WebFontRendering.

        Also add global WebFontInfo::setSubpixelPositioning() to turn
        subpixel positioning on or off (there's not currently a
        well-defined way to configure subpixel positioning via FontConfig).

        * public/linux/WebFontInfo.h:
        (WebFontInfo):
        * public/linux/WebFontRenderStyle.h:
        * public/linux/WebFontRendering.h:
        (WebFontRendering):
        * src/linux/WebFontInfo.cpp:
        (WebKit):
        (WebKit::WebFontInfo::setSubpixelPositioning):
        (WebKit::WebFontInfo::renderStyleForStrike):
        * src/linux/WebFontRenderStyle.cpp:
        (WebKit::WebFontRenderStyle::toFontRenderStyle):
        (WebKit::WebFontRenderStyle::setDefaults):
        * src/linux/WebFontRendering.cpp:
        (WebKit::WebFontRendering::setSubpixelGlyphs):
        (WebKit):
        (WebKit::WebFontRendering::setSubpixelRendering):
        (WebKit::WebFontRendering::setSubpixelPositioning):

2012-06-06  Dana Jansens  <danakj@chromium.org>

        [chromium] In each composited frame, didDraw() should only be called on layers for which willDraw() was called
        https://bugs.webkit.org/show_bug.cgi?id=88469

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-07  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119694.
        http://trac.webkit.org/changeset/119694
        https://bugs.webkit.org/show_bug.cgi?id=88529

        it broke PrerenderBrowserTest.PrerenderHTML5VideoNetwork
        (Requested by loislo on #webkit).

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/AssertMatchingEnums.cpp:
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::loadInternal):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-06-07  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119689.
        http://trac.webkit.org/changeset/119689
        https://bugs.webkit.org/show_bug.cgi?id=88516

        it broke didDrawNotCalledOnScissoredLayer webkit_unit_test
        (Requested by loislo on #webkit).

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-07  Ami Fischman  <fischman@chromium.org>

        Plumb CORS attribute information from HTMLMediaElement to media players so it can be used
        https://bugs.webkit.org/show_bug.cgi?id=88349

        Reviewed by Adam Barth.

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::loadInternal):

2012-06-07  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Introduce conversion from/to Deciaml to/from double and helper functions
        https://bugs.webkit.org/show_bug.cgi?id=88480

        Reviewed by Kent Tamura.

        This patch added tests for Decimal::fromDouble, isInfinity, toDouble.

        * tests/DecimalTest.cpp:
        (TEST_F):

2012-06-07  Ami Fischman  <fischman@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-06  Dana Jansens  <danakj@chromium.org>

        [chromium] In each composited frame, didDraw() should only be called on layers for which willDraw() was called
        https://bugs.webkit.org/show_bug.cgi?id=88469

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-06  Kent Tamura  <tkent@chromium.org>

        Unreviewed, rolling out r60044.
        http://trac.webkit.org/changeset/60044

        It made a regression, crbug.com/114922.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::invalidateContentsForSlowScroll): Do not hide popups by scrolling.
        (WebKit::ChromeClientImpl::scroll): ditto.

2012-06-06  Noel Gordon  <noel.gordon@gmail.com>

        Unreviewed. Rolled DEPS.

        * DEPS: Roll to chromium 140955.

2012-06-06  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119683.
        http://trac.webkit.org/changeset/119683
        https://bugs.webkit.org/show_bug.cgi?id=88505

        it broke webkit-unit-test
        WebLayerTreeViewThreadedTest.InstrumentationCallbacks on mac
        (Requested by loislo on #webkit).

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::MockLayerTreeHost::create):
        * tests/Canvas2DLayerChromiumTest.cpp:
        (Canvas2DLayerChromiumTest::fullLifecycleTest):

2012-06-06  Robert Kroeger  <rjkroege@chromium.org>

        [Chromium] Re-enable handling of smooth scrolling on Chromium Linux/Windows
        https://bugs.webkit.org/show_bug.cgi?id=87535 by adding support for precise
        scrolling deltas on all Chromium platforms.

        Reviewed by James Robinson.

        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformWheelEventBuilder::PlatformWheelEventBuilder): Create PlatformWheelEvents
        with m_hasPreciseScrollingDelta flag as required.
        * tests/ScrollAnimatorNoneTest.cpp: Added new unit test condiiton for precise scrolling.
        (TEST):

2012-06-06  Michal Mocny  <mmocny@google.com>

        [chromium] Stop dropping texture limits when the layer tree host becomes invisible, and initialize with 0 allocation.
        https://bugs.webkit.org/show_bug.cgi?id=87747

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::MockLayerTreeHost::create):
        * tests/Canvas2DLayerChromiumTest.cpp:
        (Canvas2DLayerChromiumTest::fullLifecycleTest):

2012-06-06  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move createMessagePortChannel to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=85764

        Reviewed by Adam Barth.
        
        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/WebFrame.h:
        (WebFrame):
        * public/WebMessagePortChannel.h:
        * public/WebMessagePortChannelClient.h:
        * public/WebSharedWorkerClient.h:
        (WebSharedWorkerClient):
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKit::WebKitPlatformSupport::injectIDBKeyIntoSerializedValue):
        * src/PlatformMessagePortChannel.cpp:
        (WebCore::PlatformMessagePortChannel::PlatformMessagePortChannel):
        * src/PlatformMessagePortChannel.h:
        * src/SharedWorkerRepository.cpp:
        * src/WebSharedWorkerImpl.cpp:

2012-06-06  Amy Ousterhout  <aousterh@chromium.org>

        [Chromium] DeviceOrientation cleanup
        https://bugs.webkit.org/show_bug.cgi?id=88406

        Reviewed by Kent Tamura.

        Made default constructor public and added a set function for each property.
        This will allow us to remove the 8-parameter constructor.

        * public/WebDeviceOrientation.h:
        (WebKit::WebDeviceOrientation::WebDeviceOrientation):
        (WebKit::WebDeviceOrientation::setNull):
        (WebKit::WebDeviceOrientation::setAlpha):
        (WebKit::WebDeviceOrientation::setBeta):
        (WebKit::WebDeviceOrientation::setGamma):
        (WebKit::WebDeviceOrientation::setAbsolute):
        (WebDeviceOrientation):

2012-06-06  James Robinson  <jamesr@chromium.org>

        [chromium] Move implementation of WebCore::GraphicsContext3D and related from WebKit/chromium/src to WebCore/platform/chromium/support
        https://bugs.webkit.org/show_bug.cgi?id=86257

        Reviewed by Kenneth Russell.

        * WebKit.gyp:

2012-06-06  James Robinson  <jamesr@chromium.org>

        [chromium] Unreviewed build fix, add an apparently used include of OwnArrayPtr.h back to GraphicsContext3DPrivate.h
        https://bugs.webkit.org/show_bug.cgi?id=88468

        * src/GraphicsContext3DPrivate.h:

2012-06-06  James Robinson  <jamesr@chromium.org>

        [chromium] Clean up GraphicsContext3D implementation
        https://bugs.webkit.org/show_bug.cgi?id=88460

        Reviewed by Kenneth Russell.

        Chromium's implementation of the GraphicsContext3D implementation has been somewhat messy for historical
        reasons. The actual implementation of the majority of these functions is done by delegating to the Platform API
        WebGraphicsContext3D. A few bits of functionality - extension mapping, some compositor functionality, a readback
        utility - are implemented by code in WebKit. Previously, all GraphicsContext3D functions delegates to a clone of
        the interface in GraphicsContext3DPrivate which in turn delegated to WebGraphicsContext3D. This required
        duplicating the entire GraphicsContext3D interface and made updating the interface an epic pain in the rear.

        This patch provides the implementations of GraphicsContext3D functions in GraphicsContext3DChromium.cpp. Most of
        these functions delegate directly to WebGraphicsContext3D. The ones that do not delegate to
        GraphicsContext3DPrivate, which now has a dedicated header and cpp file. GraphicsContext3DPrivate.cpp implements
        all GraphicsContext3DPrivate functions. I've also reordered the implementation files so that the function order
        matches the associated header file and normalized the names of callback adapters.

        Refactor only, no change in functionality. Existing tests apply.

        * WebKit.gyp:
        * src/Extensions3DChromium.cpp:
        (WebCore::Extensions3DChromium::ensureEnabled):
        (WebCore::Extensions3DChromium::getGraphicsResetStatusARB):
        (WebCore::Extensions3DChromium::blitFramebuffer):
        (WebCore::Extensions3DChromium::renderbufferStorageMultisample):
        (WebCore::Extensions3DChromium::postSubBufferCHROMIUM):
        (WebCore::Extensions3DChromium::mapBufferSubDataCHROMIUM):
        (WebCore::Extensions3DChromium::unmapBufferSubDataCHROMIUM):
        (WebCore::Extensions3DChromium::mapTexSubImage2DCHROMIUM):
        (WebCore::Extensions3DChromium::unmapTexSubImage2DCHROMIUM):
        (WebCore::Extensions3DChromium::setVisibilityCHROMIUM):
        (WebCore::Extensions3DChromium::discardFramebufferEXT):
        (WebCore::Extensions3DChromium::ensureFramebufferCHROMIUM):
        (WebCore::Extensions3DChromium::getTranslatedShaderSourceANGLE):
        (WebCore::Extensions3DChromium::rateLimitOffscreenContextCHROMIUM):
        (WebCore::Extensions3DChromium::texImageIOSurface2DCHROMIUM):
        (WebCore::Extensions3DChromium::texStorage2DEXT):
        (WebCore::Extensions3DChromium::createQueryEXT):
        (WebCore::Extensions3DChromium::deleteQueryEXT):
        (WebCore::Extensions3DChromium::isQueryEXT):
        (WebCore::Extensions3DChromium::beginQueryEXT):
        (WebCore::Extensions3DChromium::endQueryEXT):
        (WebCore::Extensions3DChromium::getQueryivEXT):
        (WebCore::Extensions3DChromium::getQueryObjectuivEXT):
        * src/GraphicsContext3DChromium.cpp:
        (WebCore::GraphicsContext3D::GraphicsContext3D):
        (WebCore::GraphicsContext3D::~GraphicsContext3D):
        (WebCore::GraphicsContext3D::setContextLostCallback):
        (WebCore::GraphicsContext3D::setErrorMessageCallback):
        (WebCore::GraphicsContext3D::create):
        (WebCore::GraphicsContext3D::platformGraphicsContext3D):
        (WebCore::GraphicsContext3D::platformTexture):
        (WebCore::GraphicsContext3D::grContext):
        (WebCore::GraphicsContext3D::platformLayer):
        (WebCore):
        (WebCore::GraphicsContext3D::isGLES2Compliant):
        (WebCore::GraphicsContext3D::isResourceSafe):
        (WebCore::GraphicsContext3D::bindAttribLocation):
        (WebCore::GraphicsContext3D::bufferData):
        (WebCore::GraphicsContext3D::getActiveAttrib):
        (WebCore::GraphicsContext3D::getActiveUniform):
        (WebCore::GraphicsContext3D::getAttribLocation):
        (WebCore::GraphicsContext3D::getContextAttributes):
        (WebCore::GraphicsContext3D::getProgramInfoLog):
        (WebCore::GraphicsContext3D::getShaderInfoLog):
        (WebCore::GraphicsContext3D::getShaderSource):
        (WebCore::GraphicsContext3D::getString):
        (WebCore::GraphicsContext3D::getUniformLocation):
        (WebCore::GraphicsContext3D::shaderSource):
        (WebCore::GraphicsContext3D::texImage2D):
        (WebCore::GraphicsContext3D::texSubImage2D):
        (WebCore::GraphicsContext3D::reshape):
        (WebCore::GraphicsContext3D::markContextChanged):
        (WebCore::GraphicsContext3D::layerComposited):
        (WebCore::GraphicsContext3D::markLayerComposited):
        (WebCore::GraphicsContext3D::paintRenderingResultsToCanvas):
        (WebCore::GraphicsContext3D::paintRenderingResultsToImageData):
        (WebCore::GraphicsContext3D::paintCompositedResultsToCanvas):
        (WebCore::GraphicsContext3D::getExtensions):
        (WebCore::GraphicsContext3D::getInternalFramebufferSize):
        * src/GraphicsContext3DPrivate.cpp: Added.
        (WebCore):
        (WebCore::GraphicsContext3DPrivate::GraphicsContext3DPrivate):
        (WebCore::GraphicsContext3DPrivate::~GraphicsContext3DPrivate):
        (WebCore::GraphicsContext3DPrivate::createGraphicsContextFromWebContext):
        (WebCore::GraphicsContext3DPrivate::extractWebGraphicsContext3D):
        (GrMemoryAllocationChangedCallback):
        (WebCore::GrMemoryAllocationChangedCallback::GrMemoryAllocationChangedCallback):
        (WebCore::GrMemoryAllocationChangedCallback::onGpuMemoryAllocationChanged):
        (WebCore::GraphicsContext3DPrivate::grContext):
        (WebCore::GraphicsContext3DPrivate::markContextChanged):
        (WebCore::GraphicsContext3DPrivate::layerComposited):
        (WebCore::GraphicsContext3DPrivate::markLayerComposited):
        (WebCore::GraphicsContext3DPrivate::paintFramebufferToCanvas):
        (GraphicsContextLostCallbackAdapter):
        (WebCore::GraphicsContextLostCallbackAdapter::GraphicsContextLostCallbackAdapter):
        (WebCore::GraphicsContextLostCallbackAdapter::~GraphicsContextLostCallbackAdapter):
        (WebCore::GraphicsContextLostCallbackAdapter::onContextLost):
        (WebCore::GraphicsContext3DPrivate::setContextLostCallback):
        (GraphicsErrorMessageCallbackAdapter):
        (WebCore::GraphicsErrorMessageCallbackAdapter::GraphicsErrorMessageCallbackAdapter):
        (WebCore::GraphicsErrorMessageCallbackAdapter::~GraphicsErrorMessageCallbackAdapter):
        (WebCore::GraphicsErrorMessageCallbackAdapter::onErrorMessage):
        (WebCore::GraphicsContext3DPrivate::setErrorMessageCallback):
        (WebCore::GraphicsContext3DPrivate::getExtensions):
        (WebCore::GraphicsContext3DPrivate::initializeExtensions):
        (WebCore::GraphicsContext3DPrivate::supportsExtension):
        (WebCore::GraphicsContext3DPrivate::ensureExtensionEnabled):
        (WebCore::GraphicsContext3DPrivate::isExtensionEnabled):
        (WebCore::GraphicsContext3DPrivate::isResourceSafe):
        (GraphicsContext3DSwapBuffersCompleteCallbackAdapter):
        (WebCore::GraphicsContext3DSwapBuffersCompleteCallbackAdapter::GraphicsContext3DSwapBuffersCompleteCallbackAdapter):
        (WebCore::GraphicsContext3DSwapBuffersCompleteCallbackAdapter::~GraphicsContext3DSwapBuffersCompleteCallbackAdapter):
        (WebCore::GraphicsContext3DSwapBuffersCompleteCallbackAdapter::onSwapBuffersComplete):
        (WebCore::GraphicsContext3DPrivate::setSwapBuffersCompleteCallbackCHROMIUM):
        (GraphicsContext3DMemoryAllocationChangedCallbackAdapter):
        (WebCore::GraphicsContext3DMemoryAllocationChangedCallbackAdapter::GraphicsContext3DMemoryAllocationChangedCallbackAdapter):
        (WebCore::GraphicsContext3DMemoryAllocationChangedCallbackAdapter::~GraphicsContext3DMemoryAllocationChangedCallbackAdapter):
        (WebCore::GraphicsContext3DMemoryAllocationChangedCallbackAdapter::onMemoryAllocationChanged):
        (WebCore::GraphicsContext3DPrivate::setGpuMemoryAllocationChangedCallbackCHROMIUM):
        * src/GraphicsContext3DPrivate.h:
        (GraphicsContext3DPrivate):
        (WebCore::GraphicsContext3DPrivate::webContext):
        (WebCore::GraphicsContext3DPrivate::preserveDrawingBuffer):

2012-06-06  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        [chromium] Avoid limiting page-scale-factor when device-scale-factor is applied in the compositor.
        https://bugs.webkit.org/show_bug.cgi?id=88417

        Reviewed by James Robinson.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):

2012-06-06  Ami Fischman  <fischman@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-06  Nico Weber  <thakis@chromium.org>

        [chromium] Expose setPictographFontFamily through the chromium webkit api.
        https://bugs.webkit.org/show_bug.cgi?id=88393

        Reviewed by Adam Barth.

        This was added to WebCore in
        https://bugs.webkit.org/show_bug.cgi?id=65197

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setPictographFontFamily):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-06  Ryosuke Niwa  <rniwa@webkit.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-06  Kinuko Yasuda  <kinuko@chromium.org>

        Roll Chromium DEPS from r140700 to r140711.

        * DEPS:

2012-06-06  Ami Fischman  <fischman@chromium.org>

        [chromium] Add a WebKit::WebMediaPlayer::CORSMode enum in preparation for 88349
        https://bugs.webkit.org/show_bug.cgi?id=88388

        Reviewed by Darin Fisher.

        * public/WebMediaPlayer.h:

2012-06-05  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140653 to r140700.

        * DEPS:

2012-06-05  Kentaro Hara  <haraken@chromium.org>

        Unreviewed, rolling out r119494.
        http://trac.webkit.org/changeset/119494
        https://bugs.webkit.org/show_bug.cgi?id=87911

        We found similar APIs are already implemented

        * public/WebWidget.h:
        * src/WebViewImpl.cpp:
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/WebViewTest.cpp:
        * tests/data/textarea.html: Removed.

2012-06-05  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140528 to r140653.

        * DEPS:

2012-06-05  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move createLocalStorageNamespace to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=85766

        Reviewed by James Robinson.
        
        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/WebStorageArea.h:
        * public/WebStorageNamespace.h:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKitPlatformSupport):

2012-06-05  Greg Billock  <gbillock@google.com>

        New constructor for WebIntent to be used for delivery
        https://bugs.webkit.org/show_bug.cgi?id=87143

        Reviewed by Darin Fisher.

        When delivering an intent to webkit, the caller needs to be able to
        provide the action, type, and data, and also extra data and ports.

        * public/WebIntent.h:
        (WebIntent):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::deliverIntent):
        * src/WebIntent.cpp:
        (WebKit::WebIntent::WebIntent):
        (WebKit):
        (WebKit::WebIntent::reset):
        (WebKit::WebIntent::messagePortChannelsRelease):

2012-06-05  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140492 to r140528.

        * DEPS:

2012-06-05  Seigo Nonaka  <nona@chromium.org>

        [chromium] There is no way to retrieve composition character rectangle in WebKit/chromium
        https://bugs.webkit.org/show_bug.cgi?id=87911

        Reviewed by Ryosuke Niwa.

        Add an API for retreieving each character bounds in composition text.
        This API is necessary for implementing IMR_QUERYCHARPOSITION message in Windows.
        The message is used by Japanese IME for showing their window at the correct position.

        * public/WebWidget.h:
        (WebWidget):
        (WebKit::WebWidget::compositionCharacterBounds):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::compositionCharacterBounds):
        (WebKit):
        * src/WebViewImpl.h:
        (WebViewImpl):

2012-06-05  Dongwoo Im  <dw.im@samsung.com>

        Add 'isProtocolHandlerRegistered' and 'unregisterProtocolHandler'.
        https://bugs.webkit.org/show_bug.cgi?id=73176

        Reviewed by Adam Barth.

        Two more APIs are added in Custom Scheme Handler specification.
        http://dev.w3.org/html5/spec/Overview.html#custom-handlers
        One is 'isProtocolHandlerRegistered' to query whether the specific URL
        is registered or not.
        The other is 'unregisterProtocolHandler' to remove the registered URL.

        * features.gypi: Add a macro 'ENABLE_CUSTOM_SCHEME_HANDLER'.

2012-06-05  Kent Tamura  <tkent@chromium.org>

        Move some function definitions in EmptyClients.h to EmptyClients.cpp
        https://bugs.webkit.org/show_bug.cgi?id=88285

        Reviewed by Ryosuke Niwa.

        * src/WebHelperPluginImpl.cpp: Remove unnecessary #includes, and add necessary #includes.
        * src/WebPagePopupImpl.cpp: ditto.

2012-06-05  Noel Gordon  <noel.gordon@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-05  Adam Barth  <abarth@webkit.org>

        EventHandler shouldn't dispatch fake mousemove events when scrolling on devices that don't have a mouse
        https://bugs.webkit.org/show_bug.cgi?id=88270

        Reviewed by James Robinson.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setDeviceSupportsMouse):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove redundant setNeedsCommit when prepareToDraw fails
        https://bugs.webkit.org/show_bug.cgi?id=88246

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Allow CCLayerImpl to find its layer tree host, and use this for CCVideoLayerImpl instead of always-null pointer.
        https://bugs.webkit.org/show_bug.cgi?id=88252

        Reviewed by James Robinson.

        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/TreeSynchronizerTest.cpp:
        (WebKitTests::expectTreesAreIdentical):
        (WebKitTests::TEST):

2012-06-04  Ryosuke Niwa  <rniwa@webkit.org>

        yet another build fix attempt.

        * src/WebHelperPluginImpl.cpp:

2012-06-04  Ryosuke Niwa  <rniwa@webkit.org>

        Another Chromium Windows build fix attempt after r119411.

        * src/WebHelperPluginImpl.cpp:

2012-06-04  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] CCDamageTrackerTest.verifyDamageForPerspectiveClippedLayer needs to be cleaner
        https://bugs.webkit.org/show_bug.cgi?id=85245

        Reviewed by James Robinson.

        Updated CCDamageTrackerTest.verifyDamageForPerspectiveClippedLayer
        so that the test is clearer and cleaner. The original test was
        covering what it needed, but in a confusing and not-so-practical
        way. This patch adds comments and performs a tighter test so that
        the intent is a bit more clear.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):

2012-06-04  Ryosuke Niwa  <rniwa@webkit.org>

        Fix attempt after r119411.

        * src/WebHelperPluginImpl.cpp:

2012-06-04  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        [chromium] Fix software rendering for larger device-scale-factor
        https://bugs.webkit.org/show_bug.cgi?id=88136

        Reviewed by Darin Fisher.

        The fix is to apply the device-scale factor on the GraphicsContext.
        (and add a WebWidgetClient::deviceScaleFactor method to facilitate that).

        * public/WebWidgetClient.h:
        (WebWidgetClient):
        (WebKit::WebWidgetClient::deviceScaleFactor):
        * src/PageWidgetDelegate.cpp:
        (WebKit::PageWidgetDelegate::paint):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):

2012-06-04  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        Combobox options and autofill options should not be scaled for device-scale factor.
        https://bugs.webkit.org/show_bug.cgi?id=87921

        Reviewed by Darin Fisher.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::applyAutofillSuggestions):

2012-06-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Make LayerRendererChromium use RenderPasses instead of RenderSurfaces
        https://bugs.webkit.org/show_bug.cgi?id=88132

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):
        (FakeCCRendererClient::rootRenderPass):
        (FakeCCRendererClient):
        (TEST_F):

2012-06-04  David Dorwin  <ddorwin@chromium.org>

        Enable Chromium media player to instantiate a plugin
        https://bugs.webkit.org/show_bug.cgi?id=87399

        Reviewed by Kent Tamura.

        Adds WebHelperPlugin, an off-screen widget that contains an <object> tag.

        * WebKit.gyp:
        * public/WebHelperPlugin.h: Copied from Source/WebKit/chromium/public/WebPopupType.h.
        (WebKit):
        (WebHelperPlugin):
        (WebKit::WebHelperPlugin::~WebHelperPlugin):
        * public/WebMediaPlayerClient.h:
        (WebKit):
        * public/WebPopupType.h:
        * public/WebView.h:
        * public/WebViewClient.h:
        (WebKit):
        (WebViewClient):
        (WebKit::WebViewClient::initializeHelperPluginWebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::WebFrameImpl):
        (WebKit::WebFrameImpl::initializeAsMainFrame):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebHelperPluginImpl.cpp: Added.
        (WebKit):
        (WebKit::addString):
        (WebKit::writeDocument):
        (HelperPluginChromeClient):
        (WebKit::HelperPluginChromeClient::HelperPluginChromeClient):
        (WebKit::WebHelperPluginImpl::WebHelperPluginImpl):
        (WebKit::WebHelperPluginImpl::~WebHelperPluginImpl):
        (WebKit::WebHelperPluginImpl::init):
        (WebKit::WebHelperPluginImpl::initializeFrame):
        (WebKit::WebHelperPluginImpl::initPage):
        (WebKit::WebHelperPluginImpl::setCompositorSurfaceReady):
        (WebKit::WebHelperPluginImpl::composite):
        (WebKit::WebHelperPluginImpl::layout):
        (WebKit::WebHelperPluginImpl::setFocus):
        (WebKit::WebHelperPluginImpl::close):
        (WebKit::WebHelperPluginImpl::closeHelperPlugin):
        (WebKit::WebHelperPlugin::create):
        * src/WebHelperPluginImpl.h: Copied from Source/WebKit/chromium/public/WebPopupType.h.
        (WebCore):
        (WebKit):
        (WebHelperPluginImpl):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::~WebMediaPlayerClientImpl):
        (WebKit::WebMediaPlayerClientImpl::createHelperPlugin):
        (WebKit):
        (WebKit::WebMediaPlayerClientImpl::closeHelperPlugin):
        * src/WebMediaPlayerClientImpl.h:
        (WebKit):
        (WebMediaPlayerClientImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::initializeMainFrame):
        (WebKit::WebViewImpl::initializeHelperPluginFrame):
        (WebKit):
        (WebKit::WebViewImpl::createHelperPlugin):
        * src/WebViewImpl.h:
        (WebKit):
        (WebViewImpl):

2012-06-04  Raymes Khoury  <raymes@chromium.org>

        Remove obsolete acceptMIMETypes member.
        https://bugs.webkit.org/show_bug.cgi?id=88241

        Reviewed by Darin Fisher.

        Obsoleted by https://bugs.webkit.org/show_bug.cgi?id=87271 and http://codereview.chromium.org/10414085/.

        * public/WebFileChooserParams.h:
        (WebFileChooserParams):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::runOpenPanel):

2012-06-04  Zeev Lieber  <zlieber@chromium.org>

        [chromium] Cleanup scissor rect computation/use with damage
        https://bugs.webkit.org/show_bug.cgi?id=87167

        Reviewed by Adrienne Walker.

        Added unit tests to CCLayerTreeHostImpl using mock graphic context
        to verify end-to-end quad drawing.

        Added more test cases to CCLayerTreeHostCommon to verify clip and
        scissor rect computations.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::executeCalculateDrawTransformsAndVisibility):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::calcDrawEtc):
        * tests/CCRenderSurfaceTest.cpp:

2012-06-03  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140222 to r140260.

        * DEPS:

2012-06-03  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140000 to r140222.

        * DEPS:

2012-06-03  Varun Jain  <varunjain@google.com>

        [chromium] Add new gesture type (two finger tap) that triggers context menu.
        https://bugs.webkit.org/show_bug.cgi?id=88173

        Reviewed by Adam Barth.

        * public/WebInputEvent.h:
        * src/PageWidgetDelegate.cpp:
        (WebKit::PageWidgetDelegate::handleInputEvent):
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::handleInputEvent):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):

2012-06-03  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] replace isScrollGestureEventType with isGestureEventType
        https://bugs.webkit.org/show_bug.cgi?id=88097

        This change replaces the unused and incorrect isScrollGestureEventType
        method with a correct and useful isGestureEventType method.

        Reviewed by Adam Barth.

        * public/WebInputEvent.h:
        (WebInputEvent):
        (WebKit::WebInputEvent::isGestureEventType):

2012-06-01  Alexandre Elias  <aelias@google.com>

        [chromium] Software compositor initialization and base classes
        https://bugs.webkit.org/show_bug.cgi?id=87920

        Reviewed by James Robinson.

        Add a new setting to force software compositing.  In this mode,
        no GraphicsContext3D should ever be created.

        * public/WebSettings.h:
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCSettings):
        (WebKit::WebLayerTreeView::context):
        * src/WebLayerTreeViewImpl.cpp:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        (WebKit::WebSettingsImpl::setForceSoftwareCompositing):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        (WebKit::WebSettingsImpl::forceSoftwareCompositing):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit::WebViewImpl::createCompositorGraphicsContext3D):
        (WebKit::WebViewImpl::createContext3D):
        * tests/CCLayerTreeHostImplTest.cpp:
        (WebKitTests::CCLayerTreeHostImplTest::createContext):
        (WebKitTests::TEST_F):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestAtomicCommit::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommit::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::drawLayersOnCCThread):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::Texture::updateRect):
        * tests/CCTiledLayerTestCommon.h:
        (Texture):
        (WebKitTests::FakeTextureCopier::copyTexture):
        (WebKitTests::FakeTextureUploader::uploadTexture):
        * tests/Canvas2DLayerChromiumTest.cpp:
        (Canvas2DLayerChromiumTest::fullLifecycleTest):
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeLayerRendererChromium::FakeLayerRendererChromium):
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (LayerRendererChromiumTest):
        (TEST):
        * tests/TextureCopierTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        (WTF::TEST):

2012-06-01  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119283, r119287, and r119291.
        http://trac.webkit.org/changeset/119283
        http://trac.webkit.org/changeset/119287
        http://trac.webkit.org/changeset/119291
        https://bugs.webkit.org/show_bug.cgi?id=88159

        Not only broke compilation in the initial commit but also
        broke LayerChromiumTest.basicCreateAndDestroy (Requested by
        rniwa on #webkit).

        * tests/CCAnimationTestCommon.cpp:
        (WebCore::addOpacityTransition):
        (WebCore::addAnimatedTransform):
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::MockGraphicsLayerClient::notifyAnimationStarted):
        (WebKitTests::MockGraphicsLayerClient::notifySyncRequired):
        (WebKitTests::MockGraphicsLayerClient::paintContents):
        (WebKitTests::MockGraphicsLayerClient::showDebugBorders):
        (WebKitTests::MockGraphicsLayerClient::showRepaintCounter):
        (WebKitTests::TEST):

2012-06-01  Ryosuke Niwa  <rniwa@webkit.org>

        Use fully qualified name for Fixed to avoid the collision with "typedef SInt32 Fixed" in MacTypes.h

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::TEST_F):

2012-06-01  James Robinson  <jamesr@chromium.org>

        [chromium] Unreviewed compile fix for r119283

        For the record, Dana Jensens <danakj@chromium.org> wrote this slightly faster than I did.

        * tests/CCAnimationTestCommon.h:

2012-06-01  Ian Vollick  <vollick@chromium.org>

        [chromium] Accelerated animations should use WebTransformOperations
        https://bugs.webkit.org/show_bug.cgi?id=87686

        Reviewed by James Robinson.

        CCTransformKeyframe new owns a WebTransformOperations rather than a
        TransformOperations. LayerChromium's API has been changed so that
        LayerChromium::addAnimation should take only a CCActiveAnimation.
        GraphicsLayerChromium is new responsible for translating to
        WebTransformOperations and creating CCActiveAnimations. Tests that use
        the public API (that is, they call addAnimation with KeyframeValueList
        and Animation arguments) have been moved to GraphicsLayerChromiumTest.

        * tests/CCAnimationTestCommon.cpp:
        (WebCore::addOpacityTransition):
        (WebCore::addAnimatedTransform):
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerAnimationControllerTest.cpp:
        (WebKitTests::TEST):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (MockLayerTreeHostClient):
        (WebKitTests):
        (MockLayerTreeHost):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::~GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::expectTranslateX):
        (WebKitTests::TEST_F):

2012-06-01  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call clipboard methods directly
        https://bugs.webkit.org/show_bug.cgi?id=88038

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/AssertMatchingEnums.cpp:
        * src/PlatformSupport.cpp:
        (WebCore::getCookieJar):

2012-06-01  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-01  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform][Decimal] UInt128::operator/= calls makeUInt128 with wrong argument order
        https://bugs.webkit.org/show_bug.cgi?id=88044

        Reviewed by Kent Tamura.

        * tests/DecimalTest.cpp:
        (TEST_F): Add a new test for multiplication.

2012-05-31  Hajime Morrita  <morrita@chromium.org>

        REGRESSION(r117572): editing/spelling/spellcheck-async-remove-frame.html crashes on Mac
        https://bugs.webkit.org/show_bug.cgi?id=86859

        Removed a port specific fix which was introduced at r117572.

        Reviewed by Ryosuke Niwa.

        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::frameWillDetachPage):
        (WebKit::EditorClientImpl::requestCheckingOfString):
        * src/EditorClientImpl.h:
        (WebCore):
        (EditorClientImpl):
        * src/WebTextCheckingCompletionImpl.cpp:
        (WebKit::WebTextCheckingCompletionImpl::didFinishCheckingText):
        (WebKit::WebTextCheckingCompletionImpl::didCancelCheckingText):
        * src/WebTextCheckingCompletionImpl.h:
        (WebKit::WebTextCheckingCompletionImpl::WebTextCheckingCompletionImpl):
        (WebTextCheckingCompletionImpl):

2012-05-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119146.
        http://trac.webkit.org/changeset/119146
        https://bugs.webkit.org/show_bug.cgi?id=88035

        android breakage fixed in http://crrev.com/139945 (Requested
        by fischman on #webkit).

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::didLoadingProgress):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-05-31  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Migrate to WebTransformationMatrix
        https://bugs.webkit.org/show_bug.cgi?id=87788

        Reviewed by James Robinson.

        * src/WebLayer.cpp:
        (WebKit::WebLayer::setSublayerTransform):
        (WebKit::WebLayer::setTransform):
        * tests/CCAnimationTestCommon.cpp:
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::executeCalculateDrawTransformsAndVisibility):
        (WebKitTests::TEST_F):
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerSorterTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::commitCompleteOnCCThread):
        (WTF::setLayerPropertiesForTesting):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::beginTest):
        (WTF::setTestLayerPropertiesForTesting):
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/CCLayerTreeTestCommon.h:
        (WebKitTests):
        * tests/CCMathUtilTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::createRoot):
        (WebKitTests::CCOcclusionTrackerTest::createLayer):
        (WebKitTests::CCOcclusionTrackerTest::createSurface):
        (WebKitTests::CCOcclusionTrackerTest::createDrawingLayer):
        (WebKitTests::CCOcclusionTrackerTest::createReplicaLayer):
        (WebKitTests::CCOcclusionTrackerTest::createDrawingSurface):
        (CCOcclusionTrackerTest):
        (WebKitTests::CCOcclusionTrackerTest::setBaseProperties):
        (WebKitTests::CCOcclusionTrackerTest::setProperties):
        (WebKitTests::CCOcclusionTrackerTestRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTranslatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceRotatedOffAxis::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithTwoOpaqueChildren::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestFilters::runMyTest):
        (WebKitTests::CCOcclusionTrackerTest3dTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransformBehindCamera::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerBehindCameraDoesNotOcclude::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLargePixelsOccludeInsideClipRect::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesToParent::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTwoBackgroundFiltersReduceOcclusionTwice::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionBelowBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionIfBackgroundFilterIsOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReduceOcclusionWhenBackgroundFilterIsPartiallyOccluded::runMyTest):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/FloatQuadTest.cpp:
        * tests/LayerChromiumTest.cpp:
        * tests/LinkHighlightTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):
        (WebKit):

2012-05-31  Ian Vollick  <vollick@chromium.org>

        [chromium] Single thread proxy should not tick animations unless the layer renderer has been initialized
        https://bugs.webkit.org/show_bug.cgi?id=87873

        Reviewed by James Robinson.

        When the layer renderer fails to initialize, be sure to stop the animation timer.

        * tests/CCLayerTreeHostTest.cpp:
        (CompositorFakeWebGraphicsContext3DWithTextureTracking):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::create):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::createTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::deleteTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::bindTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::numTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::texture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::resetTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::numUsedTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::usedTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::resetUsedTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::CompositorFakeWebGraphicsContext3DWithTextureTracking):
        (WTF):
        (WTF::TestHooks::didRecreateContext):
        (TestHooks):
        (WTF::TestHooks::createContext):
        (CCLayerTreeHostTest):
        (WTF::CCLayerTreeHostTest::clearEndTestTask):
        (WTF::CCLayerTreeHostTest::CCLayerTreeHostTest):
        (EndTestTask):
        (WTF::CCLayerTreeHostTest::EndTestTask::EndTestTask):
        (WTF::CCLayerTreeHostTest::EndTestTask::~EndTestTask):
        (WTF::CCLayerTreeHostTest::EndTestTask::clearTest):
        (WTF::CCLayerTreeHostTest::EndTestTask::run):
        (WTF::CCLayerTreeHostTest::runTest):
        (WTF::CCLayerTreeHostTest::endTestAfterDelay):
        (FakeWebGraphicsContext3DMakeCurrentFails):
        (WTF::FakeWebGraphicsContext3DMakeCurrentFails::makeContextCurrent):
        (CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::beginTest):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::animateLayers):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::didRecreateContext):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::afterTest):
        (WTF::TEST_F):

2012-05-15  Brett Wilson  <brettw@chromium.org>

        Hook up GTK IsKeyPad flag for keyboard events, and preserve this flag
        on all platforms when converting back to a WebKeyboardEvent.

        https://bugs.webkit.org/show_bug.cgi?id=86514

        Reviewed by Dimitri Glazkov.

        * src/WebInputEventConversion.cpp:
        (WebKit::WebKeyboardEventBuilder::WebKeyboardEventBuilder):
        * src/gtk/WebInputEventFactory.cpp:
        (WebKit::WebInputEventFactory::keyboardEvent):
        * tests/WebInputEventFactoryTestGtk.cpp:

2012-05-31  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Implement IDBTransaction.error and IDBRequest.error
        https://bugs.webkit.org/show_bug.cgi?id=87865

        Reviewed by Tony Chang.

        IDBDatabaseError now honors IDB-specific DOMException codes,
        so make sure that's how they are passed to/from chromium.

        * src/WebIDBDatabaseError.cpp:
        (WebKit::WebIDBDatabaseError::assign):

2012-05-31  James Robinson  <jamesr@chromium.org>

        [chromium] Assertion failures during compositor startup in lost context situations
        https://bugs.webkit.org/show_bug.cgi?id=87912

        Reviewed by Adrienne Walker.

        Adds a unit test verifying that even if we lose our context during or before initialization we get through the
        rest of the path without failing ASSERT()s.

        * tests/LayerRendererChromiumTest.cpp:
        (LoseContextOnFirstGetContext):
        (LoseContextOnFirstGetContext::LoseContextOnFirstGetContext):
        (TEST):

2012-05-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119125.
        http://trac.webkit.org/changeset/119125
        https://bugs.webkit.org/show_bug.cgi?id=88007

        Will break android build if rolled (Requested by rafaelw_ on
        #webkit).

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::bytesLoaded):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-05-31  Dana Jansens  <danakj@chromium.org>

        [chromium] Move drawing code for RenderSurfaces into LayerRendererChromium
        https://bugs.webkit.org/show_bug.cgi?id=87877

        Reviewed by James Robinson.

        * tests/CCRenderSurfaceTest.cpp:
        (WebCore::TEST):

2012-05-31  Ami Fischman  <fischman@chromium.org>

        Replace WebMediaPlayer::bytesLoaded() with an explicit didLoadingProgress()
        https://bugs.webkit.org/show_bug.cgi?id=86113

        Reviewed by Eric Carlson.

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::didLoadingProgress):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-05-31  Ian Vollick  <vollick@chromium.org>

        [chromium] create WebTransformOperation interface for chromium platform
        https://bugs.webkit.org/show_bug.cgi?id=87510

        Reviewed by James Robinson.

        * WebKit.gypi:
        * tests/WebTransformOperationsTest.cpp: Added.
        (TEST):
        (checkProgress):

2012-05-31  Alexander Pavlov  <apavlov@chromium.org>

        Web Inspector: [Chromium] Cannot bring Inspector to front when paused on breakpoint
        https://bugs.webkit.org/show_bug.cgi?id=87871

        Reviewed by Yury Semikhatsky.

        When input events handling is suppressed (due to the JS being paused on a breakpoint), we should report
        these events as NOT handled by the WebKit, so that the browser can handle them appropriately
        (on MacOS, switching between the application windows is done through the default key event handler, so if you run
        event.preventDefault() for all keydown events in a handler, the Chromium window switch will not occur on Cmd+`).

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleInputEvent):

2012-05-31  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-30  Peter Beverloo  <peter@chromium.org>

        [Chromium] Automatically install 64-bit linker for Android
        https://bugs.webkit.org/show_bug.cgi?id=79780

        Reviewed by Adam Barth.

        Change the Android-specific dependencies to inherit their revision from
        Chromium's DEPS file, like many other dependencies do, solving the
        versioning problem that we're running in to right now. These are listed
        in Chromium's main DEPS file starting Chromium r139529.

        * DEPS:

2012-05-31  Yoshifumi Inoue  <yosin@chromium.org>

        Build fix for Chromium Linux (Tests) after r119073.

        * tests/DecimalTest.cpp:
        (TEST_F):

2012-05-31  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Introduce Decimal class for Number/Range input type.
        https://bugs.webkit.org/show_bug.cgi?id=87360

        Reviewed by Kent Tamura.

        This patch added unit test for Decimal class.

        * WebKit.gypi:
        * tests/DecimalTest.cpp: Added.
        (WebCore):
        (WebCore::operator<<): Output Decimal for unit test debugging
        (DecimalStepRange):
        (DecimalStepRange::DecimalStepRange):
        (DecimalStepRange::clampValue):
        (DecimalTest):
        (DecimalTest::encode):
        (DecimalTest::fromString):
        (DecimalTest::stepDown):
        (DecimalTest::stepUp):
        (TEST_F):

2012-05-30  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: add MemoryUsageSupport::processMemorySizesInBytes
        https://bugs.webkit.org/show_bug.cgi?id=87830

        Reviewed by James Robinson.

        * public/platform/WebKitPlatformSupport.h: pulled getProcessMemorySize up
        to the Source/Platform/chromium/public/Platform.h
        * src/PlatformSupport.cpp:

2012-05-31  Kent Tamura  <tkent@chromium.org>

        Unreviewed, rolling out r119062 and r119064.
        http://trac.webkit.org/changeset/119062
        http://trac.webkit.org/changeset/119064
        https://bugs.webkit.org/show_bug.cgi?id=87360

        Broke build on Lion, SnowLoepard, Chromium Windows, and
        Chromium Linux 32

        * WebKit.gypi:
        * tests/DecimalTest.cpp: Removed.

2012-05-30  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Introduce Decimal class for Number/Range input type.
        https://bugs.webkit.org/show_bug.cgi?id=87360

        Reviewed by Kent Tamura.

        This patch added unit test for Decimal class.

        * WebKit.gypi:
        * tests/DecimalTest.cpp: Added.
        (WebCore):
        (WebCore::operator<<): Output Decimal for unit test debugging
        (DecimalStepRange):
        (DecimalStepRange::DecimalStepRange):
        (DecimalStepRange::clampValue):
        (DecimalTest):
        (DecimalTest::encode):
        (DecimalTest::fromString):
        (DecimalTest::stepDown):
        (DecimalTest::stepUp):
        (TEST_F):

2012-05-30  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Fix min/max bounds error in CCMathUtil.cpp
        https://bugs.webkit.org/show_bug.cgi?id=87915

        Reviewed by James Robinson.

        * tests/CCMathUtilTest.cpp:
        (WebCore::TEST):
        (WebCore):

2012-05-30  Ami Fischman  <fischman@chromium.org>

        Roll chromium DEPS from r139300 to r139542.  Unreviewed.
        https://bugs.webkit.org/show_bug.cgi?id=87868

        * DEPS:

2012-05-30  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call fileUtilities methods directly
        https://bugs.webkit.org/show_bug.cgi?id=87852

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-05-30  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118986.
        http://trac.webkit.org/changeset/118986
        https://bugs.webkit.org/show_bug.cgi?id=87914

        Caused several IndexedDB browser_test failures on Chromium
        canary builders (Requested by rafaelw_ on #webkit).

        * src/WebIDBDatabaseError.cpp:
        (WebKit::WebIDBDatabaseError::assign):

2012-05-30  Dominic Mazzoni  <dmazzoni@google.com>

        AX: Chromium WebAccessibilityObject should check if an AccessibilityObject is detached
        https://bugs.webkit.org/show_bug.cgi?id=87778

        Reviewed by Adam Barth.

        Pretty simple - all places that previously just checked for null
        now also check if the wrapped AccessibilityObject is detached.

        * public/WebAccessibilityObject.h:
        (WebAccessibilityObject):
        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::isDetached):
        (WebKit):
        (WebKit::WebAccessibilityObject::axID):
        (WebKit::WebAccessibilityObject::accessibilityDescription):
        (WebKit::WebAccessibilityObject::actionVerb):
        (WebKit::WebAccessibilityObject::canSetFocusAttribute):
        (WebKit::WebAccessibilityObject::canSetValueAttribute):
        (WebKit::WebAccessibilityObject::isValid):
        (WebKit::WebAccessibilityObject::childCount):
        (WebKit::WebAccessibilityObject::childAt):
        (WebKit::WebAccessibilityObject::firstChild):
        (WebKit::WebAccessibilityObject::focusedChild):
        (WebKit::WebAccessibilityObject::lastChild):
        (WebKit::WebAccessibilityObject::nextSibling):
        (WebKit::WebAccessibilityObject::parentObject):
        (WebKit::WebAccessibilityObject::previousSibling):
        (WebKit::WebAccessibilityObject::canSetSelectedAttribute):
        (WebKit::WebAccessibilityObject::isAnchor):
        (WebKit::WebAccessibilityObject::isAriaReadOnly):
        (WebKit::WebAccessibilityObject::isButtonStateMixed):
        (WebKit::WebAccessibilityObject::isChecked):
        (WebKit::WebAccessibilityObject::isCollapsed):
        (WebKit::WebAccessibilityObject::isControl):
        (WebKit::WebAccessibilityObject::isEnabled):
        (WebKit::WebAccessibilityObject::isFocused):
        (WebKit::WebAccessibilityObject::isHovered):
        (WebKit::WebAccessibilityObject::isIndeterminate):
        (WebKit::WebAccessibilityObject::isLinked):
        (WebKit::WebAccessibilityObject::isLoaded):
        (WebKit::WebAccessibilityObject::isMultiSelectable):
        (WebKit::WebAccessibilityObject::isOffScreen):
        (WebKit::WebAccessibilityObject::isPasswordField):
        (WebKit::WebAccessibilityObject::isPressed):
        (WebKit::WebAccessibilityObject::isReadOnly):
        (WebKit::WebAccessibilityObject::isRequired):
        (WebKit::WebAccessibilityObject::isSelected):
        (WebKit::WebAccessibilityObject::isSelectedOptionActive):
        (WebKit::WebAccessibilityObject::isVertical):
        (WebKit::WebAccessibilityObject::isVisible):
        (WebKit::WebAccessibilityObject::isVisited):
        (WebKit::WebAccessibilityObject::accessKey):
        (WebKit::WebAccessibilityObject::ariaHasPopup):
        (WebKit::WebAccessibilityObject::ariaLiveRegionAtomic):
        (WebKit::WebAccessibilityObject::ariaLiveRegionBusy):
        (WebKit::WebAccessibilityObject::ariaLiveRegionRelevant):
        (WebKit::WebAccessibilityObject::ariaLiveRegionStatus):
        (WebKit::WebAccessibilityObject::boundingBox):
        (WebKit::WebAccessibilityObject::estimatedLoadingProgress):
        (WebKit::WebAccessibilityObject::helpText):
        (WebKit::WebAccessibilityObject::headingLevel):
        (WebKit::WebAccessibilityObject::hierarchicalLevel):
        (WebKit::WebAccessibilityObject::hitTest):
        (WebKit::WebAccessibilityObject::keyboardShortcut):
        (WebKit::WebAccessibilityObject::performDefaultAction):
        (WebKit::WebAccessibilityObject::roleValue):
        (WebKit::WebAccessibilityObject::selectionEnd):
        (WebKit::WebAccessibilityObject::selectionStart):
        (WebKit::WebAccessibilityObject::setFocused):
        (WebKit::WebAccessibilityObject::stringValue):
        (WebKit::WebAccessibilityObject::title):
        (WebKit::WebAccessibilityObject::titleUIElement):
        (WebKit::WebAccessibilityObject::url):
        (WebKit::WebAccessibilityObject::valueDescription):
        (WebKit::WebAccessibilityObject::valueForRange):
        (WebKit::WebAccessibilityObject::maxValueForRange):
        (WebKit::WebAccessibilityObject::minValueForRange):
        (WebKit::WebAccessibilityObject::node):
        (WebKit::WebAccessibilityObject::document):
        (WebKit::WebAccessibilityObject::hasComputedStyle):
        (WebKit::WebAccessibilityObject::computedStyleDisplay):
        (WebKit::WebAccessibilityObject::accessibilityIsIgnored):
        (WebKit::WebAccessibilityObject::lineBreaks):
        (WebKit::WebAccessibilityObject::columnCount):
        (WebKit::WebAccessibilityObject::rowCount):

2012-05-30  Shawn Singh  <shawnsingh@chromium.org>

        Simplify TransformationMatrix rotation code to improve precision
        https://bugs.webkit.org/show_bug.cgi?id=86666

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):
        (WebKit):

2012-05-30  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Implement IDBTransaction.error and IDBRequest.error
        https://bugs.webkit.org/show_bug.cgi?id=87865

        Reviewed by Tony Chang.

        IDBDatabaseError now honors IDB-specific DOMException codes,
        so make sure that's how they are passed to/from chromium.

        * src/WebIDBDatabaseError.cpp:
        (WebKit::WebIDBDatabaseError::assign):

2012-05-30  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Merge shared code in CCOcclusionTrackerTest
        https://bugs.webkit.org/show_bug.cgi?id=87798

        Reviewed by Adrienne Walker.

        This patch simple uses a different existing macro function so that
        the same thing doesn't exist in multiple places, and so that the
        naming is more consistent with gtest's conventions.

        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTestIdentityTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTranslatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceRotatedOffAxis::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithTwoOpaqueChildren::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestFilters::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaDoesOcclude::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithMask::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerScissorRectOutsideChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestScreenScissorRectOutsideChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerScissorRectPartlyOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestScreenScissorRectPartlyOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOpaqueContentsRegionNonEmpty::runMyTest):
        (WebKitTests::CCOcclusionTrackerTest3dTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity1OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity0OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationTranslateOnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesToParent::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithReplicaUnoccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceAndReplicaOccludedDifferently::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfClippingSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTwoBackgroundFiltersReduceOcclusionTwice::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilterWithClip::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionBelowBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionIfBackgroundFilterIsOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestMinimumTrackingSize::runMyTest):

2012-05-30  Tony Chang  <tony@chromium.org>

        [chromium] port webframe_unittest.cc to webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=87796

        Reviewed by James Robinson.

        Move WebFrameTest.GetContentAsPlainText and WebFrameTest.GetFullHtmlOfPage to webkit_unit_tests.

        * tests/WebFrameTest.cpp:
        (WebKit::TEST_F):
        (WebKit): Add tests.

2012-05-30  Jochen Eisinger  <jochen@chromium.org>

        Match Firefox restrictions to window.blur and window.focus
        https://bugs.webkit.org/show_bug.cgi?id=86969

        Reviewed by Adam Barth.

        Allow window.focus() during the dispatch of the click event on
        notifications.

        * src/WebNotification.cpp:
        (WebKit::WebNotification::dispatchClickEvent):

2012-05-29  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move fileExists to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=87531

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-05-29  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Align codes and names for IDB-specific and DOM-specific errors/exceptions
        https://bugs.webkit.org/show_bug.cgi?id=87276

        Reviewed by Tony Chang.

        * public/WebIDBDatabaseException.h:
        * src/AssertMatchingEnums.cpp:

2012-05-29  Rafael Weinstein  <rafaelw@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-29  Dana Jansens  <danakj@chromium.org>

        [chromium] Unoccluded area in surfaces should always be clipped to the rootScissorRect
        https://bugs.webkit.org/show_bug.cgi?id=87677

        Reviewed by Adrienne Walker.

        * tests/CCOcclusionTrackerTest.cpp:
        (CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor):
        (WebKitTests::CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor::runMyTest):
        (WebKitTests):

2012-05-29  David Barr  <davidbarr@chromium.org>

        Introduce ENABLE_CSS_IMAGE_RESOLUTION compile flag
        https://bugs.webkit.org/show_bug.cgi?id=87685

        Reviewed by Eric Seidel.

        Add a configuration option for CSS image-resolution support, disabling it by default.

        * features.gypi:

2012-05-29  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-29  Hironori Bono  <hbono@chromium.org>

        Use WebSpellCheckClient::spellcheck to retrieve suggestions.
        https://bugs.webkit.org/show_bug.cgi?id=87690

        Reviewed by Hajime Morita.

        This change uses WebSpellCheckClient::spellcheck as a fallback method to
        retrieve suggestions when a marker does not have any suggestions. (It consumes
        lots of CPU power to get suggestions for misspelled word, i.e. Chromium cannot
        afford to attach suggestions to all spelling markers.)

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Retrieve suggestions if markers do not have any.

2012-05-28  Takashi Toyoshima  <toyoshim@chromium.org>

        [WebSocket] Receiving reserved close codes, 1005, 1006, and 1015 must appear as code=1006 and wasClean=false
        https://bugs.webkit.org/show_bug.cgi?id=87084

        Reviewed by Kent Tamura.

        Update close event codes corresponding to WebSocketChannel::CloseEventCode.

        * public/WebSocket.h: Update on newly defined close event codes

2012-05-28  MORITA Hajime  <morrita@google.com>

        Rename FrameLoaderClient::shadowDOMAllowed() to allowShadowDOM()
        https://bugs.webkit.org/show_bug.cgi?id=87101

        Reviewed by Kentaro Hara.

        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::allowShadowDOM):
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):

2012-05-28  Rob Flack  <flackr@chromium.org>

        [chromium] Only increase size of Combo Box Options when displayed on touch screen
        https://bugs.webkit.org/show_bug.cgi?id=85921

        Reviewed by Adam Barth.

        Adds a flag to set whether the current device is a touch screen, independent of whether touch events are supported and use this for the combo box sizing.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::defaultDeviceScaleFactor):
        (WebKit):
        (WebKit::WebSettingsImpl::setDeviceSupportsTouch):
        (WebKit::WebSettingsImpl::deviceSupportsTouch):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::applyAutofillSuggestions):
        * tests/PopupMenuTest.cpp:
        (WebKit::SelectPopupMenuTest::SetUp):
        (WebKit::SelectPopupMenuTest::TearDown):
        (SelectPopupMenuTest):
        (WebKit::TEST_F):

2012-05-25  Jesus Sanchez-Palencia  <jesus.palencia@openbossa.org>

        WebKitTestRunner needs to support layoutTestController.setJavaScriptProfilingEnabled
        https://bugs.webkit.org/show_bug.cgi?id=42328

        Reviewed by Eric Seidel.

        Removed private APIs that were only being used by DRT.

        * public/WebDevToolsAgent.h:
        (WebDevToolsAgent):
        * src/WebDevToolsAgentImpl.cpp:
        * src/WebDevToolsAgentImpl.h:
        (WebDevToolsAgentImpl):

2012-05-28  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-28  Peter Beverloo  <peter@chromium.org>

        [Chromium] Build fix for the Android bot, set CXX_target at gyp generation-time
        https://bugs.webkit.org/show_bug.cgi?id=87649

        Unreviewed build fix.

        Chromium Android builds were broken because v8 tried to compile files
        for target with the "-m32" flag. This was caused by a v8 check falling
        back to using "which g++" to find the right compiler, whereas it should
        have used the $CXX_target environment variable. This isn't being set
        for Android builds.

        * gyp_webkit: Set the CXX_target environment variable. Annotate the fix
          with a FIXME comment too.

2012-05-28  Keishi Hattori  <keishi@webkit.org>

        Expose value localization function of HTMLInputElement
        https://bugs.webkit.org/show_bug.cgi?id=84356

        Reviewed by Kent Tamura.

        * public/WebInputElement.h:
        (WebInputElement):
        * src/WebInputElement.cpp:
        (WebKit::WebInputElement::localizeValue):
        (WebKit):

2012-05-28  MORITA Hajime <morrita@google.com>

        Unreviewed Mac Chromium build fix.

        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::allowStyleScoped):

2012-05-28  MORITA Hajime  <morrita@google.com>

        https://bugs.webkit.org/show_bug.cgi?id=87609
        [Chromium] FrameLoaderClient::allowStyleScoped() should be implemented interms of WebPermissionClient

        Reviewed by Kent Tamura.

        Added allowStyleScoped() implementation which is essentially same as shadowDOMAllowed().

        * src/FrameLoaderClientImpl.cpp:
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):

2012-05-25  Ryosuke Niwa  <rniwa@webkit.org>

        Roll chromium DEPS from r139156 to r139184.

        * DEPS:

2012-05-25  Garrett Casto  <gcasto@chromium.org>

        Allow WebTextFieldDecoratorClient to see applied decorations.
        https://bugs.webkit.org/show_bug.cgi?id=86557

        Reviewed by Kent Tamura.

        * WebKit.gyp: Added new files.
        * public/WebInputElement.h:
        (WebKit::WebInputElement::decorationElementFor): Returns the
        WebElement attached to the WebInputElement by the given
        WebTextFieldDecoratorClient, if one exists.
        * src/TextFieldDecoratorImpl.cpp:
        (WebKit):
        * src/TextFieldDecoratorImpl.h:
        (TextFieldDecoratorImpl::decoratorClient): Get the
        WebTextFieldDecoratorClient owned by this object.

2012-05-25  Mihai Parparita  <mihaip@chromium.org>

        Allow synchronous XHRs to be disabled in documents
        https://bugs.webkit.org/show_bug.cgi?id=87540

        Reviewed by Eric Seidel.

        Synchronous XMLHttpRequests are a problematic API, since they result
        in blocked UI threads. Some clients may wish to always disable them;
        give them a setting to do so (see also r103629 for other cases where
        synchronous XHRs are disabled).

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setSyncXHRInDocumentsEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-25  Kinuko Yasuda  <kinuko@chromium.org>

        [chromium] Deprecate FileUtilities::getFileSize and getFileModifiedTime in favor of getFileMetadata
        https://bugs.webkit.org/show_bug.cgi?id=87492

        Reviewed by Adam Barth.

        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getFileMetadata):

2012-05-25  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r139024 to r139156 in an attempt to fix Chromium Win builds.

        * DEPS:

2012-05-25  Mark Pilgrim  <pilgrim@chromium.org>

        [Chomium] Move sandboxSupport to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=87518

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKitPlatformSupport):
        * public/platform/android/WebSandboxSupport.h:
        * public/platform/linux/WebFontFamily.h:
        * public/platform/linux/WebSandboxSupport.h:
        * public/platform/mac/WebSandboxSupport.h:
        * public/platform/win/WebSandboxSupport.h:
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::ensureFontLoaded):
        (WebCore::PlatformSupport::loadFont):
        (WebCore::PlatformSupport::getFontFamilyForCharacters):
        (WebCore::PlatformSupport::getRenderStyleForStrike):

2012-05-25  Dana Jansens  <danakj@chromium.org>

        [chromium] WebLayerTreeViewImpl should not hide methods in CCLayerTreeHost with signatures that match the Client interface
        https://bugs.webkit.org/show_bug.cgi?id=87301

        Reviewed by James Robinson.

        Most methods in the CCLayerTreeHostClient interface have a matching
        method signature on CCLayerTreeHost that simply calls the client, if
        one exists at all. However, CCLayerTreeHost::updateAnimations() does
        important work in addition to calling the client.

        Currently WebLayerTreeViewImpl itself implements the interface for
        CCLayerTreeHostClient as well as CCLayerTreeHost, and simply forwards
        any call to a method in the client interface to its own client. This
        blocks WebViewImpl from calling CCLayerTreeHost::updateAnimations, since
        the method is also in the client interface.

        We change WebLayerTreeViewImpl to own a CCLayerTreeHost and a
        WebLayerTreeHostClientAdapter. This fixes the shadowing by making
        the two interfaces separate, and resolves lifetime issues by
        ensuring that the CCLayerTreeHost is destroyed before its client.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setSurfaceReady):
        (WebKit::WebLayerTreeView::setRootLayer):
        (WebKit::WebLayerTreeView::compositorIdentifier):
        (WebKit::WebLayerTreeView::setViewportSize):
        (WebKit::WebLayerTreeView::viewportSize):
        (WebKit::WebLayerTreeView::setBackgroundColor):
        (WebKit::WebLayerTreeView::setVisible):
        (WebKit::WebLayerTreeView::setPageScaleFactorAndLimits):
        (WebKit::WebLayerTreeView::startPageScaleAnimation):
        (WebKit::WebLayerTreeView::setNeedsAnimate):
        (WebKit::WebLayerTreeView::setNeedsRedraw):
        (WebKit::WebLayerTreeView::commitRequested):
        (WebKit::WebLayerTreeView::composite):
        (WebKit::WebLayerTreeView::updateAnimations):
        (WebKit::WebLayerTreeView::compositeAndReadback):
        (WebKit::WebLayerTreeView::finishAllRendering):
        (WebKit::WebLayerTreeView::context):
        (WebKit::WebLayerTreeView::loseCompositorContext):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit):
        (WebLayerTreeViewClientAdapter):
        (WebKit::WebLayerTreeViewClientAdapter::WebLayerTreeViewClientAdapter):
        (WebKit::WebLayerTreeViewClientAdapter::~WebLayerTreeViewClientAdapter):
        (WebKit::WebLayerTreeViewImpl::create):
        (WebKit::WebLayerTreeViewImpl::WebLayerTreeViewImpl):
        (WebKit::WebLayerTreeViewImpl::~WebLayerTreeViewImpl):
        * src/WebLayerTreeViewImpl.h:
        (WebCore):
        (WebKit):
        (WebKit::WebLayerTreeViewImpl::layerTreeHost):
        (WebLayerTreeViewImpl):

2012-05-25  Kinuko Yasuda  <kinuko@chromium.org>

        Unreviewed; rolling chromium deps.

        * DEPS:

2012-05-25  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] LayerChromium should recognise existing layer active animations when the layer is added.
        https://bugs.webkit.org/show_bug.cgi?id=87166

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::MockLayerTreeHost::didAddAnimationWasCalled):
        (MockLayerTreeHost):
        (WTF::MockLayerTreeHost::MockLayerTreeHost):
        (WTF):
        (CCLayerTreeHostTestLayerAddedWithAnimation):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::CCLayerTreeHostTestLayerAddedWithAnimation):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::afterTest):

2012-05-17  Andrey Kosyakov  <caseq@chromium.org>

        [chromium] add instrumentation for compositing
        https://bugs.webkit.org/show_bug.cgi?id=83928

        Reviewed by James Robinson.

        - plumb willCommit() and didComposite() to inspector instrumentation via WebViewImpl.

        * WebKit.gypi: Added WebLayerTreeViewTest
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::didBeginFrame):
        (WebKit):
        (WebKit::WebLayerTreeViewImpl::willCommit):
        * src/WebLayerTreeViewImpl.h:
        (WebLayerTreeViewImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::didBeginFrame):
        (WebKit):
        (WebKit::WebViewImpl::willCommit):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp: Added.

2012-05-25  Peter Beverloo  <peter@chromium.org>

        [Chromium] Pull in Android tools from Chromium's repo through the DEPS file
        https://bugs.webkit.org/show_bug.cgi?id=87478

        Reviewed by Kent Tamura.

        Chromium's r122048 added the forwarder tool, which forwards a TCP port
        listening on the device to a port on the host. This now is a required
        dependency of DumpRenderTree, so pull it in.

        Since it's likely that more tools will be required, pull in the entire
        tools/android/ directory in case the Chromium port for Android is being
        checked out or updated.

        * DEPS: Added Android-specific dependency on tools/android/

2012-05-25  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118461.
        http://trac.webkit.org/changeset/118461
        https://bugs.webkit.org/show_bug.cgi?id=87468

        Breaks two chromium browser_tests. (Requested by vsevik on
        #webkit).

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::resize):

2012-05-24  Tim Horton  <timothy_horton@apple.com>

        Add feature defines for web-facing parts of CSS Regions and Exclusions
        https://bugs.webkit.org/show_bug.cgi?id=87442
        <rdar://problem/10887709>

        Reviewed by Dan Bernstein.

        * features.gypi:

2012-05-24  Kent Tamura  <tkent@chromium.org>

        PAGE_POPUP: window.setValueAndClosePopup should be moved to a
        per-context property of DOMWindow.
        https://bugs.webkit.org/show_bug.cgi?id=87086

        Reviewed by Adam Barth.

        * src/WebPagePopupImpl.cpp:
        (WebKit): Add PagePopupFrameLoaderClient, which allows window.pagePopupController.
        (WebKit::WebPagePopupImpl::initPage):
         - Use PagePopupFrameLoaderClient
         - Remove the call of ScriptController::installFunctionsForPagePopup().
         - Call DOMWindowPagePopup::install() to inform m_popupClient to a
           DOMWindowPagePopup object for the DOMWindow.

2012-05-21  Kinuko Yasuda  <kinuko@chromium.org>

        Cleanup: add a file system call which captures the file metadata at once.
        https://bugs.webkit.org/show_bug.cgi?id=86995

        Reviewed by David Levin.

        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getFileMetadata):
        (WebCore):

2012-05-24  Hironori Bono  <hbono@chromium.org>

        Enable grammar checking on Chromium when we paste text  (Take 2)
        https://bugs.webkit.org/show_bug.cgi?id=74393

        Reviewed by Ryosuke Niwa.

        This change enables grammar checking on Chromium and implements a mock grammar
        checker to fix a failing test.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Show suggestions when we right-click grammatically-misspelled words.
        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled): Enable grammar checking when we enable asynchronous spellchecking.
        (WebKit::EditorClientImpl::checkGrammarOfString): set badGrammarLocation to -1 to avoid an assertion error.
        * src/WebTextCheckingResult.cpp:
        (WebKit::WebTextCheckingResult::operator TextCheckingResult): Fill GrammarDetails for grammatical errors.

2012-05-24  Alexandre Elias  <aelias@google.com>

        [chromium] Support mobile device rotation resizing
        https://bugs.webkit.org/show_bug.cgi?id=86819

        Reviewed by Adam Barth.

        Resizes on a mobile device are caused either by rotation or
        on-screen-keyboard bringup, and need different treatment to remain
        naturally laid out, scaled and scrolled without disorienting the user.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::resize):

2012-05-24  Antoine Labour  <piman@chromium.org>

        [chromium] Add a setForceRenderSurface to WebLayer for test/bench purpose
        https://bugs.webkit.org/show_bug.cgi?id=87436

        Reviewed by James Robinson.

        * src/WebLayer.cpp:
        (WebKit::WebLayer::setForceRenderSurface):
        (WebKit):
        (WebKit::WebLayer::forceRenderSurface):
        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):
        * tests/LayerChromiumTest.cpp:

2012-05-24  Adam Barth  <abarth@webkit.org>

        Fix the chromium-android build.

        * features.gypi:

2012-05-24  John Mellor  <johnme@chromium.org>

        Font Boosting: Add compile flag and runtime setting
        https://bugs.webkit.org/show_bug.cgi?id=87394

        Reviewed by Adam Barth.

        Expose fontBoostingEnabled runtime setting via WebSettings.

        * features.gypi:
        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setFontBoostingEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-24  Kinuko Yasuda  <kinuko@chromium.org>

        Cleanup: introduce toFile() to reduce static cast from Blob to File
        https://bugs.webkit.org/show_bug.cgi?id=87234

        Reviewed by Eric Seidel.

        * src/WebDragData.cpp:
        (WebKit::WebDragData::items):

2012-05-24  Lu Guanqun  <guanqun.lu@intel.com>

        use built-in data type DashArray
        https://bugs.webkit.org/show_bug.cgi?id=87344

        Reviewed by Eric Seidel.

        * tests/PlatformContextSkiaTest.cpp:
        (WebCore::TEST):

2012-05-24  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move queryLocalizedString to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=85762

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit::WebKitPlatformSupport::getPluginList):
        * public/platform/WebLocalizedString.h:
        * src/LocalizedStrings.cpp:
        (WebCore::query):

2012-05-24  Dana Jansens  <danakj@chromium.org>

        [chromium] Only display frames created with memory allocations meant to be displayed
        https://bugs.webkit.org/show_bug.cgi?id=85108

        Reviewed by Adrienne Walker.

        Removing code to protect visible textures when a tab becomes invisible,
        as we want to reduce our memory limit for invisible tabs and these
        textures should not be saved.

        * src/NonCompositedContentHost.cpp:
        * src/NonCompositedContentHost.h:
        (NonCompositedContentHost):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setVisibilityState):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TestHooks::didCommit):
        (WTF::CCLayerTreeHostTest::CCLayerTreeHostTest):
        (WTF::CCLayerTreeHostTest::scheduleComposite):
        (WTF::CCLayerTreeHostTest::dispatchComposite):
        (CCLayerTreeHostTest):
        (WTF::CCLayerTreeHostTest::doBeginTest):
        (CCLayerTreeHostTestTickAnimationWhileBackgrounded):
        (WTF::CCLayerTreeHostTestTickAnimationWhileBackgrounded::willAnimateLayers):
        (CCLayerTreeHostTestVisibilityAndAllocationControlDrawing):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::beginTest):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommitAndDrawFrame):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommit):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::afterTest):
        (WTF):

2012-05-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118352.
        http://trac.webkit.org/changeset/118352
        https://bugs.webkit.org/show_bug.cgi?id=87390

        Caused 6 editing/spelling tests crash/fail on chromium in
        debug. (Requested by vsevik on #webkit).

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):
        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled):
        * src/WebTextCheckingResult.cpp:
        (WebKit::WebTextCheckingResult::operator TextCheckingResult):

2012-05-24  Ian Vollick  <vollick@chromium.org>

        [chromium] Forcibly sync running animations in the waiting state when synchronized start times are needed.
        https://bugs.webkit.org/show_bug.cgi?id=87153

        Reviewed by James Robinson.

        * tests/CCLayerAnimationControllerTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):

2012-05-23  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: add a command to InspectorMemoryAgent for getting process memory break down
        https://bugs.webkit.org/show_bug.cgi?id=87263

        Reviewed by Pavel Feldman.

        Added an API for retrieving render process private and shared memory in bytes.

        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        (WebKit::WebKitPlatformSupport::getProcessMemorySize):
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getProcessMemorySize):
        (WebCore):

2012-05-24  Hironori Bono  <hbono@chromium.org>

        Enable grammar checking on Chromium when we paste text.
        https://bugs.webkit.org/show_bug.cgi?id=74393

        Reviewed by Hajime Morita.

        This change enables grammar checking on Chromium and implements a mock grammar
        checker to fix a failing test.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Show suggestions when we right-click grammatically-misspelled words.
        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled): Enable grammar checking when we enable asynchronous spellchecking.
        * src/WebTextCheckingResult.cpp:
        (WebKit::WebTextCheckingResult::operator TextCheckingResult): Fill GrammarDetails for grammatical errors.

2012-05-24  Vivek Galatage  <vivekgalatage@gmail.com>

        Web Inspector: localStorage items are not updated when the storage changes
        https://bugs.webkit.org/show_bug.cgi?id=83012

        Reviewed by Pavel Feldman.

        Instrumented the DOM Storage Events in order to update the frontend.

        * src/StorageAreaProxy.cpp:
        (WebCore::StorageAreaProxy::dispatchLocalStorageEvent):
        (WebCore::StorageAreaProxy::dispatchSessionStorageEvent):

2012-05-23  Ojan Vafai  <ojan@chromium.org>

        add back the ability to disable flexbox
        https://bugs.webkit.org/show_bug.cgi?id=87147

        Reviewed by Tony Chang.

        * features.gypi:

2012-05-23  Dana Jansens  <danakj@chromium.org>

        [chromium] Enable the CCLayerTreeHostTestCanDrawBlocksDrawing test in single-threaded mode
        https://bugs.webkit.org/show_bug.cgi?id=87308

        Reviewed by James Robinson.

        Chromium bug: http://crbug.com/127481

        Unit test: CCLayerTreeHostTestCanDrawBlocksDrawing.runSingleThread

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TestHooks::didCommit):
        (WTF):
        (WTF::CCLayerTreeHostTestCanDrawBlocksDrawing::didCommit):

2012-05-23  James Robinson  <jamesr@chromium.org>

        Add a Setting to make position:fixed form a new stacking context
        https://bugs.webkit.org/show_bug.cgi?id=87186

        Reviewed by Adam Barth.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setFixedPositionCreatesStackingContext):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-23  James Robinson  <jamesr@chromium.org>

        [chromium] Turn ENABLE(OVERFLOW_SCROLLING) off for Chromium port
        https://bugs.webkit.org/show_bug.cgi?id=87177

        Reviewed by Eric Seidel.

        Removes ENABLE(OVERFLOW_SCROLLING) from the set of enables set by Chromium. This guards a new non-standard
        CSS property, -webkit-overflow-scrolling, that was introduced by iOS5 intended for mobile browsers. This
        property is very partially implemented in Chromium but the way it's implemented does cause new stacking contexts
        to be created that otherwise would not be, breaking "desktop" pages.

        This turns the feature off until we can figure out how to deal with the compatibility issues.

        * features.gypi:

2012-05-23  Jay Civelli  <jcivelli@chromium.org>

        [chromium] Provides a way to cancel an external popup menu before it is shown.
        https://bugs.webkit.org/show_bug.cgi?id=83474

        Reviewed by Kent Tamura.

        * src/ExternalPopupMenu.cpp:
        (WebKit::ExternalPopupMenu::show):

2012-05-23  Michael Nordman  <michaeln@google.com>

        [chromium] DomStorage events handling needs TLC (3)
        https://bugs.webkit.org/show_bug.cgi?id=87031
        https://code.google.com/p/chromium/issues/detail?id=128482
        Only queue storage events for Documents which have allocated
        a WebCore::Storage instance since pages that have attached onstorage
        event handlers must have a non-null Storage instance.

        Reviewed by Adam Barth.

        * src/StorageAreaProxy.cpp:
        (WebCore::StorageAreaProxy::dispatchLocalStorageEvent):
        (WebCore::StorageAreaProxy::dispatchSessionStorageEvent):
        (WebCore::StorageAreaProxy::isEventSource):

2012-05-23  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118218.
        http://trac.webkit.org/changeset/118218
        https://bugs.webkit.org/show_bug.cgi?id=87299

        breaks webkit win builder (Requested by pilgrim_google__ on
        #webkit).

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        (WebKit::WebKitPlatformSupport::queryLocalizedString):
        * public/platform/WebLocalizedString.h:
        (WebKit):
        * src/LocalizedStrings.cpp:
        (WebCore::query):

2012-05-23  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move themeEngine to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=87268

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKit::WebKitPlatformSupport::sandboxSupport):
        * public/platform/android/WebThemeEngine.h:
        * public/platform/linux/WebThemeEngine.h:
        * public/platform/mac/WebThemeEngine.h:
        * public/platform/win/WebThemeEngine.h:
        * src/AssertMatchingEnums.cpp:
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::paintButton):
        (WebCore::PlatformSupport::paintMenuList):
        (WebCore::PlatformSupport::paintScrollbarArrow):
        (WebCore::PlatformSupport::paintScrollbarThumb):
        (WebCore::PlatformSupport::paintScrollbarTrack):
        (WebCore::PlatformSupport::paintSpinButton):
        (WebCore::PlatformSupport::paintTextField):
        (WebCore::PlatformSupport::paintTrackbar):
        (WebCore::PlatformSupport::paintProgressBar):
        (WebCore::PlatformSupport::getThemePartSize):
        (WebCore::PlatformSupport::paintThemePart):

2012-05-23  Raymes Khoury  <raymes@chromium.org>

        Change acceptMIMETypes member to acceptTypes now that file extensions are legal accept types
        https://bugs.webkit.org/show_bug.cgi?id=87271

        Reviewed by Darin Fisher.

        * public/WebFileChooserParams.h:
        (WebFileChooserParams):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::runOpenPanel):

2012-05-23  Dana Jansens  <danakj@chromium.org>

        [chromium] Layers on main thread should get a RenderSurface for animating transform only if masksToBounds is true also
        https://bugs.webkit.org/show_bug.cgi?id=87184

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):

2012-05-23  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move queryLocalizedString to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=85762

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit::WebKitPlatformSupport::getPluginList):
        * public/platform/WebLocalizedString.h:
        * src/LocalizedStrings.cpp:
        (WebCore::query):

2012-05-23  Antti Koivisto  <antti@apple.com>

        Build fix.

        Not reviewed.

        * src/WebDocument.cpp:
        (WebKit::WebDocument::insertUserStyleSheet):

2012-05-22  Alexandre Elias  <aelias@google.com>

        [chromium] Apply viewport tag initial-scale only once
        https://bugs.webkit.org/show_bug.cgi?id=82949

        Reviewed by Adam Barth.

        First, check that isPageScaleFactorSet return false before setting
        initial-scale. We need to call dispatchViewportPropertiesDidChange()
        when the viewport width changes, since that's an input to the viewport
        tag calculation. When this happens, we shouldn't pop back to initial
        scale.

        Second, check that isNewNavigation is true when deciding to clear
        isPageScaleFactorIsSet in didCommitLoad. We only want to clear it on
        the very first commit, otherwise we'll pop back to initial scale if
        the user zooms in before the load is complete.

        New test WebFrameTest::FixedLayoutInitializeAtMinimumPageScale.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::dispatchViewportPropertiesDidChange):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::didCommitLoad):

2012-05-21  Shawn Singh  <shawnsingh@chromium.org>

        Improve W3C conformance of backface-visibility
        https://bugs.webkit.org/show_bug.cgi?id=84195

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):

2012-05-22  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118095.
        http://trac.webkit.org/changeset/118095
        https://bugs.webkit.org/show_bug.cgi?id=87201

        "Causing crashes on Mac in
        WebCore::StyleResolver::adjustRenderStyle (Requested by
        sundiamonde on #webkit).

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-22  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium-Android] Run DumpRenderTree as an apk (C++ and gyp part)
        https://bugs.webkit.org/show_bug.cgi?id=86922

        Reviewed by Kent Tamura.

        * All.gyp: Added DumpRenderTree_apk into dependencies for Android.

2012-05-22  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call canAccelerate2dCanvas directly
        https://bugs.webkit.org/show_bug.cgi?id=86893

        Reviewed by James Robinson.

        Part of a refactoring series. See tracking bug 82948.

        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        * src/PlatformSupport.cpp:
        (WebCore):

2012-05-22  Dana Jansens  <danakj@chromium.org>

        [chromium] Don't drop children of a RenderSurface from the renderSurfaceLayerList when then position of the surface in its clipRect is not known
        https://bugs.webkit.org/show_bug.cgi?id=87181

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):

2012-05-22  MORITA Hajime  <morrita@google.com>

        [Chromium][API] Introduce WebPermissionClient::allowWebComponents()
        https://bugs.webkit.org/show_bug.cgi?id=87097

        Reviewed by Kent Tamura.

        - Added WebPermissionClient::allowWebComponents(), and
        - Implemented FrameLoaderClientImpl::shadowDOMAllowed() using it.

        * public/WebPermissionClient.h:
        (WebPermissionClient):
        (WebKit::WebPermissionClient::allowWebComponents):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::shadowDOMAllowed):
        (WebKit):
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):

2012-05-22  James Robinson  <jamesr@chromium.org>

        Add a Setting to make position:fixed form a new stacking context
        https://bugs.webkit.org/show_bug.cgi?id=87186

        Reviewed by Adam Barth.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setFixedPositionCreatesStackingContext):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-22  Dana Jansens  <danakj@chromium.org>

        [chromium] Don't force the visibleLayerRect to be empty for animating layers whose front face is not visible
        https://bugs.webkit.org/show_bug.cgi?id=86886

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):

2012-05-22  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move cookieJar to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=86755

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebCookie.h:
        * public/platform/WebCookieJar.h:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKit::WebKitPlatformSupport::themeEngine):
        * src/PlatformSupport.cpp:
        (WebCore::getCookieJar):

2012-05-22  Jochen Eisinger  <jochen@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-22  Kausalya Madhusudhanan  <kmadhusu@chromium.org>

        [Chromium] Use overloaded printBegin() webkit API to support auto fit to page functionality.
        https://bugs.webkit.org/show_bug.cgi?id=86684

        Reviewed by Darin Fisher.

        * public/WebFrame.h:
        (WebFrame):
        * public/WebPlugin.h:
        (WebPlugin):
        * public/WebPrintParams.h:
        (WebKit::WebPrintParams::WebPrintParams):
        (WebPrintParams):
        * src/WebFrameImpl.cpp:
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::printBegin):

2012-05-22  Adam Barth  <abarth@webkit.org>

        [Chromium] Expose setMediaPlaybackRequiresUserGesture via WebSettings
        https://bugs.webkit.org/show_bug.cgi?id=87164

        Reviewed by Eric Seidel.

        This is used by the Chromium Android port.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setMediaPlaybackRequiresUserGesture):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-21  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Add unit testing for WebTransformationMatrix::blend()
        https://bugs.webkit.org/show_bug.cgi?id=87066

        Reviewed by Adrienne Walker.

        8 more unit tests added:
        WebTransformationMatrixTest.verifyBlendForTranslation
        WebTransformationMatrixTest.verifyBlendForScale
        WebTransformationMatrixTest.verifyBlendForSkewX
        WebTransformationMatrixTest.verifyBlendForSkewY
        WebTransformationMatrixTest.verifyBlendForRotationAboutX
        WebTransformationMatrixTest.verifyBlendForRotationAboutY
        WebTransformationMatrixTest.verifyBlendForRotationAboutZ
        WebTransformationMatrixTest.verifyBlendForCompositeTransform

        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):
        (WebKit):
        (WebKit::printTransform):

== Rolled over to ChangeLog-2012-05-22 ==
