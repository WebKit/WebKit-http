2012-06-05  Noel Gordon  <noel.gordon@gmail.com>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-05  Adam Barth  <abarth@webkit.org>

        EventHandler shouldn't dispatch fake mousemove events when scrolling on devices that don't have a mouse
        https://bugs.webkit.org/show_bug.cgi?id=88270

        Reviewed by James Robinson.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setDeviceSupportsMouse):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-06-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Remove redundant setNeedsCommit when prepareToDraw fails
        https://bugs.webkit.org/show_bug.cgi?id=88246

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostImplTest.cpp:

2012-06-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Allow CCLayerImpl to find its layer tree host, and use this for CCVideoLayerImpl instead of always-null pointer.
        https://bugs.webkit.org/show_bug.cgi?id=88252

        Reviewed by James Robinson.

        * tests/ScrollbarLayerChromiumTest.cpp:
        (WebCore::TEST):
        * tests/TreeSynchronizerTest.cpp:
        (WebKitTests::expectTreesAreIdentical):
        (WebKitTests::TEST):

2012-06-04  Ryosuke Niwa  <rniwa@webkit.org>

        yet another build fix attempt.

        * src/WebHelperPluginImpl.cpp:

2012-06-04  Ryosuke Niwa  <rniwa@webkit.org>

        Another Chromium Windows build fix attempt after r119411.

        * src/WebHelperPluginImpl.cpp:

2012-06-04  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] CCDamageTrackerTest.verifyDamageForPerspectiveClippedLayer needs to be cleaner
        https://bugs.webkit.org/show_bug.cgi?id=85245

        Reviewed by James Robinson.

        Updated CCDamageTrackerTest.verifyDamageForPerspectiveClippedLayer
        so that the test is clearer and cleaner. The original test was
        covering what it needed, but in a confusing and not-so-practical
        way. This patch adds comments and performs a tighter test so that
        the intent is a bit more clear.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::TEST_F):

2012-06-04  Ryosuke Niwa  <rniwa@webkit.org>

        Fix attempt after r119411.

        * src/WebHelperPluginImpl.cpp:

2012-06-04  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        [chromium] Fix software rendering for larger device-scale-factor
        https://bugs.webkit.org/show_bug.cgi?id=88136

        Reviewed by Darin Fisher.

        The fix is to apply the device-scale factor on the GraphicsContext.
        (and add a WebWidgetClient::deviceScaleFactor method to facilitate that).

        * public/WebWidgetClient.h:
        (WebWidgetClient):
        (WebKit::WebWidgetClient::deviceScaleFactor):
        * src/PageWidgetDelegate.cpp:
        (WebKit::PageWidgetDelegate::paint):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::paint):

2012-06-04  Sadrul Habib Chowdhury  <sadrul@chromium.org>

        Combobox options and autofill options should not be scaled for device-scale factor.
        https://bugs.webkit.org/show_bug.cgi?id=87921

        Reviewed by Darin Fisher.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::applyAutofillSuggestions):

2012-06-04  Dana Jansens  <danakj@chromium.org>

        [chromium] Make LayerRendererChromium use RenderPasses instead of RenderSurfaces
        https://bugs.webkit.org/show_bug.cgi?id=88132

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeCCRendererClient::FakeCCRendererClient):
        (FakeCCRendererClient::rootRenderPass):
        (FakeCCRendererClient):
        (TEST_F):

2012-06-04  David Dorwin  <ddorwin@chromium.org>

        Enable Chromium media player to instantiate a plugin
        https://bugs.webkit.org/show_bug.cgi?id=87399

        Reviewed by Kent Tamura.

        Adds WebHelperPlugin, an off-screen widget that contains an <object> tag.

        * WebKit.gyp:
        * public/WebHelperPlugin.h: Copied from Source/WebKit/chromium/public/WebPopupType.h.
        (WebKit):
        (WebHelperPlugin):
        (WebKit::WebHelperPlugin::~WebHelperPlugin):
        * public/WebMediaPlayerClient.h:
        (WebKit):
        * public/WebPopupType.h:
        * public/WebView.h:
        * public/WebViewClient.h:
        (WebKit):
        (WebViewClient):
        (WebKit::WebViewClient::initializeHelperPluginWebFrame):
        * src/WebFrameImpl.cpp:
        (WebKit::WebFrameImpl::WebFrameImpl):
        (WebKit::WebFrameImpl::initializeAsMainFrame):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebHelperPluginImpl.cpp: Added.
        (WebKit):
        (WebKit::addString):
        (WebKit::writeDocument):
        (HelperPluginChromeClient):
        (WebKit::HelperPluginChromeClient::HelperPluginChromeClient):
        (WebKit::WebHelperPluginImpl::WebHelperPluginImpl):
        (WebKit::WebHelperPluginImpl::~WebHelperPluginImpl):
        (WebKit::WebHelperPluginImpl::init):
        (WebKit::WebHelperPluginImpl::initializeFrame):
        (WebKit::WebHelperPluginImpl::initPage):
        (WebKit::WebHelperPluginImpl::setCompositorSurfaceReady):
        (WebKit::WebHelperPluginImpl::composite):
        (WebKit::WebHelperPluginImpl::layout):
        (WebKit::WebHelperPluginImpl::setFocus):
        (WebKit::WebHelperPluginImpl::close):
        (WebKit::WebHelperPluginImpl::closeHelperPlugin):
        (WebKit::WebHelperPlugin::create):
        * src/WebHelperPluginImpl.h: Copied from Source/WebKit/chromium/public/WebPopupType.h.
        (WebCore):
        (WebKit):
        (WebHelperPluginImpl):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::~WebMediaPlayerClientImpl):
        (WebKit::WebMediaPlayerClientImpl::createHelperPlugin):
        (WebKit):
        (WebKit::WebMediaPlayerClientImpl::closeHelperPlugin):
        * src/WebMediaPlayerClientImpl.h:
        (WebKit):
        (WebMediaPlayerClientImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::initializeMainFrame):
        (WebKit::WebViewImpl::initializeHelperPluginFrame):
        (WebKit):
        (WebKit::WebViewImpl::createHelperPlugin):
        * src/WebViewImpl.h:
        (WebKit):
        (WebViewImpl):

2012-06-04  Raymes Khoury  <raymes@chromium.org>

        Remove obsolete acceptMIMETypes member.
        https://bugs.webkit.org/show_bug.cgi?id=88241

        Reviewed by Darin Fisher.

        Obsoleted by https://bugs.webkit.org/show_bug.cgi?id=87271 and http://codereview.chromium.org/10414085/.

        * public/WebFileChooserParams.h:
        (WebFileChooserParams):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::runOpenPanel):

2012-06-04  Zeev Lieber  <zlieber@chromium.org>

        [chromium] Cleanup scissor rect computation/use with damage
        https://bugs.webkit.org/show_bug.cgi?id=87167

        Reviewed by Adrienne Walker.

        Added unit tests to CCLayerTreeHostImpl using mock graphic context
        to verify end-to-end quad drawing.

        Added more test cases to CCLayerTreeHostCommon to verify clip and
        scissor rect computations.

        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::executeCalculateDrawTransformsAndVisibility):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostImplTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::calcDrawEtc):
        * tests/CCRenderSurfaceTest.cpp:

2012-06-03  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140222 to r140260.

        * DEPS:

2012-06-03  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r140000 to r140222.

        * DEPS:

2012-06-03  Varun Jain  <varunjain@google.com>

        [chromium] Add new gesture type (two finger tap) that triggers context menu.
        https://bugs.webkit.org/show_bug.cgi?id=88173

        Reviewed by Adam Barth.

        * public/WebInputEvent.h:
        * src/PageWidgetDelegate.cpp:
        (WebKit::PageWidgetDelegate::handleInputEvent):
        * src/WebInputEventConversion.cpp:
        (WebKit::PlatformGestureEventBuilder::PlatformGestureEventBuilder):
        * src/WebPopupMenuImpl.cpp:
        (WebKit::WebPopupMenuImpl::handleInputEvent):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleGestureEvent):

2012-06-03  Robert Kroeger  <rjkroege@chromium.org>

        [chromium] replace isScrollGestureEventType with isGestureEventType
        https://bugs.webkit.org/show_bug.cgi?id=88097

        This change replaces the unused and incorrect isScrollGestureEventType
        method with a correct and useful isGestureEventType method.

        Reviewed by Adam Barth.

        * public/WebInputEvent.h:
        (WebInputEvent):
        (WebKit::WebInputEvent::isGestureEventType):

2012-06-01  Alexandre Elias  <aelias@google.com>

        [chromium] Software compositor initialization and base classes
        https://bugs.webkit.org/show_bug.cgi?id=87920

        Reviewed by James Robinson.

        Add a new setting to force software compositing.  In this mode,
        no GraphicsContext3D should ever be created.

        * public/WebSettings.h:
        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::Settings::operator CCSettings):
        (WebKit::WebLayerTreeView::context):
        * src/WebLayerTreeViewImpl.cpp:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::WebSettingsImpl):
        (WebKit::WebSettingsImpl::setForceSoftwareCompositing):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        (WebKit::WebSettingsImpl::forceSoftwareCompositing):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setIsAcceleratedCompositingActive):
        (WebKit::WebViewImpl::createCompositorGraphicsContext3D):
        (WebKit::WebViewImpl::createContext3D):
        * tests/CCLayerTreeHostImplTest.cpp:
        (WebKitTests::CCLayerTreeHostImplTest::createContext):
        (WebKitTests::TEST_F):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestAtomicCommit::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommit::drawLayersOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::drawLayersOnCCThread):
        * tests/CCTiledLayerTestCommon.cpp:
        (WebKitTests::FakeLayerTextureUpdater::Texture::updateRect):
        * tests/CCTiledLayerTestCommon.h:
        (Texture):
        (WebKitTests::FakeTextureCopier::copyTexture):
        (WebKitTests::FakeTextureUploader::uploadTexture):
        * tests/Canvas2DLayerChromiumTest.cpp:
        (Canvas2DLayerChromiumTest::fullLifecycleTest):
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/LayerRendererChromiumTest.cpp:
        (FakeLayerRendererChromium::FakeLayerRendererChromium):
        (LayerRendererChromiumTest::LayerRendererChromiumTest):
        (LayerRendererChromiumTest):
        (TEST):
        * tests/TextureCopierTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        (WTF::TEST):

2012-06-01  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119283, r119287, and r119291.
        http://trac.webkit.org/changeset/119283
        http://trac.webkit.org/changeset/119287
        http://trac.webkit.org/changeset/119291
        https://bugs.webkit.org/show_bug.cgi?id=88159

        Not only broke compilation in the initial commit but also
        broke LayerChromiumTest.basicCreateAndDestroy (Requested by
        rniwa on #webkit).

        * tests/CCAnimationTestCommon.cpp:
        (WebCore::addOpacityTransition):
        (WebCore::addAnimatedTransform):
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::MockGraphicsLayerClient::notifyAnimationStarted):
        (WebKitTests::MockGraphicsLayerClient::notifySyncRequired):
        (WebKitTests::MockGraphicsLayerClient::paintContents):
        (WebKitTests::MockGraphicsLayerClient::showDebugBorders):
        (WebKitTests::MockGraphicsLayerClient::showRepaintCounter):
        (WebKitTests::TEST):

2012-06-01  Ryosuke Niwa  <rniwa@webkit.org>

        Use fully qualified name for Fixed to avoid the collision with "typedef SInt32 Fixed" in MacTypes.h

        * tests/GraphicsLayerChromiumTest.cpp:
        (WebKitTests::TEST_F):

2012-06-01  James Robinson  <jamesr@chromium.org>

        [chromium] Unreviewed compile fix for r119283

        For the record, Dana Jensens <danakj@chromium.org> wrote this slightly faster than I did.

        * tests/CCAnimationTestCommon.h:

2012-06-01  Ian Vollick  <vollick@chromium.org>

        [chromium] Accelerated animations should use WebTransformOperations
        https://bugs.webkit.org/show_bug.cgi?id=87686

        Reviewed by James Robinson.

        CCTransformKeyframe new owns a WebTransformOperations rather than a
        TransformOperations. LayerChromium's API has been changed so that
        LayerChromium::addAnimation should take only a CCActiveAnimation.
        GraphicsLayerChromium is new responsible for translating to
        WebTransformOperations and creating CCActiveAnimations. Tests that use
        the public API (that is, they call addAnimation with KeyframeValueList
        and Animation arguments) have been moved to GraphicsLayerChromiumTest.

        * tests/CCAnimationTestCommon.cpp:
        (WebCore::addOpacityTransition):
        (WebCore::addAnimatedTransform):
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCKeyframedAnimationCurveTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerAnimationControllerTest.cpp:
        (WebKitTests::TEST):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        * tests/GraphicsLayerChromiumTest.cpp:
        (MockLayerTreeHostClient):
        (WebKitTests):
        (MockLayerTreeHost):
        (WebKitTests::MockLayerTreeHost::create):
        (WebKitTests::MockLayerTreeHost::createLayerTreeHostImpl):
        (WebKitTests::MockLayerTreeHost::MockLayerTreeHost):
        (GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::~GraphicsLayerChromiumTest):
        (WebKitTests::GraphicsLayerChromiumTest::expectTranslateX):
        (WebKitTests::TEST_F):

2012-06-01  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call clipboard methods directly
        https://bugs.webkit.org/show_bug.cgi?id=88038

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/AssertMatchingEnums.cpp:
        * src/PlatformSupport.cpp:
        (WebCore::getCookieJar):

2012-06-01  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-06-01  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform][Decimal] UInt128::operator/= calls makeUInt128 with wrong argument order
        https://bugs.webkit.org/show_bug.cgi?id=88044

        Reviewed by Kent Tamura.

        * tests/DecimalTest.cpp:
        (TEST_F): Add a new test for multiplication.

2012-05-31  Hajime Morrita  <morrita@chromium.org>

        REGRESSION(r117572): editing/spelling/spellcheck-async-remove-frame.html crashes on Mac
        https://bugs.webkit.org/show_bug.cgi?id=86859

        Removed a port specific fix which was introduced at r117572.

        Reviewed by Ryosuke Niwa.

        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::frameWillDetachPage):
        (WebKit::EditorClientImpl::requestCheckingOfString):
        * src/EditorClientImpl.h:
        (WebCore):
        (EditorClientImpl):
        * src/WebTextCheckingCompletionImpl.cpp:
        (WebKit::WebTextCheckingCompletionImpl::didFinishCheckingText):
        (WebKit::WebTextCheckingCompletionImpl::didCancelCheckingText):
        * src/WebTextCheckingCompletionImpl.h:
        (WebKit::WebTextCheckingCompletionImpl::WebTextCheckingCompletionImpl):
        (WebTextCheckingCompletionImpl):

2012-05-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119146.
        http://trac.webkit.org/changeset/119146
        https://bugs.webkit.org/show_bug.cgi?id=88035

        android breakage fixed in http://crrev.com/139945 (Requested
        by fischman on #webkit).

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::didLoadingProgress):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-05-31  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Migrate to WebTransformationMatrix
        https://bugs.webkit.org/show_bug.cgi?id=87788

        Reviewed by James Robinson.

        * src/WebLayer.cpp:
        (WebKit::WebLayer::setSublayerTransform):
        (WebKit::WebLayer::setTransform):
        * tests/CCAnimationTestCommon.cpp:
        (WebKitTests::FakeTransformTransition::getValue):
        * tests/CCAnimationTestCommon.h:
        * tests/CCDamageTrackerTest.cpp:
        (WebKitTests::executeCalculateDrawTransformsAndVisibility):
        (WebKitTests::TEST_F):
        * tests/CCKeyframedAnimationCurveTest.cpp:
        * tests/CCLayerAnimationControllerTest.cpp:
        * tests/CCLayerImplTest.cpp:
        (WebCore::TEST):
        * tests/CCLayerIteratorTest.cpp:
        * tests/CCLayerSorterTest.cpp:
        * tests/CCLayerTreeHostCommonTest.cpp:
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::CCLayerTreeHostTestDeviceScaleFactorScalesViewportAndLayers::commitCompleteOnCCThread):
        (WTF::setLayerPropertiesForTesting):
        (WTF::CCLayerTreeHostTestAtomicCommitWithPartialUpdate::beginTest):
        (WTF::setTestLayerPropertiesForTesting):
        (WTF::CCLayerTreeHostTestLayerOcclusion::beginTest):
        (WTF::CCLayerTreeHostTestLayerOcclusionWithFilters::beginTest):
        (WTF::CCLayerTreeHostTestManySurfaces::beginTest):
        * tests/CCLayerTreeTestCommon.h:
        (WebKitTests):
        * tests/CCMathUtilTest.cpp:
        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTest::createRoot):
        (WebKitTests::CCOcclusionTrackerTest::createLayer):
        (WebKitTests::CCOcclusionTrackerTest::createSurface):
        (WebKitTests::CCOcclusionTrackerTest::createDrawingLayer):
        (WebKitTests::CCOcclusionTrackerTest::createReplicaLayer):
        (WebKitTests::CCOcclusionTrackerTest::createDrawingSurface):
        (CCOcclusionTrackerTest):
        (WebKitTests::CCOcclusionTrackerTest::setBaseProperties):
        (WebKitTests::CCOcclusionTrackerTest::setProperties):
        (WebKitTests::CCOcclusionTrackerTestRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTranslatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceRotatedOffAxis::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithTwoOpaqueChildren::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestFilters::runMyTest):
        (WebKitTests::CCOcclusionTrackerTest3dTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransformBehindCamera::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerBehindCameraDoesNotOcclude::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLargePixelsOccludeInsideClipRect::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesToParent::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTwoBackgroundFiltersReduceOcclusionTwice::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionBelowBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionIfBackgroundFilterIsOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReduceOcclusionWhenBackgroundFilterIsPartiallyOccluded::runMyTest):
        * tests/CCQuadCullerTest.cpp:
        * tests/CCRenderSurfaceTest.cpp:
        * tests/FloatQuadTest.cpp:
        * tests/LayerChromiumTest.cpp:
        * tests/LinkHighlightTest.cpp:
        * tests/TiledLayerChromiumTest.cpp:
        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):
        (WebKit):

2012-05-31  Ian Vollick  <vollick@chromium.org>

        [chromium] Single thread proxy should not tick animations unless the layer renderer has been initialized
        https://bugs.webkit.org/show_bug.cgi?id=87873

        Reviewed by James Robinson.

        When the layer renderer fails to initialize, be sure to stop the animation timer.

        * tests/CCLayerTreeHostTest.cpp:
        (CompositorFakeWebGraphicsContext3DWithTextureTracking):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::create):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::createTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::deleteTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::bindTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::numTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::texture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::resetTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::numUsedTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::usedTexture):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::resetUsedTextures):
        (WTF::CompositorFakeWebGraphicsContext3DWithTextureTracking::CompositorFakeWebGraphicsContext3DWithTextureTracking):
        (WTF):
        (WTF::TestHooks::didRecreateContext):
        (TestHooks):
        (WTF::TestHooks::createContext):
        (CCLayerTreeHostTest):
        (WTF::CCLayerTreeHostTest::clearEndTestTask):
        (WTF::CCLayerTreeHostTest::CCLayerTreeHostTest):
        (EndTestTask):
        (WTF::CCLayerTreeHostTest::EndTestTask::EndTestTask):
        (WTF::CCLayerTreeHostTest::EndTestTask::~EndTestTask):
        (WTF::CCLayerTreeHostTest::EndTestTask::clearTest):
        (WTF::CCLayerTreeHostTest::EndTestTask::run):
        (WTF::CCLayerTreeHostTest::runTest):
        (WTF::CCLayerTreeHostTest::endTestAfterDelay):
        (FakeWebGraphicsContext3DMakeCurrentFails):
        (WTF::FakeWebGraphicsContext3DMakeCurrentFails::makeContextCurrent):
        (CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::beginTest):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::animateLayers):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::didRecreateContext):
        (WTF::CCLayerTreeHostTestInitializeLayerRendererFailsAfterAddAnimation::afterTest):
        (WTF::TEST_F):

2012-05-15  Brett Wilson  <brettw@chromium.org>

        Hook up GTK IsKeyPad flag for keyboard events, and preserve this flag
        on all platforms when converting back to a WebKeyboardEvent.

        https://bugs.webkit.org/show_bug.cgi?id=86514

        Reviewed by Dimitri Glazkov.

        * src/WebInputEventConversion.cpp:
        (WebKit::WebKeyboardEventBuilder::WebKeyboardEventBuilder):
        * src/gtk/WebInputEventFactory.cpp:
        (WebKit::WebInputEventFactory::keyboardEvent):
        * tests/WebInputEventFactoryTestGtk.cpp:

2012-05-31  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Implement IDBTransaction.error and IDBRequest.error
        https://bugs.webkit.org/show_bug.cgi?id=87865

        Reviewed by Tony Chang.

        IDBDatabaseError now honors IDB-specific DOMException codes,
        so make sure that's how they are passed to/from chromium.

        * src/WebIDBDatabaseError.cpp:
        (WebKit::WebIDBDatabaseError::assign):

2012-05-31  James Robinson  <jamesr@chromium.org>

        [chromium] Assertion failures during compositor startup in lost context situations
        https://bugs.webkit.org/show_bug.cgi?id=87912

        Reviewed by Adrienne Walker.

        Adds a unit test verifying that even if we lose our context during or before initialization we get through the
        rest of the path without failing ASSERT()s.

        * tests/LayerRendererChromiumTest.cpp:
        (LoseContextOnFirstGetContext):
        (LoseContextOnFirstGetContext::LoseContextOnFirstGetContext):
        (TEST):

2012-05-31  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r119125.
        http://trac.webkit.org/changeset/119125
        https://bugs.webkit.org/show_bug.cgi?id=88007

        Will break android build if rolled (Requested by rafaelw_ on
        #webkit).

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::bytesLoaded):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-05-31  Dana Jansens  <danakj@chromium.org>

        [chromium] Move drawing code for RenderSurfaces into LayerRendererChromium
        https://bugs.webkit.org/show_bug.cgi?id=87877

        Reviewed by James Robinson.

        * tests/CCRenderSurfaceTest.cpp:
        (WebCore::TEST):

2012-05-31  Ami Fischman  <fischman@chromium.org>

        Replace WebMediaPlayer::bytesLoaded() with an explicit didLoadingProgress()
        https://bugs.webkit.org/show_bug.cgi?id=86113

        Reviewed by Eric Carlson.

        * public/WebMediaPlayer.h:
        (WebMediaPlayer):
        * src/WebMediaPlayerClientImpl.cpp:
        (WebKit::WebMediaPlayerClientImpl::didLoadingProgress):
        * src/WebMediaPlayerClientImpl.h:
        (WebMediaPlayerClientImpl):

2012-05-31  Ian Vollick  <vollick@chromium.org>

        [chromium] create WebTransformOperation interface for chromium platform
        https://bugs.webkit.org/show_bug.cgi?id=87510

        Reviewed by James Robinson.

        * WebKit.gypi:
        * tests/WebTransformOperationsTest.cpp: Added.
        (TEST):
        (checkProgress):

2012-05-31  Alexander Pavlov  <apavlov@chromium.org>

        Web Inspector: [Chromium] Cannot bring Inspector to front when paused on breakpoint
        https://bugs.webkit.org/show_bug.cgi?id=87871

        Reviewed by Yury Semikhatsky.

        When input events handling is suppressed (due to the JS being paused on a breakpoint), we should report
        these events as NOT handled by the WebKit, so that the browser can handle them appropriately
        (on MacOS, switching between the application windows is done through the default key event handler, so if you run
        event.preventDefault() for all keydown events in a handler, the Chromium window switch will not occur on Cmd+`).

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::handleInputEvent):

2012-05-31  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-30  Peter Beverloo  <peter@chromium.org>

        [Chromium] Automatically install 64-bit linker for Android
        https://bugs.webkit.org/show_bug.cgi?id=79780

        Reviewed by Adam Barth.

        Change the Android-specific dependencies to inherit their revision from
        Chromium's DEPS file, like many other dependencies do, solving the
        versioning problem that we're running in to right now. These are listed
        in Chromium's main DEPS file starting Chromium r139529.

        * DEPS:

2012-05-31  Yoshifumi Inoue  <yosin@chromium.org>

        Build fix for Chromium Linux (Tests) after r119073.

        * tests/DecimalTest.cpp:
        (TEST_F):

2012-05-31  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Introduce Decimal class for Number/Range input type.
        https://bugs.webkit.org/show_bug.cgi?id=87360

        Reviewed by Kent Tamura.

        This patch added unit test for Decimal class.

        * WebKit.gypi:
        * tests/DecimalTest.cpp: Added.
        (WebCore):
        (WebCore::operator<<): Output Decimal for unit test debugging
        (DecimalStepRange):
        (DecimalStepRange::DecimalStepRange):
        (DecimalStepRange::clampValue):
        (DecimalTest):
        (DecimalTest::encode):
        (DecimalTest::fromString):
        (DecimalTest::stepDown):
        (DecimalTest::stepUp):
        (TEST_F):

2012-05-30  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: add MemoryUsageSupport::processMemorySizesInBytes
        https://bugs.webkit.org/show_bug.cgi?id=87830

        Reviewed by James Robinson.

        * public/platform/WebKitPlatformSupport.h: pulled getProcessMemorySize up
        to the Source/Platform/chromium/public/Platform.h
        * src/PlatformSupport.cpp:

2012-05-31  Kent Tamura  <tkent@chromium.org>

        Unreviewed, rolling out r119062 and r119064.
        http://trac.webkit.org/changeset/119062
        http://trac.webkit.org/changeset/119064
        https://bugs.webkit.org/show_bug.cgi?id=87360

        Broke build on Lion, SnowLoepard, Chromium Windows, and
        Chromium Linux 32

        * WebKit.gypi:
        * tests/DecimalTest.cpp: Removed.

2012-05-30  Yoshifumi Inoue  <yosin@chromium.org>

        [Platform] Introduce Decimal class for Number/Range input type.
        https://bugs.webkit.org/show_bug.cgi?id=87360

        Reviewed by Kent Tamura.

        This patch added unit test for Decimal class.

        * WebKit.gypi:
        * tests/DecimalTest.cpp: Added.
        (WebCore):
        (WebCore::operator<<): Output Decimal for unit test debugging
        (DecimalStepRange):
        (DecimalStepRange::DecimalStepRange):
        (DecimalStepRange::clampValue):
        (DecimalTest):
        (DecimalTest::encode):
        (DecimalTest::fromString):
        (DecimalTest::stepDown):
        (DecimalTest::stepUp):
        (TEST_F):

2012-05-30  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Fix min/max bounds error in CCMathUtil.cpp
        https://bugs.webkit.org/show_bug.cgi?id=87915

        Reviewed by James Robinson.

        * tests/CCMathUtilTest.cpp:
        (WebCore::TEST):
        (WebCore):

2012-05-30  Ami Fischman  <fischman@chromium.org>

        Roll chromium DEPS from r139300 to r139542.  Unreviewed.
        https://bugs.webkit.org/show_bug.cgi?id=87868

        * DEPS:

2012-05-30  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call fileUtilities methods directly
        https://bugs.webkit.org/show_bug.cgi?id=87852

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-05-30  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118986.
        http://trac.webkit.org/changeset/118986
        https://bugs.webkit.org/show_bug.cgi?id=87914

        Caused several IndexedDB browser_test failures on Chromium
        canary builders (Requested by rafaelw_ on #webkit).

        * src/WebIDBDatabaseError.cpp:
        (WebKit::WebIDBDatabaseError::assign):

2012-05-30  Dominic Mazzoni  <dmazzoni@google.com>

        AX: Chromium WebAccessibilityObject should check if an AccessibilityObject is detached
        https://bugs.webkit.org/show_bug.cgi?id=87778

        Reviewed by Adam Barth.

        Pretty simple - all places that previously just checked for null
        now also check if the wrapped AccessibilityObject is detached.

        * public/WebAccessibilityObject.h:
        (WebAccessibilityObject):
        * src/WebAccessibilityObject.cpp:
        (WebKit::WebAccessibilityObject::isDetached):
        (WebKit):
        (WebKit::WebAccessibilityObject::axID):
        (WebKit::WebAccessibilityObject::accessibilityDescription):
        (WebKit::WebAccessibilityObject::actionVerb):
        (WebKit::WebAccessibilityObject::canSetFocusAttribute):
        (WebKit::WebAccessibilityObject::canSetValueAttribute):
        (WebKit::WebAccessibilityObject::isValid):
        (WebKit::WebAccessibilityObject::childCount):
        (WebKit::WebAccessibilityObject::childAt):
        (WebKit::WebAccessibilityObject::firstChild):
        (WebKit::WebAccessibilityObject::focusedChild):
        (WebKit::WebAccessibilityObject::lastChild):
        (WebKit::WebAccessibilityObject::nextSibling):
        (WebKit::WebAccessibilityObject::parentObject):
        (WebKit::WebAccessibilityObject::previousSibling):
        (WebKit::WebAccessibilityObject::canSetSelectedAttribute):
        (WebKit::WebAccessibilityObject::isAnchor):
        (WebKit::WebAccessibilityObject::isAriaReadOnly):
        (WebKit::WebAccessibilityObject::isButtonStateMixed):
        (WebKit::WebAccessibilityObject::isChecked):
        (WebKit::WebAccessibilityObject::isCollapsed):
        (WebKit::WebAccessibilityObject::isControl):
        (WebKit::WebAccessibilityObject::isEnabled):
        (WebKit::WebAccessibilityObject::isFocused):
        (WebKit::WebAccessibilityObject::isHovered):
        (WebKit::WebAccessibilityObject::isIndeterminate):
        (WebKit::WebAccessibilityObject::isLinked):
        (WebKit::WebAccessibilityObject::isLoaded):
        (WebKit::WebAccessibilityObject::isMultiSelectable):
        (WebKit::WebAccessibilityObject::isOffScreen):
        (WebKit::WebAccessibilityObject::isPasswordField):
        (WebKit::WebAccessibilityObject::isPressed):
        (WebKit::WebAccessibilityObject::isReadOnly):
        (WebKit::WebAccessibilityObject::isRequired):
        (WebKit::WebAccessibilityObject::isSelected):
        (WebKit::WebAccessibilityObject::isSelectedOptionActive):
        (WebKit::WebAccessibilityObject::isVertical):
        (WebKit::WebAccessibilityObject::isVisible):
        (WebKit::WebAccessibilityObject::isVisited):
        (WebKit::WebAccessibilityObject::accessKey):
        (WebKit::WebAccessibilityObject::ariaHasPopup):
        (WebKit::WebAccessibilityObject::ariaLiveRegionAtomic):
        (WebKit::WebAccessibilityObject::ariaLiveRegionBusy):
        (WebKit::WebAccessibilityObject::ariaLiveRegionRelevant):
        (WebKit::WebAccessibilityObject::ariaLiveRegionStatus):
        (WebKit::WebAccessibilityObject::boundingBoxRect):
        (WebKit::WebAccessibilityObject::estimatedLoadingProgress):
        (WebKit::WebAccessibilityObject::helpText):
        (WebKit::WebAccessibilityObject::headingLevel):
        (WebKit::WebAccessibilityObject::hierarchicalLevel):
        (WebKit::WebAccessibilityObject::hitTest):
        (WebKit::WebAccessibilityObject::keyboardShortcut):
        (WebKit::WebAccessibilityObject::performDefaultAction):
        (WebKit::WebAccessibilityObject::roleValue):
        (WebKit::WebAccessibilityObject::selectionEnd):
        (WebKit::WebAccessibilityObject::selectionStart):
        (WebKit::WebAccessibilityObject::setFocused):
        (WebKit::WebAccessibilityObject::stringValue):
        (WebKit::WebAccessibilityObject::title):
        (WebKit::WebAccessibilityObject::titleUIElement):
        (WebKit::WebAccessibilityObject::url):
        (WebKit::WebAccessibilityObject::valueDescription):
        (WebKit::WebAccessibilityObject::valueForRange):
        (WebKit::WebAccessibilityObject::maxValueForRange):
        (WebKit::WebAccessibilityObject::minValueForRange):
        (WebKit::WebAccessibilityObject::node):
        (WebKit::WebAccessibilityObject::document):
        (WebKit::WebAccessibilityObject::hasComputedStyle):
        (WebKit::WebAccessibilityObject::computedStyleDisplay):
        (WebKit::WebAccessibilityObject::accessibilityIsIgnored):
        (WebKit::WebAccessibilityObject::lineBreaks):
        (WebKit::WebAccessibilityObject::columnCount):
        (WebKit::WebAccessibilityObject::rowCount):

2012-05-30  Shawn Singh  <shawnsingh@chromium.org>

        Simplify TransformationMatrix rotation code to improve precision
        https://bugs.webkit.org/show_bug.cgi?id=86666

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):
        (WebKit):

2012-05-30  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Implement IDBTransaction.error and IDBRequest.error
        https://bugs.webkit.org/show_bug.cgi?id=87865

        Reviewed by Tony Chang.

        IDBDatabaseError now honors IDB-specific DOMException codes,
        so make sure that's how they are passed to/from chromium.

        * src/WebIDBDatabaseError.cpp:
        (WebKit::WebIDBDatabaseError::assign):

2012-05-30  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Merge shared code in CCOcclusionTrackerTest
        https://bugs.webkit.org/show_bug.cgi?id=87798

        Reviewed by Adrienne Walker.

        This patch simple uses a different existing macro function so that
        the same thing doesn't exist in multiple places, and so that the
        naming is more consistent with gtest's conventions.

        * tests/CCOcclusionTrackerTest.cpp:
        (WebKitTests::CCOcclusionTrackerTestIdentityTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTranslatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestChildInRotatedChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestVisitTargetTwoTimes::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceRotatedOffAxis::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithTwoOpaqueChildren::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblings::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOverlappingSurfaceSiblingsWithTwoTransforms::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestFilters::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaDoesOcclude::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaWithMask::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerScissorRectOutsideChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestScreenScissorRectOutsideChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestLayerScissorRectPartlyOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestScreenScissorRectPartlyOverChild::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestOpaqueContentsRegionNonEmpty::runMyTest):
        (WebKitTests::CCOcclusionTrackerTest3dTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestPerspectiveTransform::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity1OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationOpacity0OnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestAnimationTranslateOnMainThread::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesToParent::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceOcclusionTranslatesWithClipping::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestReplicaOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceWithReplicaUnoccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceAndReplicaOccludedDifferently::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestSurfaceChildOfClippingSurface::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestTwoBackgroundFiltersReduceOcclusionTwice::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontOccludePixelsNeededForBackgroundFilterWithClip::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionBelowBackgroundFilter::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestDontReduceOcclusionIfBackgroundFilterIsOccluded::runMyTest):
        (WebKitTests::CCOcclusionTrackerTestMinimumTrackingSize::runMyTest):

2012-05-30  Tony Chang  <tony@chromium.org>

        [chromium] port webframe_unittest.cc to webkit_unit_tests
        https://bugs.webkit.org/show_bug.cgi?id=87796

        Reviewed by James Robinson.

        Move WebFrameTest.GetContentAsPlainText and WebFrameTest.GetFullHtmlOfPage to webkit_unit_tests.

        * tests/WebFrameTest.cpp:
        (WebKit::TEST_F):
        (WebKit): Add tests.

2012-05-30  Jochen Eisinger  <jochen@chromium.org>

        Match Firefox restrictions to window.blur and window.focus
        https://bugs.webkit.org/show_bug.cgi?id=86969

        Reviewed by Adam Barth.

        Allow window.focus() during the dispatch of the click event on
        notifications.

        * src/WebNotification.cpp:
        (WebKit::WebNotification::dispatchClickEvent):

2012-05-29  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move fileExists to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=87531

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * src/PlatformSupport.cpp:
        (WebCore):

2012-05-29  Alec Flett  <alecflett@chromium.org>

        IndexedDB: Align codes and names for IDB-specific and DOM-specific errors/exceptions
        https://bugs.webkit.org/show_bug.cgi?id=87276

        Reviewed by Tony Chang.

        * public/WebIDBDatabaseException.h:
        * src/AssertMatchingEnums.cpp:

2012-05-29  Rafael Weinstein  <rafaelw@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-29  Dana Jansens  <danakj@chromium.org>

        [chromium] Unoccluded area in surfaces should always be clipped to the rootScissorRect
        https://bugs.webkit.org/show_bug.cgi?id=87677

        Reviewed by Adrienne Walker.

        * tests/CCOcclusionTrackerTest.cpp:
        (CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor):
        (WebKitTests::CCOcclusionTrackerTestTopmostSurfaceIsClippedToScissor::runMyTest):
        (WebKitTests):

2012-05-29  David Barr  <davidbarr@chromium.org>

        Introduce ENABLE_CSS_IMAGE_RESOLUTION compile flag
        https://bugs.webkit.org/show_bug.cgi?id=87685

        Reviewed by Eric Seidel.

        Add a configuration option for CSS image-resolution support, disabling it by default.

        * features.gypi:

2012-05-29  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-29  Hironori Bono  <hbono@chromium.org>

        Use WebSpellCheckClient::spellcheck to retrieve suggestions.
        https://bugs.webkit.org/show_bug.cgi?id=87690

        Reviewed by Hajime Morita.

        This change uses WebSpellCheckClient::spellcheck as a fallback method to
        retrieve suggestions when a marker does not have any suggestions. (It consumes
        lots of CPU power to get suggestions for misspelled word, i.e. Chromium cannot
        afford to attach suggestions to all spelling markers.)

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Retrieve suggestions if markers do not have any.

2012-05-28  Takashi Toyoshima  <toyoshim@chromium.org>

        [WebSocket] Receiving reserved close codes, 1005, 1006, and 1015 must appear as code=1006 and wasClean=false
        https://bugs.webkit.org/show_bug.cgi?id=87084

        Reviewed by Kent Tamura.

        Update close event codes corresponding to WebSocketChannel::CloseEventCode.

        * public/WebSocket.h: Update on newly defined close event codes

2012-05-28  MORITA Hajime  <morrita@google.com>

        Rename FrameLoaderClient::shadowDOMAllowed() to allowShadowDOM()
        https://bugs.webkit.org/show_bug.cgi?id=87101

        Reviewed by Kentaro Hara.

        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::allowShadowDOM):
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):

2012-05-28  Rob Flack  <flackr@chromium.org>

        [chromium] Only increase size of Combo Box Options when displayed on touch screen
        https://bugs.webkit.org/show_bug.cgi?id=85921

        Reviewed by Adam Barth.

        Adds a flag to set whether the current device is a touch screen, independent of whether touch events are supported and use this for the combo box sizing.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::defaultDeviceScaleFactor):
        (WebKit):
        (WebKit::WebSettingsImpl::setDeviceSupportsTouch):
        (WebKit::WebSettingsImpl::deviceSupportsTouch):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::applyAutofillSuggestions):
        * tests/PopupMenuTest.cpp:
        (WebKit::SelectPopupMenuTest::SetUp):
        (WebKit::SelectPopupMenuTest::TearDown):
        (SelectPopupMenuTest):
        (WebKit::TEST_F):

2012-05-25  Jesus Sanchez-Palencia  <jesus.palencia@openbossa.org>

        WebKitTestRunner needs to support layoutTestController.setJavaScriptProfilingEnabled
        https://bugs.webkit.org/show_bug.cgi?id=42328

        Reviewed by Eric Seidel.

        Removed private APIs that were only being used by DRT.

        * public/WebDevToolsAgent.h:
        (WebDevToolsAgent):
        * src/WebDevToolsAgentImpl.cpp:
        * src/WebDevToolsAgentImpl.h:
        (WebDevToolsAgentImpl):

2012-05-28  Peter Beverloo  <peter@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-28  Peter Beverloo  <peter@chromium.org>

        [Chromium] Build fix for the Android bot, set CXX_target at gyp generation-time
        https://bugs.webkit.org/show_bug.cgi?id=87649

        Unreviewed build fix.

        Chromium Android builds were broken because v8 tried to compile files
        for target with the "-m32" flag. This was caused by a v8 check falling
        back to using "which g++" to find the right compiler, whereas it should
        have used the $CXX_target environment variable. This isn't being set
        for Android builds.

        * gyp_webkit: Set the CXX_target environment variable. Annotate the fix
          with a FIXME comment too.

2012-05-28  Keishi Hattori  <keishi@webkit.org>

        Expose value localization function of HTMLInputElement
        https://bugs.webkit.org/show_bug.cgi?id=84356

        Reviewed by Kent Tamura.

        * public/WebInputElement.h:
        (WebInputElement):
        * src/WebInputElement.cpp:
        (WebKit::WebInputElement::localizeValue):
        (WebKit):

2012-05-28  MORITA Hajime <morrita@google.com>

        Unreviewed Mac Chromium build fix.

        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::allowStyleScoped):

2012-05-28  MORITA Hajime  <morrita@google.com>

        https://bugs.webkit.org/show_bug.cgi?id=87609
        [Chromium] FrameLoaderClient::allowStyleScoped() should be implemented interms of WebPermissionClient

        Reviewed by Kent Tamura.

        Added allowStyleScoped() implementation which is essentially same as shadowDOMAllowed().

        * src/FrameLoaderClientImpl.cpp:
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):

2012-05-25  Ryosuke Niwa  <rniwa@webkit.org>

        Roll chromium DEPS from r139156 to r139184.

        * DEPS:

2012-05-25  Garrett Casto  <gcasto@chromium.org>

        Allow WebTextFieldDecoratorClient to see applied decorations.
        https://bugs.webkit.org/show_bug.cgi?id=86557

        Reviewed by Kent Tamura.

        * WebKit.gyp: Added new files.
        * public/WebInputElement.h:
        (WebKit::WebInputElement::decorationElementFor): Returns the
        WebElement attached to the WebInputElement by the given
        WebTextFieldDecoratorClient, if one exists.
        * src/TextFieldDecoratorImpl.cpp:
        (WebKit):
        * src/TextFieldDecoratorImpl.h:
        (TextFieldDecoratorImpl::decoratorClient): Get the
        WebTextFieldDecoratorClient owned by this object.

2012-05-25  Mihai Parparita  <mihaip@chromium.org>

        Allow synchronous XHRs to be disabled in documents
        https://bugs.webkit.org/show_bug.cgi?id=87540

        Reviewed by Eric Seidel.

        Synchronous XMLHttpRequests are a problematic API, since they result
        in blocked UI threads. Some clients may wish to always disable them;
        give them a setting to do so (see also r103629 for other cases where
        synchronous XHRs are disabled).

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setSyncXHRInDocumentsEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-25  Kinuko Yasuda  <kinuko@chromium.org>

        [chromium] Deprecate FileUtilities::getFileSize and getFileModifiedTime in favor of getFileMetadata
        https://bugs.webkit.org/show_bug.cgi?id=87492

        Reviewed by Adam Barth.

        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getFileMetadata):

2012-05-25  Ryosuke Niwa  <rniwa@webkit.org>

        Roll Chromium DEPS from r139024 to r139156 in an attempt to fix Chromium Win builds.

        * DEPS:

2012-05-25  Mark Pilgrim  <pilgrim@chromium.org>

        [Chomium] Move sandboxSupport to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=87518

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKitPlatformSupport):
        * public/platform/android/WebSandboxSupport.h:
        * public/platform/linux/WebFontFamily.h:
        * public/platform/linux/WebSandboxSupport.h:
        * public/platform/mac/WebSandboxSupport.h:
        * public/platform/win/WebSandboxSupport.h:
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::ensureFontLoaded):
        (WebCore::PlatformSupport::loadFont):
        (WebCore::PlatformSupport::getFontFamilyForCharacters):
        (WebCore::PlatformSupport::getRenderStyleForStrike):

2012-05-25  Dana Jansens  <danakj@chromium.org>

        [chromium] WebLayerTreeViewImpl should not hide methods in CCLayerTreeHost with signatures that match the Client interface
        https://bugs.webkit.org/show_bug.cgi?id=87301

        Reviewed by James Robinson.

        Most methods in the CCLayerTreeHostClient interface have a matching
        method signature on CCLayerTreeHost that simply calls the client, if
        one exists at all. However, CCLayerTreeHost::updateAnimations() does
        important work in addition to calling the client.

        Currently WebLayerTreeViewImpl itself implements the interface for
        CCLayerTreeHostClient as well as CCLayerTreeHost, and simply forwards
        any call to a method in the client interface to its own client. This
        blocks WebViewImpl from calling CCLayerTreeHost::updateAnimations, since
        the method is also in the client interface.

        We change WebLayerTreeViewImpl to own a CCLayerTreeHost and a
        WebLayerTreeHostClientAdapter. This fixes the shadowing by making
        the two interfaces separate, and resolves lifetime issues by
        ensuring that the CCLayerTreeHost is destroyed before its client.

        * src/WebLayerTreeView.cpp:
        (WebKit::WebLayerTreeView::setSurfaceReady):
        (WebKit::WebLayerTreeView::setRootLayer):
        (WebKit::WebLayerTreeView::compositorIdentifier):
        (WebKit::WebLayerTreeView::setViewportSize):
        (WebKit::WebLayerTreeView::viewportSize):
        (WebKit::WebLayerTreeView::setBackgroundColor):
        (WebKit::WebLayerTreeView::setVisible):
        (WebKit::WebLayerTreeView::setPageScaleFactorAndLimits):
        (WebKit::WebLayerTreeView::startPageScaleAnimation):
        (WebKit::WebLayerTreeView::setNeedsAnimate):
        (WebKit::WebLayerTreeView::setNeedsRedraw):
        (WebKit::WebLayerTreeView::commitRequested):
        (WebKit::WebLayerTreeView::composite):
        (WebKit::WebLayerTreeView::updateAnimations):
        (WebKit::WebLayerTreeView::compositeAndReadback):
        (WebKit::WebLayerTreeView::finishAllRendering):
        (WebKit::WebLayerTreeView::context):
        (WebKit::WebLayerTreeView::loseCompositorContext):
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit):
        (WebLayerTreeViewClientAdapter):
        (WebKit::WebLayerTreeViewClientAdapter::WebLayerTreeViewClientAdapter):
        (WebKit::WebLayerTreeViewClientAdapter::~WebLayerTreeViewClientAdapter):
        (WebKit::WebLayerTreeViewImpl::create):
        (WebKit::WebLayerTreeViewImpl::WebLayerTreeViewImpl):
        (WebKit::WebLayerTreeViewImpl::~WebLayerTreeViewImpl):
        * src/WebLayerTreeViewImpl.h:
        (WebCore):
        (WebKit):
        (WebKit::WebLayerTreeViewImpl::layerTreeHost):
        (WebLayerTreeViewImpl):

2012-05-25  Kinuko Yasuda  <kinuko@chromium.org>

        Unreviewed; rolling chromium deps.

        * DEPS:

2012-05-25  W. James MacLean  <wjmaclean@chromium.org>

        [chromium] LayerChromium should recognise existing layer active animations when the layer is added.
        https://bugs.webkit.org/show_bug.cgi?id=87166

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::MockLayerTreeHost::didAddAnimationWasCalled):
        (MockLayerTreeHost):
        (WTF::MockLayerTreeHost::MockLayerTreeHost):
        (WTF):
        (CCLayerTreeHostTestLayerAddedWithAnimation):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::CCLayerTreeHostTestLayerAddedWithAnimation):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::beginTest):
        (WTF::CCLayerTreeHostTestLayerAddedWithAnimation::afterTest):

2012-05-17  Andrey Kosyakov  <caseq@chromium.org>

        [chromium] add instrumentation for compositing
        https://bugs.webkit.org/show_bug.cgi?id=83928

        Reviewed by James Robinson.

        - plumb willCommit() and didComposite() to inspector instrumentation via WebViewImpl.

        * WebKit.gypi: Added WebLayerTreeViewTest
        * src/WebLayerTreeViewImpl.cpp:
        (WebKit::WebLayerTreeViewImpl::didBeginFrame):
        (WebKit):
        (WebKit::WebLayerTreeViewImpl::willCommit):
        * src/WebLayerTreeViewImpl.h:
        (WebLayerTreeViewImpl):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::didBeginFrame):
        (WebKit):
        (WebKit::WebViewImpl::willCommit):
        * src/WebViewImpl.h:
        (WebViewImpl):
        * tests/CCLayerTreeHostTest.cpp:
        * tests/FakeCCLayerTreeHostClient.h:
        * tests/WebLayerTest.cpp:
        * tests/WebLayerTreeViewTest.cpp: Added.

2012-05-25  Peter Beverloo  <peter@chromium.org>

        [Chromium] Pull in Android tools from Chromium's repo through the DEPS file
        https://bugs.webkit.org/show_bug.cgi?id=87478

        Reviewed by Kent Tamura.

        Chromium's r122048 added the forwarder tool, which forwards a TCP port
        listening on the device to a port on the host. This now is a required
        dependency of DumpRenderTree, so pull it in.

        Since it's likely that more tools will be required, pull in the entire
        tools/android/ directory in case the Chromium port for Android is being
        checked out or updated.

        * DEPS: Added Android-specific dependency on tools/android/

2012-05-25  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118461.
        http://trac.webkit.org/changeset/118461
        https://bugs.webkit.org/show_bug.cgi?id=87468

        Breaks two chromium browser_tests. (Requested by vsevik on
        #webkit).

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::resize):

2012-05-24  Tim Horton  <timothy_horton@apple.com>

        Add feature defines for web-facing parts of CSS Regions and Exclusions
        https://bugs.webkit.org/show_bug.cgi?id=87442
        <rdar://problem/10887709>

        Reviewed by Dan Bernstein.

        * features.gypi:

2012-05-24  Kent Tamura  <tkent@chromium.org>

        PAGE_POPUP: window.setValueAndClosePopup should be moved to a
        per-context property of DOMWindow.
        https://bugs.webkit.org/show_bug.cgi?id=87086

        Reviewed by Adam Barth.

        * src/WebPagePopupImpl.cpp:
        (WebKit): Add PagePopupFrameLoaderClient, which allows window.pagePopupController.
        (WebKit::WebPagePopupImpl::initPage):
         - Use PagePopupFrameLoaderClient
         - Remove the call of ScriptController::installFunctionsForPagePopup().
         - Call DOMWindowPagePopup::install() to inform m_popupClient to a
           DOMWindowPagePopup object for the DOMWindow.

2012-05-21  Kinuko Yasuda  <kinuko@chromium.org>

        Cleanup: add a file system call which captures the file metadata at once.
        https://bugs.webkit.org/show_bug.cgi?id=86995

        Reviewed by David Levin.

        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getFileMetadata):
        (WebCore):

2012-05-24  Hironori Bono  <hbono@chromium.org>

        Enable grammar checking on Chromium when we paste text  (Take 2)
        https://bugs.webkit.org/show_bug.cgi?id=74393

        Reviewed by Ryosuke Niwa.

        This change enables grammar checking on Chromium and implements a mock grammar
        checker to fix a failing test.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Show suggestions when we right-click grammatically-misspelled words.
        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled): Enable grammar checking when we enable asynchronous spellchecking.
        (WebKit::EditorClientImpl::checkGrammarOfString): set badGrammarLocation to -1 to avoid an assertion error.
        * src/WebTextCheckingResult.cpp:
        (WebKit::WebTextCheckingResult::operator TextCheckingResult): Fill GrammarDetails for grammatical errors.

2012-05-24  Alexandre Elias  <aelias@google.com>

        [chromium] Support mobile device rotation resizing
        https://bugs.webkit.org/show_bug.cgi?id=86819

        Reviewed by Adam Barth.

        Resizes on a mobile device are caused either by rotation or
        on-screen-keyboard bringup, and need different treatment to remain
        naturally laid out, scaled and scrolled without disorienting the user.

        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::resize):

2012-05-24  Antoine Labour  <piman@chromium.org>

        [chromium] Add a setForceRenderSurface to WebLayer for test/bench purpose
        https://bugs.webkit.org/show_bug.cgi?id=87436

        Reviewed by James Robinson.

        * src/WebLayer.cpp:
        (WebKit::WebLayer::setForceRenderSurface):
        (WebKit):
        (WebKit::WebLayer::forceRenderSurface):
        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):
        * tests/LayerChromiumTest.cpp:

2012-05-24  Adam Barth  <abarth@webkit.org>

        Fix the chromium-android build.

        * features.gypi:

2012-05-24  John Mellor  <johnme@chromium.org>

        Font Boosting: Add compile flag and runtime setting
        https://bugs.webkit.org/show_bug.cgi?id=87394

        Reviewed by Adam Barth.

        Expose fontBoostingEnabled runtime setting via WebSettings.

        * features.gypi:
        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setFontBoostingEnabled):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-24  Kinuko Yasuda  <kinuko@chromium.org>

        Cleanup: introduce toFile() to reduce static cast from Blob to File
        https://bugs.webkit.org/show_bug.cgi?id=87234

        Reviewed by Eric Seidel.

        * src/WebDragData.cpp:
        (WebKit::WebDragData::items):

2012-05-24  Lu Guanqun  <guanqun.lu@intel.com>

        use built-in data type DashArray
        https://bugs.webkit.org/show_bug.cgi?id=87344

        Reviewed by Eric Seidel.

        * tests/PlatformContextSkiaTest.cpp:
        (WebCore::TEST):

2012-05-24  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move queryLocalizedString to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=85762

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit::WebKitPlatformSupport::getPluginList):
        * public/platform/WebLocalizedString.h:
        * src/LocalizedStrings.cpp:
        (WebCore::query):

2012-05-24  Dana Jansens  <danakj@chromium.org>

        [chromium] Only display frames created with memory allocations meant to be displayed
        https://bugs.webkit.org/show_bug.cgi?id=85108

        Reviewed by Adrienne Walker.

        Removing code to protect visible textures when a tab becomes invisible,
        as we want to reduce our memory limit for invisible tabs and these
        textures should not be saved.

        * src/NonCompositedContentHost.cpp:
        * src/NonCompositedContentHost.h:
        (NonCompositedContentHost):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::setVisibilityState):
        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TestHooks::didCommit):
        (WTF::CCLayerTreeHostTest::CCLayerTreeHostTest):
        (WTF::CCLayerTreeHostTest::scheduleComposite):
        (WTF::CCLayerTreeHostTest::dispatchComposite):
        (CCLayerTreeHostTest):
        (WTF::CCLayerTreeHostTest::doBeginTest):
        (CCLayerTreeHostTestTickAnimationWhileBackgrounded):
        (WTF::CCLayerTreeHostTestTickAnimationWhileBackgrounded::willAnimateLayers):
        (CCLayerTreeHostTestVisibilityAndAllocationControlDrawing):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::beginTest):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommitAndDrawFrame):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::didCommit):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::commitCompleteOnCCThread):
        (WTF::CCLayerTreeHostTestVisibilityAndAllocationControlDrawing::afterTest):
        (WTF):

2012-05-24  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118352.
        http://trac.webkit.org/changeset/118352
        https://bugs.webkit.org/show_bug.cgi?id=87390

        Caused 6 editing/spelling tests crash/fail on chromium in
        debug. (Requested by vsevik on #webkit).

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems):
        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled):
        * src/WebTextCheckingResult.cpp:
        (WebKit::WebTextCheckingResult::operator TextCheckingResult):

2012-05-24  Ian Vollick  <vollick@chromium.org>

        [chromium] Forcibly sync running animations in the waiting state when synchronized start times are needed.
        https://bugs.webkit.org/show_bug.cgi?id=87153

        Reviewed by James Robinson.

        * tests/CCLayerAnimationControllerTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):

2012-05-23  Yury Semikhatsky  <yurys@chromium.org>

        Web Inspector: add a command to InspectorMemoryAgent for getting process memory break down
        https://bugs.webkit.org/show_bug.cgi?id=87263

        Reviewed by Pavel Feldman.

        Added an API for retrieving render process private and shared memory in bytes.

        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        (WebKit::WebKitPlatformSupport::getProcessMemorySize):
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::getProcessMemorySize):
        (WebCore):

2012-05-24  Hironori Bono  <hbono@chromium.org>

        Enable grammar checking on Chromium when we paste text.
        https://bugs.webkit.org/show_bug.cgi?id=74393

        Reviewed by Hajime Morita.

        This change enables grammar checking on Chromium and implements a mock grammar
        checker to fix a failing test.

        * src/ContextMenuClientImpl.cpp:
        (WebKit::ContextMenuClientImpl::getCustomMenuFromDefaultItems): Show suggestions when we right-click grammatically-misspelled words.
        * src/EditorClientImpl.cpp:
        (WebKit::EditorClientImpl::isGrammarCheckingEnabled): Enable grammar checking when we enable asynchronous spellchecking.
        * src/WebTextCheckingResult.cpp:
        (WebKit::WebTextCheckingResult::operator TextCheckingResult): Fill GrammarDetails for grammatical errors.

2012-05-24  Vivek Galatage  <vivekgalatage@gmail.com>

        Web Inspector: localStorage items are not updated when the storage changes
        https://bugs.webkit.org/show_bug.cgi?id=83012

        Reviewed by Pavel Feldman.

        Instrumented the DOM Storage Events in order to update the frontend.

        * src/StorageAreaProxy.cpp:
        (WebCore::StorageAreaProxy::dispatchLocalStorageEvent):
        (WebCore::StorageAreaProxy::dispatchSessionStorageEvent):

2012-05-23  Ojan Vafai  <ojan@chromium.org>

        add back the ability to disable flexbox
        https://bugs.webkit.org/show_bug.cgi?id=87147

        Reviewed by Tony Chang.

        * features.gypi:

2012-05-23  Dana Jansens  <danakj@chromium.org>

        [chromium] Enable the CCLayerTreeHostTestCanDrawBlocksDrawing test in single-threaded mode
        https://bugs.webkit.org/show_bug.cgi?id=87308

        Reviewed by James Robinson.

        Chromium bug: http://crbug.com/127481

        Unit test: CCLayerTreeHostTestCanDrawBlocksDrawing.runSingleThread

        * tests/CCLayerTreeHostTest.cpp:
        (WTF::TestHooks::didCommit):
        (WTF):
        (WTF::CCLayerTreeHostTestCanDrawBlocksDrawing::didCommit):

2012-05-23  James Robinson  <jamesr@chromium.org>

        Add a Setting to make position:fixed form a new stacking context
        https://bugs.webkit.org/show_bug.cgi?id=87186

        Reviewed by Adam Barth.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setFixedPositionCreatesStackingContext):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-23  James Robinson  <jamesr@chromium.org>

        [chromium] Turn ENABLE(OVERFLOW_SCROLLING) off for Chromium port
        https://bugs.webkit.org/show_bug.cgi?id=87177

        Reviewed by Eric Seidel.

        Removes ENABLE(OVERFLOW_SCROLLING) from the set of enables set by Chromium. This guards a new non-standard
        CSS property, -webkit-overflow-scrolling, that was introduced by iOS5 intended for mobile browsers. This
        property is very partially implemented in Chromium but the way it's implemented does cause new stacking contexts
        to be created that otherwise would not be, breaking "desktop" pages.

        This turns the feature off until we can figure out how to deal with the compatibility issues.

        * features.gypi:

2012-05-23  Jay Civelli  <jcivelli@chromium.org>

        [chromium] Provides a way to cancel an external popup menu before it is shown.
        https://bugs.webkit.org/show_bug.cgi?id=83474

        Reviewed by Kent Tamura.

        * src/ExternalPopupMenu.cpp:
        (WebKit::ExternalPopupMenu::show):

2012-05-23  Michael Nordman  <michaeln@google.com>

        [chromium] DomStorage events handling needs TLC (3)
        https://bugs.webkit.org/show_bug.cgi?id=87031
        https://code.google.com/p/chromium/issues/detail?id=128482
        Only queue storage events for Documents which have allocated
        a WebCore::Storage instance since pages that have attached onstorage
        event handlers must have a non-null Storage instance.

        Reviewed by Adam Barth.

        * src/StorageAreaProxy.cpp:
        (WebCore::StorageAreaProxy::dispatchLocalStorageEvent):
        (WebCore::StorageAreaProxy::dispatchSessionStorageEvent):
        (WebCore::StorageAreaProxy::isEventSource):

2012-05-23  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118218.
        http://trac.webkit.org/changeset/118218
        https://bugs.webkit.org/show_bug.cgi?id=87299

        breaks webkit win builder (Requested by pilgrim_google__ on
        #webkit).

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        (WebKit::WebKitPlatformSupport::queryLocalizedString):
        * public/platform/WebLocalizedString.h:
        (WebKit):
        * src/LocalizedStrings.cpp:
        (WebCore::query):

2012-05-23  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move themeEngine to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=87268

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKit::WebKitPlatformSupport::sandboxSupport):
        * public/platform/android/WebThemeEngine.h:
        * public/platform/linux/WebThemeEngine.h:
        * public/platform/mac/WebThemeEngine.h:
        * public/platform/win/WebThemeEngine.h:
        * src/AssertMatchingEnums.cpp:
        * src/PlatformSupport.cpp:
        (WebCore::PlatformSupport::paintButton):
        (WebCore::PlatformSupport::paintMenuList):
        (WebCore::PlatformSupport::paintScrollbarArrow):
        (WebCore::PlatformSupport::paintScrollbarThumb):
        (WebCore::PlatformSupport::paintScrollbarTrack):
        (WebCore::PlatformSupport::paintSpinButton):
        (WebCore::PlatformSupport::paintTextField):
        (WebCore::PlatformSupport::paintTrackbar):
        (WebCore::PlatformSupport::paintProgressBar):
        (WebCore::PlatformSupport::getThemePartSize):
        (WebCore::PlatformSupport::paintThemePart):

2012-05-23  Raymes Khoury  <raymes@chromium.org>

        Change acceptMIMETypes member to acceptTypes now that file extensions are legal accept types
        https://bugs.webkit.org/show_bug.cgi?id=87271

        Reviewed by Darin Fisher.

        * public/WebFileChooserParams.h:
        (WebFileChooserParams):
        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::runOpenPanel):

2012-05-23  Dana Jansens  <danakj@chromium.org>

        [chromium] Layers on main thread should get a RenderSurface for animating transform only if masksToBounds is true also
        https://bugs.webkit.org/show_bug.cgi?id=87184

        Reviewed by James Robinson.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):

2012-05-23  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move queryLocalizedString to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=85762

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit::WebKitPlatformSupport::getPluginList):
        * public/platform/WebLocalizedString.h:
        * src/LocalizedStrings.cpp:
        (WebCore::query):

2012-05-23  Antti Koivisto  <antti@apple.com>

        Build fix.

        Not reviewed.

        * src/WebDocument.cpp:
        (WebKit::WebDocument::insertUserStyleSheet):

2012-05-22  Alexandre Elias  <aelias@google.com>

        [chromium] Apply viewport tag initial-scale only once
        https://bugs.webkit.org/show_bug.cgi?id=82949

        Reviewed by Adam Barth.

        First, check that isPageScaleFactorSet return false before setting
        initial-scale. We need to call dispatchViewportPropertiesDidChange()
        when the viewport width changes, since that's an input to the viewport
        tag calculation. When this happens, we shouldn't pop back to initial
        scale.

        Second, check that isNewNavigation is true when deciding to clear
        isPageScaleFactorIsSet in didCommitLoad. We only want to clear it on
        the very first commit, otherwise we'll pop back to initial scale if
        the user zooms in before the load is complete.

        New test WebFrameTest::FixedLayoutInitializeAtMinimumPageScale.

        * src/ChromeClientImpl.cpp:
        (WebKit::ChromeClientImpl::dispatchViewportPropertiesDidChange):
        * src/WebViewImpl.cpp:
        (WebKit::WebViewImpl::didCommitLoad):

2012-05-21  Shawn Singh  <shawnsingh@chromium.org>

        Improve W3C conformance of backface-visibility
        https://bugs.webkit.org/show_bug.cgi?id=84195

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):

2012-05-22  Sheriff Bot  <webkit.review.bot@gmail.com>

        Unreviewed, rolling out r118095.
        http://trac.webkit.org/changeset/118095
        https://bugs.webkit.org/show_bug.cgi?id=87201

        "Causing crashes on Mac in
        WebCore::StyleResolver::adjustRenderStyle (Requested by
        sundiamonde on #webkit).

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-22  Xianzhu Wang  <wangxianzhu@chromium.org>

        [Chromium-Android] Run DumpRenderTree as an apk (C++ and gyp part)
        https://bugs.webkit.org/show_bug.cgi?id=86922

        Reviewed by Kent Tamura.

        * All.gyp: Added DumpRenderTree_apk into dependencies for Android.

2012-05-22  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Call canAccelerate2dCanvas directly
        https://bugs.webkit.org/show_bug.cgi?id=86893

        Reviewed by James Robinson.

        Part of a refactoring series. See tracking bug 82948.

        * public/platform/WebKitPlatformSupport.h:
        (WebKitPlatformSupport):
        * src/PlatformSupport.cpp:
        (WebCore):

2012-05-22  Dana Jansens  <danakj@chromium.org>

        [chromium] Don't drop children of a RenderSurface from the renderSurfaceLayerList when then position of the surface in its clipRect is not known
        https://bugs.webkit.org/show_bug.cgi?id=87181

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):
        (WebKitTests):

2012-05-22  MORITA Hajime  <morrita@google.com>

        [Chromium][API] Introduce WebPermissionClient::allowWebComponents()
        https://bugs.webkit.org/show_bug.cgi?id=87097

        Reviewed by Kent Tamura.

        - Added WebPermissionClient::allowWebComponents(), and
        - Implemented FrameLoaderClientImpl::shadowDOMAllowed() using it.

        * public/WebPermissionClient.h:
        (WebPermissionClient):
        (WebKit::WebPermissionClient::allowWebComponents):
        * src/FrameLoaderClientImpl.cpp:
        (WebKit::FrameLoaderClientImpl::shadowDOMAllowed):
        (WebKit):
        * src/FrameLoaderClientImpl.h:
        (FrameLoaderClientImpl):

2012-05-22  James Robinson  <jamesr@chromium.org>

        Add a Setting to make position:fixed form a new stacking context
        https://bugs.webkit.org/show_bug.cgi?id=87186

        Reviewed by Adam Barth.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setFixedPositionCreatesStackingContext):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-22  Dana Jansens  <danakj@chromium.org>

        [chromium] Don't force the visibleLayerRect to be empty for animating layers whose front face is not visible
        https://bugs.webkit.org/show_bug.cgi?id=86886

        Reviewed by Adrienne Walker.

        * tests/CCLayerTreeHostCommonTest.cpp:
        (WebKitTests::TEST):

2012-05-22  Mark Pilgrim  <pilgrim@chromium.org>

        [Chromium] Move cookieJar to Platform.h
        https://bugs.webkit.org/show_bug.cgi?id=86755

        Reviewed by Adam Barth.

        Part of a refactoring series. See tracking bug 82948.

        * WebKit.gyp:
        * public/platform/WebCookie.h:
        * public/platform/WebCookieJar.h:
        * public/platform/WebKitPlatformSupport.h:
        (WebKit):
        (WebKit::WebKitPlatformSupport::themeEngine):
        * src/PlatformSupport.cpp:
        (WebCore::getCookieJar):

2012-05-22  Jochen Eisinger  <jochen@chromium.org>

        Unreviewed.  Rolled DEPS.

        * DEPS:

2012-05-22  Kausalya Madhusudhanan  <kmadhusu@chromium.org>

        [Chromium] Use overloaded printBegin() webkit API to support auto fit to page functionality.
        https://bugs.webkit.org/show_bug.cgi?id=86684

        Reviewed by Darin Fisher.

        * public/WebFrame.h:
        (WebFrame):
        * public/WebPlugin.h:
        (WebPlugin):
        * public/WebPrintParams.h:
        (WebKit::WebPrintParams::WebPrintParams):
        (WebPrintParams):
        * src/WebFrameImpl.cpp:
        (WebKit):
        * src/WebFrameImpl.h:
        (WebFrameImpl):
        * src/WebPluginContainerImpl.cpp:
        (WebKit::WebPluginContainerImpl::printBegin):

2012-05-22  Adam Barth  <abarth@webkit.org>

        [Chromium] Expose setMediaPlaybackRequiresUserGesture via WebSettings
        https://bugs.webkit.org/show_bug.cgi?id=87164

        Reviewed by Eric Seidel.

        This is used by the Chromium Android port.

        * public/WebSettings.h:
        * src/WebSettingsImpl.cpp:
        (WebKit::WebSettingsImpl::setMediaPlaybackRequiresUserGesture):
        (WebKit):
        * src/WebSettingsImpl.h:
        (WebSettingsImpl):

2012-05-21  Shawn Singh  <shawnsingh@chromium.org>

        [chromium] Add unit testing for WebTransformationMatrix::blend()
        https://bugs.webkit.org/show_bug.cgi?id=87066

        Reviewed by Adrienne Walker.

        8 more unit tests added:
        WebTransformationMatrixTest.verifyBlendForTranslation
        WebTransformationMatrixTest.verifyBlendForScale
        WebTransformationMatrixTest.verifyBlendForSkewX
        WebTransformationMatrixTest.verifyBlendForSkewY
        WebTransformationMatrixTest.verifyBlendForRotationAboutX
        WebTransformationMatrixTest.verifyBlendForRotationAboutY
        WebTransformationMatrixTest.verifyBlendForRotationAboutZ
        WebTransformationMatrixTest.verifyBlendForCompositeTransform

        * tests/WebTransformationMatrixTest.cpp:
        (WebKit::TEST):
        (WebKit):
        (WebKit::printTransform):

== Rolled over to ChangeLog-2012-05-22 ==
